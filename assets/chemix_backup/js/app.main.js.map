{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/api/auth/storage.ts","webpack:///./src/components/radio.tsx","webpack:///./src/components/combo_slider.tsx","webpack:///./src/apparatus/library/transportation/schlenk_lines.ts","webpack:///./src/apparatus/library/decorative/mirror.ts","webpack:///./src/layout/app.tsx","webpack:///./src/apparatus/library/tripod.ts","webpack:///./src/apparatus/library/measurement/hydrometer.ts","webpack:///./src/apparatus/debug.ts","webpack:///./src/tiers/promo_ui.tsx","webpack:///./src/store/actions.ts","webpack:///./src/apparatus/library/biology/equipment/microplates.ts","webpack:///./src/apparatus/library/biology/organic/agar.ts","webpack:///./src/apparatus/library/heating/calorimetry_cup.ts","webpack:///./src/apparatus/library/biology/equipment/water_bath.ts","webpack:///./src/apparatus/library/biology/equipment/choice_chamber.ts","webpack:///./src/components/colorpicker.tsx","webpack:///./src/apparatus/library/biology/equipment/scalpel.ts","webpack:///./src/apparatus/library/biology/organic/shoot.ts","webpack:///./src/apparatus/library/measure/ph_probe.ts","webpack:///./src/tiers/promo_plus.tsx","webpack:///./src/apparatus/library/biology/equipment/tweezers.ts","webpack:///./src/apparatus/library/accessories/microscope.ts","webpack:///./src/apparatus/library/measurement/triple_beam_balance.ts","webpack:///./src/apparatus/library/physics/raybox.ts","webpack:///./src/apparatus/library/container/weight_boat.ts","webpack:///./src/apparatus/library/decorative/beads.ts","webpack:///./src/apparatus/library/container/cell_flask.ts","webpack:///./src/components/text_input.tsx","webpack:///./src/apparatus/library/accessories/faucet.ts","webpack:///./src/tiers/badge.tsx","webpack:///./src/file/diagram.tsx","webpack:///./src/apparatus/library/measurement/tape.ts","webpack:///./src/apparatus/library/accessories/sellotape.ts","webpack:///./src/apparatus/library/burette.ts","webpack:///./src/log.ts","webpack:///./src/apparatus/library/spotting_tile.ts","webpack:///./src/api/api.ts","webpack:///./src/layout/sidebar/tabbed_sidebar.tsx","webpack:///./src/apparatus/library/live_apparatus.ts","webpack:///./src/ext/array.ts","webpack:///./src/apparatus/library/electrical/ammeter.ts","webpack:///./src/layout/top_bar/extras.tsx","webpack:///./src/apparatus/library/metallic/steel_wool.ts","webpack:///./src/apparatus/library/accessories/joint_clip.ts","webpack:///./src/apparatus/library/physics/light_gates.ts","webpack:///./src/panel/propertyPanel.ts","webpack:///./src/apparatus/library/decorative/camera.ts","webpack:///./src/apparatus/library/metallic/nichrome_loops.ts","webpack:///./src/arrows/component.ts","webpack:///./src/apparatus/library/shapes/triangle.ts","webpack:///./src/components/propertyPanel.tsx","webpack:///./src/apparatus/library/metallic/hoffman_clamp.ts","webpack:///./src/view/tooltips.ts","webpack:///./src/apparatus/library/borked.ts","webpack:///./src/tools.ts","webpack:///./src/apparatus/library/heating/peg.ts","webpack:///./src/apparatus/library/retort.ts","webpack:///./src/version.ts","webpack:///./src/apparatus/library/crucible.ts","webpack:///./src/apparatus/library/biology/equipment/petri_top.ts","webpack:///./src/components/slider.tsx","webpack:///./src/apparatus/library/devices/spectrophotometer.ts","webpack:///./src/editing/snapping/compute.ts","webpack:///./src/apparatus/library/accessories/tlc_plate.ts","webpack:///./src/editing/handle.ts","webpack:///./src/apparatus/library/accessories/ph_paper.ts","webpack:///./src/editing/clipboard.ts","webpack:///./src/ext/js.ts","webpack:///./src/apparatus/library/biology/organic/bacteria.ts","webpack:///./src/apparatus/library/hot_plate.ts","webpack:///./src/apparatus/library/measurement/vernier.ts","webpack:///./src/freehand/apparatus.ts","webpack:///./src/apparatus/library/wire_gauze.ts","webpack:///./src/apparatus/library/raster_image.ts","webpack:///./src/apparatus/library/devices/hofmann.ts","webpack:///./src/apparatus/library/clamp.ts","webpack:///./src/editing/multilayerliquids.ts","webpack:///./src/apparatus/library/reagent_bottle.ts","webpack:///./src/apparatus/library/decorative/crystals.ts","webpack:///./src/apparatus/library/heating/sandbath.ts","webpack:///./src/apparatus/library/metalstrip.ts","webpack:///./src/apparatus/library/gas_jar.ts","webpack:///./src/layout/modals/new.tsx","webpack:///./src/apparatus/library/gas_wash_bottle.ts","webpack:///./src/apparatus/library/heating/boilingtube.ts","webpack:///./src/apparatus/library/shapes/cylinder.ts","webpack:///./src/layout/modals/welcome.tsx","webpack:///./src/layout/editor/editor_container.tsx","webpack:///./src/apparatus/library/physics/slotted_weight.ts","webpack:///./src/apparatus/library/container/eppendorfTube.ts","webpack:///./src/editing/deleting.ts","webpack:///./src/layout/top_bar/main_menu.tsx","webpack:///./src/apparatus/library/mortar.ts","webpack:///./src/apparatus/library/biology/other/plant_pot.ts","webpack:///./src/apparatus/library/biology/other/dirt.ts","webpack:///./src/editing/rotation/rotation_handler.ts","webpack:///./src/apparatus/library/biology/organic/seed.ts","webpack:///./src/store/id.ts","webpack:///./src/apparatus/library/devices/spectrophotometer_schematic.ts","webpack:///./src/apparatus/library/transportation/osmosis_tube.ts","webpack:///./src/layout/modals/about.tsx","webpack:///./src/editing/arrange/align.ts","webpack:///./src/layout/top_bar/account.tsx","webpack:///./src/panel/apparatus_panel_ui.tsx","webpack:///./src/apparatus/library/distillation/distillation_head.ts","webpack:///./src/apparatus/library/measure/digital_themormeter.ts","webpack:///./src/apparatus/library/flask.ts","webpack:///./src/layout/modals/my_account.tsx","webpack:///./src/apparatus/library/pump.ts","webpack:///./src/view/zoom.ts","webpack:///./src/apparatus/library/spatula.ts","webpack:///./src/apparatus/library/lamp.ts","webpack:///./src/apparatus/library/biology/organic/potato.ts","webpack:///./src/text/ui.tsx","webpack:///./src/apparatus/library/shapes/common.ts","webpack:///./src/bootstrap_colorpicker_extensions.ts","webpack:///./src/apparatus/library/accessories/drop_counter.ts","webpack:///./src/apparatus/library/accessories/tap.ts","webpack:///./src/apparatus/library/measure/conductimeter.ts","webpack:///./src/apparatus/library/accessories/paper_clip.ts","webpack:///./src/apparatus/library/distillation/distillation_flask.ts","webpack:///./src/support/beacon.ts","webpack:///./src/apparatus/library/container/centrifugeTube.ts","webpack:///./src/math.ts","webpack:///./src/apparatus/library/physics/cable.ts","webpack:///./src/apparatus/library/biology/equipment/cover_slip.ts","webpack:///./src/editing/rotation/rotation_overlay.tsx","webpack:///./src/apparatus/library/tank.ts","webpack:///./src/apparatus/library/magnetic_stirrer.ts","webpack:///./src/apparatus/library/timer.ts","webpack:///./src/view/formatters.ts","webpack:///./src/apparatus/library/coldfinger.ts","webpack:///./src/apparatus/library/accessories/glove.ts","webpack:///./src/apparatus/library/distillation/splash_head.ts","webpack:///./src/apparatus/library/bunsen.ts","webpack:///./src/apparatus/library/accessories/tlc_spot.ts","webpack:///./src/file/type.ts","webpack:///./src/apparatus/library/utility/wash_bottle.ts","webpack:///./src/layout/sidebar/apparatus_item.tsx","webpack:///./src/apparatus/library/accessories/scissors.ts","webpack:///./src/apparatus/library/physics/solenoid.ts","webpack:///./src/apparatus/library/gas_syringe.ts","webpack:///./src/apparatus/library/accessories/splint.ts","webpack:///./src/apparatus/library/decorative/label.ts","webpack:///./src/layout/sidebar/sidebar.tsx","webpack:///./src/apparatus/library/distillation/receiver_adaptor.ts","webpack:///./src/layout/top_bar/top_bar.tsx","webpack:///./src/ordering/actions.ts","webpack:///./src/apparatus/library/buchner.ts","webpack:///./src/apparatus/specList.ts","webpack:///./src/components/checkbox.tsx","webpack:///./src/apparatus/library/measurement/digital_meters.ts","webpack:///./src/apparatus/text/appearance.ts","webpack:///./src/random/random.ts","webpack:///./src/apparatus/library/pipette.ts","webpack:///./src/apparatus/library/container/thermos_flask.ts","webpack:///./src/apparatus/library/filter.ts","webpack:///./src/layout/editor/context_menu.tsx","webpack:///./src/apparatus/library/accessories/candle.ts","webpack:///./src/apparatus/library/accessories/tlc_chamber.ts","webpack:///./src/apparatus/library/petri.ts","webpack:///./src/apparatus/library/container/gas_cylinder.ts","webpack:///./src/apparatus/library/thermometer.ts","webpack:///./src/editing/pathedit/tool.ts","webpack:///./src/apparatus/library/heating/testTubeHolder.ts","webpack:///./src/apparatus/library/stirringRod.ts","webpack:///./src/apparatus/library/testTube.ts","webpack:///./src/apparatus/library/heating/spirit_lamp.ts","webpack:///./src/apparatus/library/biology/equipment/microscope_slide.ts","webpack:///./src/apparatus/library/balance.ts","webpack:///./src/apparatus/library/roundBottomFlask.ts","webpack:///./src/apparatus/library/transportation/dialysis.ts","webpack:///./src/tiers/promo_table.tsx","webpack:///./src/apparatus/driver.ts","webpack:///./src/file/api.ts","webpack:///./src/apparatus/library/tubes.ts","webpack:///./src/layout/editor/selection_overlay.tsx","webpack:///./src/apparatus/library/shapes/rectangle.ts","webpack:///./src/apparatus/library/shapes/ellipse.ts","webpack:///./src/tiers/apparatus.ts","webpack:///./src/apparatus/library/decorative/flame.ts","webpack:///./src/apparatus/library/nail.ts","webpack:///./src/apparatus/library/measurement/micropipette.ts","webpack:///./src/apparatus/library/distillation/cow_type.ts","webpack:///./src/apparatus/library/watch_glass.ts","webpack:///./src/apparatus/library/measurement/suction_pear.ts","webpack:///./src/apparatus/library/dropper.ts","webpack:///./src/apparatus/library/distillation/waterless_condenser.ts","webpack:///./src/apparatus/library/distillation/soxhlet.ts","webpack:///./src/components/searchbox.tsx","webpack:///./src/freehand/tool.ts","webpack:///./src/editing/grouping/operations.ts","webpack:///./src/panel/appearance_spec_converter.tsx","webpack:///./src/apparatus/library/decorative/drop.ts","webpack:///./src/file/loading.ts","webpack:///./src/apparatus/library/biology/organic/leaf.ts","webpack:///./src/apparatus/library/accessories/smoke.ts","webpack:///./src/apparatus/library/shapes/star.ts","webpack:///./src/command/basic.ts","webpack:///./src/arrows/tool.ts","webpack:///./src/ordering/reorder.ts","webpack:///./src/apparatus/library/shapes/line.ts","webpack:///./src/apparatus/library/heating/beehive.ts","webpack:///./src/apparatus/library/distillation/liebig.ts","webpack:///./src/apparatus/library/distillation/graham.ts","webpack:///./src/apparatus/library/transportation/drop_funnel.ts","webpack:///./src/arrows/command.ts","webpack:///./src/apparatus/library/accessories/bottle.ts","webpack:///./src/text/parse.ts","webpack:///./src/apparatus/library/cylinder.ts","webpack:///./src/apparatus/library/electrical/powerpack.ts","webpack:///./src/apparatus/library/physics/trolley.ts","webpack:///./src/apparatus/library/electrical/voltmeter.ts","webpack:///./src/view/keyboard_shortucts.tsx","webpack:///./src/panel/arrow_panel_ui.tsx","webpack:///./src/editing/rotation/rotate_command.ts","webpack:///./src/apparatus/library/condensers.ts","webpack:///./src/apparatus/library/biology/other/sun.ts","webpack:///./src/apparatus/library/accessories/balloon.ts","webpack:///./src/apparatus/library/thiele.ts","webpack:///./src/apparatus/library/accessories/goggles.ts","webpack:///./src/apparatus/library/volumetric_flask.ts","webpack:///./src/apparatus/library/electrical/battery.ts","webpack:///./src/apparatus/library/accessories/cork_ring.ts","webpack:///./src/setup.ts","webpack:///./src/api/querystringlite.ts","webpack:///./src/layout/top_bar/toolbox.tsx","webpack:///./src/apparatus/library/distillation/dean_stark_trap.ts","webpack:///./src/tiers/currency.ts","webpack:///./src/apparatus/library/devices/fume_hood.ts","webpack:///./src/apparatus/library/biology/equipment/potometer.ts","webpack:///./src/command/command.ts","webpack:///./src/editing/move.ts","webpack:///./src/shim-types.ts","webpack:///./src/apparatus/library/capillary_tube.ts","webpack:///./less/styles.less?68db","webpack:///./src/apparatus/library/heating/stick_lighter.ts","webpack:///./src/components/remodal.tsx","webpack:///./src/apparatus/library/cuvette.ts","webpack:///./src/apparatus/index.ts","webpack:///./src/api/auth/reauth.ts","webpack:///./src/apparatus/library/bench_mat.ts","webpack:///./src/apparatus/library/heating/torch.ts","webpack:///./src/apparatus/library/measure/oxsat_probe.ts","webpack:///./src/apparatus/library/measurement/pipette_bottle.ts","webpack:///./src/apparatus/search.ts","webpack:///./src/apparatus/library/measurement/beam_balance.ts","webpack:///./src/panel/shared.ts","webpack:///./src/apparatus/library/beaker.ts","webpack:///./src/apparatus/library/devices/sonicator.ts","webpack:///./src/apparatus/library/shapes/cross.ts","webpack:///./src/arrows/type.ts","webpack:///./src/utils.ts","webpack:///./src/view/pan.ts","webpack:///./src/apparatus/library/measurement/protractor.ts","webpack:///./src/apparatus/library/container/pear_flask.ts","webpack:///./src/apparatus/library/heating/combustion_spoon.ts","webpack:///./src/layout/modals/export_image.tsx","webpack:///./src/apparatus/library/index.ts","webpack:///./src/apparatus/library/distillation/allihn.ts","webpack:///./src/store/reducers.ts","webpack:///./src/apparatus/library/accessories/glass_stopper.ts","webpack:///./src/apparatus/library/table.ts","webpack:///./src/apparatus/draw.ts","webpack:///./src/editing/interaction.ts","webpack:///./src/apparatus/library/decorative/ice_cube.ts","webpack:///./src/components/button.tsx","webpack:///./src/apparatus/library/decorative/bubbles.ts","webpack:///./src/apparatus/library/biology/organic/pond_weed.ts","webpack:///./src/apparatus/library/decorative/particles.ts","webpack:///./src/layout/editor/editor_canvas.tsx","webpack:///./src/editing/zoom.tsx","webpack:///./src/apparatus/library/shapes/tick.ts","webpack:///./src/apparatus/library/bung.ts","webpack:///./src/apparatus/library/distillation/vigreux.ts","webpack:///./src/tiers/promo.tsx","webpack:///./src/apparatus/library/test_tube_rack.ts","webpack:///./src/apparatus/library/electrical/crocodile_clip.ts","webpack:///./src/apparatus/library/physics/spring.ts","webpack:///./src/browser/cookie.ts","webpack:///./src/components/text_replacements.ts","webpack:///./src/apparatus/library/biology/equipment/quadrat.ts","webpack:///./src/editing/grouping/commands.ts","webpack:///./src/apparatus/library/storage/plastic_reagent_bottle.ts","webpack:///./src/apparatus/library/physics/ramp.ts","webpack:///./src/apparatus/library/biology/organic/plant_shoot.ts","webpack:///./src/apparatus/library/evaporating_dish.ts","webpack:///./src/apparatus/library/schlenk_flask.ts","webpack:///./src/apparatus/library/structure/jack.ts","webpack:///./src/apparatus/library/electrical/magnet.ts","webpack:///./src/apparatus/library/biology/organic/bug.ts","webpack:///./src/apparatus/library/accessories/ghs_hazard_symbol.ts","webpack:///./src/apparatus/specs.ts","webpack:///./src/editing/arrange/distribute.ts","webpack:///./src/vars.ts","webpack:///./src/apparatus/library/common/tap.ts","webpack:///./src/editing/multitool.ts","webpack:///./src/file/open_modal.tsx","webpack:///./src/apparatus/library/decorative/eye.ts","webpack:///./src/editing/image_export.ts","webpack:///./src/components/icon.tsx","webpack:///./src/layout/modals/help.tsx","webpack:///./src/editing/snapping/type.ts","webpack:///./src/types.ts","webpack:///./src/panel/same_type_apparatus.tsx","webpack:///./src/editing/snapping/visualise.ts","webpack:///./src/apparatus/library/biology/organic/streaked_bacteria.ts","webpack:///./src/apparatus/library/syringe.ts","webpack:///./src/api/specialErrorHandler.ts","webpack:///./src/editing/undo_redo.ts","webpack:///./src/apparatus/library/accessories/pencil.ts","webpack:///./src/apparatus/common.ts","webpack:///./src/apparatus/library/biology/organic/root.ts","webpack:///./src/apparatus/library/physics/glass_block.ts","webpack:///./src/analytics.ts","webpack:///./src/apparatus/library/glass_wool.ts","webpack:///./src/apparatus/library/heating/tongs.ts","webpack:///./src/apparatus/library/distillation/fractionating.ts","webpack:///./src/components/text_area.tsx","webpack:///./src/flags.ts","webpack:///./src/apparatus/library/shapes/curve.ts","webpack:///./src/apparatus/library/physics/pulley.ts","webpack:///./src/apparatus/library/desiccator.ts","webpack:///./src/apparatus/library/container/thistle.ts","webpack:///./src/tiers/context.tsx","webpack:///./src/store/store.ts","webpack:///./src/apparatus/library/ruler.ts","webpack:///./src/panel/ordering_ui.tsx","webpack:///./src/apparatus/library/accessories/lamp.ts","webpack:///./src/keyboard.ts","webpack:///./src/panel/property_panel_adapter.tsx","webpack:///external \"paper\"","webpack:///./src/api/auth/login_button.tsx","webpack:///./src/apparatus/library/devices/rotavap.ts","webpack:///./src/paper_ext.ts","webpack:///./src/apparatus/library/heating/mantle.ts","webpack:///./src/apparatus/library/heating/clay_triangle.ts","webpack:///./src/apparatus/library/separatory.ts","webpack:///./src/apparatus/library/structure/burette_clamp.ts","webpack:///./src/apparatus/library/structure/burette_holder.ts","webpack:///./src/components/select.tsx","webpack:///./src/text/render.ts","webpack:///./src/apparatus/library/accessories/wool.ts","webpack:///./src/apparatus/library/shapes/sphere.ts","webpack:///./src/api/auth/types.ts","webpack:///./src/apparatus/component.ts","webpack:///./src/apparatus/library/measurement/manometer.ts","webpack:///./src/apparatus/library/devices/centrifuge.ts","webpack:///./src/apparatus/library/shapes/cuboid.ts","webpack:///./src/apparatus/library/distillation/oil_bubbler.ts","webpack:///./src/editing/selection.ts","webpack:///./src/tutorial.ts","webpack:///./src/apparatus/library/accessories/felt_tip_pen.ts","webpack:///./src/apparatus/library/decorative/powder.ts","webpack:///./src/layout/top_bar/button_group.tsx","webpack:///./src/apparatus/library/shapes/arrow.ts","webpack:///./src/main.ts","webpack:///./src/ext/color.ts"],"names":[],"mappings":";AAAA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAQ,oBAAoB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yBAAiB,4BAA4B;AAC7C;AACA;AACA,0BAAkB,2BAA2B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;AACA;AACA;AACA,wBAAgB,uBAAuB;AACvC;;;AAGA;AACA;AACA;AACA;;;;;;;;;;;;;ACvJA;AAAA;AAAA;AAAA;AAAA;AACO;AACP;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACzBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAC+B;AACa;AAC5C;AACO;AACP,gBAAgB,gDAAgB,CAAC,yDAAW;AAC5C,WAAW,mDAAmB,CAAC,8CAAc;AAC7C;AACA;AACA;AACA,eAAe,mDAAmB,SAAS,uDAAuD;AAClG,YAAY,mDAAmB,WAAW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A;AACA;AACA;AACA;AACA;AACA,QAAQ,mDAAC;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA,QAAQ,uDAAgB;AACxB;AACA,oCAAoC,8EAAyB;AAC7D;AACA,YAAY,2DAAoB,EAAE,yBAAyB,sDAAe,qDAAqD;AAC/H,0BAA0B,8DAAuB;AACjD;AACA;AACA,gCAAgC,mBAAmB;AACnD,gBAAgB,8DAAuB,WAAW,mBAAmB;AACrE;AACA,SAAS;AACT;AACA;AACA,CAAC,CAAC,gDAAS;AACI;AACf;AACA;AACA;AACA;AACA,4DAA4D,sBAAsB,EAAE;AACpF,+DAA+D,uBAAuB,EAAE;AACxF;AACA;AACA;AACA;AACA,sBAAsB,0DAAQ;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,mBAAmB,4DAAO;;;;;;;;;;;;;AC7PjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAA0D;AACN;AAChB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,0CAAI,CAAC,yEAAQ;AACvC,QAAQ,8DAAO;AACf,QAAQ,sEAAe;AACvB,uBAAuB,2CAAK;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiB;;;;;;;;;;;;;AC1ClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsE;AACf;AACnB;AACpC;AACA;AACA;AACA;AACA,wBAAwB,0CAAI,CAAC,yEAAQ;AACrC,QAAQ,8DAAO;AACf;AACA,0BAA0B,0CAAI,CAAC,yEAAQ;AACvC,QAAQ,8DAAO;AACf;AACA;AACA;AACA,QAAQ,sEAAe;AACvB;AACA;AACA,0BAA0B,2CAAK;AAC/B,QAAQ,iEAAU,UAAU,kEAAC,cAAc,kEAAC;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;A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;;;AC9DtB;AAAA;AAAA;AAAA;AAAA;AAAoD;AACf;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,2CAAK,WAAW,kEAAC;AACpC,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,2CAAK,WAAW,kEAAC;AACnC,oBAAoB,2CAAK,WAAW,kEAAC,0BAA0B,8DAAK;AACpE,qBAAqB,2CAAK,WAAW,kEAAC,0BAA0B,8DAAK;AACrE,mBAAmB,2CAAK,WAAW,kEAAC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,uCAAuC,mBAAmB;AAC1D,aAAa;AACb;AACA;AACA,uCAAuC,mBAAmB;AAC1D,aAAa;AACb;AACA;AACA;AACA,CAAC;AACe;;;;;;;;;;;;;ACtEhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAoC;AACC;AACG;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC,sBAAsB,0CAAI,CAAC,wDAAQ;AACnC,QAAQ,qDAAO;AACf;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,oBAAoB,iDAAC,4CAA4C;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;;;;;;;;;;;;;ACjD1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA2D;AACX;AACU;AACf;AAC3C;AACA;AACA;AACA;AACA;AACA,sBAAsB,0CAAI,CAAC,yEAAQ;AACnC;AACA,QAAQ,mEAAY;AACpB,QAAQ,mEAAY;AACpB,8BAA8B,0CAAI,CAAC,yEAAQ;AAC3C;AACA;AACA;AACA;AACA,yBAAyB,kEAAC;AAC1B;AACA,wBAAwB,kEAAW;AACnC,sCAAsC,6DAAS;AAC/C,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACoB;AACrB;AACA,kBAAkB,2CAAK,WAAW,kEAAC;AACnC,oBAAoB,kEAAW;AAC/B;AACA,cAAc,2CAAK,WAAW,kEAAC;AAC/B,oBAAoB,kEAAW;AAC/B;AACA,kBAAkB,2CAAK,WAAW,kEAAC;AACnC;AACA;AACA;AACA;AACA;AACA,eAAe,2CAAK;AACpB;;;;;;;;;;;;;ACxEA;AAAA;AAAA;AAAA;AAAA;AAA4E;AAC1B;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,0CAAI,QAAQ,kEAAC;AACvC,2BAA2B,0CAAI,MAAM,kEAAC,WAAW,kEAAC;AAClD,6BAA6B,0CAAI,MAAM,kEAAC,WAAW,kEAAC;AACpD,0BAA0B,2CAAK;AAC/B;AACA,uCAAuC,0CAAI,KAAK,kEAAC,WAAW,kEAAC,WAAW,kEAAC;AACzE;AACA;AACA,0BAA0B,kDAAY;AACtC;AACA,6BAA6B,0CAAI,QAAQ,kEAAC;AAC1C,6BAA6B,0CAAI,QAAQ,kEAAC;AAC1C,sCAAsC,qEAAY;AAClD,gDAAgD,wEAAe;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,qBAAqB,+BAA+B;AACpD,qBAAqB,sCAAsC;AAC3D;AACA;AACA;AACA;AACA;AACA,CAAC;AACwB;;;;;;;;;;;;;ACtDzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,8EAA8E;AAC3G;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD;AACsD;AACvB;AAC/B;AACO;AACA;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,+CAAe;AACnC,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,iBAAiB,sBAAsB;AACvC,iBAAiB,uBAAuB;AACxC;AACA,SAAS;AACT;AACA;AACA;AACA,+BAA+B,eAAe;AAC9C;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,+BAA+B,eAAe;AAC9C;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,mDAAmB,SAAS,8BAA8B;AACzE,YAAY,mDAAmB,WAAW,wBAAwB,uCAAuC,EAAE;AAC3G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,mDAAmB,SAAS,+BAA+B;AAC1E,YAAY,mDAAmB,SAAS,gBAAgB;AACxD,gBAAgB,mDAAmB,SAAS,+CAA+C,sCAAsC,EAAE;AACnI,gBAAgB,mDAAmB,WAAW,sBAAsB;AACpE;AACA;AACA,kBAAkB,mDAAmB,CAAC,mEAAW,GAAG,6QAA6Q;AACjU;AACA;AACA,CAAC,CAAC,+CAAe;AACM;;;;;;;;;;;;;ACzHvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6C;AACG;AACO;AACF;AACrD;AACA;AACA;AACA;AACA,yBAAyB,0CAAI,CAAC,yEAAQ;AACtC,wCAAwC,6DAAS;AACjD,wBAAwB,kEAAW;AACnC;AACA,wBAAwB,0CAAI,CAAC,yEAAQ;A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C9B,2BAA2B,WAAW;AACtC;AACA,iCAAiC,kEAAC;AAClC,iCAAiC,kEAAC;AAClC;AACA,6BAA6B,kEAAC;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,2CAAK,WAAW,kEAAC,gBAAgB,8DAAK;AAC7E;AACA;AACA,uCAAuC,2CAAK,WAAW,kEAAC,eAAe,8DAAK,iFAAiF,kEAAC,QAAQ,kEAAC;AACvK;AACA,+BAA+B,WAAW;AAC1C;AACA,+CAA+C,0CAAI,MAAM,kEAAC,WAAW,kEAAC,kDAAkD,qEAAY;AACpI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,uCAAuC;AAC5D,qBAAqB,wCAAwC;AAC7D;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,yCAAyC;AAC9D,qBAAqB,iCAAiC;AACtD,qBAAqB,iCAAiC;AACtD;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACiB;;;;;;;;;;;;;AC/ElB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAwE;AACpB;AACvB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,0CAAI,CAAC,yEAAQ;AACvC,QAAQ,8DAAO;AACf,QAAQ,sEAAe;AACvB;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,mEAAY;AACpB,QAAQ,mEAAY;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb,aAAa;AACb;AACA;AACA;AACA,CAAC;AACqB;;;;;;;;;;;;;AChDtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6C;AACA;AACR;AACE;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,2CAAK;AAC/B;AACA,oBAAoB,oDAAM;AAC1B,kCAAkC,iBAAiB;AACnD,sCAAs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A;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsB;;;;;;;;;;;;;ACnDvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyC;AACI;AAChB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,0CAAI;AAC9B,uBAAuB,kEAAC;AACxB;AACA,uBAAuB,YAAY;AACnC,2BAA2B,kEAAC;AAC5B;AACA;AACA,uBAAuB,kEAAC;AACxB,QAAQ,8DAAO;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACoB;;;;;;;;;;;;;AClDrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC8F;AACxB;AAC3B;AACG;AAC9C;AACA;AACA;AACA;AACA;AACA,wBAAwB,0CAAI,CAAC,yEAAQ;AACrC,QAAQ,8DAAO;AACf;AACA,YAAY,+CAAG;AACf;AACA;AACA,QAAQ,kEAAW;AACnB,yBAAyB,gEAAS;AAClC,QAAQ,sEAAe;AACvB,uBAAuB,6DAAS;AAChC;AACA;AACA,0BAA0B,2CAAK;AAC/B,QAAQ,iEAAU,UAAU,kEAAC,yCAAyC,kEAAC,IAAI,sEAAa;AACxF;AACA,YAAY,2CAAK;AACjB,YAAY,2CAAK;AACjB;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA,8CAA8C,0BAA0B,EAAE,+CAAG,sBAAsB,iBAAiB;AACpH;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb,YAAY,+CAAG;AACf;AACA;AACA,uCAAuC,QAAQ,+CAAG,wBAAwB,EAAE;AAC5E,aAAa;AACb;AACA;AACA;AACA,CAAC;AACkB;;;;;;;;;;;;;AC9DnB;AAAA;AAAO;AACP;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACPA;AAAA;AAAA;AAAA;AAAA;AAAgD;AACM;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,2CAAK,WAAW,kEAAC;AACpC;AACA;AACA;AACA,0BAA0B,2CAAK;AAC/B;AACA,+BAA+B,8CAAQ;AACvC;AACA;AACA,uBAAuB,OAAO;AAC9B,2BAA2B,OAAO;AAClC,2BAA2B,2CAAK,QAAQ,kEAAC;AACzC,qCAAqC,2CAAK,eAAe,kEAAC,mBAAmB,kEAAC;AAC9E;AACA;AACA;AACA;AACA,gCAAgC,kEAAC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,qBAAqB,2BAA2B;AAChD,qBAAqB,+BAA+B;AACpD,qBAAqB,+CAA+C;AACpE;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACuB;;;;;;;;;;;;;AChFxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B,2BAA2B,+DAA+D,gBAAgB,EAAE,EAAE;AAC9G;AACA,mCAAmC,MAAM,6BAA6B,EAAE,YAAY,WAAW,EAAE;AACjG,kCAAkC,MAAM,iCAAiC,EAAE,YAAY,WAAW,EAAE;AACpG,+BAA+B,qFAAqF;AACpH;AACA,KAAK;AACL;AACA,mBAAmB,SAAI,IAAI,SAAI;AAC/B,aAAa,6BAA6B,0BAA0B,aAAa,EAAE,qBAAqB;AACxG,gBAAgB,qDAAqD,oEAAoE,aAAa,EAAE;AACxJ,sBAAsB,sBAAsB,qBAAqB,GAAG;AACpE;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC,kCAAkC,SAAS;AAC3C,kCAAkC,WAAW,UAAU;AACvD,yCAAyC,cAAc;AACvD;AACA,6GAA6G,OAAO,UAAU;AAC9H,gFAAgF,iBAAiB,OAAO;AACxG,wDAAwD,gBAAgB,QAAQ,OAAO;AACvF,8CAA8C,gBAAgB,gBAAgB,OAAO;AACrF;AACA,iCAAiC;AACjC;AACA;AACA,SAAS,YAAY,aAAa,OAAO,EAAE,UAAU,WAAW;AAChE,mCAAmC,SAAS;AAC5C;AACA;AACkD;AACO;AAC3B;AACvB,kBAAkB,2CAAM;AAC/B;AACA;AACA;AACA;AACA;AACO;AACP;AACA,0BAA0B,aAAa;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,+DAAW;AACjC;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,8EAAc;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK,EAAE,EAAE;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;;;;;;;;;;;;AC3HA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,8EAA8E;AAC3G;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC6B;AACyC;AAChC;AACU;AACvB;AAC6B;AACxB;AACe;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,mDAAmB,SAAS,gBAAgB;AAC3D,YAAY,mDAAmB,SAAS,yBAAyB;AACjE,gBAAgB,mDAAmB,CAAC,8DAAS,GAAG,uDAAuD,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AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,mCAAmC;AACxD,qBAAqB,qCAAqC;AAC1D,qBAAqB,iCAAiC;AACtD;AACA;AACA;AACA;AACA;AACA,CAAC;AACoB;;;;;;;;;;;;;ACxFrB;AAAA;AAAA;AAAA;AAAA;AAA8D;AACnB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,2CAAK,WAAW,kEAAC,mCAAmC,8DAAK;AAC/E,yBAAyB,2CAAK,WAAW,kEAAC,kDAAkD,8DAAK;AACjG;AACA;AACA;AACA,2BAA2B,0CAAI,CAAC,yEAAQ;AACxC;AACA,6BAA6B,0CAAI,CAAC,yEAAQ;AAC1C;AACA;AACA,4BAA4B,0CAAI,CAAC,yEAAQ;AACzC;AACA;AACA,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,6BAA6B;AAClD,qBAAqB,gDAAgD;AACrE,qBAAqB,8CAA8C;AACnE,qBAAqB,kDAAkD;AACvE,qBAAqB,gDAAgD;AACrE;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACzFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmE;AACE;AACjC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAAI,WAAW,kEAAC;AACvC,QAAQ,mEAAY;AACpB,wBAAwB,0CAAI,WAAW,kEAAC;AACxC,wBAAwB,0CAAI,CAAC,yEAAQ;AACrC,QAAQ,mEAAY;AACpB,mBAAmB,0EAAmB,YAAY,qEAAY;AAC9D,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,qBAAqB,mCAAmC;AACxD,qBAAqB,mCAAmC;AACxD;AACA;AACA;AACA;AACA;AACA,CAAC;AACoB;;;;;;;;;;;;;ACxCrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AAC8B;AAC+B;AACf;AACU;AACO;AACrC;AACqD;AACrB;AACnD;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,+EAAqB,kCAAkC,aAAa,EAAE;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,mDAAC;AACzB,wBAAwB,gEAAgB;AACxC;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,mDAAC;AACzB,wBAAwB,gEAAgB;AACxC;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,YAAY,6CAAK;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,oGAAmC;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAoE,qCAAqC,EAAE;AAC3G,sEAAsE,qCAAqC,EAAE;AAC7G,gEAAgE,mCAAmC,EAAE;AACrG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,2DAAK;AAC5C;AACA,4BAA4B,mDAAC;AAC7B,4BAA4B,gEAAgB,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AO;AACtD,2BAA2B,oEAAqB;AAChD;AACA,gCAAgC,iEAAiE;AACjG,wCAAwC,iDAAiD;AACzF,qBAAqB;AACrB,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,iDAAG;AACrC,YAAY,yCAAG;AACf,kCAAkC,mEAAE;AACpC,gCAAgC,mEAAE,CAAC,iDAAG;AACtC;AACA;AACA;AACA;AACA,kCAAkC,iDAAG;AACrC;AACA;AACA;AACA;AACA,kCAAkC,iDAAG;AACrC,YAAY,yCAAG;AACf,kCAAkC,mEAAE,CAAC,iDAAG;AACxC,gCAAgC,mEAAE;AAClC;AACA;AACA;AACA;AACA,kCAAkC,iDAAG;AACrC;AACA;AACA;AACA;AACA;AACA,mBAAmB,mEAAE,qBAAqB,mEAAE;AAC5C,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,mBAAmB,iDAAG;AACtB,iBAAiB,iDAAG;AACpB,SAAS;AACT;AACA;AACA,uBAAuB,mEAAE;AACzB,qBAAqB,mEAAE;AACvB;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,mEAAE;AACtB,kBAAkB,mEAAE;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,sEAAK;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,qEAAY;AACnD;AACA;AACA;AACA;AACA;AACA,iCAAiC,kEAAC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,kEAAC;AACtD;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAAI,CAAC,yEAAQ;AACpC;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,+CAAe;AACF,6EAAc,EAAC;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,mDAAQ;AACnC;AACA;AACA;AACA,SAAS,oDAAQ;AACjB;AACA;AACA;AACA,2BAA2B,mDAAQ;AACnC;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mDAAQ;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,kEAAC;AAChB;AACA;AACA;AACA;AACA,WAAW,kEAAC;AACZ;;;;;;;;;;;;;ACnVA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AACuD;AACO;AACjC;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA,iBAAiB,EAAE,EAAE;AACrB,8CAA8C,QAAQ,kEAAC,4BAA4B,EAAE;AACrF;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,kEAAC;AAC5B,0BAA0B,0CAAI,CAAC,yEAAQ;AACvC;AACA,QAAQ,2EAAW;AACnB;AAC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AwB,aAAa;AACrC,2BAA2B,YAAY;AACvC,2BAA2B,eAAe;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA,kDAAkD,wBAAwB;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS,EAAE;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA,wDAAwD,mEAAe;AACvE;AACA;AACA;;;;;;;;;;;;;ACtEA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA,CAAC;AACiB;;;;;;;;;;;;;AClBlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8B;AACE;AACa;AAC7C;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,IAAI,mDAAC;AACL,IAAI,mDAAK,UAAU,iEAAU;AAC7B;AACA,mCAAmC;AACnC,iCAAiC;;;;;;;;;;;;;ACnBjC;AAAA;AAAA;AAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,qBAAqB,iDAAiD;AACtE,qBAAqB,oCAAoC;AACzD;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACc;AACf;AACA,WAAW,iDAAG;AACd,YAAY,iDAAG;AACf;;;;;;;;;;;;;AChDA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsD;AACqB;AACnB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,QAAQ,iDAAC,eAAe,EAAE;AACxE,4CAA4C,UAAU,eAAe,EAAE,EAAE;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,sDAAQ,CAAC,iDAAC,QAAQ,iDAAC;AACpC,uBAAuB,0CAAI,CAAC,wDAAQ;AACpC,QAAQ,0DAAY;AACpB,QAAQ,qDAAO;AACf,QAAQ,6DAAe;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,uDAAe;AACpD,0BAA0B,2CAAK;AAC/B;AACA;AACA,YAAY,2CAAK,eAAe,+CAAS;AACzC;AACA,YAAY,2CAAK;AACjB;AACA;AACA;AACA;AACA,mBAAmB,iDAAC;AACpB;AACA;AACA;AACA,2BAA2B,iDAAC;AAC5B,yBAAyB,iDAAC;AAC1B,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,qBAAqB,sCAAsC;AAC3D,qBAAqB,6CAA6C;AAClE,qBAAqB,wCAAwC;AAC7D;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsB;;;;;;;;;;;;;ACnFvB;AAAe,uEAAQ,EAAC;;;;;;;;;;;;;ACAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC0D;AACkB;AACjC;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,0CAAI,CAAC,yEAAQ;AACvC,QAAQ,8DAAO;AACf;AACA,QAAQ,sEAAe;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,+CAA+C,EAAE,4EAAmB,IAAI,qCAAqC;AAC7G;AACA;AACA,CAAC;AACmB;AACpB;AACA;AACA;AACA;AACA;AACA,wBAAwB,0CAAI,CAAC,yEAAQ;AACrC,QAAQ,8DAAO;AACf,qBAAqB,2CAAK,QAAQ,kEAAC;AACnC,0BAA0B,2CAAK;AAC/B,QAAQ,sEAAe;AACvB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACuB;;;;;;;;;;;;;AC/ExB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiD;AACiB;AACpC;AAC9B;AACA;AACA;AACA;AACA,mBAAmB,2CAAK,QAAQ,kEAAC;AACjC,QAAQ,sEAAe;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,4EAAmB;AACtC,qBAAqB,4EAAmB;AACxC,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACmB;;;;;;;;;;;;;ACxCpB;AAAA;AAAA;AAAA;AAAA;AACA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,8EAA8E;AAC3G;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC8B;AAC/B;AACA;AACA;AACA;AACA,oBAAoB,+CAAe;AACnC;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,eAAe;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,eAAe;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,+BAA+B,iCAAiC;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,iCAAiC;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,mDAAmB,SAAS,2GAA2G;AACtJ;AACA;AACA,CAAC,CAAC,+CAAe;AACC;;;;;;;;;;;;;ACxHlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyD;AACe;AAClB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,qEAAY;AACrC,wBAAwB,0CAAI,CAAC,yEAAQ;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,8EAAuB,SAAS,qCAAqC;AAC7E,yBAAyB,2CAAK,WAAW,kEAAC;AAC1C,mCAAmC,qEAAY;AAC/C,sBAAsB,qEAAY;AAClC,qBAAqB,2CAAK,WAAW,kEAAC;AACtC,+CAA+C,qEAAY;AAC3D;AACA;AACA;AACA;AACA,0BAA0B,+CAAS;AACnC,mBAAmB,kEAAC;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,iCAAiC,+CAAS;AAC1C,mBAAmB,kEAAC;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,mCAAmC,kEAAC,iBAAiB,kEAAC;AACvE;AACA;AACA;AACA;AACA,qBAAqB,2CAAK,WAAW,kEAAC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,2CAAK;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,aAAa,qEAAqE;AAClF,aAAa;AACb;AACA;AACA;AACA,CAAC;AAC4B;;;;;;;;;;;;;ACpF7B;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC6C;AACJ;AACzC;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,wBAAwB;AACnE;AACA,+CAA+C,gBAAgB;AAC/D;AACA;AACA,iCAAiC,+GAA+G;AAChJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,cAAc,yBAAyB;AAC7F;AACA;AACA,sDAAsD;AACtD;AACA;AACA;AACA;AACA;AACA,iCAAiC,+BAA+B;AAChE;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,mBAAmB;AACpD;AACA;AACA;AACA;AACA,mDAAmD,gBAAgB;AACnE;AACA;AACA,2DAA2D,0BAA0B;AACrF;AACA;AACA,iEAAiE,0DAAI;AACrE,wBAAwB,8DAAiB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,2BAA2B;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sFAAsF;AACtF,+DAA+D,4BAA4B;AAC3F;AACA,wBAAwB,8DAAiB;AACzC,0CAA0C,sEAAsE;AAChH;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D,UAAU,2DAA2D,EAAE,EAAE;AACxI;AACA;AACA,iFAAiF,qCAAqC;AACtH;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,wBAAwB;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,0BAA0B;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,6BAA6B,0DAAI;AACjC;AACA,4BAA4B,oCAAoC;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,6CAA6C,yBAAyB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC5MA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiD;AACK;AACX;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,qEAAI;AAC9B,oBAAoB,2CAAK,WAAW,kEAAC;AACrC,QAAQ,sEAAe;AACvB;AACA,2BAA2B,0CAAI,MAAM,kEAAC,8BAA8B,kEAAC;AACrE;AACA,0BAA0B,2CAAK;AAC/B;AACA,mCAAmC,0CAAI,MAAM,kEAAC,kBAAkB,kEAAC;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,WAAW;AACtC;AACA,+BAA+B,2BAA2B,kEAAC,mCAAmC,kEAAC,kBAAkB;AACjH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,qBAAqB,oCAAoC;AACzD,qBAAqB,iCAAiC;AACtD;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,uCAAuC,uBAAuB;AAC9D;AACA;AACA;AACA;AACA,CAAC;AACmB;;;;;;;;;;;;;ACnFpB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8D;AACX;AACtB;AAC7B;AACA;AACA;AACA;AACO;AACP,sBAAsB,wEAAY,CAAC,0CAAI;AACvC,iCAAiC,kEAAC,eAAe,8DAAK;AACtD;AACA,uBAAuB,iEAAQ;AAC/B,yBAAyB,iEAAQ;AACjC;AACA;AACA;;;;;;;;;;;;;ACfA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkD;AACe;AAClB;AACjB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,0CAAI,WAAW,kEAAC;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb,aAAa,mDAAmD;AAChE;AACA;AACA;AACA,uCAAuC,iBAAiB;AACxD,aAAa;AACb;AACA;AACA;AACA,uCAAuC,iBAAiB;AACxD,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,0CAAI,WAAW,kEAAC,gBAAgB,8DAAK;AACnE;AACA;AACA;AACA,4BAA4B,0CAAI,CAAC,yEAAQ;AACzC;AACA,QAAQ,8DAAO;AACf,8BAA8B,0CAAI,WAAW,kEAAC,eAAe,8DAAK;AAClE,8BAA8B,0CAAI,WAAW,kEAAC,gBAAgB,8DAAK;AACnE;AACA;AACA,yBAAyB,0CAAI,WAAW,kEAAC;AACzC,0BAA0B,2CAAK;AAC/B,uBAAuB,QAAQ;AAC/B;AACA;AACA;AACA;AACA;AACA,qCAAqC,+CAAS;AAC9C,2BAA2B,kEAAC;AAC5B;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,0CAAI,QAAQ,kEAAC;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,0CAAI;AAC7B,YAAY,kEAAC,CAAC,kEAAC,wCAAwC,kEAAC;AACxD,YAAY,kEAAC,CAAC,kEAAC;AACf;AACA,QAAQ,8DAAO;AACf,0BAA0B,2CAAK;AAC/B,uBAAuB,QAAQ;AAC/B;AACA;AACA,qCAAqC,+CAAS;AAC9C,2BAA2B,kEAAC;AAC5B;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,kDAAkD,kEAAC;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,qBAAqB,+BAA+B;AACpD,qBAAqB,kCAAkC;AACvD;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb,aAAa;AACb;AACA;AACA;AACA,CAAC;AACsB;;;;;;;;;;;;;ACzMvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AAC8B;AAC0B;AACgB;AACX;AACJ;AACE;AACxB;AACL;AACE;AACJ;AAC5B;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,OAAO,KAAK,2CAAE,kHAAkH;AACvK;AACA;AACA,uCAAuC,OAAO,KAAK,2CAAE,uBAAuB,iDAAG,WAAW,2DAA2D,QAAQ,iDAAG,SAAS,2DAA2D,2BAA2B;AAC/P;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,mDAAK,2BAA2B,mDAAK;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,mDAAK,iBAAiB,gBAAgB;AACpE;AACA;AACA,gCAAgC,gFAAY;AAC5C,qBAAqB,gDAAM;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,mDAAK,kBAAkB,gBAAgB;AACrE;AACA;AACA,gCAAgC,gFAAY;AAC5C,qBAAqB,gDAAM;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,2CAAE;AAC5B;AACA;AACA,gCAAgC,0BAA0B,mDAAK;AAC/D;AACA,gCAAgC,sBAAsB,mDAAK;AAC3D;AACA,gCAAgC,4CAA4C,mDAAK;AACjF;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,gEAAgB,aAAa,wDAAQ;AAC7C,gBAAgB,6DAAe,CAAC,mDAAK;AACrC,gBAAgB,2DAAY,CAAC,mDAAK;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,gEAAgB,aAAa,wDAAQ;AAC7C,gBAAgB,0DAAY;AAC5B,gBAAgB,uDAAQ;AACxB,0DAA0D,6CAA6C,EAAE;AACzG;AACA,gBAAgB,sDAAQ,gBAAgB,mDAAK,mCAAmC,aAAa,EAAE,GAAG,mDAAK,oCAAoC,aAAa,EAAE;AAC1J;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,gBAAgB;AAC1D;AACA;AACA;AACA;AACA;AACA,sCAAsC,0DAAY;AAClD;AACA;AACA;AACA;AACA,sCAAsC,uDAAQ;AAC9C;AACA;AACA,uCAAuC,2CAAE;AACzC;AACA;AACA;AACA;AACA;AACA,0BAA0B,sEAAY;AACtC;AACA;AACA;AACA,CAAC;AACD;AACA,gDAAgD,0BAA0B,YAAY,EAAE;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,mDAAC;AACT;AACA;AACA;AACA,QAAQ,mDAAC;AACT;AACA;AACA;AACA,QAAQ,mDAAC;AACT;AACA;AACA;AACA,CAAC;AACc,qFAAsB,EAAC;;;;;;;;;;;;;AC1LtC;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,cAAc;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,+DAA+D;AAC1G;AACU;;;;;;;;;;;;;AC/CV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAgD;AACO;AAClB;AACE;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,2CAAK;AAC/B;AACA;AACA,wBAAwB,2CAAK,QAAQ,kEAAC;AACtC;AACA;AACA;AACA;AACA;AACA,qBAAqB,kEAAC,mBAAmB,8DAAK;AAC9C;AACA;AACA,oBAAoB,oDAAM;AAC1B,qBAAqB,oDAAM;AAC3B,iCAAiC,kBAAkB;AACnD,oCAAoC,mBAAmB;AACvD;AACA;AACA;AACA;AACA,+BAA+B,2CAAK,QAAQ,kEAAC;AAC7C,+CAA+C,6DAAS,sBAAsB,+BAA+B;AAC7G;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,kEAAC;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACmB;;;;;;;;;;;;;ACtEpB;AAAA;AAAA;AAAA;AAAA;AAA6C;AACA;AACT;AACpC;AACA;AACA;AACA;AACA,sBAAsB,iDAAG;AACzB,8CAA8C,kEAAC;AAC/C,sDAAsD,kEAAW;AACjE,sDAAsD,kEAAW;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACmB;;;;;;;;;;;;;ACnCpB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAgD;AACqB;AACjC;AACpC,YAAY,6DAAS,UAAU,qEAAY;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,0CAAI,CAAC,yEAAQ;AACxC;AACA;AACA,6BAA6B,0CAAI,CAAC,yEAAQ;AAC1C;AACA;AACA,2BAA2B,kEAAC;AAC5B,8BAA8B,kEAAC;AAC/B,2BAA2B,0CAAI,CAAC,yEAAQ;AACxC;AACA;AACA,yBAAyB,kEAAC;AAC1B,4BAA4B,kEAAC;AAC7B,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;;;;;;;;;;;;;AC1D1B;AAAA;AAAA;AAAA;AAAA;AAAqE;AACjC;AACpC;AACA;AACA;AACA;AACA,uBAAuB,0CAAI,CAAC,iEAAQ;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,kEAAC;AAC3B;AACA;AACA,oBAAoB,kEAAC;AACrB;AACA,aAAa;AACb;AACA,0BAA0B,kEAAC;AAC3B;AACA;AACA,oBAAoB,kEAAC;AACrB;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,qEAAY;AACrC;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,wBAAwB,oCAAoC;AAC5D,wBAAwB,+BAA+B;AACvD,wBAAwB,iCAAiC;AACzD;AACA,gBAAgB;AAChB;AACA;AACA;AACA,qBAAqB,uDAAuD;AAC5E,qBAAqB,uDAAuD;AAC5E,qBAAqB,wEAAwE;AAC7F;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,uCAAuC,0DAA0D,EAAE;AACnG,aAAa;AACb;AACA;AACA;AACA,uCAAuC,8BAA8B;AACrE,aAAa;AACb;AACA;AACA;AACA,uCAAuC,8BAA8B;AACrE,aAAa;AACb;AACA;AACA;AACA,CAAC;AAC0B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,2CAAK;AACpB;;;;;;;;;;;;;AC9GA;AAAA;AAAA;AAAA;AAAA;AAA0D;AACP;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,sCAAsC;AAC3D,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,CAAC;AACoB;AACrB;AACA,uBAAuB,0CAAI,CAAC,yEAAQ;AACpC;AACA;AACA;AACA,sBAAsB,2CAAK;AAC3B,mBAAmB,WAAW;AAC9B,6BAA6B,yEAAQ;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,kEAAC;AACrD,aAAa;AACb;AACA,kDAAkD,kEAAC;AACnD,iDAAiD,kEAAC;AAClD,aAAa;AACb;AACA;AACA;AACA,eAAe,2CAAK,WAAW,kEAAC;AAChC;AACA,yBAAyB,4CAAM;AAC/B;AACA;AACA,sBAAsB,2CAAK;AAC3B,mBAAmB,eAAe;AAClC,0CAA0C,kEAAC;AAC3C,gDAAgD,kEAAC;AACjD;AACA;AACA;AACA,cAAc,2CAAK;AACnB;AACA;AACA,mBAAmB,2CAAK;AACxB,YAAY;AACZ;;;;;;;;;;;;;AC7EA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiD;AACD;AACV;AACtC;AACA;AACA;AACA;AACA,wBAAwB,2CAAK,WAAW,kEAAC;AACzC;AACA;AACA;AACA;AACA;AACA,wBAAwB,2CAAK,WAAW,kEAAC;AACzC,YAAY,sEAAe;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,4CAAM;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,kEAAC;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsB;;;;;;;;;;;;;AC1DvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkF;AACb;AAClB;AACf;AACpC;AACA;AACA;AACA;AACA,wBAAwB,0CAAI,CAAC,yEAAQ;AACrC;AACA;AACA;AACA;A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;AACA;AACA;AACA,mBAAmB,kEAAC;AACpB,uBAAuB,yBAAyB,kEAAC;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACe;AAChB;AACA;AACA;AACA,iCAAiC,8CAAQ;AACzC,qBAAqB,2CAAK,SAAS,kEAAC;AACpC,+BAA+B,2CAAK,qBAAqB,kEAAC,gBAAgB,kEAAC;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,8CAAQ;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,qEAAY;AAC7C,2BAA2B,8CAAQ;AACnC;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,yDAAW;AACpC,2BAA2B,2CAAK;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,qEAAY;AACjC;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACtQA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AAC4E;AACzC;AAC5B;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,qEAAY;AACnC;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,qEAAY;AACnC,uBAAuB,qEAAY;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,2EAAkB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,kDAAkD,EAAE;AAChG;AACA,uBAAuB,iBAAiB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,wBAAwB;AACrE;AACA,0CAA0C,gCAAgC,EAAE;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,wBAAwB;AACrE;AACA;AACA;AACA,CAAC,kCAAkC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,mDAAQ;AAChB;AACA;AACA,QAAQ,mDAAQ;AAChB;AACA;AACA;AACA;AACA,sCAAsC;AACtC,2DAA2D;AAC3D,sCAAsC,OAAO,6BAA6B,cAAc,iBAAiB,GAAG,MAAM,EAAE;AACpH;AACA,SAAS;AACT;AACA;AACA,CAAC;AAC6B;;;;;;;;;;;;;AC/H9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAA+E;AACpD;AACS;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,0CAAM,CAAC,wDAAQ;AACxC,QAAQ,8DAAO;AACf;AACA,QAAQ,0EAAmB;AAC3B,0BAA0B,2CAAO;AACjC;AACA,2BAA2B,0CAAM,CAAC,wDAAQ;AAC1C,YAAY,8DAAO;AACnB;AACA,2BAA2B,0CAAM,CAAC,wDAAQ;AAC1C,YAAY,8DAAO;AACnB,0BAA0B,2CAAO;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,sEAAe;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,iCAAiC;AACtD,qBAAqB,mCAAmC;AACxD,qBAAqB,yCAAyC;AAC9D,qBAAqB,wCAAwC;AAC7D;AACA;AACA;AACA;AACA;AACA,CAAC;AACwB;;;;;;;;;;;;;AC5EzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAuD;AACG;AACtB;AACoB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,2CAAK;AAC/B,uBAAuB,WAAW;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,qBAAqB,2CAA2C;AAChE,qBAAqB,gDAAgD;AACrE,qBAAqB,oDAAoD;AACzE;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,0BAA0B,uEAAgB;AAC1C;AACA;AACA;AACA;AACA,CAAC;AACmB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0CAAI,CAAC,yEAAQ;AACnC;AACA;AACA;AACA;AACA;AACA,sCAAsC,0CAAI,CAAC,yEAAQ;AACnD;AACA;AACA,oCAAoC,0CAAI,CAAC,yEAAQ;AACjD;AACA;AACA;AACA,qBAAqB,0CAAI,CAAC,yEAAQ;AAClC;AACA;AACA,qBAAqB,0CAAI,CAAC,yEAAQ;AAClC;AACA,sBAAsB,2CAAK;AAC3B;AACA;AACA;AACA;AACA,sBAAsB,0CAAI,CAAC,yEAAQ;AACnC;AACA;AACA;AACA;AACA,kBAAkB,qEAAkB;AACpC;AACA;AACA,qBAAqB,0CAAI,CAAC,yEAAQ;AAClC;AACA,qBAAqB,0CAAI,CAAC,yEAAQ;AAClC;AACA,sBAAsB,2CAAK;AAC3B;AACA;AACA;AACA;AACA,sBAAsB,0CAAI,CAAC,yEAAQ;AACnC;AACA;AACA;AACA;AACA,kBAAkB,qEAAkB;AACpC;AACA;AACA,qBAAqB,0CAAI,CAAC,yEAAQ;AAClC;AACA,qBAAqB,0CAAI,CAAC,yEAAQ;AAClC;AACA,sBAAsB,2CAAK;AAC3B;AACA;AACA;AACA;AACA;AACA,KAAK,kEAAC;AACN,KAAK,kEAAC;AACN,KAAK,kEAAC;AACN,KAAK,kEAAC;AACN,KAAK,kEAAC;AACN;;;;;;;;;;;;;AChJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiD;AACK;AACf;AACI;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,0CAAI,CAAC,wDAAQ;AACzC,QAAQ,sEAAe;AACvB,mBAAmB,2CAAK,WAAW,iDAAC;AACpC;AACA;AACA;AACA;AACA,yBAAyB,2CAAK;AAC9B,oBAAoB,oDAAM;AAC1B,oEAAoE,wBAAwB;AAC5F,kCAAkC,uBAAuB;AACzD,4BAA4B,2CAAK,QAAQ,iDAAC;AAC1C;AACA;AACA;AACA;AACA,0BAA0B,2CAAK;AAC/B,uBAAuB,+CAAS;AAChC,uBAAuB,2CAAK;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACmB;;;;;;;;;;;;;AC7DpB;AAAA;AAAA;AAAA;AAAA;AAAkE;AACrC;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,qEAAY;AAC/B,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,8BAA8B,qEAAY;AAC1C,iCAAiC,qEAAY;AAC7C,4BAA4B,qEAAY;AACxC,8BAA8B,qEAAY;AAC1C,4BAA4B,qEAAY;AACxC;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,uCAAuC;AAC5D,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;AACtB;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAAI,CAAC,yEAAQ;AACpC;AACA;AACA;AACA;AACA,uBA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AiC,yEAAQ;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,gEAAS;AAC/B,uBAAuB,0CAAI,CAAC,yEAAQ;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,kEAAC;AACzC;AACA,4BAA4B,gEAAS;AACrC;AACA,QAAQ,sEAAe;AACvB;AACA;AACA;AACA;AACA;AACA,iBAAiB,0BAA0B,kEAAC,uBAAuB;AACnE,iBAAiB,0BAA0B,kEAAC;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,+CAA+C,EAAE,4EAAmB,IAAI,oBAAoB;AAC5F;AACA;AACA;AACA;AACA,qBAAqB,iDAAiD;AACtE,qBAAqB,yCAAyC;AAC9D;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACwB;;;;;;;;;;;;;ACrFzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AAC+C;AAC+B;AACtC;AACxC;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,0CAAI;AAC9B,4BAA4B,wDAAQ;AACpC,QAAQ,qDAAO;AACf,QAAQ,yDAAW;AACnB;AACA,QAAQ,6DAAe;AACvB,uBAAuB,2CAAK,eAAe,+CAAS;AACpD;AACA;AACA;AACA;AACA;AACA,iBAAiB,oBAAoB,iDAAC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACsB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A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AAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACe;;;;;;;;;;;;;AC5ChB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAuD;AACM;AACf;AACgB;AAC/B;AAC/B;AACA;AACA;AACA,0BAA0B,2CAAW;AACrC;AACA;AACA,yBAAyB,2CAAW;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD,uDAAuD,EAAE;AAClH,kDAAkD,mDAAmD,EAAE;AACvG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sEAAsE;AACtE;AACA;AACA;AACA,SAAS,EAAE,EAAE;AACb,wBAAwB,2DAAc,0CAA0C,UAAU,iEAAiE,EAAE,EAAE;AAC/J,qCAAqC,oEAAqB,uCAAuC;AACjG;AACA,oBAAoB,yCAAyC;AAC7D,4BAA4B,yCAAyC;AACrE,SAAS,EAAE,EAAE;AACb,2BAA2B,wDAAQ,MAAM,2EAAW;AACpD,QAAQ,gEAAgB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;;;;;;;;;;;;;AC1F3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiD;AACG;AACN;AAC9C;AACA;AACA;AACA;AACA,0BAA0B,0CAAI,CAAC,yEAAQ;AACvC;AACA,QAAQ,sEAAe;AACvB,gCAAgC,2CAAK,KAAK,8CAAQ;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACe;;;;;;;;;;;;;ACrChB;AAAA;AAAO;AACP;AACA;AACA;AACA;AACA;AACA,2BAA2B,cAAc;AACz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C7C;AACA,gBAAgB,gEAAgB,aAAa,wDAAQ;AACrD,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,gBAAgB,mDAAC;AACjB,gBAAgB,gEAAgB,aAAa,kDAAI,QAAQ,wCAAwC;AACjG,aAAa;AACb,SAAS;AACT;AACA;AACA,gBAAgB,mDAAC;AACjB,gBAAgB,gEAAgB,aAAa,kDAAI,QAAQ,uCAAuC;AAChG,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,6BAA6B,+EAAqB;AAClD;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,mDAAC;AAC7B,4BAA4B,gEAAgB;AAC5C;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACO;AACP,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,qBAAqB;AACtE;AACA;AACA;AACA;AACA,mEAAmE,4BAA4B,qBAAqB;AACpH;AACA,aAAa;AACb;AACA,gBAAgB,mDAAC;AACjB,kCAAkC,gEAAkB,yBAAyB;AAC7E;AACA;AACA;AACA,iBAAiB,EAAE,EAAE;AACrB,gBAAgB,gEAAgB;AAChC;AACA,SAAS;AACT;AACA;AACA;AACA,uDAAuD,QAAQ,qFAAqF,EAAE;AACtJ;AACA;AACA;AACA;AACA;AACA,iDAAiD,qBAAqB;AACtE;AACA;AACA;AACA;AACA,mEAAmE,iBAAiB,eAAe;AACnG;AACA,aAAa;AACb;AACA;AACA;AACA,gBAAgB,mDAAC;AACjB,kCAAkC,+DAAiB,4BAA4B,+BAA+B,EAAE,oBAAoB;AACpI;AACA;AACA;AACA,iBAAiB,EAAE,EAAE;AACrB,gBAAgB,gEAAgB;AAChC,aAAa;AACb;AACA;AACA,uBAAuB,+EAAoB;AAC3C;AACA,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B,2CAAK,QAAQ,kEAAC;AAClC;AACA;AACA;AACA;AACA;AACA,uBAAuB,2CAAK;AAC5B,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,qBAAqB,iCAAiC;AACtD,qBAAqB,gCAAgC;AACrD,qBAAqB;AACrB;AACA,aAAa;AACb;AACA;AACA,uCAAuC,8BAA8B;AACrE;AACA;AACA;AACA;AACA,CAAC;AACkB;;;;;;;;;;;;;AC1DnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6C;AACA;AACT;AACC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC,uCAAuC;AACvC,sCAAsC;AACtC,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA,mBAAmB,iDAAG;AACtB;AACA,2BAA2B,kEAAW;AACtC;AACA,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA,uBAAuB,2CAAK,QAAQ,kEAAC;AACrC;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,6BAA6B;AAClD,qBAAqB,mCAAmC;AACxD,qBAAqB,6BAA6B;AAClD,qBAAqB,iCAAiC;AACtD,qBAAqB,+BAA+B;AACpD;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,8BAA8B;AACnD,qBAAqB,iCAAiC;AACtD,qBAAqB,iCAAiC;AACtD;AACA,uCAAuC,0BAA0B;AACjE;AACA;AACA;AACA;AACA,CAAC;AACe;;;;;;;;;;;;;ACjFhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6C;AACG;AACiB;AACtB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,wCAAwC;AAC7D,qBAAqB,+BAA+B;AACpD,qBAAqB,8CAA8C;AACnE;AACA,aAAa;AACb;AACA;AACA;AACA,uCAAuC,mDAAmD;AAC1F,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,0CAAI,CAAC,yEAAQ;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,kEAAW;AAChC,qBAAqB,2CAAK,QAAQ,kEAAC;AACnC;AACA;AACA;AACA,qBAAqB,2CAAK,QAAQ,kEAAC;AACnC;AACA;AACA;AACA,eAAe,2CAAK;AACpB;AACA;AACA;AACA,eAAe,2CAAK;AACpB;AACA,QAAQ,2CAAK,WAAW,kEAAC;AACzB;AACA,QAAQ,2CAAK,WAAW,kEAAC;AACzB;AACA,QAAQ,2CAAK,WAAW,kEAAC,0CAA0C,kEAAW;AAC9E;AACA;AACA;AACA;AACA,kBAAkB,0CAAI,SAAS,kEAAC,+BAA+B,8DAAK;AACpE;AACA;AACA,mBAAmB,0CAAI,WAAW,kEAAC,yBAAyB,8DAAK;AACjE;AACA;AACA;AACA,oCAAoC,6DAAS;AAC7C;AACA;AACA,uBAAuB,kEAAW;AAClC,eAAe,2CAAK;AACpB;AACA;AACA;;;;;;;;;;;;;AC3GA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA+B;AACW;AACJ;AACF;AACQ;AAC5C;AACA;AACA;AACA;AACO;AACP,WAAW,mDAAmB,CAAC,yDAAW;AAC1C,eAAe,mDAAmB,SAAS,0BAA0B;AACrE;AACA,YAAY,mDAAmB;AAC/B,gBAAgB,mDAAmB;AACnC,gBAAgB,mDAAmB;AACnC,gBAAgB,mDAAmB;AACnC,YAAY,mDAAmB,OAAO,2CAA2C,uDAAQ,WAAW;AACpG,YAAY,mDAAmB;AAC/B,mDAAmD,mDAAmB;AACtE,gBAAgB,mDAAmB;AACnC;AACA,gBAAgB,mDAAmB;AACnC;AACA,oBAAoB,mDAAQ;AAC5B;AACA,gBAAgB,mDAAmB,CAAC,iDAAK,GAAG,gBAAgB;AAC5D,gBAAgB,mDAAmB,YAAY,0EAA0E,gCAAgC,EAAE,EAAE;AAC7J,KAAK;AACL;;;;;;;;;;;;;AC7BA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC0D;AAC1D,gCAAgC,6HAA6H,EAAE,uEAAgB;AAC/K;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,qDAAqD;AAClE;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,qEAAqE;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA,iBAAiB,wEAAwE;AACzF,iBAAiB,yDAAyD;AAC1E;AACA,SAAS;AACT,SAAS,wEAAwE,oDAAoD,EAAE,EAAE;AACzI;AACA;AACA,sBAAsB,uEAAgB;AACtC;AACA,sBAAsB,kCAAkC;AACxD,mCAAmC,oDAAoD;AACvF,SAAS;AACT,SAAS,4EAA4E,sDAAsD,EAAE,EAAE;AAC/I;AACA;AACA;AACA,sBAAsB,uEAAgB;AACtC;AACA,mCAAmC,sDAAsD;AACzF,SAAS;AACT;AACA;AACA;AACA;AACA,mCAAmC,sDAAsD;AACzF,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,kCAAkC;;;;;;;;;;;;;AC5HnC;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,8EAA8E;AAC3G;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC2C;AAC5C;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0GAA0G;AAC1G,gHAAgH;AAChH;AACA;AACA,wDAAwD;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,gEAAS;AACrB;AACA,sDAAsD;AACtD;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;;;;;;;;;;;;ACtFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AACgD;AAC+B;AACpC;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0CAAI,CAAC,iEAAQ;AACnC;AACA,wBAAwB,0CAAI,CAAC,iEAAQ;AACrC,4DAA4D,8CAA8C,EAAE;AAC5G;AACA,sCAAsC,qEAAY;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,2CAAK,WAAW,kEAAC,gBAAgB,8DAAK;AAC1D,uBAAuB,2CAAK,WAAW,kEAAC,gBAAgB,8DAAK;AAC7D,gCAAgC,qEAAY;AAC5C,oCAAoC,6DAAS;AAC7C,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA,iBAAiB,yBAAyB,kEAAC;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA,CAAC;AACsB;;;;;;;;;;;;;A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E;AAC7J;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,cAAc;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,2CAAM;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,oBAAoB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,CAAC,kBAAkB;AACnB;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,4BAA4B;;;;;;;;;;;;;AC9E7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsE;AACQ;AACnC;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,4EAAW;AAC/B,qBAAqB,4EAAW;AAChC,uBAAuB,4EAAW;AAClC,wBAAwB,0CAAI,CAAC,yEAAQ;AACrC,QAAQ,8DAAO;AACf;AACA,QAAQ,sEAAe;AACvB,0BAA0B,2CAAK;AAC/B,QAAQ,iEAAU,UAAU,kEAAC,uCAAuC,kEAAC;AACrE;AACA,sBAAsB,2CAAK,WAAW,kEAAC,uBAAuB,8DAAK;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,+BAA+B;AACpD,qBAAqB,mCAAmC;AACxD,qBAAqB,iCAAiC;AACtD;AACA,uCAAuC,cAAc,EAAE;AACvD;AACA;AACA;AACA;AACA,CAAC;AACyB;AAC1B;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACvEA;AAAA;AAAA;AACO;AACP;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACNA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACyC;AACO;AACqB;AACH;AAC9B;AACpC;AACA;AACA;AACA;AACA,uBAAuB,oEAAK;AAC5B;AACA;AACA;AACA,iBAAiB,gFAAS;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA,mBAAmB,kEAAC;AACpB;AACA;AACA;AACA;AACA,yBAAyB,0CAAI,CAAC,yEAAQ;AACtC,sCAAsC,6DAAS;AAC/C,4BAA4B,0CAAI,CAAC,yEAAQ;AACzC,QAAQ,8DAAO;AACf,2CAA2C,6DAAS,UAAU,qEAAY;AAC1E,0BAA0B,kEAAC;AAC3B,6BAA6B,kEAAC;AAC9B,wBAAwB,2CAAK;AAC7B,sBAAsB,kEAAC;AACvB;AACA;AACA;AACA;AACA;AACA,+CAA+C,EAAE,oEAAK,iCAAiC,mBAAmB;AAC1G;AACA;AACA;AACA;AACA,qBAAqB,iCAAiC;AACtD,qBAAqB,qCAAqC;AAC1D;AACA;AACA;AACA;AACA;AACA,CAAC;AACgB;;;;;;;;;;;;;ACtEjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6C;AACG;AACZ;AACpC;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,0CAAI,MAAM,kEAAC,QAAQ,kEAAC;AAClD,+BAA+B,kEAAW;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,2CAAK,WAAW,kEAAC;AAC3C,+BAA+B,kEAAW;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACoB;;;;;;;;;;;;;ACjDrB;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,8EAA8E;AAC3G;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC8B;AACoB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,QAAQ,mEAAC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,mDAAmB,CAAC,8CAAc;AACjD,YAAY,mDAAmB,SAAS;AACxC;AACA;AACA;AACA,iBAAiB,EAAE;AACnB;AACA,gBAAgB,mDAAmB,SAAS;AAC5C;AACA;AACA,qBAAqB,EAAE;AACvB;AACA,YAAY,mDAAmB,SAAS;AACxC;AACA;AACA,iBAAiB,EAAE;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA,CAAC,CAAC,+CAAe;AACU;;;;;;;;;;;;;AClE3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiD;AACF;AACX;AACpC;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,0CAAI,CAAC,wDAAQ;AACvC,QAAQ,sEAAe;AACvB,uBAAuB,+CAAS;AAChC,uBAAuB,2CAAK;AAC5B,6BAA6B,0CAAI;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACe;;;;;;;;;;;;;ACvChB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA+C;AACF;AACT;AACN;AAC9B;AACA;AACA;AACA;AACA,sBAAsB,iDAAG;AACzB,8CAA8C,kEAAC;AAC/C,sDAAsD,oEAAW;AACjE,sDAAsD,oEAAW;AACjE,uBAAuB,2CAAK;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;AAC3B;AACA;AACA;AACA;AACA,sBAAsB,iDAAG;AACzB;AACA;AACA,uBAAuB,2CAAK;AAC5B,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkB;;;;;;;;;;;;;AC/DnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6C;AACT;AACK;AACzC;AACA;AACA;AACA;AACA,0BAA0B,2CAAK;AAC/B,YAAY,iDAAG,yBAAyB,kEAAC;AACzC,gBAAgB,+CAAS;AACzB,uBAAuB,kEAAC;AACxB;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgB;;;;;;;;;;;;;ACjCjB;AAAA;AAAA;AACA;AACO;AACP;AACA;;;;;;;;;;;;;ACJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA2D;AACvB;AACN;AAC9B;AACA;AACA;AACA;AACA,sBAAsB,iDAAG;AACzB;AACA,QAAQ,gFAAyB;AACjC,uBAAuB,2CAAK;AAC5B,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACqB;;;;;;;;;;;;;AC7BtB;AAAA;AAAA;AAAoC;AACpC;AACA;AACA;AACA;AACA,sBAAsB,iDAAG;AACzB;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgB;;;;;;;;;;;;;ACzBjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA2G;AACpD;AAC1B;AAC7B;AACA;AACA;AACA;AACA,wBAAwB,0CAAI,CAAC,yEAAQ;AACrC,QAAQ,8DAAO;AACf,sBAAsB,gEAAS;AAC/B,QAAQ,sEAAe;AACvB,yBAAyB,gEAAS,KAAK,0CAAI,CAAC,yEAAQ;AACpD,QAAQ,gFAAyB;AACjC;AACA,yBAAyB,gEAAS,SAAS,gBAAgB;AAC3D;AACA;AACA;AACA;AACA,iBAAiB,0BAA0B,kEAAC,mBAAmB;AAC/D,iBAAiB,0BAA0B,kEAAC,uBAAuB;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA,CAAC;AACqB;;;;;;;;;;;;;ACjCtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA0D;AACJ;AACzB;AAC4D;AACzF;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAAI,CAAC,wDAAQ;AACpC,QAAQ,8DAAO;AACf,wBAAwB,iDAAC;AACzB;AACA,QAAQ,sEAAe;AACvB;AACA;AACA;AACA;AACA,kBAAkB,2CAAK,WAAW,iDAAC,2BAA2B,6CAAK;AACnE,mCAAmC,oDAAY;AAC/C,uCAAuC,uDAAe;AACtD,2BAA2B,0CAAI,CAAC,wDAAQ;AACxC,QAAQ,8DAAO;AACf;AACA,yCAAyC,uDAAe;AACxD;AACA,4BAA4B,iDAAC;AAC7B,uCAAuC,oDAAY;AACnD,0BAA0B,2CAAK;AAC/B,yBAAyB,2CAAK;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,2CAAK;AAChC;AACA;AACA;AACA;AACA,mBAAmB,iDAAC;AACpB;AACA;AACA;AACA;AACA,uBAAuB,+CAAS;AAChC,mBAAmB,iDAAC;AACpB;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,wBAAwB,0CAAI,CAAC,wDAAQ;AACrC;AACA;AACA,0BAA0B,2CAAK;AAC/B;AACA,gBAAgB;AAChB;AACA;AACA,qBAAqB,2CAAK,WAAW,iDAAC,+BAA+B,6CAAK;AAC1E,mBAAmB,2CAAK,WAAW,uDAAO;AAC1C;AACA;AACA,mCAAmC,oDAAY;AAC/C,sCAAsC,uDAAe;AACrD,qBAAqB,2CAAK,WAAW,uDAAO;AAC5C;AACA,mBAAmB,2CAAK;AACxB;AACA;AACA,yBAAyB,0CAAI,WAAW,uDAAO;AAC/C,uBAAuB,0CAAI,WAAW,uDAAO;AAC7C;AACA;AACA;AACA,mCAAmC,oDAAY;AAC/C,sCAAsC,uDAAe;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,wCAAG;AAClC;AACA;AACA,+BAA+B,wCAAG;AAClC;AACA;AACA;AACA;AACA,+BAA+B,wCAAG;AAClC;AACA;AACA,+BAA+B,wCAAG;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,qBAAqB,6BAA6B;AAClD,qBAAqB,8CAA8C;AACnE,qBAAqB,iDAAiD;AACtE,qBAAqB,mCAAmC;AACxD;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,0CAA0C;AAC/D,qBAAqB,oCAAoC;AACzD;AACA,uCAAuC,4BAA4B;AACnE,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,uCAAuC,4BAA4B,EAAE;AACrE;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACuB;;;;;;;;;;;;;AC7JxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6C;AAC1B;AACW;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,2CAAK,QAAQ,kEAAC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB,kEAAC;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,iCAAiC;AACtD,qBAAqB,kCAAkC;AACvD;AACA,aAAa;AACb;AACA;AACA;AACA,uCAAuC,yBAAyB;AAChE,aAAa;AACb;AACA;AACA;AACA,CAAC;AACkB;;;;;;;;;;;;;ACpEnB;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACO;;;;;;;;;;;;;ACNP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyC;AACoB;AACzB;AACoB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,0CAAI,CAAC,yEAAQ;AACtC,QAAQ,8DAAO;AACf;AACA,QAAQ,sEAAe;AACvB;AACA,uBAAuB,0CAAI,CAAC,yEAAQ;AACpC,sBAAsB,gEAAS;AAC/B,QAAQ,sEAAe;AACvB;AACA,kBAAkB,wEAAO;AACzB,QAAQ,sEAAe;AACvB;AACA,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;;;;;;;;;;;;;AC/CtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8B;AACsB;AACE;AACS;AACF;AAC9B;AACC;AACY;AACd;AAC9B;AACO;AACP,gBAAgB,gDAAgB,CAAC,yDAAW;AAC5C;AACA;AACA,QAAQ,mDAAC;AACT,QAAQ,mDAAK;AACb,4BAA4B,yEAAe;AAC3C;AACA,gBAAgB,0DAAY;AAC5B,gBAAgB,sDAAQ,CAAC,mDAAK;AAC9B,gBAAgB,oDAAM;AACtB;AACA,QAAQ,gEAAgB,aAAa,wDAAQ;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,mDAAmB,SAAS,6DAA6D;AACpG,QAAQ,mDAAmB,SAAS;AACpC;AACA,aAAa,EAAE;AACf,QAAQ,mDAAmB,UAAU,iCAAiC;AACtE,YAAY,mDAAmB,UAAU,2CAA2C;AACpF;AACA;AACA,kBAAkB,mDAAmB,UAAU,uCAAuC;AACtF,oBAAoB,mDAAmB,OAAO,uBAAuB,mEAAmB,uBAAuB;AAC/G;AACA,oBAAoB,mEAAmB;AACvC;AACA;AACA;AACA;AACO;AACP,WAAW,mDAAmB,UAAU,SAAS,iHAAiH,EAAE;AACpK;;;;;;;;;;;;;AC3DA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6C;AACU;AACE;AACzD;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,0CAAI,CAAC,yEAAQ;AACrC;AACA,8BAA8B,0CAAI,CAAC,yEAAQ;AAC3C;AACA,8BAA8B,0CAAI,CAAC,yEAAQ;AAC3C;AACA,yBAAyB,kDAAY,EAAE,uCAAuC;AAC9E;AACA;AACA,yBAAyB,kEAAW;AACpC,0BAA0B,kEAAW;AACrC,wBAAwB,2CAAK;AAC7B,6CAA6C,kEAAC;AAC9C;AACA;AACA,+BAA+B,kEAAC;AAChC;AACA;AACA;AACA;AACA,0BAA0B,2CAAK,gBAAgB,2CAAK,QAAQ,kEAAC;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,kEAAC;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,iCAAiC;AACtD,qBAAqB,kCAAkC;AACvD,qBAAqB,mCAAmC;AACxD,qBAAqB,sCAAsC;AAC3D;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACmB;;;;;;;;;;;;;ACpEpB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyC;AACsC;AACtB;AACzD;AACA;AACA;AACA;AACA,2BAA2B,kDAAY;AACvC;AACA,4BAA4B,kDAAY;AACxC;AACA;AACA;AACA;AACA;AACA,2BAA2B,kEAAC;AAC5B,kDAAkD,kEAAC;AACnD,4BAA4B,kEAAC;AAC7B,oDAAoD,kEAAC;AACrD,uBAAuB,WAAW;AAClC,4BAA4B,kEAAC;AAC7B,kCAAkC,kEAAC;AACnC,6BAA6B,kEAAC;AAC9B,mCAAmC,kEAAC;AACpC;AACA,gCAAgC,0CAAI,CAAC,yEAAQ;AAC7C,gCAAgC,0CAAI,CAAC,yEAAQ;AAC7C;AACA,sBAAsB,0CAAI,WAAW,kEAAC,iCAAiC,8DAAK;AAC5E;AACA,gCAAgC,2CAAK;AACrC;AACA;AACA,2BAA2B,wBAAwB;AACnD;AACA,+BAA+B,0CAAI;AACnC,oBAAoB,kEAAC,CAAC,kEAAC;AACvB,oBAAoB,kEAAC,CAAC,kEAAC,QAAQ,kEAAC,SAAS,kEAAC;AAC1C,oBAAoB,kEAAC,CAAC,kEAAC,8DAA8D,sEAAK;AAC1F,oBAAoB,sEAAK;AACzB;AACA,gBAAgB,8DAAO;AACvB;AACA,kCAAkC,kEAAC;AACnC;AACA;AACA,gCAAgC,0CAAI;AACpC,oBAAoB,kEAAC;AACrB,oBAAoB,kEAAC,qBAAqB,kEAAC;AAC3C,oBAAoB,kEAAC,qBAAqB,kEAAC;AAC3C;AACA;AACA,mCAAmC,kEAAC;AACpC;AACA;AACA;AACA;AACA,0BAA0B,2CAAK;AAC/B;AACA;AACA,sBAAsB,2CAAK,WAAW,mEAAE;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACmB;;;;;;;;;;;;;AC5EpB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACoC;AAC2B;AACY;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAAI,CAAC,wDAAQ;AACpC;AACA;AACA;AACA,QAAQ,qDAAO;AACf;AACA,QAAQ,6DAAe;AACvB;AACA,0BAA0B,0CAAI,CAAC,wDAAQ;AACvC,QAAQ,qDAAO;AACf;AACA,QAAQ,6DAAe;AACvB;AACA;AACA,0BAA0B,2CAAK;AAC/B,QAAQ,wDAAU,UAAU,iDAAC,gCAAgC,iDAAC,IAAI,qDAAa;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,iDAAC;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,EAAE,2DAAmB,IAAI,mBAAmB;AAC3F;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;;;;;;;;;;;;;ACvEtB;AAAA;AAAA;AAAA;AAAA;AAA6C;AACf;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,2CAAK,WAAW,kEAAC;AACvC;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiB;;;;;;;;;;;;;ACjClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC6C;AAC+D;AAC5D;AACT;AACD;AACc;AACpD;AACA;AACA,gCAAgC,yDAAY;AAC5C,iCAAiC,yDAAY;AAC7C;AACA;AACA;AACA,kGAAkG,kEAAC;AACnG,0BAA0B,2CAAK;AAC/B;AACA;AACA,8GAA8G,kEAAC;AAC/G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,2CAAK;AAC/B,4CAA4C;AAC5C;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,oDAAQ,mBAAmB,mDAAQ,oBAAoB,mDAAQ;AAC/F,4CAA4C,iBAAiB,oBAAoB;AACjF;AACA;AACA;AACA;AACA;AACA,uBAAuB,+CAAS,WAAW,iCAAiC;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,yBAAyB,6EAAmB;AAC5C,aAAa;AACb;AACA;AACA,0BAA0B,8EAAoB;AAC9C,6CAA6C,8EAAoB;AACjE,aAAa;AACb;AACA;AACA;AACA,qBAAqB,kDAAkD;AACvE,qBAAqB,gFAAgF,qBAAqB,EAAE,EAAE;AAC9H;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC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CA;AACA;AACA,QAAQ,mDAAQ;AAChB;AACA;AACA;AACA;AACA,uCAAuC,WAAW,kBAAkB;AACpE,SAAS;AACT;AACA;AACA,CAAC;AACuB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,mDAAQ;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,mDAAQ;AAChB;AACA;AACA;AACA,uCAAuC,WAAW,kBAAkB;AACpE,SAAS;AACT;AACA;AACA;AACA,QAAQ,mDAAQ;AAChB;AACA;AACA;AACA;AACA,uCAAuC,WAAW,kBAAkB;AACpE,SAAS;AACT;AACA;AACA,CAAC;AACuB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,mDAAQ;AAChB;AACA;AACA;AACA,uCAAuC,WAAW,kBAAkB;AACpE,SAAS;AACT;AACA;AACA;AACA,QAAQ,mDAAQ;AAChB;AACA;AACA;AACA;AACA,uCAAuC,WAAW,kBAAkB;AACpE,SAAS;AACT;AACA;AACA,CAAC;AACuB;AACxB;AACA,gBAAgB,mDAAQ;AACxB,mBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,mDAAQ;AACxB;AACA,mBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACnNA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC4D;AACa;AAC5C;AACK;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,0CAAI,CAAC,yEAAQ;AACrC,QAAQ,8DAAO;AACf;AACA;AACA,sBAAsB,gEAAS;AAC/B;AACA,8BAA8B,0CAAI,CAAC,yEAAQ;AAC3C;AACA;AACA;AACA;AACA,QAAQ,sEAAe;AACvB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,EAAE,4EAAmB,IAAI,mBAAmB;AAC3F;AACA;AACA,CAAC;AACwB;;;;;;;;;;;;;ACtDzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACmD;AACzB;AACI;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,2CAAM;AACxB,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,kBAAkB,6CAAK;AACvB,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,kBAAkB,6CAAK;AACvB,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,kBAAkB,6CAAK;AACvB,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,kBAAkB,6CAAK;AACvB,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,kBAAkB,6CAAK;AACvB,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,kBAAkB,6CAAK;AACvB,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,kBAAkB,6CAAK;AACvB,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,kBAAkB,6CAAK;AACvB,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,kBAAkB,6CAAK;AACvB,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,kBAAkB,6CAAK;AACvB,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,kBAAkB,6CAAK;AACvB,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,kBAAkB,6CAAK;AACvB,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,kBAAkB,6CAAK;AACvB,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,kBAAkB,6CAAK;AACvB,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,kBAAkB,6CAAK;AACvB,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,kBAAkB,6CAAK;AACvB,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,kBAAkB,6CAAK;AACvB,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,kBAAkB,6CAAK;AACvB,KAAK;AACL;AACA;AACA;AACA;AACA,6BAA6B,QAAQ,qEAAqE,EAAE;AAC5G;AACA,eAAe,wEAAc;AAC7B,+BAA+B,UAAU,gDAAgD;AACzF,CAAC;AACD,8DAA8D,QAAQ,qEAAqE,EAAE;AAC7I,iEAAiE,gCAAgC,EAAE;AAC5F,sEAAsE,6BAA6B,EAAE,uBAAuB,kBAAkB,EAAE;AACvJ;AACO;AACP;AACO;AACQ,yFAA0B,EAAC;;;;;;;;;;;;;ACx/C1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC+B;AACa;AACrC;AACP;AACA,YAAY,mDAAmB,WAAW,0EAA0E,+DAA+D,EAAE,sIAAsI,gDAAgD,EAAE,EAAE;AAC/W;AACO;AACP,gBAAgB,gDAAgB,CAAC,yDAAW;AAC5C;AACA;AACA,iDAAiD,sCAAsC,EAAE;AACzF,WAAW,mDAAmB,SAAS,yCAAyC;AAChF,QAAQ,mDAAmB,sBAAsB,UAAU,yDAAyD;AACpH,QAAQ,mDAAmB,WAAW,qEAAqE;AAC3G;AACA;AACA;AACO,8CAA8C,SAAS,mDAAmB,iDAAiD,QAAQ,mDAAmB,8BAA8B,MAAM,YAAY,GAAG,EAAE,IAAI;;;;;;;;;;;;;AC7BtN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAgD;AACqB;AACD;AACd;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,CAAC;AAC2B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,CAAC;AAC0B;AAC3B;AACA,qBAAqB,0CAAI,WAAW,kEAAC,eAAe,8DAAK;AACzD;AACA,kCAAkC,6DAAS,KAAK,qEAAY,sBAAsB,cAAc;AAChG,kBAAkB,yFAAU,yBAAyB,kEAAC;AACtD,kBAAkB,yFAAU,yBAAyB,kEAAC;AACtD,iBAAiB,2CAAK,WAAW,kEAAC,eAAe,8DAAK;AACtD;AACA,kBAAkB,qEAAY;AAC9B,6BAA6B,+CAAS;AACtC,eAAe,kEAAC;AAChB;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,mBAAmB,+CAAS;AAC5B,eAAe,kEAAC;AAChB;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,uBAAuB,+CAAS;AAChC,eAAe,kEAAC;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,sBAAsB,2CAAK;AAC3B;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC7EA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,KAAK,wCAAwC;AAC7C,KAAK,iCAAiC;AACtC,KAAK,qCAAqC;AAC1C,KAAK,8CAA8C;AACnD,KAAK,6CAA6C;AAClD,KAAK,qCAAqC;AAC1C,KAAK,iCAAiC;AACtC,KAAK,qDAAqD;AAC1D,KAAK,qCAAqC;AAC1C;AACO;AACP;AACA;AACA;AACA;AACA;AACO,sCAAsC;;;;;;;;;;;;;AC5B7C;AAAA;AAAA;AAA6C;AAC7C;AACA;AACA,8BAA8B,gBAAgB;AAC9C;AACA;AACA;AACA;AACA,2BAA2B,SAAS;AACpC,eAAe,kEAAC;AAChB;AACA;AACA;AACA,2BAA2B,SAAS;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,kEAAC;AAChB;AACA;AACA,CAAC;AACiB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC1CA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkF;AACjB;AACX;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,0CAAI,CAAC,yEAAQ;AACvC;AACA,QAAQ,8DAAO;AACf;AACA;AACA;AACA,+BAA+B,kEAAC;AAChC,0BAA0B,2CAAK;AAC/B;AACA;AACA,QAAQ,sEAAe;AACvB;AACA,mCAAmC,0CAAI,MAAM,kEAAC,2BAA2B,kEAAC;AAC1E;AACA;AACA;AACA;AACA,4BAA4B,+CAAS;AACrC,uBAAuB,kEAAC;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,mCAAmC,2CAAK,WAAW,kEAAC,wBAAwB,8DAAK;AACjF;AACA;AACA;AACA,gBAAgB,2CAAK,WAAW,kEAAC,uBAAuB,8DAAK;AAC7D,gBAAgB,2CAAK,WAAW,kEAAC,2BAA2B,8DAAK;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,0EAA0E,kEAAC;AAC3F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,oDAAoD,UAAU,6BAA6B,EAAE,EAAE;AAC/F,aAAa;AACb,aAAa,gGAAgG;AAC7G;AACA;AACA;AACA,CAAC;AACkB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,0CAAI,CAAC,yEAAQ;AACvC,QAAQ,8DAAO;AACf;AACA,QAAQ,sEAAe;AACvB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;AAC1B;AACA;AACA;AACA;AACA;AACA,wBAAwB,0CAAI,CAAC,yEAAQ;AACrC,QAAQ,8DAAO;AACf;AACA,sBAAsB,gEAAS;AAC/B,QAAQ,sEAAe;AACvB,QAAQ,kEAAW,WAAW,QAAQ,kEAAC,wBAAwB,kEAAC,uDAAuD;AACvH,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsB;;;;;;;;;;;;;AC1MvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA+C;AACN;AACyB;AAC9B;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,0CAAI,CAAC,yEAAQ;AACvC,QAAQ,8DAAO;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,oEAAW,iCAAiC,qEAAY;AACnF;AACA,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACuB;;;;;;;;;;;;;ACxDxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC4D;AACY;AAC7B;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,0CAAI,CAAC,yEAAQ;AACrC;AACA;AACA,sBAAsB,gEAAS;AAC/B,QAAQ,sEAAe;AACvB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACuB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,2CAAK;AAC5B,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,qBAAqB,kCAAkC;AACvD,qBAAqB,8CAA8C;AACnE,qBAAqB,qDAAqD;AAC1E;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA,uCAAuC,kBAAkB,EAAE;AAC3D;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACsB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,2CAAK;AAC5B,gBAAgB;AAChB;AACA;AACA;AACA;AACA,+CAA+C,8CAA8C,oBAAoB;AACjH;AACA;AACA;AACA,CAAC;AAC4B;AAC7B;AACA;AACA;AACA;AACA,kCAAkC,2CAAK;AACvC,kCAAkC,2CAAK,QAAQ,kEAAC;AAChD;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EAAe;AACvB;AACA,uBAAuB,2CAAK,eAAe,+CAAS;AACpD,6BAA6B,0CAAI,eAAe,+CAAS;AACzD,gBAAgB,0EAA0E,wBAAwB,iDAAC,wBAAwB;AAC3I;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACoB;;;;;;;;;;;;;ACtCrB;AAAA;AAAA;AAAA;AAAA;AAA+E;AACpC;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,0CAAI,CAAC,yEAAQ;AACxC,uBAAuB,0CAAI,CAAC,yEAAQ;AACpC,qBAAqB,2CAAK,WAAW,kEAAC,mBAAmB,8DAAK;AAC9D,oCAAoC,qEAAY;AAChD;AACA,4BAA4B,0CAAI,CAAC,yEAAQ;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,sDAAsD,kEAAC,oBAAoB;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,+CAA+C;AACpE,qBAAqB,yCAAyC;AAC9D,qBAAqB,oDAAoD;AACzE;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,4DAA4D;AACjF,qBAAqB,wDAAwD;AAC7E,qBAAqB,wDAAwD;AAC7E,qBAAqB,gDAAgD;AACrE,qBAAqB,yCAAyC;AAC9D,qBAAqB,iCAAiC;AACtD,qBAAqB,wCAAwC;AAC7D,qBAAqB,mCAAmC;AACxD,qBAAqB,uCAAuC;AAC5D,qBAAqB,iDAAiD;AACtE,qBAAqB,mCAAmC;AACxD;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACsB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACrIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAoE;AACd;AACJ;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA,wBAAwB;AACxB;AACA,wBAAwB;AACxB;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAAI,eAAe,+CAAS;AACnD,uBAAuB,0CAAI,QAAQ,iDAAC;AACpC,uBAAuB,kDAAY;AACnC,QAAQ,6DAAe;AACvB;AACA;AACA,8BAA8B,0CAAI,QAAQ,iDAAC;AAC3C;AACA,8BAA8B,0CAAI,MAAM,iDAAC,IAAI,oDAAI,kDAAkD,iDAAC;AACpG;AACA;AACA;AACA;AACA,0BAA0B,2CAAK;AAC/B,QAAQ,wDAAU,UAAU,iDAAC,4CAA4C,iDAAC,IAAI,qDAAa;AAC3F;AACA;AACA,uBAAuB,2CAAK,eAAe,+CAAS;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,qBAAqB,iCAAiC;AACtD,qBAAqB,kDAAkD;AACvE,qBAAqB,iCAAiC;AACtD,qBAAqB;AACrB;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACsB;;;;;;;;;;;;;AC3FvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,8EAA8E;AAC3G;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC4C;AACI;AACY;AACzB;AACT;AACO;AACC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,mDAAQ;AAC5C;AACA;AACA;AACA;AACA;AACA,gBAAgB,yCAAG,kBAAkB,yCAAG,oBAAoB,yCAAG;AAC/D;AACA,uDAAuD,kEAAC;AACxD,oDAAoD,qCAAqC,EAAE;AAC3F;AACA,4BAA4B;AAC5B;AACA,qBAAqB,yCAAG,oBAAoB,yCAAG;AAC/C;AACA,oCAAoC,kEAAC;AACrC,gBAAgB,gEAAgB,aAAa,wDAAQ,CAAC,mDAAQ,mCAAmC,YAAY,iDAAI,gCAAgC,kEAAC,aAAa,EAAE;AACjK;AACA,qBAAqB,yCAAG;AACxB,yEAAyE,uCAAuC;AAChH;AACA;AACA;AACA;AACA,qDAAqD,kEAAC;AACtD,sDAAsD,kEAAC;AACvD;AACA;AACA;AACA;AACA,sDAAsD,kEAAC;AACvD;AACA;AACA;AACA,sDAAsD,kEAAC;AACvD,qDAAqD,kEAAC;AACtD;AACA;AACA;AACA,qDAAqD,kEAAC;AACtD;AACA;AACA;AACA,qBAAqB,yCAAG;AACxB;AACA,yEAAyE,qCAAqC;AAC9G,gBAAgB,gDAAI;AACpB;AACA;AACA,mFAAmF,kEAAC;AACpF;AACA;AACA;AACA,qBAAqB,yCAAG;AACxB;AACA,yEAAyE,uCAAuC;AAChH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,yCAAG;AAC3B;AACA;AACA;AACA;AACA;AACA,wBAAwB,yCAAG;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,gEAAgB;AAC5B;AACA;AACA;AACA;AACA,YAAY,gEAAgB,aAAa,8DAAgB;AACzD;AACA,gBAAgB,gEAAgB,aAAa,iDAAI;AACjD;AACA,YAAY,gEAAgB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,0CAAI;AACkB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,gBAAgB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACnMA;AAAA;AAAA;AAAoC;AACpC;AACA;AACA;AACA;AACA,sBAAsB,iDAAG;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;;;;;;;;;;;;;AC5B1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAA2C;AACD;AACH;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0CAAI,WAAW,iDAAC;AACtC;AACA;AACA,2BAA2B,0CAAI,WAAW,iDAAC;AAC3C;AACA;AACA;AACA;AACA;AACA,QAAQ,6DAAe;AACvB;AACA,0BAA0B,2CAAK;AAC/B;AACA;AACA,uCAAuC,0CAAI,CAAC,wDAAQ,2HAA2H,QAAQ;AACvL;AACA,uBAAuB,2CAAK,WAAW,iDAAC;AACxC,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,qBAAqB,iCAAiC;AACtD,qBAAqB,mCAAmC;AACxD;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsB;;;;;;;;;;;;;ACzDvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AAC+C;AAC4B;AACpC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,QAAQ,iDAAC,oBAAoB,EAAE;AAC7E,4CAA4C,UAAU,0BAA0B,EAAE,EAAE;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,0CAAI;AAC9B,4BAA4B,wDAAQ;AACpC,QAAQ,qDAAO;AACf,QAAQ,yDAAW;AACnB;AACA,QAAQ,6DAAe;AACvB,uBAAuB,2CAAK,eAAe,+CAAS;AACpD;AACA;AACA;AACA;AACA,uBAAuB,oBAAoB,iDAAC;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACmB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAAI;AAC3B,yBAAyB,wDAAQ;AACjC,QAAQ,qDAAO;AACf,+BAA+B,wDAAQ;AACvC,QAAQ,yDAAW;AACnB;AACA,uBAAuB,uDAAS;AAChC,QAAQ,6DAAe;AACvB,uBAAuB,2CAAK,eAAe,+CAAS;AACpD;AACA;AACA;AACA;AACA;AACA,iBAAiB,0BAA0B,iDAAC,8CAA8C;AAC1F,iBAAiB,oBAAoB,iDAAC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,2CAA2C,mBAAmB;AAC7G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC8B;;;;;;;;;;;;;AC3H/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyC;AACL;AACA;AACS;AACC;AAC9C;AACA;AACA;AACA;AACA,yBAAyB,0CAAI,CAAC,wDAAQ;AACtC,uBAAuB,0CAAI,CAAC,wDAAQ;AACpC,QAAQ,8DAAO;AACf;AACA,QAAQ,sEAAe;AACvB;AACA,qCAAqC;AACrC,kBAAkB,uDAAO;AACzB,QAAQ,sEAAe;AACvB,kCAAkC;AAClC,0BAA0B,2CAAK;AAC/B;AACA,wBAAwB,iDAAG;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,qBAAqB,6BAA6B;AAClD,qBAAqB,mCAAmC;AACxD;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;;;;;;;;;;;;;AC1DtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6C;AACG;AACZ;AACpC;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,0CAAI,MAAM,kEAAC,QAAQ,kEAAC;AAClD,+BAA+B,kEAAW;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,2CAAK,WAAW,kEAAC;AAC3C,+BAA+B,kEAAW;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;;;;;;;;;;;;;ACpD3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyD;AAC9B;AACY;AACyC;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,qBAAqB,yCAAyC;AAC9D,qBAAqB,yCAAyC;AAC9D;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA,uCAAuC,6BAA6B,EAAE;AACtE;AACA;AACA,qBAAqB,wCAAwC;AAC7D,qBAAqB,6CAA6C;AAClE;AACA;AACA;AACA;AACA;AACA,CAAC;AACkB;AACnB;AACA;AACA;AACA;AACA,gBAAgB,2CAAO,WAAW,iDAAC,yBAAyB;AAC5D,cAAc,2CAAO,WAA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;AACA;AACA;AACA;AACA;AACA,oEAAoE,2FAA2F,yCAAG;AAClK;AACA;AACA;AACA;AACO;AACP;AACA;AACA,aAAa,iFAA0B,CAAC,sEAAU;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,YAAY,mDAAC,mDAAmD,OAAO;AACvE;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,8DAAgB;AAClD;AACA,uBAAuB,wDAAQ;AAC/B,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC7EA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACwC;AACV;AACqB;AACJ;AACK;AACtB;AACO;AACuC;AAClC;AACnC;AACP,IAAI,mDAAC;AACL;AACA,IAAI,gEAAgB;AACpB,IAAI,qDAAQ,UAAU,gEAAU;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,uDAAgB;AACpB;AACA;AACA;AACA;AACA,0CAA0C,gBAAgB,OAAO,4DAAe,gCAAgC;AAChH;AACA,QAAQ,2CAAE;AACV;AACA,QAAQ,qDAAQ,UAAU,6EAAuB;AACjD,gCAAgC,QAAQ,qDAAQ,UAAU,6DAAO,uBAAuB,EAAE;AAC1F,KAAK;AACL;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,kBAAkB;AACpD,QAAQ,mDAAC;AACT,kCAAkC,4DAAe;AACjD;AACA,qCAAqC,qDAAQ;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,qDAAQ;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,gBAAgB;AACjE,QAAQ,wDAAO;AACf;AACA,gBAAgB,qDAAQ,UAAU,qEAAe;AACjD;AACA,aAAa;AACb;AACA;AACA,oBAAoB,mDAAC;AACrB;AACA;AACA;AACA;AACA;AACA,+FAA+F,yCAAyC;AACxI;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,QAAQ,wDAAO;AACf;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,2BAA2B,qDAAQ;AACnC,oBAAoB,qDAAQ,UAAU,qEAAe,EAAE,+BAA+B;AACtF;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,QAAQ,wDAAO,8BAA8B,iBAAiB;AAC9D;AACA;AACA;AACA;AACA,2BAA2B,qDAAQ;AACnC,oBAAoB,qDAAQ,UAAU,qEAAe;AACrD;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,CAAC,gCAAgC;;;;;;;;;;;;;ACpJjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AACiD;AACY;AACJ;AACrB;AACpC;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,2CAAK;AAC/B,QAAQ,sEAAe;AACvB,2BAA2B,0CAAI;AAC/B;AACA;AACA;AACA;AACA;AACA,iBAAiB,0BAA0B,kEAAC,qBAAqB;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,sBAAsB,oDAAoD;AAC1E;AACA,sBAAsB,gCAAgC;AACtD;AACA;AACA;AACA,CAAC;AACmB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,QAAQ,kEAAC,eAAe,EAAE;AACxE,4CAA4C,UAAU,cAAc,EAAE,EAAE;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,0CAAI,CAAC,yEAAQ;AACvC,6BAA6B,0CAAI,CAAC,yEAAQ;AAC1C,0BAA0B,2CAAK;AAC/B,QAAQ,sEAAe;AACvB,uBAAuB,2CAAK,WAAW,kEAAC;AACxC;AACA;AACA;AACA;AACA,6CAA6C,kEAAC;AAC9C,iBAAiB;AACjB,6CAA6C,kEAAC;AAC9C,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACe;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,kDAAY,GAAG;AACtC,oBAAoB,kEAAC;AACrB,oBAAoB,kEAAC;AACrB,oBAAoB,kEAAC;AACrB,oBAAoB,kEAAC;AACrB,oBAAoB,kEAAC;AACrB,oBAAoB,kEAAC;AACrB,oBAAoB,kEAAC;AACrB,oBAAoB,kEAAC;AACrB,oBAAoB,kEAAC;AACrB,oBAAoB,kEAAC;AACrB,oBAAoB,kEAAC;AACrB,oBAAoB,kEAAC;AACrB,QAAQ,sEAAe;AACvB;AACA;AACA;AACA,iBAAiB,0BAA0B,kEAAC,yBAAyB;AACrE,iBAAiB,0BAA0B,kEAAC,wBAAwB;AACpE,iBAAiB,0BAA0B,kEAAC,wBAAwB;AACpE,iBAAiB,0BAA0B,kEAAC,0BAA0B;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,kDAAY,GAAG;AACtC,oBAAoB,kEAAC;AACrB,oBAAoB,kEAAC;AACrB,oBAAoB,kEAAC;AACrB,oBAAoB,kEAAC;AACrB,oBAAoB,kEAAC;AACrB,oBAAoB,kEAAC;AACrB,oBAAoB,kEAAC;AACrB,oBAAoB,kEAAC;AACrB,QAAQ,sEAAe;AACvB;AACA;AACA;AACA,iBAAiB,0BAA0B,kEAAC,yBAAyB;AACrE,iBAAiB,0BAA0B,kEAAC,wBAAwB;AACpE,iBAAiB,0BAA0B,kEAAC,wBAAwB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,QAAQ,kEAAC,YAAY,EAAE;AACrE,4CAA4C,UAAU,YAAY,EAAE,EAAE;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAAI,CAAC,yEAAQ;AACpC,sBAAsB,gEAAS;AAC/B,QAAQ,sEAAe;AACvB;AACA;AACA;AACA;AACA,iBAAiB,0BAA0B,kEAAC,8CAA8C;AAC1F,iBAAiB,0BAA0B,kEAAC,6CAA6C;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACgB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,kEAAC;AACnC,qCAAqC,kEAAC;AACtC;AACA,wDAAwD,kCAAkC,EAAE;AAC5F,2DAA2D,kCAAkC,EAAE;AAC/F;AACA,0BAA0B,2CAAK;AAC/B,gBAAgB,0CAAI;AACpB,gBAAgB,0CAAI;AACpB;AACA,QAAQ,sEAAe;AACvB;AACA,2BAA2B,0CAAI;AAC/B;AACA;AACA;AACA;AACA,oCAAoC,uBAAuB,kDAAkD;AAC7G,oCAAoC,sBAAsB,8EAA8E;AACxI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,sBAAsB,sDAAsD;AAC5E,sBAAsB,uDAAuD;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,0CAAI,CAAC,yEAAQ;AACxC;AACA;AACA;AACA;AACA,sBAAsB,gEAAS;AAC/B,QAAQ,sEAAe;AACvB;AACA;AACA;AACA;AACA,iBAAiB,0BAA0B,kEAAC,uBAAuB;AACnE,iBAAiB,0BAA0B,kEAAC,qBAAqB;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,kEAAC;AACb;AACA;AACA,qBAAqB,kEAAC;AACtB;AACA,qBAAqB,kEAAC;AACtB;AACA,YAAY,kEAAC;AACb,YAAY,kEAAC;AACb;AACA;AACA,aAAa,kEAAC;AACd,aAAa,kEAAC;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0CAAI;AAC1B,QAAQ,kEAAC;AACT,QAAQ,kEAAC;AACT,QAAQ,kEAAC;AACT,QAAQ,kEAAC;AACT;AACA;AACA,yBAAyB,0CAAI;AAC7B,QAAQ,kEAAC;AACT,QAAQ,kEAAC;AACT,QAAQ,kEAAC;AACT,QAAQ,kEAAC;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,kEAAC;AACnB,kBAAkB,kEAAC;AACnB;AACA;AACA;AACA;;;;;;;;;;;;;AC/aA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,8EAA8E;AAC3G;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC+C;AACoB;AACrC;AACmB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,+CAAe;AAChD;AACA,oCAAoC,iFAAe;AACnD,uBAAuB,2BAA2B,kEAAC,gBAAgB,kEAAC;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,mDAAmB,SAAS;AAC3C;AACA;AACA;AACA,aAAa,EAAE;AACf,YAAY,mDAAmB,SAAS;AACxC;AACA;AACA;AACA;AACA,iBAAiB,EAAE;AACnB,YAAY,mDAAmB,SAAS;AACxC;AACA,iBAAiB,EAAE;AACnB,gBAAgB,mDAAmB,OAAO,+BAA+B;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mBAAmB;AAC1C;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA,CAAC,CAAC,+CAAe;AACW;AAC5B;AACA;AACA,2CAA2C,uEAAO;AAClD;AACA;;;;;;;;;;;;;AClGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AACuD;AACO;AAChC;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA,iBAAiB,EAAE,EAAE;AACrB,8CAA8C,QAAQ,kEAAC,4BAA4B,EAAE;AACrF;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,2CAAK,WAAW,kEAAC,4CAA4C,8DAAK;AACxF,QAAQ,2EAAW;AACnB;AACA;AACA,sBAAsB,2EAAW;AACjC;AACA;AACA;AACA;AACA;AACA,qCAAqC,kEAAkE,EAAE,2EAAW;AACpH,wCAAwC,2EAAW;AACnD,YAAY,2EAAW;AACvB;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,uCAAuC,wBAAwB;AAC/D;AACA;AACA;AACA;AACA,CAAC;AACoB;;;;;;;;;;;;;AC3ErB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AACuD;AACO;AAChC;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,QAAQ,kEAAC,4BAA4B,EAAE;AACrF,4CAA4C,UAAU,kCAAkC,EAAE,EAAE;AAC5F;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,2CAAK,SAAS,kEAAC,sBAAsB,8DAAK;AAChE,QAAQ,2EAAW;AACnB;AACA;AACA,sBAAsB,2EAAW;AACjC;AACA;AACA;AACA;AACA;AACA,qCAAqC,6CAA6C,EAAE,2EAAW;AAC/F,wCAAwC,2EAAW;AACnD,YAAY,2EAAW;AACvB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkB;;;;;;;;;;;;;ACtEnB;AAAA;AAAA;AAAA;AAAmD;AACQ;AAC3D;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA,QAAQ,wEAAqB;AAC7B;AACA;AACA,gBAAgB,wEAAc;AAC9B;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AClBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6C;AACT;AACN;AACS;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,iDAAG;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,2CAAK;AAC/B;AACA,oBAAoB,oDAAM;AAC1B;AACA,uBAAuB,sBAAsB;AAC7C;AACA,oCAAoC,kEAAC;AACrC;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,yCAAyC;AAC9D,qBAAqB,mCAAmC;AACxD;AACA,aAAa;AACb;AACA;AACA,uCAAuC,iCAAiC,EAAE;AAC1E;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,uCAAuC,oBAAoB;AAC3D;AACA;AACA;AACA;AACA,CAAC;AACgB;;;;;;;;;;;;;ACpFjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAoE;AACkB;AAC3C;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAAI,CAAC,yEAAQ;AACpC,QAAQ,8DAAO;AACf;AACA,QAAQ,gFAAyB;AACjC;AACA;AACA;AACA,2BAA2B,qEAAY;AACvC;AACA,2BAA2B,qEAAY;AACvC;AACA;AACA;AACA,SAAS;AACT,0BAA0B,2CAAK;AAC/B;AACA;AACA,6BAA6B,2CAAK,WAAW,kEAAC;AAC9C,2CAA2C,wEAAe;AAC1D,uCAAuC,qEAAY;AACnD;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,uCAAuC;AAC5D,qBAAqB,qCAAqC;AAC1D,qBAAqB;AACrB;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,kCAAkC;AACvD,qBAAqB,6CAA6C;AAClE;AACA;AACA;AACA;AACA;AACA,CAAC;AACe;;;;;;;;;;;;;ACtEhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyC;AACO;AACkC;AACvC;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,0CAAI,CAAC,yEAAQ;AACtC,0BAA0B,0CAAI,WAAW,kEAAC,iBAAiB,8DAAK;AAChE;AACA,uCAAuC,6DAAS;AAChD,oBAAoB,2CAAK,WAAW,kEAAC,iBAAiB,8DAAK;AAC3D,uCAAuC,6DAAS;AAChD,oBAAoB,2CAAK,WAAW,kEAAC,gBAAgB,8DAAK;AAC1D,uCAAuC,6DAAS;AAChD,oBAAoB,2CAAK,WAAW,kEAAC,gBAAgB,8DAAK;AAC1D;AACA,uCAAuC,6DAAS;AAChD,6BAA6B,0CAAI,CAAC,yEAAQ;AAC1C,sCAAsC,6DAAS;AAC/C,wBAAwB,0CAAI,CAAC,yEAAQ;AACrC,uCAAuC,6DAAS;AAChD,gCAAgC,0CAAI,CAAC,yEAAQ;AAC7C,QAAQ,8DAAO;AACf;AACA;AACA;AACA,yBAAyB,2CAAK,WAAW,kEAAC,gBAAgB,8DAAK;AAC/D,sCAAsC,wEAAe;AACrD,0BAA0B,2CAAK;AAC/B,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA,mBAAmB,kEAAC;AACpB;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA,CAAC;AACuB;;;;;;;;;;;;;ACnDxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsF;AACrB;AACpC;AAC7B;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAAI,QAAQ,kEAAC;AACpC,wBAAwB,0CAAI,CAAC,yEAAQ;AACrC,QAAQ,8DAAO;AACf,yBAAyB,0CAAI,CAAC,yEAAQ;AACtC,QAAQ,8DAAO;AACf,6BAA6B,0CAAI,WAAW,kEAAC,cAAc,8DAAK;AAChE,+BAA+B,kEAAC;AAChC;AACA,8BAA8B,kEAAC;AAC/B;AACA,+BAA+B,kEAAC;AAChC;AACA,sBAAsB,sEAAe;AACrC,QAAQ,sEAAe;AACvB,yBAAyB,gEAAS;AAClC,yBAAyB,gEAAS,SAAS,gBAAgB;AAC3D,yBAAyB,gEAAS,UAAU,wBAAwB;AACpE,yBAAyB,gEAAS,WAAW,wBAAwB;AACrE;AACA;AACA;AACA;AACA,iBAAiB,0BAA0B,kEAAC,qBAAqB;AACjE,iBAAiB,0BAA0B,kEAAC,sBAAsB;AAClE,iBAAiB,0BAA0B,kEAAC,6CAA6C;AACzF,iBAAiB,0BAA0B,kEAAC,4CAA4C;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA,CAAC;AACkB;;;;;;;;;;;;;AC9CnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC0D;AACkB;AAC/C;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,0CAAI,CAAC,yEAAQ;AACvC,QAAQ,8DAAO;AACf;AACA,QAAQ,sEAAe;AACvB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,kEAAC;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,EAAE,4EAAmB,IAAI,mBAAmB;AAC3F;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;;;;;;;;;;;;;AClDtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA0D;AACV;AACO;AACQ;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,kCAAkC;AACvD,qBAAqB,qCAAqC;AAC1D;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,kCAAkC;AACvD,qBAAqB,iCAAiC;AACtD;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACsB;AACvB;AACA,sBAAsB,0CAAI,CAAC,yEAAQ;AACnC,IAAI,8DAAO;AACX;AACA,IAAI,sEAAe;AACnB,4BAA4B,2CAAM,KAAK,8CAAQ,CAAC,6DAAS,gCAAgC,kEAAC,SAAS,kEAAC,QAAQ,kEAAC;AAC7G;AACA;AACA;AACA;AACA;AACA,mBAAmB,0CAAI,CAAC,yEAAQ;AAChC,IAAI,8DAAO;AA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;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA,sCAAsC,gBAAgB;AACtD;AACA;AACA,6BAA6B,mDAAK,iBAAiB,2CAAE;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACxCA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC8B;AAC0C;AACrB;AACc;AAClC;AACO;AACR;AAC9B;AACO;AACP;AACO;AACP;AACA;AACA,6CAA6C,UAAU,8DAA8D,EAAE,EAAE;AACzH,mBAAmB,mEAAqB;AACxC;AACA;AACA;AACA,mBAAmB,8DAAgB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,qBAAqB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACO;AACP,yCAAyC,wCAAwC,aAAa,EAAE,oBAAoB,EAAE;AACtH;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,UAAU,iHAAiH,4BAA4B,EAAE;AACpM;AACA,yDAAyD,qBAAqB;AAC9E;AACA;AACA;AACA,qBAAqB;AACrB;AACA,wBAAwB,mDAAC;AACzB,wBAAwB,mDAAK;AAC7B,wBAAwB,gEAAgB;AACxC,qBAAqB,EAAE;AACvB;AACA;AACA;AACA,2CAA2C,UAAU;AACrD,wBAAwB,mDAAC;AACzB,wBAAwB,mDAAK;AAC7B,wBAAwB,gEAAgB;AACxC,qBAAqB,EAAE;AACvB;AACA;AACA;AACA,2CAA2C,UAAU;AACrD,wBAAwB,mDAAK;AAC7B,wBAAwB,gEAAgB;AACxC,qBAAqB,EAAE;AACvB;AACA;AACA;AACA;AACA;AACA,mCAAmC,yBAAyB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D;AAC5D;AACA;AACA;AACA,4BAA4B,mDAAK;AACjC,4BAA4B,gEAAgB;AAC5C;AACA,qBAAqB,EAAE,EAAE;AACzB;AACA;AACA;AACA;AACA,2CAA2C,UAAU,uQAAuQ,4BAA4B,EAAE;AAC1V;AACA,yDAAyD,qBAAqB;AAC9E;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,wBAAwB,mDAAC;AACzB,wBAAwB,mDAAK;AAC7B,wBAAwB,gEAAgB;AACxC,qBAAqB,EAAE;AACvB;AACA;AACA;AACA,2CAA2C,UAAU,iQAAiQ,4BAA4B,EAAE;AACpV;AACA,yDAAyD,qBAAqB;AAC9E;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,wBAAwB,mDAAC;AACzB,wBAAwB,mDAAK;AAC7B,wBAAwB,gEAAgB;AACxC,qBAAqB,EAAE;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,sFAAiC;AAClE;AACA;AACA,4BAA4B,mDAAK;AACjC,4BAA4B,gEAAgB;AAC5C;AACA;AACA;AACA;AACA,2CAA2C,UAAU;AACrD;AACA;AACA;AACA,yDAAyD,qBAAqB;AAC9E;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,wBAAwB,mDAAC;AACzB,wBAAwB,mDAAK;AAC7B,wBAAwB,gEAAgB;AACxC,qBAAqB;AACrB;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,UAAU;AACtD,gCAAgC,mDAAC;AACjC,gCAAgC,mDAAK;AACrC,gCAAgC,gEAAgB;AAChD,6BAA6B,EAAE;AAC/B;AACA;AACA;AACA;AACA,2CAA2C,UAAU;AACrD,kDAAkD,QAAQ,8EAA8E,aAAa,EAAE,oBAAoB,EAAE;AAC7K,+CAA+C,6BAA6B,WAAW;AACvF,4BAA4B,mDAAC;AAC7B,4BAA4B,mDAAK;AACjC,4BAA4B,gEAAgB;AAC5C,yBAAyB,EAAE,GAAG,EAAE,GAAG;AACnC;AACA,iCAAiC,8BAA8B;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,qBAAqB;AAClE;AACA;AACA;AACA,SAAS;AACT;AACA,YAAY,mDAAC;AACb,YAAY,gEAAgB;AAC5B;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mDAAQ;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,mDAAC;AAC7B,4BAA4B,gEAAgB;AAC5C;AACA,qBAAqB;AACrB,aAAa;AACb,YAAY,mDAAmB,CAAC,mDAAQ,QAAQ,kEAAkE;AAClH;AACA;AACA;;;;;;;;;;;;;ACvQA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA2F;AACjC;AACtB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,0CAAI,CAAC,yEAAQ;AAChD;AACA;AACA;AACA,+BAA+B,0CAAI,QAAQ,kEAAC;AAC5C;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,0BAA0B,2CAAK;AAC/B;AACA,2BAA2B,sBAAsB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,sCAAsC,kEAAC;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,qEAAY;AAC/B,qBAAqB,qEAAY;AACjC;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,+BAA+B;AACpD,qBAAqB,iCAAiC;AACtD;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,uCAAuC,oBAAoB,EAAE;AAC7D,aAAa;AACb;AACA;AACA;AACA,uCAAuC,0BAA0B;AACjE,aAAa;AACb;AACA;AACA,0BAA0B,uEAAgB;AAC1C,0BAA0B,wBAAwB,6EAAoB;AACtE;AACA;AACA;AACA;AACA,CAAC;AACe;;;;;;;;;;;;;AC1FhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACmD;AACY;AAC3B;AACwB;AAC9B;AACwB;AAC/C;AACP,gBAAgB,wEAAc;AAC9B;AACA;AACA;AACA;AACA,8CAA8C;AAC9C;AACA;AACA,0CAA0C,EAAE,4EAAmB;AAC/D;AACA;AACA;AACO;AACP;AACA,2DAA2D;AAC3D;AACA,wCAAwC,EAAE,iDAAK,yBAAyB,qEAAqE;AAC7I;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,yEAA+B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,oDAAQ;AACnC;AACA,qBAAqB,yEAA+B;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,0BAA0B,oCAAoC;AACjG;AACA;AACA,CAAC,0CAA0C;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,EAAE,yDAAa;AAC1C;AACA;AACA;AACA;AACA,iEAAiE,iCAAiC;AAClG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB,uBAAuB;AACvB;AACA;AACA,oCAAoC,8CAA8C,EAAE;AACpF,qCAAqC,0CAA0C,EAAE;AACjF,qCAAqC,0CAA0C,EAAE;AACjF;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,kBAAkB,EAAE;AAC1D,mCAAmC,+BAA+B,EAAE;AACpE;AACA;AACA,sCAAsC,kBAAkB,EAAE;AAC1D,KAAK;AACL;AACA;AACA;AACA,oCAAoC,4BAA4B,EAAE;AAClE;AACA;AACA;AACA;AACA,gDAAgD,2CAAE;AAClD,qEAAqE,kCAAkC,EAAE;AACzG;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,iDAAiD,2BAA2B,EAAE;AAC9E;AACA;AACA;AACA;AACA,oCAAoC,2CAAE;AACtC;AACA,qCAAqC,2CAAE;AACvC;AACA,qCAAqC,2CAAE;AACvC;AACA;;;;;;;;;;;;;ACpKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6C;AACG;AACO;AAC3B;AACT;AACiB;AAC7B,oBAAoB,iDAAG;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAAI,CAAC,yEAAQ;AACpC;AACA,wBAAwB,kEAAW;AACnC,qCAAqC,6DAAS;AAC9C,uBAAuB,0CAAI,CAAC,yEAAQ;AACpC,wBAAwB,kEAAW;AACnC,gCAAgC,kEAAC;AACjC,mBAAmB,2CAAK;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACe;;;;;;;;;;;;;ACpDhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA4C;AACkB;AACnB;AAC3C;AACA;AACA,mCAAmC,yDAAU;AAC7C,oCAAoC,yDAAU;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,0CAAI,CAAC,yEAAQ;AACtC,yBAAyB,0CAAI,CAAC,yEAAQ;AACtC,yBAAyB,0CAAI,CAAC,yEAAQ;AACtC,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA,6BAA6B,2CAAK,WAAW,kEAAC,gBAAgB,8DAAK;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,uBAAuB,2CAAK,WAAW,kEAAC,gBAAgB,8DAAK;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA,6BAA6B,2CAAK,WAAW,kEAAC,gBAAgB,8DAAK;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,uBAAuB,2CAAK,WAAW,kEAAC,gBAAgB,8DAAK;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,qBAAqB,mCAAmC;AACxD,qBAAqB,sCAAsC;AAC3D,qBAAqB,wCAAwC;AAC7D;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,qCAAqC;AAC1D,qBAAqB,kDAAkD;AACvE;AACA,aAAa;AACb,aAAa,sEAAsE,6BAA6B,EAAE;AAClH;AACA;AACA;AACA,CAAC;AACgB;AACV;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AClIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AAC6C;AACiB;AACzB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA,iBAAiB,EAAE,EAAE;AACrB,8CAA8C,QAAQ,kEAAC,eAAe,EAAE;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,kEAAC;AACtB,yBAAyB,kEAAC;AAC1B,yBAAyB,kEAAC;AAC1B,0BAA0B,kDAAY,GAAG;AACzC;AACA;AACA,uBAAuB,gBAAgB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,2EAAW;AACnB;AACA;AACA,sBAAsB,2EAAW;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,yCAAyC,EAAE,2EAA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;AACA;AACA;AACA,CAAC;AACiB;;;;;;;;;;;;;ACpDlB;AAAA;AAAA;AAAA;AAAgB;AAC4B;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA,oBAAoB,yDAAiB;AACrC;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA,yCAAyC,qBAAqB;AAC9D;AACA,yCAAyC,6BAA6B;AACtE,yCAAyC,kBAAkB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,uCAAuC;AAC9E;AACA;AACA,uCAAuC,0CAA0C;AACjF;AACA;AACA;AACA;AACA,yCAAyC,qBAAqB;AAC9D;AACA;AACA;AACA;AACA,+BAA+B,kBAAkB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,uCAAuC;AAC9E,uCAAuC,kCAAkC;AACzE;AACA;AACA;AACA;AACA;AACA,uCAAuC,uCAAuC;AAC9E;AACA;AACA;AACA;AACA,uCAAuC,uCAAuC;AAC9E,uCAAuC,kCAAkC;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,mDAAmD;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,0CAA0C;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,4BAA4B;AAC7B;AACA,qDAAqD,6BAA6B;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,qBAAqB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACpPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA2C;AACuD;AACxD;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,0CAAI,CAAC,wDAAQ;AACxC,QAAQ,0DAAY;AACpB,QAAQ,qDAAO;AACf,QAAQ,iEAAmB;AAC3B,QAAQ,6DAAe;AACvB,0BAA0B,2CAAK;AAC/B,QAAQ,wDAAU,UAAU,iDAAC,mBAAmB,iDAAC;AACjD;AACA,YAAY,2CAAK,WAAW,iDAAC;AAC7B,YAAY,2CAAK,WAAW,iDAAC;AAC7B;AACA,6BAA6B,0CAAI,WAAW,iDAAC;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACmB;;;;;;;;;;;;;ACjDpB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmD;AACH;AACwB;AACzB;AAC/C;AACA,qBAAqB,gEAAiB;AACtC;AACA;AACA;AACA,CAAC;AACD,sBAAsB,gEAAiB;AACvC;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,yBAAyB,0CAAI,WAAW,kEAAC;AACzC;AACA,sCAAsC,6DAAS,KAAK,qEAAY,sBAAsB,aAAa;AACnG,uBAAuB,0CAAI,QAAQ,kEAAC;AAC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;;;ACnCjH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AAC8B;AAC8E;AACrD;AACJ;AACuD;AAC3C;AACE;AAClC;AACO;AACtC;AACA;AACA;AACA,eAAe,oEAAqB;AACpC;AACA,iBAAiB,0BAA0B,kDAAkD,yBAAyB;AACtH,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,uCAAuC,sBAAsB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA,8CAA8C,qCAAqC,EAAE;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,mCAAmC,EAAE;AACvE;AACA,iDAAiD,0DAA0D,kBAAkB,EAAE,EAAE;AACjI,aAAa;AACb;AACA;AACA,sCAAsC,kBAAkB;AACxD,gBAAgB,gEAAgB;AAChC;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,qBAAqB,6EAAmB;AACxC;AACA,sCAAsC,oBAAoB;AAC1D,gBAAgB,gEAAgB;AAChC,aAAa;AACb;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,8EAAoB;AAC9C;AACA,qDAAqD,oBAAoB,mBAAmB,EAAE,EAAE;AAChG,iBAAiB;AACjB;AACA;AACA;AACA,oBAAoB,gEAAgB;AACpC,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;AACA;AACA,qBAAqB,sFAAiC,CAAC,8EAAoB;AAC3E,mGAAmG,4FAA4B;AAC/H;AACA,gBAAgB,gEAAgB;AAChC;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,mDAAC;AACzB,wBAAwB,gEAAgB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,mDAAC;AACzB;AACA,wBAAwB,gEAAgB;AACxC;AACA,8CAA8C,qBAAqB;AACnE,qBAAqB;AACrB,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,0DAA0D,wBAAwB,EAAE,EAAE;AACvI,aAAa;AACb;AACA,gBAAgB,gEAAgB;AAChC;AACA,sCAAsC,wBAAwB;AAC9D;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,yFAAyB;AACtE;AACA,sDAAsD,4BAA4B,EAAE;AACpF;AACA,qEAAqE,0DAA0D,eAAe,EAAE,EAAE;AAClJ,iCAAiC;AACjC;AACA;AACA;AACA;AACA,oCAAoC,mDAAC;AACrC,oCAAoC,gEAAgB;AACpD,iCAAiC;AACjC,6BAA6B;AAC7B;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,mDAAQ;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,mDAAC;AAC7C,4CAA4C,gEAAgB;AAC5D;AACA,qCAAqC;AACrC,6BAA6B;AAC7B,4BAA4B,mDAAmB,CAAC,mDAAQ,QAAQ,uIAAuI;AACvM;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,gCAAgC,oFAAwB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,gEAAgB;AACpC;AACA;AACA,SAAS;AACT;AACA;;;;;;;;;;;;;ACtPA;AAAA;AAAA;AAAA;AAAiD;AACV;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,QAAQ,oDAAQ,UAAU,sEAAgB;AAC1C;AACA;AACA,QAAQ,oDAAQ,UAAU,sEAAgB;AAC1C;AACA;AACA,CAAC;AACsB;;;;;;;;;;;;;ACpBvB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Q,8DAAO;AACf;AACA;AACA;AACA;AACA,gCAAgC,2CAAK,KAAK,8CAAQ,CAAC,6DAAS,gCAAgC,kEAAC,wBAAwB,qEAAI,8DAA8D,kEAAC;AACxL;AACA;AACA,mBAAmB,kEAAC;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA,qBAAqB,gCAAgC;AACrD,qBAAqB,uDAAuD;AAC5E,qBAAqB,qDAAqD;AAC1E,qBAAqB,gDAAgD;AACrE;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkB;AACnB;AACA;AACA,yBAAyB,6CAAO;AAChC;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,kEAAC,CAAC,qEAAI,yBAAyB,qEAAI;AAC9C;AACA;AACA,oBAAoB,2CAAK;AACzB,kBAAkB,qEAAI;AACtB,mBAAmB,qEAAI;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACvHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiD;AACG;AAChB;AACgB;AACpD;AACA;AACA;AACA;AACA,wBAAwB,0CAAI,CAAC,yEAAQ;AACrC,QAAQ,mEAAY;AACpB,QAAQ,kEAAW;AACnB,wBAAwB,0CAAI,CAAC,yEAAQ;AACrC;AACA,QAAQ,mEAAY;AACpB;AACA;AACA;AACA;AACA;AACA,0BAA0B,2CAAK;AAC/B,QAAQ,sEAAe;AACvB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;;;;;;;;;;;;;ACvCtB;AAAA;AAAA;AAAoC;AACpC;AACA;AACA;AACA;AACA,sBAAsB,iDAAG;AACzB;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkB;;;;;;;;;;;;;ACxBnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA+E;AACpD;AACuB;AAClD;AACA;AACA;AACA;AACA;AACA,wBAAwB,0CAAM,CAAC,wDAAQ;AACvC,QAAQ,8DAAO;AACf;AACA;AACA;AACA,QAAQ,0EAAmB;AAC3B,QAAQ,sEAAe;AACvB,6BAA6B,0CAAM,CAAC,wDAAQ;AAC5C,iCAAiC,oDAAY;AAC7C;AACA;AACA;AACA;AACA,0BAA0B,2CAAO;AACjC;AACA;AACA;AACA;AACA;AACA,iBAAiB,qDAAqD;AACtE,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,CAAC;AAC0B;;;;;;;;;;;;;AC7C3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AACgD;AACkC;AACvC;AAC3C,sBAAsB,6DAAS;AAC/B,qBAAqB,6DAAS;AAC9B,iBAAiB,6DAAS;AAC1B,gBAAgB,6DAAS;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,kCAAkC;AACvD,qBAAqB,oCAAoC;AACzD,qBAAqB,kCAAkC;AACvD,qBAAqB,gCAAgC;AACrD,qBAAqB,gCAAgC;AACrD,qBAAqB,+BAA+B;AACpD,qBAAqB,4CAA4C;AACjE;AACA;AACA;AACA;AACA;AACA,CAAC;AACkB;AACnB;AACA;AACA,aAAa,2CAAK,WAAW,kEAAC,+BAA+B,8DAAK;AAClE,gBAAgB,2CAAK,WAAW,kEAAC,8DAA8D,8DAAK;AACpG,cAAc,2CAAK,WAAW,kEAAC,aAAa,8DAAK;AACjD;AACA;AACA;AACA;AACA,kCAAkC,wEAAe;AACjD;AACA,eAAe,2CAAK;AACpB;AACA;AACA;AACA;AACA;AACA,aAAa,2CAAK,WAAW,kEAAC,+BAA+B,8DAAK;AAClE,gBAAgB,2CAAK,WAAW,kEAAC,8DAA8D,8DAAK;AACpG;AACA;AACA;AACA,kBAAkB,2CAAK,WAAW,kEAAC,cAAc,8DAAK;AACtD,mBAAmB,2CAAK,WAAW,kEAAC,eAAe,8DAAK;AACxD,mBAAmB,2CAAK,WAAW,kEAAC,aAAa,8DAAK;AACtD;AACA;AACA;AACA,sCAAsC,wEAAe;AACrD,uCAAuC,wEAAe;AACtD,uCAAuC,wEAAe;AACtD;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,0CAAI,MAAM,kEAAC,wBAAwB,kEAAC;AAChE;AACA,6BAA6B,0CAAI,MAAM,kEAAC,uBAAuB,kEAAC;AAChE;AACA;AACA;AACA;AACA,yBAAyB,0CAAI,CAAC,yEAAQ;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,2CAAK;AACpB;;;;;;;;;;;;;ACvHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6C;AACG;AACqB;AAClD;AACwB;AACJ;AACvC;AACA;AACA;AACA;AACA,wCAAwC,qEAAY;AACpD,4CAA4C,qEAAY;AACxD;AACA;AACA;AACA,uBAAuB,0CAAI,WAAW,kEAAC,kBAAkB,8DAAK;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,0CAAI,WAAW,kEAAC,wBAAwB,8DAAK;AACzE,4BAA4B,0CAAI,QAAQ,kEAAC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,mCAAmC,kEAAC,eAAe,kEAAC,SAAS;AAC9E;AACA;AACA,uBAAuB,kEAAC;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACmB;AACpB;AACA;AACA;AACA;AACA;AACA,gBAAgB,oDAAM;AACtB;AACA;AACA,wBAAwB,2CAAK;AAC7B;AACA;AACA,kCAAkC,uBAAuB;AACzD,qCAAqC,wBAAwB;AAC7D;AACA,2BAA2B,2CAAK,QAAQ,kEAAC;AACzC;AACA;AACA;AACA;AACA;AACA,mCAAmC,6DAAS;AAC5C,qBAAqB,kEAAW;AAChC;AACA,yBAAyB,2CAAK;AAC9B;AACA;;;;;;;;;;;;;ACvFA;AAAA;AAAA;AAAA;AAAA;AAAwC;AACP;AACD;AAChC;AACA;AACA,IAAI,4CAAM;AACV,IAAI,kDAAW;AACf,aAAa,4CAAM;AACnB,iBAAiB,+CAAU;AAC3B,qBAAqB,4CAAM,kBAAkB,4CAAM;AACnD,KAAK;AACL;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACxBA;AAAA;AAAA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,CAAC,kCAAkC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;;;;;;;;;;;;ACjDA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACuC;AACb;AACK;AACI;AACL;AACsB;AACpD;AACA;AACA;AACA;AACA;AACA,qBAAqB,WAAW,GAAG,WAAW;AAC9C,KAAK;AACL;AACA;AACA;AACA;AACA,qBAAqB,WAAW,GAAG,WAAW;AAC9C,KAAK;AACL;AACA;AACA;AACA;AACA,qBAAqB,WAAW,GAAG,WAAW;AAC9C,KAAK;AACL;AACA,IAAI,6CAAK;AACT;AACA;AACA;AACA;AACA,qBAAqB,WAAW,GAAG,WAAW;AAC9C,KAAK;AACL;AACA,IAAI,2CAAM;AACV;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACO,gCAAgC,SAAS,mDAAmB,SAAS,2DAA2D,kCAAkC,QAAQ,mDAAmB,iBAAiB,cAAc,MAAM,gCAAgC,GAAG,EAAE,IAAI;AAClR,4BAA4B,SAAS,mDAAmB,SAAS,wGAAwG,QAAQ,wDAAU,qBAAqB,EAAE,SAAS,oEAAa,6BAA6B;AACrQ,IAAI,mDAAmB,CAAC,oDAAI,GAAG,mCAAmC,IAAI;;;;;;;;;;;;;AC7DtE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AACkG;AACtB;AACd;AACjC;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,0CAAI,CAAC,iEAAQ;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,0CAAI,CAAC,iEAAQ;AAC1C,QAAQ,mEAAY;AACpB,QAAQ,mEAAY;AACpB,QAAQ,mEAAY;AACpB,QAAQ,mEAAY;AACpB,QAAQ,kEAAW;AACnB,sBAAsB,gEAAS;AAC/B,QAAQ,sEAAe;AACvB;AACA,yBAAyB,gEAAS,UAAU,gBAAgB;AAC5D;AACA,kBAAkB,8EAAS;AAC3B;AACA,uBAAuB,kEAAC;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,EAAE,gEAAG;AAC3C;AACA,YAAY,gEAAG;AACf;AACA,+CAA+C,EAAE,4EAAmB,IAAI,oBAAoB;AAC5F;AACA;AACA,CAAC;AACuB;;;;;;;;;;;;;AC1ExB;AAAA;AAAA;AAAA;AAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC9DA;AAAA;AAAA;AAAA;AAAA;AAAwE;AACpC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,0CAAI,CAAC,yEAAQ,gHAAgH,qEAAY;AAClK;AACA,yBAAyB,0CAAI,CAAC,yEAAQ,kGAAkG,qEAAY;AACpJ,0BAA0B,0CAAI,MAAM,kEAAC,WAAW,kEAAC;AACjD,0BAA0B,0CAAI,MAAM,kEAAC,YAAY,kEAAC;AAClD,0BAA0B,0CAAI,MAAM,kEAAC,YAAY,kEAAC;AAClD,uBAAuB,0CAAI,WAAW,kEAAC;AACvC;AACA;AACA,4BAA4B,0CAAI,WAAW,kEAAC;AAC5C,yCAAyC,qEAAY;AACrD;AACA,2BAA2B,2CAAK;AAChC;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,0CAAI,WAAW,kEAAC;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,2CAAK;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,qBAAqB,+BAA+B;AACpD,qBAAqB,qCAAqC;AAC1D;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACmB;;;;;;;;;;;;;AC3EpB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA0E;AACE;AAC/C;AAC7B;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAAI,CAAC,yEAAQ;AACpC,QAAQ,mEAAY;AACpB,QAAQ,mEAAY;AACpB,QAAQ,mEAAY;AACpB,QAAQ,mEAAY;AACpB;AACA;AACA,sBAAsB,gEAAS;AAC/B,QAAQ,sEAAe;AACvB;AACA;AACA;AACA,2BAA2B,4EAAmB,qBAAqB,4EAAmB;AACtF;AACA;AACA;AACA;AACA,uBAAuB,kEAAC;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACoB;;;;;;;;;;;;;AC5CrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,8EAA8E;AAC3G;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC0B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,gDAAI;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8EAA8E;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;AAC5B;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,kDAAkD,0BAA0B,EAAE;AAC9E;AACA;AACA,8CAA8C,QAAQ;AACtD;AACA;AACA;AACA;AACA,CAAC;AACmB;AACb;;;;;;;;;;;;;ACvMP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC8C;AACiB;AAC5B;AACP;AAC5B;AACA;AACA;AACA;AACA;AACA,qBAAqB,mEAAE;AACvB;AACA;AACA,QAAQ,mDAAQ;AAChB;AACA;AACA,QAAQ,mDAAQ;AAChB;AACA;AACA,iCAAiC,6BAA6B,WAAW;AACzE;AACA;AACA;AACA,2CAA2C,SAAS,iDAAG;AACvD,aAAa;AACb;AACA;AACA;AACA,2CAA2C,WAAW,QAAQ,iDAAG,2BAA2B,iDAAG,oBAAoB;AACnH,aAAa,GAAG,GAAG;AACnB;AACA;AACA;AACA,oBAAoB,mDAAQ,+BAA+B,wBAAwB,EAAE;AACrF,wBAAwB,oFAAgB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACe;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,sBAAsB;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,mDAAQ,sCAAsC,kCAAkC,EAAE;AAC1F;AACA;AACA;AACA,QAAQ,mDAAQ,sCAAsC,mCAAmC,EAAE;AAC3F;AACA;AACA;AACA,mCAAmC,WAAW;AAC9C;AACA;AACA;AACA,2CAA2C,SAAS,iDAAG;AACvD,aAAa;AACb;AACA;AACA;AACA,2CAA2C,WAAW,QAAQ,iDAAG,2BAA2B,iDAAG,yCAAyC;AACxI,aAAa,GAAG;AAChB;AACA;AACA,CAAC;AACyB;;;;;;;;;;;;;ACnG1B;AAAA;AAAA;AAAA;AACO;AACP;AACA;AACA;AACA,CAAC,sCAAsC;AAChC;AACP;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,uDAAuD;AAC5D,CAAC,0BAA0B;;;;;;;;;;;;;ACd3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAA2D;AACJ;AACnB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,0CAAI,WAAW,kEAAC;AACxC;AACA;AACA,0BAA0B,2CAAK;AAC/B,gBAAgB,0CAAI,CAAC,yEAAQ;AAC7B,gBAAgB,0CAAI,CAAC,yEAAQ;AAC7B;AACA,QAAQ,gFAAyB;AACjC,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACwB;;;;;;;;;;;;ACvCzB,uC;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyC;AACO;AACiB;AACZ;AACrD;AACA;AACA;AACA;AACA,yBAAyB,0CAAI,CAAC,yEAAQ;AACtC,QAAQ,8DAAO;AACf;AACA;AACA,uCAAuC,6DAAS;AAChD,qBAAqB,2CAAK,WAAW,kEAAC,eAAe,8DAAK;AAC1D,uCAAuC,6DAAS;AAChD,qBAAqB,2CAAK,WAAW,kEAAC,gBAAgB,8DAAK;AAC3D,+CAA+C,8CAAQ,iEAAiE,kEAAC,mBAAmB,kEAAC;AAC7I;AACA,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA,CAAC;AACuB;;;;;;;;;;;;;AChCxB;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,8EAA8E;AAC3G;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC8B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,cAAc,MAAM,SAAS;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,+CAAe;AACnC;AACA;AACA;AACA;AACA,uBAAuB,kBAAkB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,iBAAiB;AAC7C,SAAS;AACT;AACA,4BAA4B,kBAAkB;AAC9C,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA,CAAC,CAAC,mDAAmB;AACF;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mDAAmB,SAAS,8CAA8C,KAAE,8EAA8E;AACjL,oBAAoB,mDAAmB,YAAY,6DAA6D;AAChH;AACA;AACA,0BAA0B,mDAAmB;AAC7C,4BAA4B,mDAAmB,OAAO,6CAA6C;AACnG;AACA;AACA;AACA;AACA;AACA,0BAA0B,mDAAmB,SAAS,2BAA2B;AACjF;AACA;AACA;AACA;AACA;AACA,8BAA8B,QAAQ,mIAAmI,EAAE;AAC3K;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,uBAAuB,mDAAmB,UAAU,qDAAqD;AACzG,aAAa;AACb;AACA;AACA,SAAS;AACT;AACA,KAAK,CAAC,+CAAe;AACrB;AACA,CAAC,0BAA0B;AAC3B;AACA;AACA;AACA;;;;;;;;;;;;;AC9GA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACyC;AACzC,UAAU,kBAAkB;AACQ;AACgB;AACK;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,0CAAI,CAAC,wDAAQ;AAC3C;AACA;AACA;AACA;AACA,8BAA8B,0CAAI,CAAC,wDAAQ;AAC3C,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA,mCAAmC,0CAAI,CAAC,wDAAQ;AAChD;AACA,mCAAmC,0CAAI,CAAC,wDAAQ;AAChD;AACA,mCAAmC,0CAAI,CAAC,wDAAQ;AAChD;AACA,aAAa;AACb,YAAY,8DAAO;AACnB;AACA;AACA;AACA,QAAQ,gFAAyB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,+CAA+C,EAAE,2DAAmB,IAAI,sCAAsC;AAC9G;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,wCAAwC;AAC7D,qBAAqB,sCAAsC;AAC3D;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,iCAAiC;AACtD,qBAAqB,2CAA2C;AAChE,qBAAqB,gDAAgD;AACrE;AACA,uCAAuC,0BAA0B;AACjE,aAAa;AACb;AACA;AACA;AACA,uCAAuC,yBAAyB;AAChE,aAAa;AACb;AACA;AACA;AACA,CAAC;AACkB;;;;;;;;;;;;;ACnGnB;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC6D;AACtD;AACP;AACA,6BAA6B,0EAAkB;AAC/C;AACA;;;;;;;;;;;;;AChBA;AAAA;AAAA;AAAA;AAAA;AAAkC;AACI;AACH;AACnC;AACA;AACA;AACA;AACA;AACA;AACO;AACP,gBAAgB,mDAAQ;AACxB;AACA;AACA,IAAI,uDAAO;AACX;AACA;AACA,gBAAgB,mDAAQ,UAAU,2DAAK;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,KAAK;AACL;;;;;;;;;;;;;AC7BA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiD;AACJ;AACf;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,2CAAK,WAAW,kEAAC;AAC5C;AACA,2BAA2B,2CAAK,WAAW,k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kEAAC;AAC9C;AACA,2BAA2B,kEAAC;AAC5B;AACA,0BAA0B,kEAAC;AAC3B,0BAA0B,2CAAK;AAC/B;AACA,YAAY,gEAAS,eAAe,kEAAC,UAAU,kEAAC;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsB;;;;;;;;;;;;;AC/EvB;AAAA;AAAO;AACP;AACA;AACA,sBAAsB,uCAAuC;AAC7D;AACA;AACA,kBAAkB,sDAAsD;AACxE;AACA;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA+B;AACyF;AAClE;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,QAAQ,iDAAC,oBAAoB,EAAE;AAC7E,4CAA4C,UAAU,0BAA0B,EAAE,EAAE;AACpF;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,yDAAW;AACnB;AACA;AACA;AACA,gCAAgC,2CAAW;AAC3C;AACA,QAAQ,6DAAe;AACvB,uBAAuB,2CAAW;AAClC;AACA;AACA;AACA;AACA;AACA,iBAAiB,oBAAoB,iDAAC,kEAAkE;AACxG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACiB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,wDAAQ;AAC7C,QAAQ,yDAAW;AACnB;AACA;AACA;AACA,4BAA4B,uDAAS;AACrC,QAAQ,6DAAe;AACvB;AACA,uBAAuB,2CAAW;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,oBAAoB,iDAAC,kEAAkE;AACxG;AACA;AACA;AACA;AACA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CO;AACP;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACO;AACA;AACP;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,yBAAyB;AAC9D;AACA;AACA;AACA,iCAAiC,yBAAyB;AAC1D;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA,2DAA2D;AAC3D;AACA;AACA,uBAAuB,eAAe;AACtC;AACA;AACA,0CAA0C,aAAa;AACvD,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,CAAC;AACe;;;;;;;;;;;;;ACpHhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,8EAA8E;AAC3G;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AACmD;AACf;AACP;AACG;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,mDAAK,2BAA2B,aAAa,EAAE,GAAG,mDAAK,4BAA4B,aAAa,EAAE;AAC1I,yDAAyD,yCAAyC,EAAE;AACpG;AACA;AACA;AACA,+CAA+C,kCAAkC,EAAE;AACnF;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,gEAAgB,aAAa,iDAAI,oCAAoC,aAAa,EAAE;AAChG;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,0CAAI;A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;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACgE;AACF;AACK;AACH;AACF;AACO;AACH;AACE;AACR;AACE;AACN;AACe;AACJ;AACF;AACD;AACZ;AACG;AAC4B;AACR;AACE;AACU;AACd;AACC;AACJ;AACA;AACE;AACG;AACb;AACQ;AACV;AACE;AACa;AACJ;AACL;AACJ;AACA;AACE;AACuB;AAC3B;AACS;AACX;AACR;AACJ;AACM;AACa;AACF;AACW;AACE;AACF;AACD;AACJ;AACD;AAChB;AACsB;AACjB;AACF;AACM;AACM;AACT;AACQ;AACN;AACA;AACoB;AACkB;AACzB;AACP;AAC6B;AACX;AACZ;AACA;AACU;AACR;AACF;AACP;AACb;AACiB;AACN;AACc;AAChB;AACM;AACM;AACJ;AACmB;AACrC;AACQ;AACO;AACT;AACmC;AACf;AACzB;AACmB;AACG;AACZ;AACP;AACuB;AACX;AACM;AACwB;AAC3B;AACF;AACM;AACJ;AACG;AACR;AACqB;AACf;AACC;AACC;AACP;AACR;AACA;AACZ;AACU;AACW;AACD;AACR;AACJ;AACI;AACe;AACX;AACJ;AACE;AACqB;AACnC;AACe;AACI;AACV;AACP;AACe;AACR;AACA;AACwB;AACpB;AACN;AACU;AACV;AACA;AACQ;AACT;AACoC;AACf;AACrB;AACY;AAChB;AAC4B;AACE;AAC5B;AACO;AACY;AACV;AACF;AACJ;AACvB;AACgB;AACW;AACX;AACU;AACU;AACP;AACf;AACgB;AACN;AACR;AACgB;AACR;AACZ;AACF;AACU;AACR;AACa;AACJ;AACD;AACZ;AACK;AACI;AACE;AACN;AACK;AACL;AACE;AACE;AACC;AACsB;AACF;AACX;AACe;AACR;AACpB;AACe;AACJ;AACN;AACH;AACK;AACX;AACV;AACuB;AACG;AACW;AACtB;AACgB;AACzB;AACgC;AACpB;AACP;AACkB;AAClB;AACM;AACH;AACe;AAChB;AACX;AACF;AAC6B;AACf;AACN;AACmB;AACK;AACyB;AACpC;AAC5C;AACP;AACA,qDAAqD,6EAAmB;AACxE;AACA,YAAY,6CAAE;AACd;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;AACO;AACP;AACA,qCAAqC,mEAAiB;AACtD,6BAA6B,gEAAM;AACnC,wCAAwC,4EAAW;AACnD,kCAAkC,oEAAe;AACjD,8BAA8B,gDAAM;AACpC,iCAAiC,oDAAQ;AACzC,+CAA+C,+DAAmB;AAClE,mCAAmC,0DAAW;AAC9C,qCAAqC,qDAAY;AACjD,6BAA6B,8CAAK;AAClC,kCAAkC,kDAAS;AAC3C,0CAA0C,oEAAgB;AAC1D,oCAAoC,sEAAW;AAC/C,4BAA4B,4CAAI;AAChC,gCAAgC,oDAAQ;AACxC,oCAAoC,0DAAW;AAC/C,6BAA6B,8CAAK;AAClC,mCAAmC,mDAAU;AAC7C,8BAA8B,sDAAY;AAC1C,4BAA4B,4DAAI;AAChC,wCAAwC,oFAAe;AACvD,sCAAsC,gFAAa;AACnD,+BAA+B,kEAAO;AACtC,+BAA+B,mEAAO;AACtC,iCAAiC,kEAAQ;AACzC,4BAA4B,8DAAI;AAChC,2BAA2B,qEAAG;AAC9B,uCAAuC,kEAAO;AAC9C,+CAA+C,mFAAe;AAC9D,kCAAkC,uEAAS;AAC3C,8BAA8B,iEAAM;AACpC,iCAAiC,qEAAQ;AACzC,yCAAyC,2EAAO;AAChD,wCAAwC,sFAAe;AACvD,+BAA+B,kEAAO;AACtC,4BAA4B,6DAAI;AAChC,4CAA4C,kGAAoB;AAChE,qCAAqC,sEAAY;AACjD,4BAA4B,uEAAI;AAChC,2CAA2C,4DAAkB;AAC7D,oCAAoC,qEAAW;AAC/C,2CAA2C,2EAAiB;AAC5D,qCAAqC,gEAAY;AACjD,kCAAkC,wEAAS;AAC3C,+BAA+B,mEAAO;AACtC,+BAA+B,iEAAM;AACrC,8BAA8B,iEAAM;AACpC,8BAA8B,iEAAM;AACpC,sCAAsC,+EAAY;AAClD,mCAAmC,oDAAU;AAC7C,gCAAgC,oEAAQ;AACxC,+BAA+B,kEAAO;AACtC,sCAAsC,wEAAY;AAClD,kCAAkC,wEAAU;AAC5C,wCAAwC,mFAAe;AACvD,4BAA4B,4CAAI;AAChC,6BAA6B,+DAAK;AAClC,6BAA6B,yDAAK;AAClC,qCAAqC,6DAAY;AACjD,mCAAmC,6CAAI;AACvC,uCAAuC,0EAAc;AACrD,mCAAmC,0EAAU;AAC7C,4BAA4B,6DAAI;AAChC,iCAAiC,qEAAQ;AACzC,qCAAqC,2EAAM;AAC3C,sCAAsC,+EAAa;AACnD,uCAAuC,gFAAa;AACpD,sCAAsC,yEAAe;AACrD,sCAAsC,0EAAgB;AACtD,mCAAmC,+DAAK;AACxC,mCAAmC,+DAAK;AACxC,6BAA6B,0DAAK;AAClC,+BAA+B,6EAAO;AACtC,mCAAmC,yEAAU;AAC7C,oCAAoC,qEAAW;AAC/C,6BAA6B,+DAAK;AAClC,8BAA8B,uFAAgB;AAC9C,8BAA8B,uEAAgB;AAC9C,mCAAmC,wDAAU;AAC7C,mDAAmD,gEAAuB;AAC1E,+BAA+B,wDAAa;AAC5C,yCAAyC,8DAAgB;AACzD,6BAA6B,sDAAK;AAClC,+BAA+B,6DAAO;AACtC,gCAAgC,+DAAQ;AACxC,iCAAiC,4DAAQ;AACzC,qCAAqC,0DAAO;AAC5C,qCAAqC,qEAAY;AACjD,2CAA2C,iFAAkB;AAC7D,uCAAuC,yEAAc;AACrD,oCAAoC,kFAAW;AAC/C,iDAAiD,6FAAsB;AACvE,mCAAmC,iEAAU;AAC7C,mCAAmC,yEAAU;AAC7C,oCAAoC,gEAAW;AAC/C,sCAAsC,2EAAa;AACnD,gCAAgC,8DAAO;AACvC,mCAAmC,iEAAU;AAC7C,8BAA8B,2DAAM;AACpC,sCAAsC,+DAAa;AACnD,2CAA2C,sFAAkB;AAC7D,sCAAsC,yEAAa;AACnD,gCAAgC,2DAAO;AACvC,qCAAqC,sEAAa;AAClD,kCAAkC,gFAAe;AACjD,6BAA6B,yDAAK;AAClC,2BAA2B,kEAAG;AAC9B,wCAAwC,wFAAc;AACtD,uCAAuC,0FAAc;AACrD,sCAAsC,wFAAa;AACnD,gCAAgC,yDAAO;AACvC,oCAAoC,qEAAW;AAC/C,yCAAyC,kFAAgB;AACzD,uCAAuC,4EAAc;AACrD,0CAA0C,0EAAgB;AAC1D,qCAAqC,yEAAY;AACjD,0CAA0C,oFAAiB;AAC3D,yCAAyC,iEAAS;AAClD,kCAAkC,oEAAU;AAC5C,wCAAwC,gGAAe;AACvD,qCAAqC,8EAAY;AACjD,uCAAuC,4FAAa;AACpD,kCAAkC,2FAAc;AAChD,yCAAyC,wFAAgB;AACzD,iCAAiC,8EAAS;AAC1C,+BAA+B,0EAAO;AACtC,qCAAqC,6FAAY;AACjD,iCAAiC,iFAAS;AAC1C,8CAA8C,uGAAoB;AAClE,iCAAiC,gFAAQ;AACzC,+BAA+B,0EAAO;AACtC,qCAAqC,wFAAY;AACjD,4BAA4B,4EAAI;AAChC,8BAA8B,gFAAM;AACpC,+BAA+B,0EAAO;AACtC,iCAAiC,iFAAQ;AACzC,gCAAgC,+EAAO;AACvC,4BAA4B,4EAAI;AAChC,iCAAiC,uFAAQ;AACzC,mCAAmC,8EAAU;AAC7C,4BAA4B,4EAAI;AAChC,wCAAwC,qGAAe;AACvD,kCAAkC,yFAAS;AAC3C,iCAAiC,wFAAS;AAC1C,gCAAgC,sFAAQ;AACxC,mCAAmC,yFAAU;AAC7C,6BAA6B,8EAAK;AAClC,2BAA2B,mFAAQ;AACnC,iCAAiC,qFAAQ;AACzC,2BAA2B,wEAAG;AAC9B,+BAA+B,oFAAO;AACtC,+BAA+B,oFAAO;AACtC,4BAA4B,0EAAI;AAChC,gCAAgC,oFAAQ;AACxC,6BAA6B,sEAAK;AAClC,iCAAiC,2EAAQ;AACzC,mCAAmC,sFAAU;AAC7C,4BAA4B,oEAAI;AAChC,6BAA6B,sEAAK;AAClC,6BAA6B,yDAAK;AAClC,kCAAkC,yFAAS;AAC3C,oCAAoC,gFAAW;AAC/C,4BAA4B,4EAAI;AAChC,+BAA+B,mEAAO;AACtC,2BAA2B,0EAAG;AAC9B,kCAAkC,2DAAU;AAC5C,gCAAgC,+EAAQ;AACxC,2BAA2B,sEAAG;AAC9B,6BAA6B,sEAAK;AAClC,oCAAoC,4EAAW;AAC/C,kCAAkC,0EAAS;AAC3C,4BAA4B,oEAAI;AAChC,+BAA+B,gFAAO;AACtC,mCAAmC,sFAAU;AAC7C,+BAA+B,+EAAO;AACtC,4BAA4B,uEAAW;AACvC,oCAAoC,yFAAY;AAChD,kCAAkC,2FAAU;AAC5C,oCAAoC,wFAAW;AAC/C,kCAAkC,iFAAS;AAC3C,qCAAqC,uFAAY;AACjD,kCAAkC,wFAAgB;AAClD,qCAAqC,wFAAY;AACjD,+BAA+B,6EAAO;AACtC,8BAA8B,2EAAM;AACpC,mCAAmC,gFAAW;AAC9C,+BAA+B,uFAAY;AAC3C,qCAAqC,qFAAY;AACjD,oCAAoC,4EAAW;AAC/C,kCAAkC,oFAAU;AAC5C,+BAA+B,6EAAO;AACtC,4BAA4B,oEAAI;AAChC,yCAAyC,qGAAgB;AACzD,iCAAiC,kFAAS;AAC1C,oCAAoC,2FAAW;AAC/C,qCAAqC,uEAAY;AACjD,8BAA8B,4DAAM;AACpC,qCAAqC,iFAAS;AAC9C,iCAAiC,8DAAS;AAC1C,8BAA8B,4DAAM;AACpC,8BAA8B,uDAAM;AACpC,gCAAgC,+DAAO;AACvC,qCAAqC,mEAAW;AAChD,oCAAoC,uEAAW;AAC/C,8BAA8B,uDAAM;AACpC,iCAAiC,6DAAQ;AACzC,gCAAgC,4EAAQ;AACxC,8BAA8B,4DAAM;AACpC,oCAAoC,sEAAU;AAC9C,yCAAyC,8FAAiB;AAC1D,2CAA2C,gHAAyB;AACpE,8BAA8B,2EAAM;AACpC,2CAA2C,qGAAiB;AAC5D,6BAA6B,yEAAK;AAClC,kCAAkC,qFAAU;AAC5C,oCAAoC,uFAAW;AAC/C,mCAAmC,iFAAU;AAC7C,iCAAiC,iFAAS;AAC1C,8BAA8B,yEAAM;AACpC,8BAA8B,2EAAM;AACpC,wCAAwC,2FAAe;AACvD,8BAA8B,2EAAM;AACpC,mCAAmC,uFAAe;AAClD,iCAAiC,mFAAa;AAC9C,8BAA8B,yEAAM;AACpC,6BAA6B,uEAAK;AAClC,mCAAmC,kFAAU;AAC7C,sCAAsC,wFAAa;AACnD,8BAA8B,yEAAM;AACpC,sCAAsC,iGAAa;AACnD,+BAA+B,sFAAc;AAC7C,yCAAyC,8FAAgB;AACzD,uCAAuC,6FAAe;AACtD,gCAAgC,6EAAQ;AACxC,kCAAkC,gFAAU;AAC5C,mCAAmC,mFAAU;AAC7C,iCAAiC,kFAAS;AAC1C,+BAA+B,2EAAO;AACtC,4BAA4B,qEAAI;AAChC,kCAAkC,iFAAS;AAC3C,mCAAmC,qFAAU;AAC7C;AACA;;;;;;;;;;;;;ACzeA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AACiD;AACM;AACnB;AACgC;AACpE;AACA;AACA;AACA;AACA,eAAe,2DAAe;AAC9B;AACA;AACA;AACA,iBAAiB,sEAAkB;AACnC,8BAA8B,0CAAI,CAAC,yEAAQ;AAC3C;AACA;AACA,uBAAuB,aAAa;AACpC;AACA,oCAAoC,yEAAQ;AAC5C;AACA,gCAAgC,yEAAQ;AACxC;AACA,qCAAqC,kEAAC;AACtC,0BAA0B,2CAAK;AAC/B,QAAQ,sEAAe;AACvB;AACA;AACA;AACA;AACA,mBAAmB,kEAAC;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,EAAE,2DAAe;AACvD,wCAAwC,2DAAe;AACvD;AACA;AACA,CAAC;AAC2B;;;;;;;;;;;;;AC3D5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AACwC;AACyB;AACnB;AACX;AACL;AACO;AACM;AACN;AACrB;AAChB;AACA,aAAa,gEAAO,CAAC,iDAAgB;AACrC,uCAAuC,WAAW,qDAAqD;AACvG;AACA,aAAa,gEAAO,CAAC,0DAAyB;AAC9C;AACA,0CAA0C;AAC1C,yEAAyE,0BAA0B,EAAE;AACrG;AACA;AACA;AACA,iBAAiB;AACjB;AACA,aAAa;AACb;AACA,aAAa,gEAAO,CAAC,yDAAwB;AAC7C;AACA,sCAAsC;AACtC;AACA;AACA,mDAAmD;AACnD;AACA,+CAA+C,UAAU,4BAA4B;AACrF;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa,gEAAO,CAAC,8DAA6B;AAClD;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA,+CAA+C,UAAU,iCAAiC,4BAA4B,8BAA8B;AACpJ;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa,gEAAO,CAAC,mEAAkC;AACvD;AACA,sCAAsC;AACtC;AACA;AACA,0CAA0C,UAAU,iCAAiC,8BAA8B;AACnH,aAAa;AACb;AACA;AACA,aAAa,gEAAO,CAAC,wEAAuC;AAC5D;AACA,sCAAsC;AACtC;AACA,uBAAuB,gDAAM;AAC7B,0CAA0C,UAAU,iCAAiC,8BAA8B;AACnH,aAAa;AACb;AACA;AACA,aAAa,gEAAO,CAAC,oDAAmB;AACxC;AACA,sCAAsC;AACtC,gDAAgD,2CAAE;AAClD;AACA;AACA,aAAa,gEAAO,CAAC,mDAAkB;AACvC;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,aAAa,gEAAO,CAAC,wDAAuB;AAC5C;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA,mEAAmE,8CAA8C,EAAE;AACnH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,gBAAgB;AAClE;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,gEAAO,CAAC,yDAAwB;AAC7C;AACA,sCAAsC;AACtC;AACA;AACA,+CAA+C,UAAU,oCAAoC;AAC7F;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa,gEAAO,CAAC,mDAAkB;AACvC;AACA,uCAAuC,WAAW,iBAAiB;AACnE;AACA,aAAa,gEAAO,CAAC,gEAA+B;AACpD,uCAAuC,WAAW,4BAA4B,iBAAiB,kCAAkC,GAAG;AACpI;AACA,aAAa,gEAAO,CAAC,gDAAe;AACpC;AACA;AACA;AACA;AACA,aAAa,gEAAO,CAAC,8CAAa;AAClC,YAAY,kDAAG;AACf,YAAY,qDAAc,EAAE,+DAA+D;AAC3F;AACA;AACA,iFAAiF,sFAAwB;AACzG;AACA,uCAAuC,WAAW;AAClD;AACA;AACA;AACA;AACA,iBAAiB,6BAA6B;AAC9C;AACA,aAAa,gEAAO,CAAC,+CAAc;AACnC,YAAY,kDAAG;AACf,YAAY,qDAAc;AAC1B;AACA,YAAY,mEAAU;AACtB,uCAAuC,WAAW;AAClD;AACA,iBAAiB,mBAAmB;AACpC;AACA,aAAa,gEAAO,CAAC,mDAAkB;AACvC,uCAAuC,WAAW,oCAAoC;AACtF;AACA,aAAa,gEAAO,CAAC,gDAAe;AACpC;AACA;AACA;AACA;AACA,gDAAgD,0BAA0B;AAC1E;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA,aAAa,gEAAO,CAAC,wDAAuB;AAC5C,uCAAuC,WAAW,sCAAsC;AACxF;AACA,aAAa,gEAAO,CAAC,6DAA4B;AACjD;AACA;AACA;AACA,8BAA8B;AAC9B;AACA,CAAC,EAAE;;;;;;;;;;;;;ACtNH;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8D;AAC1B;AACiC;AACrE;AACA;AACA;AACA;AACA;AACA,yBAAyB,0CAAI,WAAW,kEAAC,oBAAoB,8DAAK;AAClE,0BAA0B,0CAAI,WAAW,kEAAC,sBAAsB,8DAAK;AACrE,0BAA0B,0CAAI,CAAC,yEAAQ;AACvC;AACA,QAAQ,0DAAY;AACpB,QAAQ,0DAAY;AACpB;AACA;AACA,QAAQ,uEAAyB;AACjC;AACA;AACA;AACA;AACA;AACA,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACuB;;;;;;;;;;;;;AC3CxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6C;AACoB;AACvB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,QAAQ,kEAAC,cAAc,EAAE;AACvE,4CAA4C,UAAU,aAAa,EAAE,EAAE;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,+CAAS;AACxC,8BAA8B,+CAAS;AACvC,+BAA+B,+CAAS;AACxC,uBAAuB,2CAAK;AAC5B,sBAAsB,2CAAK;AAC3B,uBAAuB,2CAAK;AAC5B,QAAQ,6DAAe;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,8CAAQ;AAC3C;AACA;AACA;AACA;AACA,yCAAyC,2CAAK;AAC9C,wCAAwC,2CAAK;AAC7C,yCAAyC,2CAAK;AAC9C;AACA,0BAA0B,2CAAK;AAC/B,uBAAuB,2CAAK;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,2CAAK;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,qBAAqB,iCAAiC;AACtD,qBAAqB,iCAAiC;AACtD;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,qBAAqB,kCAAkC;AACvD,qBAAqB,oCAAoC;AACzD,qBAAqB,oCAAoC;AACzD,qBAAqB,sCAAsC;AAC3D;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,qBAAqB,sCAAsC;AAC3D,qBAAqB,kCAAkC;AACvD,qBAAqB,sCAAsC;AAC3D;AACA,uCAAuC,yBAAyB,EAAE;AAClE,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,yBAAyB,EAAE;AAClE;AACA;AACA;AACA;AACA,CAAC;AACgB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AClJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AACoE;AACrC;AACA;AACY;AACiC;AACrE;AACP;AACO;AACP;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA;AACA;AACO;AACP;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA,uBAAuB,2CAAW;AAClC;AACA,yCAAyC,uBAAuB;AAChE;AACA,8BAA8B,0CAAU;AACxC;AACA;AACA;AACA,0BAA0B,0CAAU;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA,qCAAqC,qBAAqB;AAC1D;AACA,2BAA2B,4DAAmB;AAC9C;AACA;AACA;AACA;AACO;AACP,WAAW,oEAAiB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,yDAAC;AACrB;AACA;AACA,sBAAsB,6CAAa,CAAC,yDAAC;AACrC;AACA;AACA;AACA;AACA,uBAAuB,6CAAa,CAAC,yDAAC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,yDAAC;AACrB;AACA,sBAAsB,6CAAa,KAAK,2CAAW;AACnD;AACA,gDAAgD,yDAAC;AACjD;AACA;AACA,uBAAuB,6CAAa,KAAK,2CAAW;AACpD;AACA,gDAAgD,yDAAC;AACjD;AACA;AACA;AACA;AACO;AACP,6BAA6B,WAAW,uDAAc,CAAC;AACvD;AACA;AACO;AACP,6BAA6B,WAAW,uDAAc,CAAC;AACvD;AACA;AACA;AACO;AACP,uBAAuB,OAAO;AAC9B;AACA,mBAAmB,6CAAa;AAChC,KAAK;AACL;AACA;AACA;AACA;AACO;AACP,uBAAuB,OAAO;AAC9B;AACA,mBAAmB,6CAAa;AAChC,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,0BAA0B,QAAQ,0DAAiB,CAAC;AACpD;AACA;AACA;AACA;AACA;AACA,uBAAuB,6CAAa,kEAAkE,2CAAW;AACjH,uBAAuB,6CAAa,mDAAmD,2CAAW;AAClG;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA,qDAAqD,6BAA6B;AAClF;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA,mBAAmB,0BAA0B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA,oCAAoC,0DAAU;AAC9C;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA,oBAAoB,2CAAW;AAC/B,mBAAmB,WAAW;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA,mBAAmB,0CAAU,CAAC,gEAAQ;AACtC;AACA;AACA,oBAAoB,yDAAC;AACrB,uBAAuB,4DAAY;AACnC;AACA;AACA;AACO;AACP;AACA;AACA;AACA,eAAe,2CAAW,WAAW,yDAAC,EAAE,0DAAU,UAAU,0CAAU,CAAC,0DAAU;AACjF,qBAAqB,4DAAY;AACjC,sBAAsB,4CAAY;AAClC;AACA;AACO;AACP;AACA;AACA;AACA;AACO;AACP;AACA,kBAAkB,0CAAU;AAC5B;AACA,0BAA0B,2CAAW,KAAK,8CAAc;AACxD,SAAS,4DAAmB;AAC5B,SAAS,4DAAmB;AAC5B;AACA;AACA,2BAA2B,0CAAU;AACrC;AACA;AACA;AACA;AACA;AACA;AACO;AACP,oBAAoB,kCAAK;AACzB;AACA;AACA;AACA;AACO;AACP;AACA,4BAA4B,yDAAC;AAC7B,0BAA0B,yDAAC;AAC3B,4BAA4B,yDAAC;AAC7B,6BAA6B,yDAAC;AAC9B;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA,yCAAyC,gBAAgB;AACzD,mBAAmB,kBAAkB;AACrC,4CAA4C,gBAAgB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA,oBAAoB,2CAAW;AAC/B;AACA;AACA;AACA;AACA;AACA;AACO;AACP,6BAA6B,WAAW,4DAAY,oBAAoB;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,8BAA8B,gBAAgB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0CAAU,WAAW,yDAAC,2BAA2B,qDAAY;AACnF,4BAA4B,2CAAW,KAAK,8CAAc,kBAAkB,yDAAC,aAAa,yDAAC;AAC3F,yBAAyB,0CAAU,WAAW,yDAAC,6CAA6C,qDAAY;AACxG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,0CAAU,WAAW,yDAAC,gCAAgC,qDAAY;AAC3F,+BAA+B,2CAAW,KAAK,8CAAc,kBAAkB,yDAAC,sBAAsB,yDAAC;AACvG,oBAAoB,2CAAW;AAC/B,kBAAkB,yDAAC;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,eAAe;AACjD,+BAA+B,kBAAkB;AACjD,mBAAmB,+CAAe,oBAAoB,uDAAuD,cAAc,uBAAuB;AAClJ;AACA;AACA,CAAC;AAC4B;AACtB;AACP;AACA;AACA,uBAAuB,0CAAU,CAAC,gEAAQ;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,gCAAgC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,4CAAY;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;;;;;;;;;;;;;ACtZtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,8EAA8E;AAC3G;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD;AACA;AACO;AACP;AACA;AACA;AACA;AACA,4BAA4B,uBAAuB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACO;AACP;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACO;AACP,YAAY;AACZ;AACA;AACO;AACP,YAAY;AACZ;;;;;;;;;;;;;AC9CA;AAAA;AAAA;AAAA;AAAA;AAA6C;AACf;AAC9B;AACA;AACA;AACA;AACA;AACA,sBAAsB,2CAAK,WAAW,kEAAC;AACvC;AACA,uBAAuB,2CAAK,WAAW,kEAAC;AACxC,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkB;;;;;;;;;;;;;AC3BnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,8EAA8E;AAC3G;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACuC;AACR;AACK;AACpC;AACA;AACA;AACO;AACP;AACA,YAAY,mDAAmB,YAAY,2IAA2I,wBAAwB,cAAc;AAC5N,qBAAqB,mDAAmB,CAAC,oDAAI,GAAG,kCAAkC;AAClF;AACA,yBAAyB,mDAAmB,CAAC,iDAAK,GAAG,uBAAuB;AAC5E;AACA;AACA;AACA;AACO;AACP;AACA,YAAY,mDAAmB,YAAY,kHAAkH,wBAAwB,0BAA0B;AAC/M,QAAQ,mDAAmB,CAAC,oDAAI,GAAG,6DAA6D;AAChG,QAAQ,mDAAmB;AAC3B;AACA;AACA;AACA;AACA;AACO;AACP;AACA,YAAY,mDAAmB,YAAY,0HAA0H,wBAAwB,4BAA4B;AACzN,QAAQ,mDAAmB,CAAC,oDAAI,GAAG,mCAAmC;AACtE;AACA;AACA,sBAAsB,iBAAiB;AACvC;AACO;AACP;AACA;AACA,WAAW,mDAAmB,SAAS,uCAAuC,qCAAqC,QAAQ,mDAAmB,uBAAuB,6BAA6B,MAAM,EAAE;AAC1M;AACA;AACA,sBAAsB,kBAAkB;AACxC;AACO;AACP;AACA;AACA;AACA;AACA,mBAAmB,mDAAmB,SAAS,uCAAuC;AACtF,uBAAuB,mDAAmB,uBAAuB,8FAA8F;AAC/J,aAAa;AACb;AACA,mBAAmB,mDAAmB,SAAS,uCAAuC;AACtF,uBAAuB,mDAAmB,wBAAwB,8FAA8F;AAChK,aAAa;AACb;AACA,mBAAmB,mDAAmB,SAAS,uCAAuC;AACtF,uBAAuB,mDAAmB,mBAAmB,8FAA8F,MAAM,kBAAkB;AACnL,aAAa;AACb;AACA;AACA;AACA,wBAAwB,cAAc;AACtC;AACO,wCAAwC,SAAS,mDAAmB,SAAS,mCAAmC,qCAAqC,QAAQ,mDAAmB,mBAAmB,SAAS,MAAM,EAAE,IAAI;AAC/N;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA,eAAe,mDAAmB,SAAS,0GAA0G;AACrJ;AACA,mBAAmB,mDAAmB,UAAU,mDAAmD,iBAAiB,iBAAiB,EAAE,+BAA+B,EAAE,oKAAoK;AAC5U,SAAS;AACT;AACA;AACA,CAAC,CAAC,+CAAe;AACoB;;;;;;;;;;;;;AC7GrC;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6C;AACR;AACE;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,oDAAM;AAC1B,0BAA0B,2CAAK;AAC/B,uBAAuB,UAAU;AACjC;AACA,2BAA2B,kCAAkC;AAC7D,+BAA+B,kEAAC;AAChC;AACA,6BAA6B,2CAAK;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkB;;;;;;;;;;;;;ACtEnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6C;AACU;AACnB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAAI,CAAC,yEAAQ;AACpC;AACA;AACA;AACA,uBAAuB,0CAAI,CAAC,yEAAQ;AACpC,wBAAwB,kEAAC;AACzB;AACA,wBAAwB,kEAAW;AACnC,yBAAyB,kEAAC;AAC1B,0BAA0B,2CAAK;AAC/B,uBAAuB,iBAAiB;AACxC;AACA,yBAAyB,kEAAC;AAC1B;AACA,+BAA+B,kEAAC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACmB;;;;;;;;;;;;;ACjDpB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6C;AACR;AACE;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,UAAU,0BAA0B,EAAE,EAAE;AACpF,8CAA8C,QAAQ,kEAAC,oBAAoB,EAAE;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,oDAAM;AAC1B,0BAA0B,2CAAK;AAC/B,uBAAuB,UAAU;AACjC;AACA;AACA,2BAA2B,oCAAoC;AAC/D,+BAA+B,kEAAC;AAChC;AACA,+BAA+B,2CAAK;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,kEAAC;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACoB;;;;;;;;;;;;;ACnFrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,8EAA8E;AAC3G;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AACyD;AACX;AACU;AAChB;AACuB;AACpC;AACI;AACkB;AACnB;AACiB;AACjB;AAC4C;AACnB;AACb;AAC1C;AACA;AACA,eAAe,2CAAM;AACrB;AACA;AACA;AACA,mBAAmB,2CAAM;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,+CAAe;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,2CAAE;AACjC;AACA;AACA,+BAA+B,2CAAE;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,gDAAI;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yEAAyE,iBAAiB,EAAE,yCAAyC,gBAAgB,EAAE;AACvJ,2CAA2C,yBAAyB,2CAAE,aAAa,EAAE;AACrF;AACA,yCAAyC,qBAAqB;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,6EAAgB;AAC/B;AACA;AACA,eAAe,yFAA4B;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,6DAAY;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,2DAAa;AAClC;AACA;AACA;AACA,0BAA0B,2DAAW;AACrC,aAAa;AACb;AACA;AACA,uCAAuC,8CAA8C,EAAE;AACvF,wCAAwC,8CAA8C,EAAE;AACxF;AACA;AACA,gCAAgC,eAAe,YAAY,6BAA6B,EAAE,EAAE;AAC5F;AACA;AACA,SAAS;AACT;AACA;AACA,mBAAmB,mDAAmB,CAAC,sEAAkB;AACzD;AACA;AACA;AACA,wB;AACA;AACA;AACA;AACA,qBAAqB,2CAAE,yDAAyD,wEAAc,6CAA6C;AAC3I,uCAAuC,2CAAE;AACzC,8CAA8C,2CAAE,kBAAkB,EAAE,EAAE;AACtE,SAAS;AACT;AACA;AACA,mBAAmB,mDAAmB,CAAC,wDAAc,sBAAsB,WAAW,MAAM,2CAAE,sCAAsC,yBAAyB,2CAAE,uBAAuB,EAAE,mEAAmE;AAC3P,SAAS;AACT;AACA;AACA,cAAc,mDAAmB,CAAC,wDAAc,qBAAqB,sBAAsB,sBAAsB,yBAAyB;AAC1I;AACA;AACA;AACA,YAAY,mDAAmB,CAAC,4EAAiB,GAAG,gFAAgF,wBAAwB,yBAAyB,EAAE,EAAE,iCAAiC;AAC1N;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,6BAA6B;AACpD,qBAAqB,2CAAE;AACvB,yBAAyB,2CAAE;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kFAAkF,iBAAiB,EAAE,kDAAkD,gBAAgB,EAAE;AACzK,2CAA2C,qCAAqC,EAAE;AAClF;AACA,mBAAmB,4DAAsB;AACzC;AACA;AACA;AACA;AACA,yDAAyD,sEAAkB;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,qBAAqB;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,+CAAS;AACsB;;;;;;;;;;;;;ACpOjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,8EAA8E;AAC3G;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACkD;AACpB;AACC;AACQ;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,+CAAe;AAC1C;AACA;AACA;AACA,YAAY,mDAAK;AACjB;AACA;AACA,YAAY,gEAAgB,aAAa,qDAAW,CAAC,mDAAK;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,mDAAmB,SAAS,6DAA6D;AACxG;AACA;AACA,CAAC,CAAC,+CAAe;AACK;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACzFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AACuD;AACO;AACjC;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA,iBAAiB,EAAE,EAAE;AACrB;AACA;AACA,2BAA2B,kEAAC;AAC5B,iBAAiB;AACjB;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA,iBAAiB,EAAE,EAAE;AACrB,8CAA8C,QAAQ,kEAAC,kCAAkC,EAAE;AAC3F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,0CAAI,CAAC,yEAAQ;AACvC;AACA,2BAA2B,kEAAC;AAC5B;AACA,QAAQ,2EAAW;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,6BAA6B,EAAE,2EAAW;AAC/E,wCAAwC,2EAAW;AACnD;AACA;AACA,CAAC;AACe;;;;;;;;;;;;;ACxEhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA+C;AACwB;AACpC;AACqB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAAI,CAAC,wDAAQ;AACpC,QAAQ,8DAAO;AACf,QAAQ,mEAAY;AACpB,QAAQ,mEAAY;AACpB;AACA;AACA;AACA;AACA,0BAA0B,iDAAC;AAC3B,2BAA2B,0CAAI;AAC/B,mCAAmC,0CAAI;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,0CAAI,WAAW,iDAAC,yCAAyC,6CAAK;AACrG,wCAAwC,0CAAI,WAAW,iDAAC,yCAAyC,6CAAK;AACtG;AACA;AACA;AACA,uCAAuC,qEAAc;AACrD;AACA;AACA;AACA;AACA,uCAAuC,iDAAC;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,2CAA2C;AAChE,qBAAqB,0CAA0C;AAC/D,qBAAqB,kCAAkC;AACvD;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,sCAAsC;AAC3D,qBAAqB,qCAAqC;AAC1D,qBAAqB,qCAAqC;AAC1D;AACA,aAAa;AACb;AACA;AACA;AACA,uCAAuC,wBAAwB,EAAE;AACjE,aAAa;AACb;AACA;AACA;AACA,uCAAuC,wBAAwB,EAAE;AACjE,aAAa;AACb;AACA;AACA;AACA,uCAAuC,wBAAwB,EAAE;AACjE;AACA;AACA;AACA;AACA,CAAC;AACe;AAChB;AACA,wDAAwD,oEAAW;AACnE,YAAY,WAAW,qDAAK;AAC5B;;;;;;;;;;;;;ACvHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8D;AACO;AACzB;AACO;AACnD;AACA;AACA;AACA;AACA,iBAAiB,sEAAkB;AACnC,QAAQ,sEAAe;AACvB,uBAAuB,4CAAM;AAC7B,wBAAwB,SAAS;AACjC,wCAAwC,kEAAC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA,CAAC;AACkB;AACnB;AACA;AACA,yBAAyB,0CAAI,CAAC,yEAAQ;AACtC;AACA,4BAA4B,kEAAC;AAC7B,qBAAqB,0CAAI,QAAQ,kEAAC;AAClC;AACA,yBAAyB,0CAAI,CAAC,yEAAQ;AACtC;AACA,4BAA4B,kEAAC;AAC7B,mBAAmB,0CAAI,CAAC,yEAAQ;AAChC,oBAAoB,2CAAK;AACzB,qBAAqB,kEAAW,aAAa,qEAAY;AACzD;AACA;;;;;;;;;;;;;AC3CA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,8EAA8E;AAC3G;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACwC;AACV;AACsB;AACK;AACX;AACD;AACnB;AACoC;AACnC;AACI;AACI;AACO;AACa;AACE;AACL;AACtB;AACY;AACL;AACD;AACpC;AACO;AACP;AACO;AACP;AACO;AACP;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,gDAAI;AAChB,YAAY,mEAAU;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,QAAQ,mDAAC;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,wDAAQ;AACpB;AACA;AACA;AACA,QAAQ,yDAAO,wCAAwC,oDAAQ;AAC/D;AACA;AACA;AACA;AACA;AACA,gGAAgG,4CAAM;AACtG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,mDAAC;AACrB;AACA;AACA;AACA,oBAAoB,8EAAsB;AAC1C;AACA;AACA,oBAAoB,mDAAC;AACrB;AACA;AACA;AACA,oBAAoB,4DAAqB,mDAAmD,sDAAe;AAC3G;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA,eAAe,mDAAmB,CAAC,0DAAO,aAAa,gGAAgG;AACvJ,YAAY,6CAAK,kBAAkB,mDAAmB;AACtD,YAAY,mDAAmB,CAAC,2DAAS,GAAG,+FAA+F,iDAAiD,EAAE,wEAAwE,sBAAsB,EAAE;AAC9R;AACA,2CAA2C,mEAAmE;AAC9G,iBAAiB,yCAAyC;AAC1D,YAAY,mDAAmB,SAAS,8DAA8D;AACtG,gBAAgB,mDAAmB;AACnC,gBAAgB,mDAAmB,CAAC,iEAAW,GAAG,mGAAmG,QAAQ,mDAAC,iCAAiC,EAAE,qCAAqC,0CAA0C,EAAE,EAAE;AACpR,gBAAgB,mDAAmB,CAAC,iEAAW,GAAG,sGAAsG,QAAQ,mDAAC,oCAAoC,EAAE,qCAAqC,0CAA0C,EAAE,EAAE;AAC1R,gBAAgB,mDAAmB,CAAC,iEAAW,GAAG,oGAAoG,QAAQ,mDAAC,kCAAkC,EAAE,qCAAqC,0CAA0C,EAAE,EAAE;AACtR,gBAAgB,mDAAmB,CAAC,iEAAW,GAAG,qGAAqG,QAAQ,mDAAC,mCAAmC,EAAE,qCAAqC,0CAA0C,EAAE,EAAE;AACxR,gBAAgB,mDAAmB,SAAS,2BAA2B;AACvE,oBAAoB,mDAAmB,CAAC,2EAAoB,GAAG,8EAA8E,oCAAoC,EAAE,EAAE;AACrL,YAAY,mDAAmB,CAAC,4DAAU;AAC1C,YAAY,mDAAmB,CAAC,kEAAe,GAAG,yFAAyF;AAC3I;AACA;AACA;AACA,QAAQ,gEAAS;AACjB;AACA;AACA;AACA,uBAAuB,6BAA6B;AACpD;AACA;AACA;AACA,0CAA0C,4CAAM;AAChD;AACA;AACA;AACA,gCAAgC,qBAAqB,EAAE;AACvD;AACA;AACA;AACA,mCAAmC,6EAAqB;AACxD,2BAA2B,oCAAoC;AAC/D;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,CAAC,CAAC,0DAAO;AACiB;AAC1B,+BAA+B,QAAQ,mDAAmB,CAAC,8CAAc;AACzE,IAAI,mDAAmB,SAAS,2EAA2E;AAC3G,QAAQ,mDAAmB,OAAO,mFAAmF,mCAAmC,oCAAoC,GAAG;AAC/L,QAAQ,mDAAmB,OAAO,wFAAwF,yCAAyC,oCAAoC,GAAG;AAC1M,QAAQ,mDAAmB,OAAO,iFAAiF,iCAAiC,oCAAoC,GAAG;AAC3L,QAAQ,mDAAmB;AAC3B;AACA,QAAQ,mDAAmB,OAAO,2BAA2B;AAC7D;AACA,QAAQ,mDAAmB;AAC3B,IAAI,mDAAmB,SAAS,oCAAoC;AACpE;AACA,QAAQ,mDAAmB,OAAO,8BAA8B,wDAAQ,sDAAsD,8BAA8B;AACrJ,+CAA+C;AACtD;AACA;AACA;AACA,CAAC,EAAE;;;;;;;;;;;;;ACrMH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACiD;AACD;AACO;AACD;AACH;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,mEAAQ;AACzB;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,qBAAqB,mCAAmC;AACxD,qBAAqB,mCAAmC;AACxD;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,uCAAuC,4BAA4B;AACnE;AACA;AACA;AACA;AACA,CAAC;AACuB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,kDAAY,GAAG;AACrC,mBAAmB,kEAAC;AACpB,mBAAmB,kEAAC;AACpB,mBAAmB,kEAAC;AACpB,mBAAmB,WAAW;AAC9B,uBAAuB,kEAAC;AACxB,uBAAuB,kEAAC;AACxB;AACA;AACA,mBAAmB,kEAAC;AACpB,mBAAmB,kEAAC;AACpB,uBAAuB,kEAAC;AACxB,IAAI,sEAAe;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,2CAAK,WAAW,kEAAC,wCAAwC,8DAAK;AAC5E;AACA,mCAAmC,6DAAS;AAC5C;AACA;AACA,eAAe,2CAAK,WAAW,kEAAC,sCAAsC,8DAAK;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,2CAAK;AAC3B;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC5HA;AAAA;AAAA;AAAA;AAAA;AAAqE;AAC1B;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,0CAAI,CAAC,yEAAQ;AACvC;AACA;AACA,6BAA6B,0CAAI,CAAC,yEAAQ;AAC1C;AACA;AACA,gDAAgD,kEAAC;AACjD,0BAA0B,2CAAK;AAC/B,wBAAwB,kEAAC;AACzB;AACA,8BAA8B,qEAAY;AAC1C,oBAAoB,2CAAK,QAAQ,kEAAC;AAClC,0BAA0B,qEAAY;AACtC;AACA;AACA;AACA;AACA;AACA,mBAAmB,kEAAC;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;;;;;;;;;;;;;ACpD1B;AAAA;AAAA;AAAA;AAAA;AAAwE;AAC3B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,0CAAI,sDAAsD,qEAAY;AAC/F;AACA,gCAAgC,qEAAI;AACpC;AACA;AACA,uBAAuB,WAAW;AAClC;AACA,oBAAoB,6CAAO,CAAC,kEAAC,yBAAyB,sEAAK,aAAa,sEAAK;AAC7E,oBAAoB,6CAAO,CAAC,kEAAC,gCAAgC,sEAAK,aAAa,sEAAK;AACpF;AACA;AACA,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA,2BAA2B,WAAW;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,6CAAO,CAAC,kEAAC,6BAA6B,kEAAC;AACvE,sCAAsC,6CAAO,CAAC,kEAAC,uCAAuC,kEAAC;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiB;;;;;;;;;;;;;ACvElB;AAAA;AAAO;AACP;AACA;AACA;AACA;AACA,uCAAuC,uCAAuC;AAC9E;AACA;AACA;AACA;AACA,8BAA8B,aAAa;AAC3C;AACA;AACA,wBAAwB;AACxB,2DAA2D;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,wBAAwB;;;;;;;;;;;;;ACrBzB;AAAA;AAAA;AAAgC;AACzB;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,6CAAI;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,4CAA4C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC1HA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6C;AACG;AACL;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,2CAAK,WAAW,kEAAC;AACrC,0BAA0B,2CAAK;AAC/B;AACA,uBAAuB,UAAU;AACjC,iCAAiC,0CAAI,MAAM,kEAAC,eAAe,kEAAC;AAC5D,iCAAiC,0CAAI,MAAM,kEAAC,eAAe,kEAAC;AAC5D;AACA,2BAA2B,kEAAW;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,2BAA2B;AAChD,qBAAqB,2BAA2B;AAChD,qBAAqB,0CAA0C;AAC/D,qBAAqB,6CAA6C;AAClE;AACA;AACA;AACA;AACA;AACA,CAAC;AACkB;;;;;;;;;;;;;ACxDnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACmC;AACL;AACK;AACnC;AACA;AACA;AACA;AACA,mEAAmE,2CAAE;AACrE;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,mDAAQ,uCAAuC,sCAAsC,mBAAmB,EAAE;AAClH;AACA;AACA;AACA,QAAQ,mDAAQ,yCAAyC,uCAAuC,EAAE;AAClG;AACA;AACA,CAAC;AACuB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,mDAAQ,yCAAyC,oCAAoC,EAAE;AAC/F;AACA;AACA;AACA,QAAQ,mDAAQ,uCAAuC,wCAAwC,EAAE;AACjG;AACA;AACA,CAAC;AACqB;AACtB;AACA;AACA,uCAAuC,WAAW,wCAAwC,QAAQ,gDAAM,gDAAgD,OAAO,yBAAyB,MAAM,EAAE,wCAAwC,QAAQ,gDAAM,gDAAgD,OAAO,yBAAyB,MAAM,EAAE,0CAA0C,QAAQ,gDAAM,gDAAgD,OAAO,yBAAyB,MAAM,EAAE,GAAG;AACje;AACA;AACA;AACA;AACA;AACA,+BAA+B,WAAW,wCAAwC,QAAQ,gDAAM,gDAAgD,OAAO,yBAAyB,MAAM,EAAE,wCAAwC,QAAQ,gDAAM,gDAAgD,OAAO,yBAAyB,MAAM,EAAE,6CAA6C,0BAA0B,EAAE,oBAAoB,QAAQ,gDAAM,gDAAgD,OAAO,yBAAyB,MAAM,EAAE,GAAG;AAC5gB;;;;;;;;;;;;;AC1DA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsD;AACY;AAC9B;AACpC;AACA;AACA,sCAAsC,qEAAY;AAClD;AACA;AACA;AACA;AACA,iCAAiC,0CAAI,CAAC,yEAAQ;AAC9C,QAAQ,8DAAO;AACf;AACA,wDAAwD,kEAAW;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,0CAAI,CAAC,yEAAQ;AACzC,2BAA2B,0CAAI,CAAC,yEAAQ;AACxC,sBAAsB,0CAAI,CAAC,yEAAQ;AACnC,QAAQ,8DAAO;AACf;AACA;AACA;AACA,uBAAuB,kEAAW;AAClC,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC+B;;;;;;;;;;;;;ACpDhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiD;AACM;AAC1B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,0CAAI,CAAC,yEAAQ;AACvC;AACA;AACA;AACA,QAAQ,sEAAe;AACvB;AACA;AACA;AACA,mBAAmB,kEAAC;AACpB;AACA,iBAAiB,mCAAmC,kEAAC,aAAa,kEAAC,iCAAiC;AACpG,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACe;;;;;;;;;;;;;AChDhB;AAAA;AAAA;AAAoC;AACpC;AACA;AACA;AACA;AACA,sBAAsB,iDAAG;AACzB;AACA;AACA;AACA,+DAA+D,gBAAgB;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,iCAAiC;AACtD,qBAAqB,+BAA+B;AACpD;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACrFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiD;AACG;AACvB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,sEAAe;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,qCAAqC;AAC1D,qBAAqB,mCAAmC;AACxD;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAAI,CAAC,yEAAQ;AACpC;AACA;AACA,uBAAuB,0CAAI,CAAC,yEAAQ;AACpC;AACA;;;;;;;;;;;;;ACtDA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACyE;AAClB;AACO;AACjC;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,kEAAW;AACnB;AACA;AACA;AACA;AACA;AACA,0BAA0B,gEAAS;AACnC;AACA;AACA,0BAA0B,gEAAS;AACnC;AACA;AACA,QAAQ,sEAAe;AACvB,kBAAkB,8EAAS;AAC3B;AACA;AACA;AACA,uBAAuB,kEAAC;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,kBAAkB,EAAE,gEAAG;AAC5D;AACA;AACA;AACA;AACA,qBAAqB,sCAAsC;AAC3D,qBAAqB,yDAAyD;AAC9E;AACA;AACA,aAAa;AACb,YAAY,gEAAG;AACf;AACA;AACA;AACA,CAAC;AACuB;AACxB;AACA;AACA;AACA,uBAAuB,0CAAI,CAAC,yEAAQ;AACpC;AACA,uBAAuB,0CAAI,CAAC,yEAAQ;AACpC;AACA;AACA;;;;;;;;;;;;;AC3EA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiD;AAC8B;AACpC;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,2CAAK,WAAW,kEAAC,mDAAmD,8DAAK;AAC3F,QAAQ,sEAAe;AACvB,wBAAwB,qEAAY;AACpC;AACA;AACA,6BAA6B,kEAAC;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,2CAAK;AAC5B;AACA,mBAAmB,2CAAK,WAAW,kEAAC;AACpC,QAAQ,sEAAe;AACvB;AACA;AACA;AACA;AACA;AACA,sBAAsB,0CAAI,CAAC,yEAAQ;AACnC;AACA,0BAA0B,qEAAY;AACtC,mBAAmB,2CAAK,WAAW,kEAAC,+BAA+B,8DAAK;AACxE,QAAQ,sEAAe;AACvB;AACA;AACA,uBAAuB,2CAAK;AAC5B,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA,mBAAmB,kEAAC;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkB;;;;;;;;;;;;;ACvEnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8D;AACd;AAC+B;AACA;AAC3C;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,0CAAI,WAAW,kEAAC,eAAe,8DAAK;AAChE,4CAA4C,6DAAS;AACrD,4BAA4B,0CAAI,WAAW,kEAAC,eAAe,8DAAK;AAChE,4CAA4C,6DAAS;AACrD,sBAAsB,0EAAmB,YAAY,qEAAY;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,4FAAc;AACnD,uCAAuC,4FAAc;AACrD;AACA;AACA,6BAA6B,4FAAc;AAC3C,uBAAuB,4FAAc;AACrC;AACA,4BAA4B,0CAAI,CAAC,iEAAQ;AACzC;AACA,mCAAmC,kEAAC;AACpC,iDAAiD,6DAAS;AAC1D,iDAAiD,6DAAS;AAC1D,0BAA0B,0CAAI,CAAC,iEAAQ;AACvC,QAAQ,8DAAO;AACf,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,qBAAqB,6BAA6B;AAClD,qBAAqB,yCAAyC;AAC9D;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiB;;;;;;;;;;;;;AC3ElB;AAAA;AAAA;AAAoC;AACpC;AACA;AACA;AACA;AACA,sBAAsB,iDAAG;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,iCAAiC;AACtD,qBAAqB,6BAA6B;AAClD,qBAAqB,gCAAgC;AACrD,qBAAqB,iCAAiC;AACtD;AACA;AACA;AACA;AACA;AACA,CAAC;AACc;;;;;;;;;;;;;ACxCf;AAAA;AAAA;AAAoC;AACpC;AACA;AACA;AACA;AACA,sBAAsB,iDAAG;AACzB;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,qBAAqB,6CAA6C;AAClE,qBAAqB,6CAA6C;AAClE,qBAAqB,6CAA6C;AAClE,qBAAqB,4CAA4C;AACjE,qBAAqB,wCAAwC;AAC7D,qBAAqB,qCAAqC;AAC1D,qBAAqB,sCAAsC;AAC3D,qBAAqB,8CAA8C;AACnE,qBAAqB,iDAAiD;AACtE;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;;;;;;;;;;;;;ACxC3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AAC0B;AACnB;AACA;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA,SAAS,6CAAK;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,6CAAK;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,yDAAyD,iCAAiC;AAC1F;AACA;AACA;AACA,sDAAsD,gBAAgB;AACtE;AACA,yCAAyC;AACzC;AACA;;;;;;;;;;;;;ACxGA;AAAA;AAAA;AAAoC;AAC7B;AACP;AACA;AACA;AACA;AACA;AACA,yCAAyC,wEAAwE,EAAE;AACnH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,mBAAmB,iDAAI;AACvB,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,wEAAwE,EAAE;AACnH;AACA;AACA,uBAAuB,2BAA2B;AAClD;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA,mBAAmB,iDAAI;AACvB,SAAS;AACT;AACA;AACA,CAAC,gCAAgC;;;;;;;;;;;;;AC9CjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAA+B;AACE;AACjC;AACA;AACA;AACA;AACA;AACA,CAAC,4CAA4C;AACtC;AACP;AACA;AACA;AACA;AACA,qBAAqB,+CAAU;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,wBAAwB;AACzB;AACO;AACP;AACA;AACA;AACA;AACA;AACA,CAAC,sBAAsB;AACvB;AACA;AACA,sBAAsB,kCAAK;AAC3B;;;;;;;;;;;;;ACrCA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiE;AACtB;AACqB;AACzD;AACP;AACA;AACA;AACA;AACA;AACA,+BAA+B,wBAAwB;AACvD,gBAAgB;AAChB;AACA;AACA;AACA,uCAAuC,uBAAuB;AAC9D;AACA,CAAC,kBAAkB;AACnB;AACA;AACA;AACA;AACO;AACP,6BAA6B,eAAe;AAC5C,oCAAoC,wBAAwB;AAC5D,mBAAmB,0CAAI,CAAC,yEAAQ;AAChC,IAAI,qDAAO;AACX;AACA,IAAI,uEAAyB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,2CAAK,QAAQ,kEAAC;AAC7B;AACA;AACA,kBAAkB,2CAAK,WAAW,kEAAC,cAAc,8DAAK;AACtD,IAAI,uEAAyB;AAC7B;AACA;AACA;AACA;AACA,wBAAwB,kEAAC;AACzB,6BAA6B,2CAAK;AAClC;AACA;AACA,sBAAsB,2CAAK;AAC3B,oBAAoB,kEAAC;AACrB;AACA;;;;;;;;;;;;;AClDA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,8EAA8E;AAC3G;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AACwD;AACwC;AACnC;AACgB;AACnB;AACI;AAC8B;AAClB;AAC5C;AACK;AACL;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,2CAAK,eAAe,2CAAK,YAAY,0CAAI;AAC/D;AACA,8BAA8B,qEAAY;AAC1C,4BAA4B,qEAAY,uBAAuB;AAC/D;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,gEAAgB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0EAA0E,yCAAyC,EAAE;AACrH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,0CAAI;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,gEAAgB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,2CAAI,mDAAmD,aAAa,EAAE;AAChH;AACA;AACA;AACA;AACA,mCAAmC,mDAAQ,gBAAgB,2CAAE;AAC7D;AACA;AACA;AACA;AACA,oCAAoC,wEAA0B;AAC9D,oCAAoC,2EAAW,GAAG,6FAA6F;AAC/I;AACA;AACA;AACA;AACA,wBAAwB,gEAAgB,aAAa,wDAAQ;AAC7D;AACA;AACA,wBAAwB,gEAAgB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,gEAAgB;AAC5C;AACA;AACA;AACA;AACA,oBAAoB,gEAAgB;AACpC;AACA;AACA;AACA;AACA,oDAAoD,+CAAS;AAC7D;AACA;AACA;AACA;AACA;AACA,4CAA4C,6CAAO;AACnD;AACA,mCAAmC,uEAAmB;AACtD,yBAAyB;AACzB;AACA;AACA,wCAAwC,6CAAO;AAC/C;AACA;AACA;AACA,mCAAmC,uEAAmB;AACtD,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4EAA4E,8CAA8C,EAAE,oBAAoB,gCAAgC,EAAE;AAClL;AACA;AACA;AACA,4BAA4B,gEAAgB,aAAa,oDAAM;AAC/D;AACA;AACA;AACA;AACA,wFAAwF,sBAAsB,EAAE;AAChH;AACA;AACA;AACA,gCAAgC,gEAAgB,aAAa,oDAAM;AACnE;AACA;AACA;AACA,gCAAgC,gEAAgB,aAAa,sDAAQ;AACrE;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,mDAAQ,SAAS,gBAAgB;AACnE;AACA;AACA,0FAA0F,+BAA+B;AACzH;AACA;AACA;AACA,YAAY,gEAAgB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,yCAAG;AACf,oBAAoB;AACpB;AACA,0BAA0B,6CAAO;AACjC;AACA;AACA;AACA,mBAAmB,uEAAmB;AACtC,SAAS;AACT;AACA;AACA;AACA;AACA,8BAA8B,mDAAQ;AACtC;AACA,gBAAgB,gEAAgB,aAAa,sDAAQ;AACrD;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,mDAAQ;AAC9C;AACA;AACA;AACA;AACA;AACA,wCAAwC,gFAAY;AACpD,oCAAoC,oFAAgB;AACpD;AACA;AACA;AACA;AACA;AACA,oBAAoB,gEAAgB,aAAa,+DAAiB;AAClE;AACA;AACA,qBAAqB;AACrB;AACA;AACA,oCAAoC,mDAAQ;AAC5C,wCAAwC,kDAAkD,EAAE;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,mDAAQ,SAAS,gBAAgB;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,mFAAkB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,yCAAG;AACf;AACA;AACA;AACA,YAAY,yCAAG,sBAAsB,yCAAG;AACxC,oBAAoB;AACpB;AACA;AACA;AACA,8BAA8B,6FAA4B,4DAA4D,mDAAQ;AAC9H;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA,CAAC,CAAC,0CAAI;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,oFAAgB,CAAC,gFAAY;AAC1E,KAAK;AACL;AACA;AACe,wEAAS,EAAC;;;;;;;;;;;;;ACrUzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,8EAA8E;AAC3G;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC0C;AACE;AACI;AAClB;AACK;AACQ;AACP;AACU;AACP;AACxC;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,+CAAe;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,eAAe,mDAAmB,CAAC,0DAAO,aAAa,oFAAoF,+BAA+B,mDAAmB,aAAa,mDAAmD;AAC7P;AACA;AACA;AACA;AACA,gCAAgC,sBAAs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ACT;AACA;AACA;AACA;AACA,aAAa;AACb,aAAa,8EAA8E;AAC3F;AACA;AACA;AACA;AACA,CAAC;AACc;;;;;;;;;;;;;ACzDf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiD;AACR;AACd;AACK;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA,8BAA8B,sDAAQ,CAAC,mDAAK;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA,8BAA8B,sDAAQ,CAAC,mDAAK;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,gDAAI;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,sEAAK;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,sEAAK;AACjB,YAAY;AACZ;;;;;;;;;;;;;ACnKA;AAAA;AAAA;AAAA;AAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA,UAAU,mDAAmB,OAAO,6GAA6G;A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DAAmB,QAAQ,0BAA0B;AACzD,QAAQ,mDAAmB,CAAC,2DAAG,GAAG,+BAA+B;AACjE,IAAI,mDAAmB;AACvB;AACA,eAAe;AACf;AACA;AACA,YAAY,mDAAmB,UAAU,SAAS,uBAAuB,EAAE;AAC3E;;;;;;;;;;;;;ACxKA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,oBAAoB;AACrB;AACO;AACP;AACA;AACA;AACA;AACA,uCAAuC,cAAc,uHAAuH;AAC5K;AACA;AACA;AACA;AACA,uCAAuC,cAAc,6BAA6B;AAClF;AACA;AACA;AACA,uCAAuC,cAAc,iEAAiE;AACtH;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,cAAc,+BAA+B;AACpF;AACA;;;;;;;;;;;;;AC7DA;AAAA;AAAA;AAAA;AAAA;AAAA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACO;AACP,YAAY,aAAa;AACzB,aAAa,kCAAkC;AAC/C;AACA;AACO;AACP,YAAY;AACZ;;;;;;;;;;;;;AChCA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AACwD;AACL;AAC4B;AACgB;AAChC;AACxD;AACP;AACA,yBAAyB,wEAAc;AACvC;AACA;AACA;AACA;AACA;AACA,gBAAgB,6EAA2B;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,8FAAsB;AACxC,KAAK;AACL;AACA;AACA,sBAAsB,4FAAoB;AAC1C;AACA;AACA,kCAAkC,oFAAwB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,oGAAmC;AACrE;AACA;AACA,aAAa;AACb;AACA;;;;;;;;;;;;;AC5DA;AAAA;AAAA;AAAA;AAAA;AAA0D;AACf;AAC3C;AACA;AACA;AACA;AACA;AACA,CAAC,wBAAwB;AAClB;AACP,6CAA6C,yBAAyB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,0CAAI,EAAE,kEAAC,SAAS,kEAAC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,2CAAK;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAAI,EAAE,kEAAC,CAAC,kEAAC,mBAAmB,kEAAC,CAAC,kEAAC,mBAAmB,kEAAC,CAAC,kEAAC;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,0CAAI,CAAC,yEAAQ;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,2CAAK,sBAAsB,uBAAuB,EAAE;AACnE;;;;;;;;;;;;;ACrEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6C;AACF;AACJ;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,oDAAM;AAC/B,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,6BAA6B;AAC3D;AACA;AACA,2BAA2B,OAAO;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,kEAAC;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb,aAAa;AACb;AACA;AACA;AACA,CAAC;AAC2B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,kEAAC;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA;AACA,wBAAwB,2CAAK;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAAI;AAC3B;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACrHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsE;AACf;AACnB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAAI,CAAC,yEAAQ;AACpC;AACA;AACA;AACA,QAAQ,8DAAO;AACf;AACA,QAAQ,sEAAe;AACvB;AACA,0BAA0B,0CAAI,CAAC,yEAAQ;AACvC,QAAQ,8DAAO;AACf;AACA,QAAQ,sEAAe;AACvB;AACA;AACA,sBAAsB,0CAAI,CAAC,yEAAQ;AACnC,QAAQ,8DAAO;AACf;AACA;AACA,yBAAyB,0CAAI,CAAC,yEAAQ;AACtC;AACA;AACA,0BAA0B,2CAAK;AAC/B,QAAQ,iEAAU,UAAU,kEAAC,+CAA+C,kEAAC;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb,aAAa,uHAAuH;AACpI;AACA;AACA;AACA,CAAC;AACkB;;;;;;;;;;;;;ACpFnB;AAAA;AAAO;AACP;AACA;;;;;;;;;;;;;ACFA;AAAA;AAAA;AAAA;AAAA;AAA8B;AACqB;AACnD;AACA;AACO;AACP,QAAQ,gEAAgB;AACxB,QAAQ,mDAAC;AACT;AACA;AACA,QAAQ,mDAAC;AACT;AACA;AACA;AACO;AACP,QAAQ,gEAAgB;AACxB,QAAQ,mDAAC;AACT;AACA;AACA,QAAQ,mDAAC;AACT;AACA;AACA;;;;;;;;;;;;;ACrBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8D;AAC1B;AACQ;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAAI,CAAC,yEAAQ;AACpC;AACA;AACA;AACA,sBAAsB,0CAAI,CAAC,yEAAQ;AACnC,yBAAyB,0CAAI,CAAC,yEAAQ;AACtC,0BAA0B,2CAAK;AAC/B;AACA,4BAA4B,0CAAI,WAAW,kEAAC,cAAc,8DAAK;AAC/D,wCAAwC,oDAAS;AACjD,6BAA6B,0CAAI,WAAW,kEAAC,eAAe,8DAAK;AACjE,wCAAwC,oDAAS;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACiB;;;;;;;;;;;;;ACzDlB;AAAA;AAAA;AAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;;;;;;;;;;;;;ACpCA;AAAA;AAAA;AAAoC;AACpC;AACA;AACA;AACA;AACA,sBAAsB,iDAAG;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACe;;;;;;;;;;;;;AC5BhB;AAAA;AAAA;AAAA;AAAA;AAAsF;AAC3C;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,2CAAK,WAAW,kEAAC,sBAAsB,8DAAK;AAChE,4CAA4C,wEAAe;AAC3D,gCAAgC,qEAAY;AAC5C,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,kEAAC;AAC9B,4BAA4B,kEAAC;AAC7B,0BAA0B,0CAAI;AAC9B;AACA,+BAA+B,kEAAC;AAChC;AACA;AACA,8BAA8B,kEAAC;AAC/B;AACA,yCAAyC,qEAAY;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb,aAAa,yDAAyD;AACtE,aAAa,kDAAkD;AAC/D;AACA;AACA;AACA,uCAAuC,kBAAkB,EAAE;AAC3D;AACA,aAAa;AACb;AACA;AACA;AACA,uCAAuC,kBAAkB,EAAE;AAC3D;AACA,aAAa;AACb;AACA;AACA;AACA,uCAAuC,kBAAkB;AACzD,aAAa;AACb;AACA;AACA;AACA,uCAAuC,kBAAkB;AACzD,aAAa;AACb;AACA;AACA;AACA,uCAAuC,kBAAkB;AACzD;AACA;AACA;AACA;AACA,CAAC;AACqB;;;;;;;;;;;;;ACjGtB;AAAA;AAAA;AAAgC;AAChC;AACO;AACP,gBAAgB,mBAAmB,4CAAM;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACdA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA2D;AACd;AACT;AACN;AAC9B;AACA;AACA;AACA;AACA,sBAAsB,iDAAG;AACzB,8CAA8C,kEAAC;AAC/C,8CAA8C,kEAAC;AAC/C,QAAQ,gFAAyB;AACjC;AACA,uBAAuB,2CAAK;AAC5B,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACoB;;;;;;;;;;;;;AC7CrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAoC;AACmB;AACf;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAAI;AAC3B,wCAAwC,iDAAC;AACzC;AACA;AACA,6BAA6B,iDAAC;AAC9B,0BAA0B,2CAAK;AAC/B,QAAQ,uEAAyB;AACjC;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,qBAAqB,yCAAyC;AAC9D,qBAAqB,4DAA4D;AACjF;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,6BAA6B;AAClD,qBAAqB,+BAA+B;AACpD;AACA;AACA;AACA;AACA;AACA,CAAC;AACgB;AACjB;AACA;AACA,eAAe,wDAAQ;AACvB,KAAK;AACL;AACA;AACA,eAAe,wDAAQ;AACvB;AACA;;;;;;;;;;;;;ACpEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AACiD;AACJ;AACD;AACwB;AACpE;AACA;AACA;AACA;AACA;AACA,iBAAiB,sEAAkB;AACnC,yBAAyB,kDAAY,GAAG;AACxC,sBAAsB,kEAAC;AACvB,sBAAsB,kEAAC;AACvB;AACA,wBAAwB,iBAAiB;AACzC,0BAA0B,kEAAC;AAC3B,0BAA0B,kEAAC;AAC3B;AACA,0BAA0B,2CAAK;AAC/B,QAAQ,sEAAe;AACvB;AACA;AACA;AACA;AACA,mBAAmB,kEAAC;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,EAAE,2DAAe,8BAA8B,cAAc;AAC5G,wCAAwC,2DAAe;AACvD;AACA;AACA,CAAC;AAC+B;;;;;;;;;;;;;ACtDhC;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,8EAA8E;AAC3G;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC+D;AACjC;AAC/B;AACA;AACA;AACA;AACA,oBAAoB,+CAAe;AACnC,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA,uBAAuB,2BAA2B;AAClD;AACA;AACA;AACA;AACA,YAAY,6EAAgB;AAC5B;AACA;AACA;AACA,YAAY,6EAAgB;AAC5B;AACA;AACA;AACA,uBAAuB,gBAAgB,eAAe,kFAAkF,EAAE;AAC1I;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,mDAAmB,cAAc,wIAAwI,QAAQ,sFAAsF,EAAE,0BAA0B,0BAA0B,EAAE,4BAA4B,4BAA4B,EAAE,2BAA2B,2BAA2B,EAAE,wBAAwB,wBAAwB,EAAE,sDAAsD;AACxiB;AACA;AACA,CAAC,CAAC,+CAAe;AACQ;;;;;;;;;;;;;AC1DzB;AAAA;AAAA;AAAA;AAA8B;AAC9B;AACO,qCAAqC,QAAQ,2CAAM,qCAAqC;AAC/F;AACO,wCAAwC,QAAQ,2CAAM,wGAAwG,2CAAM,SAAS;AACpL;AACA;AACA;AACA;AACA;AACA,kCAAkC,2CAAM;AACxC;AACA;AACA;AACA,6BAA6B,2CAAM,UAAU,2CAAM;AACnD,2BAA2B,2CAAM;AACjC,kCAAkC,2CAAM,UAAU,2CAAM;AACxD,CAAC,sBAAsB;AACvB;AACA;AACA,+BAA+B,2CAAM;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACe,oEAAK,EAAC;;;;;;;;;;;;;ACxCrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AACyC;AACU;AACI;AACO;AAC1B;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,2EAAW;AACnB;AACA;AACA,sBAAsB,2EAAW;AACjC;AACA,mBAAmB,kEAAC;AACpB;AACA;AACA;AACA;AACA;AACA,qCAAqC,qGAAqG,EAAE,2EAAW;AACvJ,wCAAwC,2EAAW;AACnD;AACA;AACA,2BAA2B,oBAAoB,EAAE,gEAAe,IAAI,6BAA6B,UAAU,yBAAyB,EAAE,EAAE,gCAAgC,QAAQ,kEAAC,mBAAmB,EAAE,cAAc;AACpN,2BAA2B,oBAAoB,EAAE,gEAAe,IAAI,6BAA6B,UAAU,6BAA6B,EAAE,EAAE,gCAAgC,QAAQ,kEAAC,uBAAuB,EAAE,cAAc;AAC5N,2BAA2B,oBAAoB,EAAE,gEAAe,IAAI,6BAA6B,UAAU,yBAAyB,EAAE,EAAE,gCAAgC,QAAQ,kEAAC,mBAAmB,EAAE,cAAc;AACpN,2BAA2B,oBAAoB,EAAE,gEAAe,IAAI,6BAA6B,UAAU,6BAA6B,EAAE,EAAE,gCAAgC,QAAQ,kEAAC,uBAAuB,EAAE,cAAc;AAC5N;AACA;AACA,CAAC;AACgB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,2EAAW;AACnB;AACA;AACA,sBAAsB,2EAAW;AACjC;AACA,mBAAmB,kEAAC;AACpB;AACA;AACA;AACA;AACA;AACA,+CAA+C,wCAAwC,0BAA0B;AACjH;AACA,YAAY,2EAAW;AACvB;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,0DAA0D;AAC/E,qBAAqB,uDAAuD;AAC5E,qBAAqB,iDAAiD;AACtE;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsB;AACvB;AACA;AACA;AACA;AACA,uBAAuB,0CAAI,CAAC,yEAAQ;AACpC,QAAQ,8DAAO;AACf;AACA;AACA,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,2EAAW;AACnB;AACA;AACA,sBAAsB,2EAAW;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,wCAAwC,2EAAW;AACnD,YAAY,2EAAW;AACvB;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,6DAA6D;AAClF,qBAAqB,mEAAmE;AACxF,qBAAqB,iDAAiD;AACtE;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACoB;AACd;AACP,mBAAmB,0CAAI,CAAC,yEAAQ;AAChC,mBAAmB,0CAAI,CAAC,yEAAQ;AAChC,YAAY;AACZ;AACO;AACP;AACA;AACA;AACA;AACA;AACA,eAAe,0CAAI;AACnB;;;;;;;;;;;;;ACzKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAgD;AACqB;AACjC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,0CAAI,QAAQ,kEAAC;AACtC;AACA,6BAA6B,0CAAI,WAAW,kEAAC,oCAAoC,8DAAK;AACtF;AACA,4CAA4C,6DAAS;AACrD,sBAAsB,0CAAI,QAAQ,kEAAC,sBAAsB,qEAAY;AACrE,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA,oBAAoB,0CAAI,WAAW,kEAAC,gBAAgB,8DAAK;AACzD;AACA,oBAAoB,0CAAI,MAAM,kEAAC,UAAU,kEAAC;AAC1C;AACA;AACA;AACA;AACA,mBAAmB,kEAAC;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb,aAAa;AACb;AACA;AACA;AACA,CAAC;AACiB;;;;;;;;;;;;;ACpDlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiD;AACb;AACN;AAC9B;AACA;AACA;AACA;AACA,yBAAyB,iDAAG;AAC5B,0BAA0B,2CAAK;AAC/B;AACA,sBAAsB,iDAAG;AACzB;AACA;AACA;AACA;AACA,QAAQ,sEAAe;AACvB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,iCAAiC;AACtD,qBAAqB,+BAA+B;AACpD;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;;;;;;;;;;;;;ACzCtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACyE;AAC5C;AACoC;AACjE;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,0CAAI,CAAC,yEAAQ;AACzC,QAAQ,qDAAO;AACf;AACA;AACA,sBAAsB,uDAAS;AAC/B,QAAQ,6DAAe;AACvB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,+CAA+C,EAAE,4EAAmB,IAAI,mBAAmB;AAC3F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsB;;;;;;;;;;;;;AC5CvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA+B;AACK;AACpC;AACO,kBAAkB,mDAAmB;AAC5C;AACA,sCAAsC,6DAA6D,EAAE;AACrG,kCAAkC,cAAc,EAAE;AAClD,kCAAkC,aAAa,EAAE;AACjD,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,mDAAmB,CAAC,iDAAK,GAAG,2CAA2C;AAC1F;AACA;AACA;AACA;AACA;AACA,mBAAmB,mDAAmB,CAAC,iDAAK,GAAG,yCAAyC;AACxF;AACA;AACA;AACA,CAAC;AACmC;AACpC;AACA;AACA,gCAAgC,YAAY;AAC5C,QAAQ,iBAAiB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC3DA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACwC;AACU;AACd;AACI;AACV;AACG;AAC1B;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,2CAAE;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC8B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,+DAAgB;AAC1B,sBAAsB;AACtB;AACA,0BAA0B,iEAA0B,GAAG;AAChD,eAAe,yDAAW,CAAC,iDAAO;AAC1B;AACf;AACA,wBAAwB,kCAAkC,EAAE;AAC5D,yBAAyB,mCAAmC,EAAE;AAC9D,yBAAyB,mCAAmC,EAAE;AAC9D;AACA,iCAAiC,2BAA2B,EAAE;AAC9D,4CAA4C,mBAAmB,6DAAO,mBAAmB,EAAE;AAC3F;AACA;AACA,iEAAiE,sBAAsB,EAAE;AACzF,KAAK;AACL;AACA,mEAAmE,uBAAuB,EAAE;AAC5F,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,yEAAyE,oBAAoB,EAAE;AAC/F;AACA,wEAAwE,oBAAoB,EAAE;AAC9F;AACA,yEAAyE,oBAAoB,EAAE;AAC/F;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA,kFAAkF,mBAAmB,EAAE,oBAAoB,aAAa,EAAE;AAC1I,gFAAgF,mBAAmB,EAAE,oBAAoB,aAAa,EAAE;AACxI;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,EAAC;AACK;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC5IA;AAAA;AAAA;AAAA;AAAA;AAAgD;AACE;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D;AAC3D,2BAA2B,kDAAY,GAAG;AAC1C;AACA;AACA;AACA,4BAA4B,kEAAC;AAC7B,4BAA4B,kEAAC;AAC7B;AACA;AACA;AACA;AACA;AACA,wBAAwB,0CAAI,WAAW,kEAAC;AACxC;AACA;AACA;AACA;AACA,gBAAgB,cAAc,2CAAK;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,wCAAwC;AAC7D,qBAAqB,4CAA4C;AACjE;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,iCAAiC;AACtD,qBAAqB,iCAAiC;AACtD,qBAAqB,+BAA+B;AACpD;AACA;AACA;AACA;AACA;AACA,CAAC;AACgB;AACjB;AACA;AACA;AACA,oBAAoB;AACpB;AACA,oBAAoB;AACpB;AACA,oBAAoB;AACpB;AACA;;;;;;;;;;;;;ACvEA;AAAA;AAAA;AAAA;AAAA;AAA8B;AACqB;AACH;AACzC;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,6DAAY;AAC9C;AACA,wBAAwB,mDAAC;AACzB,wBAAwB,gEAAgB;AACxC;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;AACA,kCAAkC,6DAAY;AAC9C;AACA,wBAAwB,mDAAC;AACzB,wBAAwB,gEAAgB;AACxC;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;AACA,kCAAkC,6DAAY;AAC9C;AACA,wBAAwB,mDAAC;AACzB,wBAAwB,gEAAgB;AACxC;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;AACA,kCAAkC,6DAAY;AAC9C;AACA,wBAAwB,mDAAC;AACzB,wBAAwB,gEAAgB;AACxC;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;;;;;;;;;;;;;ACnDA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsD;AACN;AACiB;AACtB;AAC3C,oBAAoB,6DAAS;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,QAAQ,kEAAC,sCAAsC,EAAE;AAC/F,+CAA+C,UAAU,8CAA8C,EAAE,EAAE;AAC3G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,kEAAC;AAC1B;AACA;AACA;AACA;AACA,mBAAmB,2CAAK,WAAW,kEAAC,mDAAmD,8DAAK;AAC5F,+BAA+B,kEAAC;AAChC;AACA,wBAAwB,kEAAW;AACnC;AACA,8BAA8B,kEAAC;AAC/B,uBAAuB,2CAAK;AAC5B,sCAAsC,kEAAC;AACvC,6BAA6B,2CAAK,WAAW,kEAAC,gBAAgB,8DAAK;AACnE,kCAAkC,kEAAW;AAC7C,2BAA2B,0CAAI,CAAC,yEAAQ;AACxC,QAAQ,8DAAO;AACf;AACA,4BAA4B,kEAAW;AACvC;AACA,4BAA4B,0CAAI,CAAC,yEAAQ;AACzC,QAAQ,8DAAO;AACf;AACA;AACA,0BAA0B,2CAAK;AAC/B;AACA;AACA,wBAAwB,kEAAC;AACzB;AACA;AACA,mBAAmB,2CAAK,WAAW,kEAAC,gBAAgB,8DAAK;AACzD,wBAAwB,kEAAW;AACnC,0BAA0B,2CAAK;AAC/B;AACA,wCAAwC,kEAAC;AACzC;AACA;AACA;AACA,mBAAmB,kEAAC;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,mCAAmC;AACxD,qBAAqB,6BAA6B;AAClD,qBAAqB,iCAAiC;AACtD,qBAAqB,+BAA+B;AACpD;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACmB;;;;;;;;;;;;;ACvHpB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAqD;AACX;AACQ;AACH;AACrB;AACI;AACO;AACrC;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,oBAAoB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACO;AACP;AACA;AACA;AACA;AACA,KAAK;AACL;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,uEAAc;AAC1B;AACA;AACA,YAAY,8DAAI;AAChB;AACA;AACA,YAAY,8DAAI;AAChB;AACA;AACA,YAAY,yDAAS;AACrB;AACA;AACA,YAAY,yDAAS;AACrB;AACA;AACA,YAAY,yDAAS;AACrB;AACA;AACA,oBAAoB,kEAAa;AACjC;AACA;AACA,YAAY,yDAAU;AACtB;AACA;AACA,YAAY,yDAAU;AACtB;AACA;AACA,YAAY,yDAAU;AACtB;AACA,iBAAiB,6CAAK;AACtB,YAAY,yDAAU;AACtB;AACA,iBAAiB,2CAAM;AACvB,YAAY,yDAAU;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACtIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,8EAA8E;AAC3G;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACyD;AAC/B;AACyC;AACf;AACW;AACgB;AAChD;AACyB;AACZ;AACF;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,wFAAuB;AAC1C;AACA;AACA,mBAAmB,yEAAY;AAC/B;AACA,iBAAiB,6CAAK;AACtB,mBAAmB,yEAAY;AAC/B;AACA,iBAAiB,6CAAK;AACtB,mBAAmB,oGAAkC;AACrD;AACA;AACA,mBAAmB,oFAAwB;AAC3C;AACA;AACA;AACA;AACA,eAAe,mDAAmB,CAAC,yDAAW,YAAY,2BAA2B,oBAAoB,SAAS,mDAAmB,CAAC,sEAAa,aAAa,qCAAqC,uBAAuB,IAAI,EAAE;AAClO;AACA;AACA,CAAC,CAAC,+CAAe;AACe;AAChC;AACA,KAAK,sDAAsD;AAC3D,KAAK,wDAAwD;AAC7D,KAAK,sDAAsD;AAC3D;AACA;AACA;AACA,mBAAmB,wCAAwC;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uFAAuF;AACvF;AACA;AACA;AACA,wCAAwC,qDAAQ,UAAU,6EAAuB;AACjF;AACA,iCAAiC,EAAE,EAAE;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACtHA,uB;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,8EAA8E;AAC3G;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC6B;AACQ;AACX;AACI;AACO;AACN;AACG;AAC5B;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,mDAAmB,YAAY,4EAA4E,8BAA8B,EAAE,EAAE;AAChK,gBAAgB,mDAAmB,OAAO,uDAAuD;AACjG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,mDAAW;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,mDAAK,UAAU,2DAAK;AAChC;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,YAAY,mDAAC;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mDAAW;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,wDAAU;AAC5B;AACA;AACA,YAAY,gDAAI;AAChB;AACA;AACA;AACA,CAAC,CAAC,+CAAe;AACM;;;;;;;;;;;;;AC5GvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsD;AACN;AAC+B;AACnD;AACe;AAC3C;AACA,oBAAoB,iDAAG;AACvB,oBAAoB,6DAAS,UAAU,iDAAG;AAC1C,2BAA2B,iDAAG,4BAA4B,iDAAG;AAC7D;AACA;AACA,4BAA4B,qEAAY;AACxC;AACA;AACA,uBAAuB,0CAAI,CAAC,yEAAQ;AACpC,QAAQ,8DAAO;AACf;AACA;AACA;AACA,wBAAwB,kEAAW;AACnC;AACA;AACA;AACA;AACA,mBAAmB,2CAAK,WAAW,kEAAC,gBAAgB,8DAAK;AACzD,wBAAwB,kEAAW,aAAa,iDAAG;AACnD,yBAAyB,iDAAG;AAC5B,mBAAmB,2CAAK,WAAW,kEAAC,gBAAgB,8DAAK;AACzD;AACA;AACA,wBAAwB,kEAAW;AACnC;AACA,wBAAwB,2CAAK,WAAW,kEAAC,gBAAgB,8DAAK;AAC9D;AACA;AACA;AACA,4BAA4B,2CAAK;AACjC,YAAY,2CAAK,WAAW,kEAAC,iBAAiB,8DAAK;AACnD,YAAY,2CAAK,WAAW,kEAAC,gBAAgB,8DAAK;AAClD,YAAY,2CAAK,WAAW,kEAAC,eAAe,8DAAK,0BAA0B,kEAAW;AACtF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA,uBAAuB,kEAAC;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkB;;;;;;;;;;;;;AC/EnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA+C;AACN;AACkB;AAC3C;AAC0D;AAC1E,0CAAI;AACJ;AACA;AACA;AACA;AACA,0CAAI;AACJ;AACA;AACA;AACA;AACA,0CAAI;AACJ;AACA;AACA;AACA,0CAAI;AACJ;AACA;AACA;AACA;AACA;AACA,0CAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,0CAAI;AACJ;AACA;AACA;AACA;AACA;AACA,0CAAI;AACJ;AACA;AACA;AACA,0CAAI;AACJ,oDAAoD,oEAAW;AAC/D,oEAAoE,qEAAY;AAChF;AACA;AACA;AACA,0CAAI;AACJ;AACA;AACA;AACA,0CAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,0CAAI;AACJ;AACA;AACA;AACA;AACA;AACA,0CAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,0CAAI;AACJ,uBAAuB,oEAAW;AAClC;AACA;AACA;AACA;AACA,0CAAI;AACJ;AACA;AACA;AACA,0CAAI;AACJ,uBAAuB,OAAO;AAC9B,IAAI,8DAAO;AACX;AACA;AACA,2CAAK;AACL,YAAY;AACZ;AACA,2CAAK;AACL;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA,mBAAmB,kDAAY,GAAG;AAClC,mDAAmD,4BAA4B;AAC/E;AACA;AACA,oBAAoB,kEAAC;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA,oBAAoB;AACpB;AACA,oBAAoB;AACpB;AACA,oBAAoB;AACpB;AACA,oBAAoB;AACpB;AACA,oBAAoB;AACpB;AACA,oBAAoB;AACpB;AACA,oBAAoB;AACpB;AACA;AACA;AACA,+CAAS;AACT;AACA;AACA;AACA;AACA;AACA,+CAAS;AACT,WAAW,2CAAK;AAChB;;;;;;;;;;;;;ACjKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsD;AACC;AACnB;AACO;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,iDAAG;AACzB;AACA;AACA,yBAAyB,iDAAG;AAC5B;AACA;AACA;AACA,+BAA+B,2CAAK,oCAAoC,kEAAC;AACzE;AACA,8BAA8B,2CAAK;AACnC;AACA,8BAA8B,2CAAK;AACnC;AACA;AACA,iCAAiC,0CAAI,CAAC,yEAAQ;AAC9C,gBAAgB,8DAAO;AACvB;AACA;AACA,kCAAkC,kEAAW;AAC7C,8BAA8B,2CAAK;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,qBAAqB,iCAAiC;AACtD,qBAAqB,qDAAqD;AAC1E,qBAAqB,2DAA2D;AAChF;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACwB;;;;;;;;;;;;;AC7DzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA+C;AACC;AACL;AACW;AACjB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,qBAAq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ACA;AACA;;;;;;;;;;;;;ACvFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAC+B;AACa;AAC5C;AACO;AACP;AACA,gBAAgB,gDAAgB,CAAC,yDAAW;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,mDAAmB,YAAY,sJAAsJ,oBAAoB,EAAE,EAAE;AACxN;AACA,YAAY,mDAAmB,YAAY,2CAA2C;AACtF,cAAc,mDAAmB,YAAY,oDAAoD;AACjG;AACA;AACA,KAAK;AACL;;;;;;;;;;;;;ACrBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC8D;AACX;AACxB;AAC4B;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,2CAAK;AAClC,oCAAoC,kEAAC;AACrC;AACA,sFAAsF,2CAAK;AAC3F;AACA,uCAAuC,qEAAY;AACnD;AACA;AACA;AACA,qCAAqC,wEAAY,CAAC,2CAAK;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,4BAA4B;AAC5D;AACA;AACA;AACA;AACA;AACA,gDAAgD,WAAW,wBAAwB;AACnF;AACA;AACA;AACA,qBAAqB,kEAAC;AACtB,4CAA4C,gBAAgB;AAC5D;AACA;AACA,4BAA4B,2CAAK;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,qBAAqB;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,kEAAC;AACrC;AACA;AACA,sCAAsC,2CAAK;AAC3C;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,sDAAsD,kEAAC;AACvD;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,CAAC;AACuB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uBAAuB;AAC/C;AACA;AACA,yCAAyC,qBAAqB;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,kEAAC;AAC1B;AACA;AACA;AACA,8BAA8B,+CAAS;AACvC;AACA;AACA;AACA,oCAAoC,qEAAY;AAChD;AACA;AACA;AACA,4CAA4C,gBAAgB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,gDAAI;AACpB;AACA;AACA;AACA;AACA,gBAAgB,gDAAI;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC9OA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6C;AACO;AAChB;AACpC;AACA;AACA;AACA;AACA,uBAAuB,0CAAI,CAAC,yEAAQ;AACpC;AACA;AACA;AACA;AACA;AACA,2BAA2B,kEAAW;AACtC;AACA;AACA;AACA,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;;;;;;;;;;;;;ACjDtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AAC6C;AACiB;AAChB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA,iBAAiB,EAAE,EAAE;AACrB,8CAA8C,QAAQ,kEAAC,cAAc,EAAE;AACvE;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,0CAAI,QAAQ,kEAAC;AACvC,QAAQ,2EAAW;AACnB,oCAAoC,2CAAK,KAAK,8CAAQ,wCAAwC,kEAAC,4BAA4B,kEAAC;AAC5H,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA,sBAAsB,2EAAW;AACjC;AACA;AACA;AACA;AACA;AACA,+CAA+C,EAAE,2EAAW,sBAAsB,gCAAgC;AAClH,wCAAwC,2EAAW;AACnD,YAAY,2EAAW;AACvB;AACA;AACA;AACA,qBAAqB,mCAAmC;AACxD,qBAAqB,+BAA+B;AACpD;AACA;AACA;AACA;AACA;AACA,CAAC;AACiB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AClFA;AAAA;AAAO;AACP;AACA;;;;;;;;;;;;;ACFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,8EAA8E;AAC3G;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACqD;AACI;AACN;AACyB;AACxC;AAC8B;AACV;AACN;AACc;AACrC;AACG;AACC;AACF;AACU;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,wEAAY,cAAc,yEAAa;AAC5E;AACA;AACA;AACA,kCAAkC,4CAAK;AACvC;AACA;AACA,6BAA6B,wEAAc;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,qCAAqC;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,gDAAI;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,IAAI,KAAK,IAAI;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,+CAA+C,EAAE;AAClG;AACA,uBAAuB,iCAAiC;AACxD;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,uBAAuB,mEAAE;AACzB;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,gDAAgD;AAChD;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,uEAAS,uCAAuC,+BAA+B,EAAE;AACpG,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,uBAAuB;AACpE;AACA;AACA;AACA,uCAAuC,8EAAqB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,gDAAI;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,0EAAkB;AAC9B;AACA;AACA;AACA,yCAAyC,4CAAK;AAC9C;AACA;AACA;AACA;AACA,+CAA+C,iEAAQ;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,wEAAY,cAAc,yEAAa;AACxF;AACA;AACA,0EAA0E,4CAA4C,EAAE;AACxH;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,2CAAK;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,2CAAK;AAC3C;AACA;AACA;AACA;AACA;AACA,mDAAmD,kEAAC;AACpD;AACA,qCAAqC,4DAAW;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,0EAAkB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,iDAAiD,EAAE;AACxG;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,kEAAC;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,2CAAK;AACjB;AACA;AACA;AACA,uCAAuC,qEAAY;AACnD,yCAAyC,qEAAY;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,qEAAW;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,iDAAG;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,2CAAK;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,qFAAkB;AAC9B;AACA;AACA;AACA,CAAC,CAAC,gDAAe;AACa;;;;;;;;;;;;;ACzgB9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AACiD;AACwB;AACrC;AACQ;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,0CAAI,CAAC,yEAAQ;AAC1C,6BAA6B,0CAAI,CAAC,yEAAQ;AAC1C,QAAQ,sEAAe;AACvB;AACA,yBAAyB,0CAAI,YAAY,0CAAI,iEAAiE,kBAAkB,EAAE,yCAAyC,kBAAkB,EAAE;AAC/L;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,qEAAc;AACtB,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,4EAAmB;AACtC;AACA,SAAS;AACT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BAA0B,kEAAC,sBAAsB;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA,CAAC;AACqB;;;;;;;;;;;;;ACvCtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAAsB,SAAI,IAAI,SAAI;AAClC,iDAAiD,QAAQ;AACzD,wCAAwC,QAAQ;AAChD,wDAAwD,QAAQ;AAChE;AACA;AACA;AACmD;AACZ;AACI;AAC0B;AACV;AACxB;AACA;AACD;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,qBAAqB;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA,kGAAkG,wEAAc;AAChH,yCAAyC,qBAAqB;AAC9D;AACA,gBAAgB,wEAAc,gCAAgC,wEAAc;AAC5E;AACA;AACA;AACA;AACA,+FAA+F,+BAA+B,EAAE;AAChI;AACA;AACA;AACA;AACA,+CAA+C,wBAAwB;AACvE;AACA;AACA,gCAAgC,gFAAY;AAC5C,qBAAqB,gDAAM;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,gBAAgB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,uBAAuB,uDAAS;AAChC;AACA;AACA,uBAAuB,uDAAS;AAChC;AACA,mBAAmB,uDAAS,sCAAsC,uDAAS;AAC3E,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,0BAA0B,4DAA4D,EAAE;AACxF;AACA;AACA,KAAK;AACL;AACA,0BAA0B,kEAAkE,EAAE;AAC9F;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,mBAAmB,gDAAM;AACzB,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,iHAAiH,aAAa,EAAE;AAChI,mBAAmB,sEAAY;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,oEAAU;AAC7B;AACA;AACA;AACA;AACA;AACA,0BAA0B,mDAAQ;AAClC;AACA,mFAAmF,aAAa,EAAE;AAClG,4DAA4D,SAAS,gDAAM,0BAA0B,EAAE;AACvG;AACA;AACA,mBAAmB,wDAAQ;AAC3B,gBAAgB,oDAAM;AACtB,gBAAgB,sEAAY;AAC5B;AACA;AACA,gCAAgC;AAChC;AACA,CAAC;AACmB;;;;;;;;;;;;;AC7KpB;AAAA;AAAA;AAAA;AAAA;AACgC;AACO;AAChC;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,sCAAsC;AAChE;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,mDAAO;AACjC,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,0BAA0B,mDAAO;AACjC;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA,QAAQ,oDAAC;AACT,KAAK;AACL;AACA,QAAQ,oDAAC;AACT,KAAK;AACL;AACA,IAAI,oDAAC;AACL;;;;;;;;;;;;;AC9DA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyC;AACO;AACc;AAC1B;AACE;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAAI,WAAW,kEAAC,gBAAgB,8DAAK;AAC5D,sCAAsC,6DAAS;AAC/C,sBAAsB,0CAAI,CAAC,yEAAQ;AACnC,QAAQ,8DAAO;AACf;AACA,sCAAsC,6DAAS;AAC/C,sBAAsB,0CAAI,CAAC,yEAAQ,6EAA6E,6DAAS;AACzH,sBAAsB,+DAAQ;AAC9B,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;;;;;;;;;;;;;ACrDtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA2C;AACJ;AACC;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,2CAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,oDAAM;AAC9B;AACA,oCAAoC,oBAAoB;AACxD,yCAAyC,mBAAmB;AAC5D,mCAAmC,iDAAC;AACpC;AACA;AACA,mCAAmC,2CAAK;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,mCAAmC;AACxD,qBAAqB,+BAA+B;AACpD,qBAAqB,iCAAiC;AACtD,qBAAqB,iCAAiC;AACtD;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB,iCAAiC;AACtD,qBAAqB,+BAA+B;AACpD;AACA,uCAAuC,0EAA0E;AACjH,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACiB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAAI,QAAQ,iDAAC;AACpC;AACA;AACA;AACA,sBAAsB,0CAAI,CAAC,wDAAQ;AACnC;AACA;AACA;AACA,sBAAsB,0CAAI,CAAC,wDAAQ;AACnC;AACA;;;;;;;;;;;;;ACjHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAuC;AACR;AACqB;AACpD;AACA;AACA;AACO,oCAAoC,SAAS,mDAAmB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","file":"js/app.main.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"main\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([\"zUnb\",\"vendors~main~svg\",\"vendors~main\",\"main~svg\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","var KEY_JWT_TOKEN = \"jwtToken\";\r\nexport function storeToken(token) {\r\n    if (isLocalStorageAllowed()) {\r\n        localStorage.setItem(KEY_JWT_TOKEN, token);\r\n    }\r\n}\r\nexport function retrieveToken() {\r\n    if (!isLocalStorageAllowed())\r\n        return null;\r\n    return localStorage.getItem(KEY_JWT_TOKEN);\r\n}\r\nexport function clearToken() {\r\n    if (isLocalStorageAllowed()) {\r\n        localStorage.removeItem(KEY_JWT_TOKEN);\r\n    }\r\n}\r\nfunction isLocalStorageAllowed() {\r\n    try {\r\n        if (localStorage)\r\n            return true;\r\n    }\r\n    catch (e) {\r\n        return false;\r\n    }\r\n    return false;\r\n}\r\n","// Component for group of radios.\r\nimport * as React from \"react\";\r\nimport { TierContext } from \"tiers/context\";\r\n/** Renders a group of radios. */\r\nexport var Radio = function (props) {\r\n    var tiers = React.useContext(TierContext);\r\n    return React.createElement(React.Fragment, null, props.options.map(function (optionProps) {\r\n        var value = optionProps.value, label = optionProps.label;\r\n        var id = props.id + \"_\" + value;\r\n        var allowSelection = tiers.allow(optionProps) || (props.allowSelectingTierLockedOptions);\r\n        return React.createElement(\"div\", { key: value, className: \"custom-control custom-radio\" },\r\n            React.createElement(\"input\", { type: \"radio\", key: value + \"_radio\", id: id, value: value, disabled: !allowSelection, checked: props.value == value, name: props.id, className: \"custom-control-input\", onChange: function (e) { return props.onChange(props.value, e.target.value); } }),\r\n            React.createElement(\"label\", { key: value + \"_label\", htmlFor: id, className: \"custom-control-label\", onClick: !allowSelection ? function () { return tiers.popup(id); } : function () { } },\r\n                label,\r\n                tiers.badge(optionProps, \"ml-1\")));\r\n    }));\r\n};\r\n","// Hacky wraper for jquery slider pips.\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { clamp, quantize } from \"apparatus/library/common\";\r\nimport { focusMainApp, Keys } from \"keyboard\";\r\nimport * as React from \"react\";\r\nimport { Slider } from \"./slider\";\r\nvar ComboSlider = /** @class */ (function (_super) {\r\n    __extends(ComboSlider, _super);\r\n    function ComboSlider(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.onSlideStart = function () {\r\n            var _a;\r\n            (_a = _this.props.onStart) === null || _a === void 0 ? void 0 : _a.call(null);\r\n        };\r\n        // Called when slider changed by sliding\r\n        _this.onSlideChange = function (value) {\r\n            _this.setState({ inputText: _this.inputText(value) });\r\n            _this.props.onChange(value);\r\n        };\r\n        // Called when slider changed by setting a value.\r\n        _this.onSlideEnd = function (initialValue, value) {\r\n            _this.setState({ value: value, inputText: _this.inputText(value) });\r\n            _this.props.onEnd(initialValue, value);\r\n        };\r\n        _this.state = { value: props.initialValue, inputText: _this.inputText(props.initialValue) };\r\n        return _this;\r\n    }\r\n    /** Calculates input value to show in the input field. */\r\n    ComboSlider.prototype.inputText = function (value) {\r\n        if (this.props.unit === \"%\") {\r\n            return Math.round(value * 100).toString();\r\n        }\r\n        return value.toString();\r\n    };\r\n    ComboSlider.prototype.componentDidUpdate = function (prevProps, prevState) {\r\n        if (prevProps.initialValue != this.props.initialValue) {\r\n            if (prevState.value != this.props.initialValue) {\r\n                this.setState({\r\n                    value: this.props.initialValue,\r\n                    inputText: this.inputText(this.props.initialValue)\r\n                });\r\n            }\r\n        }\r\n    };\r\n    /** Handle change when the input is typed into. */\r\n    ComboSlider.prototype.onInputChange = function (event) {\r\n        var value = event.target.value;\r\n        this.setState({ inputText: value });\r\n    };\r\n    /** Handle change when the input loses focus. */\r\n    ComboSlider.prototype.onInputBlur = function (event) {\r\n        var _a;\r\n        var value = event.target.value;\r\n        var convertedValue = +value;\r\n        if (isNaN(convertedValue)) {\r\n            // Invalid value, reset back to original value and return.\r\n            this.setState({ inputText: this.props.initialValue.toString() });\r\n            return;\r\n        }\r\n        // Special handling based on unit.\r\n        if (this.props.unit === \"%\") {\r\n            convertedValue = convertedValue / 100;\r\n        }\r\n        // Clamp the value to range.\r\n        convertedValue = clamp(convertedValue, this.props.min, this.props.max);\r\n        // Round it to expected steps.\r\n        convertedValue = quantize(convertedValue, this.props.min, (_a = this.props.step) !== null && _a !== void 0 ? _a : 1);\r\n        // Invoke callback.\r\n        this.props.onEnd(this.props.initialValue, convertedValue);\r\n        // Set value for input.\r\n        this.setState({ inputText: this.inputText(convertedValue) });\r\n    };\r\n    ComboSlider.prototype.render = function () {\r\n        var _this = this;\r\n        var comboClass = this.props.unit ? \"combo-3\" : \"combo-2\";\r\n        return React.createElement(React.Fragment, null,\r\n            React.createElement(Slider, { key: \"slider\", initialValue: this.state.value, min: this.props.min, max: this.props.max, step: this.props.step, pipsStep: this.props.pipsStep, formatLabel: this.props.formatLabel, onChange: this.onSlideChange, onStart: this.onSlideStart, onEnd: this.onSlideEnd, extraClass: \"combo \" + comboClass }),\r\n            React.createElement(\"input\", { key: \"input\", className: \"slider-input ui-input \" + comboClass, value: this.state.inputText, onChange: function (e) { return _this.onInputChange(e); }, onBlur: function (e) { return _this.onInputBlur(e); }, onKeyDown: function (e) { if (e.keyCode == Keys.ENTER)\r\n                    focusMainApp(); } }),\r\n            this.props.unit ? React.createElement(\"span\", { className: \"slider-input-unit\" }, this.props.unit) : undefined);\r\n    };\r\n    return ComboSlider;\r\n}(React.Component));\r\nexport { ComboSlider };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { setDefaultStyle, smoothCorner } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, Pivot, R, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Tap } from \"apparatus/library/common/tap\";\r\nimport { hsl } from \"color\";\r\nimport { Group, Path, PointText, Shape } from \"paper\";\r\nimport { strokeWidth } from \"../../draw\";\r\nvar MANOMETER_OFFSET = 250;\r\nvar SchlenkLines = /** @class */ (function () {\r\n    function SchlenkLines() {\r\n    }\r\n    SchlenkLines.prototype.render = function (appearance) {\r\n        var snaps = [];\r\n        var portGaps = 100;\r\n        var portOffset = 80;\r\n        var ports = +appearance.ports;\r\n        var topPipeworks = pipeworks(80, ports, portGaps, portOffset, 10, true, true);\r\n        tubify(topPipeworks, strokeWidth(\"default\"));\r\n        snaps.push({ type: \"connectable\", at: P(topPipeworks.bounds.left, 0), facing: -90 }, { type: \"connectable\", at: P(topPipeworks.bounds.right, 0), facing: 90 });\r\n        var bottomPipeworks = pipeworks(40, ports, portGaps, portOffset, -10, true, false);\r\n        tubify(bottomPipeworks, strokeWidth(\"default\"));\r\n        bottomPipeworks.position.y += 40;\r\n        bottomPipeworks.position.x += 36;\r\n        var graphic = new Group([topPipeworks, bottomPipeworks]);\r\n        if (appearance.coldTrap) {\r\n            var coldTrap = createColdTrap();\r\n            coldTrap.position.x -= 100;\r\n            coldTrap.position.y += 40;\r\n            graphic.addChild(coldTrap);\r\n            // Place at the end of the outlet tube. Compute this from the position of the cold\r\n            // trap's outlet tube (see inside createColdTrap() and then add the position shift above.)\r\n            snaps.push({ type: \"connectable\", at: P(-230, 40), facing: 180 });\r\n        }\r\n        else {\r\n            snaps.push({ type: \"connectable\", at: P(bottomPipeworks.bounds.left, 40), facing: -90 });\r\n        }\r\n        // Add taps and outlets.\r\n        for (var i = 0; i < ports; i++) {\r\n            var tap = Tap.create(appearance[\"tap\" + (i + 1)]);\r\n            tap.position.x = portOffset + i * portGaps + 18;\r\n            tap.position.y = 78;\r\n            var outlet = new Path(Segments([[0, 50]], [[0, 0]], [[8, 0]], [[8, 50]]));\r\n            setDefaultStyle(outlet);\r\n            outlet.position.x = tap.position.x;\r\n            outlet.position.y = 115;\r\n            graphic.addChild(outlet);\r\n            graphic.addChild(tap);\r\n            snaps.push({ type: \"connectable\", at: outlet.bounds.bottomCenter, facing: 180 });\r\n        }\r\n        // Manometer\r\n        if (appearance.manometer) {\r\n            var manometerTube = new Path.Line(P(MANOMETER_OFFSET, 31), P(MANOMETER_OFFSET, -30));\r\n            manometerTube.strokeWidth = 8;\r\n            var manometerGroup = new Group([manometerTube]);\r\n            tubify(manometerGroup, strokeWidth(\"default\"));\r\n            var manometerGraphic = manometer(appearance.reading);\r\n            manometerGraphic.position = P(MANOMETER_OFFSET, -45);\r\n            graphic.addChildren([manometerGroup, manometerGraphic]);\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.strokeBounds.toShape(),\r\n            snapping: snaps,\r\n        };\r\n    };\r\n    SchlenkLines.properties = {\r\n        label: \"Schlenk Lines\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            reading: \"0.001\",\r\n            manometer: true,\r\n            coldTrap: true,\r\n            ports: \"4\",\r\n            tap1: 1.0, tap2: 1.0, tap3: 1.0, tap4: 1.0, tap5: 1.0,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"toggle-buttons\", key: \"ports\", label: \"Number of ports\",\r\n                size: \"text\",\r\n                options: [\r\n                    { label: \"3\", icon: \"\", value: \"3\" },\r\n                    { label: \"4\", icon: \"\", value: \"4\" },\r\n                    { label: \"5\", icon: \"\", value: \"5\" },\r\n                ]\r\n            },\r\n            {\r\n                spec: \"checkbox\", key: \"coldTrap\", label: \"Cold Trap\", subLabel: \"Show\"\r\n            },\r\n            {\r\n                spec: \"checkbox\", key: \"manometer\", label: \"Manometer\", subLabel: \"Show\"\r\n            },\r\n            {\r\n                spec: \"text\", key: \"reading\", label: \"Reading\",\r\n                maxLength: 5,\r\n                visible: function (a) { return a.manometer; }\r\n            },\r\n            Tap.appearanceSpecFor(\"tap1\", \"Tap 1\"),\r\n            Tap.appearanceSpecFor(\"tap2\", \"Tap 2\"),\r\n            Tap.appearanceSpecFor(\"tap3\", \"Tap 3\"),\r\n            __assign(__assign({}, Tap.appearanceSpecFor(\"tap4\", \"Tap 4\")), { visible: function (a) { return +a.ports >= 4; } }),\r\n            __assign(__assign({}, Tap.appearanceSpecFor(\"tap5\", \"Tap 5\")), { visible: function (a) { return +a.ports >= 5; } }),\r\n        ],\r\n    };\r\n    return SchlenkLines;\r\n}());\r\nexport { SchlenkLines };\r\nfunction pipeworks(length, outlets, outletGaps, outletOffset, bend, leftEnd, rightEnd) {\r\n    var end = (outlets - 1) * outletGaps + outletOffset * 2;\r\n    var graphic = new Group();\r\n    var topPipe = new Path.Line(P(0, 0), P(end, 0));\r\n    topPipe.strokeCap = \"round\";\r\n    topPipe.strokeWidth = 18;\r\n    graphic.addChild(topPipe);\r\n    for (var i = 0; i < outlets; i++) {\r\n        var x = outletOffset + i * outletGaps;\r\n        var outlet = new Path(Segments([[x, 0]], [[x, length - Math.abs(bend)]], [[x + bend, length], [-bend, 0]]));\r\n        outlet.strokeWidth = 5;\r\n        graphic.addChild(outlet);\r\n    }\r\n    if (leftEnd) {\r\n        var end1 = new Path.Line(P(-20, 0), P(0, 0)).withStroke(8, \"white\");\r\n        graphic.addChild(end1);\r\n    }\r\n    if (rightEnd) {\r\n        var end2 = new Path.Line(P(end, 0), P(end + 20, 0)).withStroke(8, \"white\");\r\n        graphic.addChild(end2);\r\n    }\r\n    return graphic;\r\n}\r\n/**\r\n * Creates tubes by adding for each child a new child.\r\n * The original child is turned into the outlines,\r\n * while the latter child is the empty inside.\r\n */\r\nfunction tubify(group, thickness) {\r\n    var count = group.children.length;\r\n    for (var i = 0; i < count; i++) {\r\n        var child = group.children[i];\r\n        var clone = child.clone();\r\n        child.strokeWidth = clone.strokeWidth + thickness * 2;\r\n        child.strokeColor = SharedColors.stroke;\r\n        clone.strokeColor = \"white\";\r\n        group.addChild(clone);\r\n    }\r\n}\r\nfunction manometer(reading) {\r\n    var casing = Shape.Rectangle(R(0, 0, 60, 40, Pivot.TOP_CENTER), 4.0);\r\n    casing\r\n        .withGradientFill(\"right\", Gradients.box(hsl(0, 0, 90)))\r\n        .withStroke(strokeWidth(\"default\"), hsl(0, 0, 30).string());\r\n    var screen = Shape.Rectangle(R(0, 7, 46, 25, Pivot.TOP_CENTER), 2);\r\n    screen.withStroke(strokeWidth(\"thin\"), \"#777777\");\r\n    var display = new PointText({\r\n        point: P(0, 25),\r\n        content: reading,\r\n        fillColor: 'black',\r\n        fontFamily: 'sans-serif',\r\n        fontSize: 15,\r\n        justification: \"center\",\r\n    });\r\n    return new Group([casing, screen, display]);\r\n}\r\nfunction createColdTrap() {\r\n    var container = new Path(Segments([[120, 6]], [[20, 6]], [[20, 20], , [0, 20]], [[35, 60], [0, -20]], [[35, 220], , [0, 60]], [[-35, 220], [0, 60]], [[-35, 60], , [0, -20]], [[-20, 20], [0, 20]], [[-20, -20], , [0, -30]], [[20, -20], [0, -30]], [[20, -6]], [[120, -6]]));\r\n    setDefaultStyle(container);\r\n    var tubePath = new Path(Segments([[0, 180]], [[0, -90]], [[-130, -90]], [[-130, 0]]));\r\n    smoothCorner(tubePath.segments[2], 30);\r\n    smoothCorner(tubePath.segments[1], 30);\r\n    tubePath.strokeWidth = 8;\r\n    var outletTube = new Group([tubePath, new Path.Line(P(-65, -90), P(-65, -20)).withStroke(4, \"black\")]);\r\n    tubify(outletTube, strokeWidth(\"default\"));\r\n    var tap = Tap.create(0.0);\r\n    tap.position = P(-65, -65);\r\n    return new Group([container, outletTube, tap]);\r\n}\r\n","import { P } from \"apparatus/library/common\";\r\nimport { Group, Path, Symbol } from \"paper\";\r\nimport { Lazy } from \"utils\";\r\nvar Mirror = /** @class */ (function () {\r\n    function Mirror() {\r\n    }\r\n    Mirror.prototype.render = function (appearance) {\r\n        var height = appearance.size;\r\n        var graphic = new Group();\r\n        for (var y = 0; y < height - 6; y += 10) {\r\n            graphic.addChild(hashSymbol.value.place(P(0, y)));\r\n        }\r\n        var line = new Path.Line(P(0, 0), P(0, height)).withStroke(\"thick\");\r\n        line.strokeCap = \"square\";\r\n        graphic.addChild(line);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.expand(10).toShape()\r\n        };\r\n    };\r\n    Mirror.properties = {\r\n        label: \"Mirror\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            size: 250,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 50, max: 1000, unit: \"mm\",\r\n            }\r\n        ],\r\n    };\r\n    return Mirror;\r\n}());\r\nexport { Mirror };\r\nvar hashSymbol = new Lazy(function () {\r\n    var hash = new Path.Line(P(0, 0), P(8, 8)).withStroke(\"thin\", \"#666666\");\r\n    hash.pivot = P(0, 0);\r\n    return new Symbol(hash, false);\r\n});\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport * as Sentry from \"@sentry/react\";\r\nimport { g } from \"analytics\";\r\nimport { clearToken, retrieveToken } from \"api/auth/storage\";\r\nimport { disposeMarkSymbol } from \"apparatus/draw\";\r\nimport { commandProcessor } from \"command/command\";\r\nimport { Selected } from \"editing/selection\";\r\nimport { CloudFiles } from \"file/api\";\r\nimport { focusMainApp, setUpKeyboard } from \"keyboard\";\r\nimport { EditorContainer } from \"layout/editor/editor_container\";\r\nimport { TabbedSidebar } from \"layout/sidebar/tabbed_sidebar\";\r\nimport { ScreenTooSmallWarning } from \"layout/top_bar/extras\";\r\nimport { TopBar } from \"layout/top_bar/top_bar\";\r\nimport { clog } from \"log\";\r\nimport { PropertyPanelAdapter } from \"panel/property_panel_adapter\";\r\nimport * as React from \"react\";\r\nimport { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { logIn } from \"store/actions\";\r\nimport store, { appStore, extractDebugInfoFromStore } from \"store/store\";\r\nimport { Bcn } from \"support/beacon\";\r\nimport { TierContext } from \"tiers/context\";\r\nimport { PlusPromoModal } from \"tiers/promo\";\r\nimport { setUpQTip } from \"view/tooltips\";\r\nimport { callApi } from \"../api/api\";\r\nimport { setGloballyStrokeThicknessTheme } from \"../apparatus/common\";\r\nimport { FileOpenModal } from \"../file/open_modal\";\r\nimport { LoggedInTierContextValue } from \"../tiers/context\";\r\nimport { maybeShowWelcome, WelcomeModal } from \"./modals/welcome\";\r\nvar DELAY_SUPPORT_SERVICE_LOAD_MS = 500;\r\nvar SENTRY_REPORT_DIALOG_OPTIONS = {\r\n    title: \"Oops! Chemix has unexpectedly crashed.\",\r\n    subtitle: \"We're sorry about this, our team has been notified. Please help us by providing additional information.\",\r\n    labelComments: \"Please describe in as much detail the last steps you took before the error happened:\",\r\n};\r\n/** Top-level App component. */\r\nvar App = /** @class */ (function (_super) {\r\n    __extends(App, _super);\r\n    function App(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        /** Reference to the editor container. Needed for image export. */\r\n        _this.editorContainerRef = React.createRef();\r\n        /** Reference to the Chemix Plus about modal. */\r\n        _this.aboutPlusModalRef = React.createRef();\r\n        /** Reference to the File open modal. */\r\n        _this.fileOpenModalRef = React.createRef();\r\n        /** Reference to Welcome modal. Can be null. */\r\n        _this.welcomeModalRef = React.createRef();\r\n        _this.render = function () {\r\n            if (_this.state.hasError) {\r\n                return React.createElement(\"div\", { key: \"error\", className: \"error-bar\" },\r\n                    React.createElement(\"i\", { className: \"fa fa-dizzy fa-2x mr-2\" }),\r\n                    \"Oops! Unfortunately Chemix has crashed.\",\r\n                    React.createElement(\"div\", { className: \"d-inline-block\" },\r\n                        React.createElement(\"button\", { type: \"button\", className: \"btn btn-outline-light mx-1\", onClick: function () { g('CrashBar', 'SentryUserReport'); Sentry.showReportDialog(__assign({ eventId: _this.state.errorId }, SENTRY_REPORT_DIALOG_OPTIONS)); } }, \"Report crash\"),\r\n                        React.createElement(\"button\", { type: \"button\", className: \"btn btn-outline-light mx-1\", onClick: function () { g('CrashBar', 'OpenChat'); Bcn.ask(); } }, \"Chat to us\"),\r\n                        React.createElement(\"button\", { type: \"button\", className: \"btn btn-outline-light mx-1\", onClick: function () { g('CrashBar', 'Reload'); window.location.reload(); } }, \"Reload Chemix\")));\r\n            }\r\n            return React.createElement(TierContext.Provider, { value: new LoggedInTierContextValue(_this.props.tier, function (label) { return _this.popup(label); }) },\r\n                React.createElement(TopBar, { key: \"topBar\", tool: _this.props.tool, auth: _this.props.auth, file: _this, cloudDiagramTitle: _this.props.cloudDiagramTitle }),\r\n                React.createElement(EditorContainer, __assign({ key: \"editorContainer\", ref: _this.editorContainerRef }, _this.props)),\r\n                React.createElement(PropertyPanelAdapter, { key: \"PropertyPanelAdapter\", selected: _this.props.selected, app: _this.editorContainerRef.current, theme: _this.props.theme }),\r\n                React.createElement(TabbedSidebar, { key: \"Sidebar\" }),\r\n                React.createElement(ScreenTooSmallWarning, { key: \"smallScreenWarning\", onPricingClick: function () { return _this.popup(\"BlockingScreen\"); } }),\r\n                React.createElement(PlusPromoModal, { key: \"aboutPlusModal\", auth: _this.props.auth, ref: _this.aboutPlusModalRef }),\r\n                React.createElement(FileOpenModal, { auth: _this.props.auth, ref: _this.fileOpenModalRef }),\r\n                React.createElement(WelcomeModal, { ref: _this.welcomeModalRef }));\r\n        };\r\n        _this.state = { hasError: false };\r\n        return _this;\r\n    }\r\n    App.prototype.componentDidMount = function () {\r\n        // Set up tooltips after everything has been rendered.\r\n        setUpQTip();\r\n        setUpQTip(\"#rotation-handle\", 1000, true);\r\n        // Set up keyboard short cuts.\r\n        setUpKeyboard();\r\n        // Hide the loading message.\r\n        $(\"#loading-message\").addClass(\"loaded\");\r\n        // Load support service (Beacon).\r\n        Bcn.init();\r\n        setTimeout(function () { return Bcn.load(); }, DELAY_SUPPORT_SERVICE_LOAD_MS);\r\n        // If there is a stored token, trigger a fetch to see\r\n        // if it is still valid. If it is, set up a session\r\n        // from it.\r\n        this.maybeRestoreAuthSession();\r\n        // Animate in the app. This is done by a CSS transition,\r\n        // by adding the \"loaded\" class.\r\n        $(\"#app\").addClass(\"loaded\");\r\n        // Return focus to app after remodal dialog closes.\r\n        $(document).on('closed', '.remodal', function (e) {\r\n            focusMainApp();\r\n        });\r\n        // Trigger welcome screen if not yet triggered.\r\n        if (this.welcomeModalRef.current) {\r\n            maybeShowWelcome(this.welcomeModalRef.current);\r\n        }\r\n        // Handle hash url.\r\n        this.handleUrlHash();\r\n        // Load Twitter widgets.\r\n        var twitterScript = document.createElement(\"script\");\r\n        twitterScript.src = \"https://platform.twitter.com/widgets.js\";\r\n        twitterScript.async = true;\r\n        document.body.appendChild(twitterScript);\r\n    };\r\n    App.prototype.componentDidUpdate = function (prevProps) {\r\n        // Update theme.\r\n        if (prevProps.theme.strokeThickness != this.props.theme.strokeThickness) {\r\n            setGloballyStrokeThicknessTheme(this.props.theme.strokeThickness);\r\n            // Force re-render every component.\r\n            for (var _i = 0, _a = this.props.items; _i < _a.length; _i++) {\r\n                var item = _a[_i];\r\n                disposeMarkSymbol();\r\n                var component = this.editorContainerRef.current.getApparatusComponent(item.id);\r\n                component === null || component === void 0 ? void 0 : component.forceCompleteRerender();\r\n                component === null || component === void 0 ? void 0 : component.forceUpdate();\r\n            }\r\n        }\r\n    };\r\n    App.prototype.exportImages = function () {\r\n        // This is bit hacky, we expose the export image methods on\r\n        // the editor container so that we can call into its\r\n        // child editor canvas.\r\n        return this.editorContainerRef.current.exportImages();\r\n    };\r\n    App.prototype.maybeRestoreAuthSession = function () {\r\n        var token = retrieveToken();\r\n        if (!token) {\r\n            clog(\"No token found to restore session from.\");\r\n            return;\r\n        }\r\n        callApi(\"reauth\", \"GET\", token, undefined, {\r\n            success: function (response) {\r\n                if (response.type == \"success\") {\r\n                    store.dispatch(logIn({\r\n                        provider: response.provider,\r\n                        jwtToken: response.jwt,\r\n                        user: response.user,\r\n                        // This should presumably be false.\r\n                        firstTimeLogin: response.firstTimeLogin,\r\n                        tier: response.tier,\r\n                    }));\r\n                }\r\n                else {\r\n                    clearToken();\r\n                    clog(\"Auth not restored from stored token.\");\r\n                }\r\n            },\r\n            generic: function () {\r\n                // On error, clear the token.\r\n                clearToken();\r\n            }\r\n        });\r\n    };\r\n    App.prototype.saveToCloud = function (params) {\r\n        var _this = this;\r\n        var _a;\r\n        var auth = appStore.getState().auth;\r\n        if (auth.state !== \"logged_in\")\r\n            return;\r\n        if (store.items().length == 0 && store.arrows().length == 0) {\r\n            toastr.warning(\"Cannot save an empty diagram\");\r\n            return;\r\n        }\r\n        // Extract thumbnail and current document data.\r\n        var thumbnail = this.editorContainerRef.current.exportThumbnail();\r\n        CloudFiles.save(auth, thumbnail, (_a = params === null || params === void 0 ? void 0 : params.forceNew) !== null && _a !== void 0 ? _a : false, {\r\n            onDiagramsLimitExceeded: function () { return _this.fetchDiagramsFromCloud(); }\r\n        });\r\n        commandProcessor.markClean();\r\n    };\r\n    App.prototype.fetchDiagramsFromCloud = function () {\r\n        var modal = this.fileOpenModalRef.current;\r\n        modal.open();\r\n        modal.refresh();\r\n    };\r\n    // Tier Handler interface.\r\n    App.prototype.popup = function (analyticsLabel) {\r\n        g(\"PromoPopup\", analyticsLabel !== null && analyticsLabel !== void 0 ? analyticsLabel : \"\");\r\n        this.aboutPlusModalRef.current.triggerOpen(analyticsLabel);\r\n    };\r\n    App.prototype.handleUrlHash = function () {\r\n        if (window.location.hash == \"#pricing\") {\r\n            this.popup(\"UrlHash\");\r\n            // Clear hash.\r\n            window.history.pushState(\"\", document.title, window.location.pathname + window.location.search);\r\n        }\r\n    };\r\n    // Error handling.\r\n    App.getDerivedStateFromError = function () {\r\n        return { hasError: true };\r\n    };\r\n    App.prototype.componentDidCatch = function (error, errorInfo) {\r\n        var _this = this;\r\n        // Report to Sentry: https://docs.sentry.io/platforms/javascript/react/\r\n        Sentry.withScope(function (scope) {\r\n            scope.setExtra(\"componentStack\", errorInfo.componentStack);\r\n            scope.setExtra(\"store\", extractDebugInfoFromStore());\r\n            scope.setTag(\"fatalcrash\", \"yes\");\r\n            Sentry.addBreadcrumb({ category: \"app\", level: Sentry.Severity.Fatal, message: \"Error captured at error boundary\" });\r\n            var eventId = Sentry.captureException(error);\r\n            // Only set the errorId once.\r\n            if (!_this.state.errorId) {\r\n                _this.setState({ errorId: eventId });\r\n                Sentry.showReportDialog(__assign({ eventId: eventId }, SENTRY_REPORT_DIALOG_OPTIONS));\r\n            }\r\n        });\r\n    };\r\n    return App;\r\n}(Component));\r\nexport { App };\r\n// React-Redux.\r\n/** Converts the Redux state to App component's props. */\r\nvar mapStateToProps = function (store, _) {\r\n    var _a;\r\n    var selectedItems = store.items.filter(function (item) { return item.selected; });\r\n    var selectedArrows = store.arrows.filter(function (arrow) { return arrow.selected; });\r\n    return {\r\n        zoom: store.zoom,\r\n        items: store.items,\r\n        arrows: store.arrows,\r\n        selected: new Selected(selectedItems, selectedArrows),\r\n        tool: store.tool,\r\n        auth: store.auth,\r\n        tier: store.tier,\r\n        cloudDiagramTitle: (_a = store.currentCloudDiagram) === null || _a === void 0 ? void 0 : _a.title,\r\n        theme: store.theme,\r\n    };\r\n};\r\n/** Container Component for App. */\r\nexport var ConnectedApp = connect(mapStateToProps)(App);\r\n","import { mirrorX, setDefaultStyle } from \"apparatus/draw\";\r\nimport { Segments } from \"apparatus/library/common\";\r\nimport { Path, Shape } from \"paper\";\r\nvar Tripod = /** @class */ (function () {\r\n    function Tripod() {\r\n    }\r\n    Tripod.prototype.render = function (appearance) {\r\n        var height = appearance.height;\r\n        var width = appearance.width;\r\n        var graphic = new Path(Segments([[-5, height]], [[0, height - 5], [0, 5]], [[0, 5]], [[5, 0], [-5, 0]]));\r\n        mirrorX(graphic, width / 2);\r\n        setDefaultStyle(graphic);\r\n        var hitShape = Shape.Rectangle(graphic.strokeBounds);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShape,\r\n            snapping: [\r\n                graphic.placeable(),\r\n                graphic.topEdgeAsPlaceableSurface(),\r\n            ]\r\n        };\r\n    };\r\n    Tripod.properties = {\r\n        label: \"Tripod\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            width: 120,\r\n            height: 190,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"width\", label: \"Width\",\r\n                min: 70, max: 180\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Height\",\r\n                min: 30, max: 250\r\n            }\r\n        ],\r\n    };\r\n    return Tripod;\r\n}());\r\nexport { Tripod };\r\n","import { addMarkers, mirrorX, setDefaultStyle } from \"apparatus/draw\";\r\nimport { P, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nvar Hydrometer = /** @class */ (function () {\r\n    function Hydrometer() {\r\n    }\r\n    Hydrometer.prototype.render = function (appearance) {\r\n        var glass = new Path(Segments([[5, -140], [0, -7]], [[5, 0], , [0, 5]], [[10, 10], [0, -5]], [[10, 70], , [0, 14]]));\r\n        mirrorX(glass);\r\n        glass.closePath();\r\n        var ballast = new Path(Segments([[10, 60], [0, -2]], [[10, 70], , [0, 14]]));\r\n        mirrorX(ballast);\r\n        ballast.close();\r\n        var outline = glass.clone();\r\n        // Style everything.\r\n        setDefaultStyle(outline);\r\n        glass.fillColor = \"#ffffffaa\";\r\n        ballast.fillColor = \"#555555\";\r\n        var graphic = new Group([glass, ballast, outline]);\r\n        addMarkers(graphic, P(3, 0), -140, P(0, -5), 4.0);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    Hydrometer.properties = {\r\n        label: \"Hydrometer\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {},\r\n        appearanceSpecs: [],\r\n    };\r\n    return Hydrometer;\r\n}());\r\nexport { Hydrometer };\r\n","import * as paper from \"paper\";\r\nimport { Debug } from \"vars\";\r\nexport function drawPivotAndCenter(group, color, size) {\r\n    if (size === void 0) { size = 5.0; }\r\n    if (!Debug.CENTERS)\r\n        return;\r\n    var center = paper.Shape.Circle(new paper.Point(0, 0), size);\r\n    center.fillColor = color;\r\n    group.addChild(center);\r\n    var pivotRect = new paper.Rectangle(group.pivot, new paper.Size(size * 2, size * 2));\r\n    var pivot = paper.Shape.Rectangle(pivotRect);\r\n    pivot.fillColor = color;\r\n    group.addChild(pivot);\r\n}\r\nexport function drawCircle(point, color) {\r\n    var circle = paper.Shape.Circle(point, 5);\r\n    circle.fillColor = color;\r\n}\r\n","// Shared ui elements for Promo popup\r\nimport * as React from \"react\";\r\nexport var Tick = function () { return (React.createElement(\"i\", { className: \"fa fa-check\" })); };\r\nexport var Info = function (props) { return (React.createElement(\"i\", { className: \"info_chip fa fa-info-circle ml-1\", title: props.hint })); };\r\nexport var InfoLink = function (props) { return (React.createElement(\"a\", { href: props.link, target: \"_blank\" },\r\n    React.createElement(Info, { hint: props.hint }))); };\r\nexport var BeaconLink = function (props) { return (React.createElement(\"a\", { className: \"info_chip fa fa-info-circle ml-1\", \"data-beacon-article-sidebar\": props.article, title: props.hint })); };\r\n","// The App's possible actions to modify the store.\r\nimport { createAction, createStandardAction } from \"typesafe-actions\";\r\n// Following tutorials:\r\n//  - https://github.com/piotrwitek/typesafe-actions#behold-the-mighty-tutorial\r\n//  - https://github.com/piotrwitek/react-redux-typescript-guide\r\n// Actions\r\n// 1. Define an action here.\r\n// 2. Define how it's resolved in terms of modifying the store, in reducer\r\nexport var addItems = createAction(\"chemix/ADD_ITEM\", function (resolve) {\r\n    return function (data) { return resolve(data); };\r\n});\r\nexport var addItemsAtIndices = createAction(\"chemix/ADD_ITEMS_AT_INDEX\", function (resolve) {\r\n    return function (data) { return resolve(data); };\r\n});\r\n/** Updates the appearance by modifying a single property. */\r\nexport var updateAppearance = createAction(\"chemix/UPDATE_APPEARANCE\", function (resolve) {\r\n    return function (id, key, value) { return resolve({ id: id, key: key, value: value }); };\r\n});\r\n/** Updates appearance by modifying a single property of multiple items of the same type. */\r\nexport var updateItemsAppearance = createAction(\"chemix/UPDATE_APPEARANCE_MULTI_ITEMS\", function (resolve) {\r\n    return function (key, values) {\r\n        var idsToValuesMap = {};\r\n        for (var _i = 0, values_1 = values; _i < values_1.length; _i++) {\r\n            var value = values_1[_i];\r\n            idsToValuesMap[value.id.id] = value.value;\r\n        }\r\n        return resolve({ key: key, idsToValuesMap: idsToValuesMap });\r\n    };\r\n});\r\n/**\r\n * Updates the appearance by modifying multiple properties of a single item. Works on Apparatus only.\r\n */\r\nexport var updateAppearanceProperties = createAction(\"chemix/UPDATE_APPEARANCE_PROPS\", function (resolve) {\r\n    return function (id, props) { return resolve({ id: id, props: props }); };\r\n});\r\n/** Updates the appearance of multiple properties of apparatus of the same type. Works on apparatus only. */\r\nexport var updateItemsAppearanceProperties = createAction(\"chemix/UPDATE_APPEARANCE_PROPS_MULTI_ITEMS\", function (resolve) {\r\n    return function (ids, props) { return resolve({ ids: ids, props: props }); };\r\n});\r\nexport var removeItems = createAction(\"chemix/REMOVE_ITEMS\", function (resolve) {\r\n    return function (ids) { return resolve({ ids: ids }); };\r\n});\r\nexport var removeFromGroup = createAction(\"chemix/REMOVE_FROM_GROUP\", function (resolve) {\r\n    return function (data) { return resolve(data); };\r\n});\r\nexport var addToGroup = createAction(\"chemix/ADD_TO_GROUP\", function (resolve) {\r\n    return function (data) { return resolve(data); };\r\n});\r\n/**\r\n * Note this only rotates apparatus, not arrows. It takes in an unsorted\r\n * dictionary of apparatus ID numbers desired rotation values.\r\n */\r\nexport var setItemsRotation = createAction(\"chemix/SET_ITEMS_ROTATION\", function (resolve) {\r\n    return function (rotations) { return resolve({ rotations: rotations }); };\r\n});\r\nexport var generic = createAction(\"chemix/GENERIC\", function (resolve) {\r\n    return function (name, actionFn) { return resolve({ name: name, actionFn: actionFn }); };\r\n});\r\n/** Switch the current active tool. */\r\nexport var switchTool = createAction(\"chemix/SWITCH_TOOL\", function (resolve) {\r\n    return function (tool) { return resolve(tool); };\r\n});\r\n/**\r\n * Erases items and arrows.\r\n * TODO: This is needed because refs stored in editor canvas\r\n * are based on ID only but not type. This means the same ID\r\n * could be reused for a different apparatus type, so the\r\n * refs are now pointing to old objects.\r\n */\r\nexport var eraseItems = createAction(\"chemix/CLEAR_ALL\", function (resolve) {\r\n    return function () { return resolve(); };\r\n});\r\n// File-related operations.\r\n/** Replace current state with given document. */\r\nexport var replace = createAction(\"chemix/REPLACE\", function (resolve) {\r\n    return function (diagram, isTemplate) { return resolve({ diagram: diagram, isTemplate: isTemplate }); };\r\n});\r\n/** Sets cloud information about current diagram, or resets it to null. */\r\nexport var setCloudDiagram = createStandardAction(\"chemix/SET_CLOUD_DIAGRAM\")();\r\n/** Updates the current theme thickness. */\r\nexport var setThemeStrokeThickness = createStandardAction(\"chemix/SET_THEME_STROKE\")();\r\n/** Resets state completely, should only be used for tests. */\r\nexport var _TESTONLY_resetState = createAction(\"chemix/TEST_ONLY_RESET_STATE\", function (resolve) {\r\n    return function (state) { return resolve(state); };\r\n});\r\n// Auth actions.\r\nexport var logIn = createAction(\"user/LOG_IN\", function (resolve) {\r\n    return function (data) { return resolve(data); };\r\n});\r\nexport var logOut = createAction(\"user/LOG_OUT\", function (resolve) {\r\n    return function () { return resolve(); };\r\n});\r\n","import { P, Pivot, R, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path, PointText } from \"paper\";\r\nvar LABEL_COLOR = \"#333333\";\r\nvar Microplate = /** @class */ (function () {\r\n    function Microplate() {\r\n    }\r\n    Microplate.prototype.render = function (appearance) {\r\n        var graphic = new Group();\r\n        var snapping = { type: \"spotting_tile\", at: [] };\r\n        graphic.addChild(new Path.Rectangle(R(-15, -15, 123, 87, Pivot.TOP_LEFT), 4.0)\r\n            .withStroke(\"default\", SharedColors.stroke)\r\n            .withFill(\"white\"));\r\n        for (var j = 0; j < 8; j++) {\r\n            var y = j * 9;\r\n            graphic.addChild(new PointText({\r\n                point: P(-9, y + 2),\r\n                content: String.fromCharCode(65 + j),\r\n                fillColor: LABEL_COLOR,\r\n                fontFamily: 'sans-serif',\r\n                fontSize: 5,\r\n                justification: \"center\",\r\n            }));\r\n            for (var i = 0; i < 12; i++) {\r\n                var x = i * 9;\r\n                if (j === 0) {\r\n                    graphic.addChild(new PointText({\r\n                        point: P(x, -7),\r\n                        content: (i + 1),\r\n                        fillColor: LABEL_COLOR,\r\n                        fontFamily: 'sans-serif',\r\n                        fontSize: 5,\r\n                        justification: \"center\",\r\n                    }));\r\n                }\r\n                var circle = new Path.Circle(P(x, y), 4).withStroke(\"thinner\", \"#666666\");\r\n                graphic.addChild(circle);\r\n                if (appearance.zoomed) {\r\n                    snapping.at.push(P(x * 4, y * 4));\r\n                }\r\n            }\r\n        }\r\n        if (appearance.zoomed) {\r\n            graphic.scale(4.0, P(0, 0));\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: snapping,\r\n        };\r\n    };\r\n    Microplate.properties = {\r\n        label: \"Microplate\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            zoomed: false\r\n        },\r\n        appearanceSpecs: [\r\n            { spec: \"checkbox\", key: \"zoomed\", label: \"Zoomed\" }\r\n        ],\r\n    };\r\n    return Microplate;\r\n}());\r\nexport { Microplate };\r\n","import { Pivot, R } from \"apparatus/library/common\";\r\nimport { Group, Shape } from \"paper\";\r\nvar DEFAULT_DIFFUSION_COLOUR = \"#eacdd2\";\r\nvar Agar = /** @class */ (function () {\r\n    function Agar() {\r\n    }\r\n    Agar.prototype.render = function (appearance) {\r\n        var width = appearance.width, height = appearance.height, color = appearance.color, diffused = appearance.diffused, diffusion = appearance.diffusion, diffusionColor = appearance.diffusionColor;\r\n        var core = Shape.Rectangle(R(0, 0, width, height)).withFill(color);\r\n        var graphic = new Group([core]);\r\n        // Distance of blending\r\n        var blend;\r\n        var gradient;\r\n        if (diffused) {\r\n            blend = Math.min(height, width) * diffusion * 0.5;\r\n            gradient = [[diffusionColor, 0.6], [diffusionColor + \"00\", 1.0]];\r\n        }\r\n        else {\r\n            blend = 5;\r\n            gradient = [[\"#ffffff40\", 0.0], [\"#ffffff00\", 1.0]];\r\n        }\r\n        var top = Shape.Rectangle(R(0, 0, width, blend)).withGradientFill(\"down\", gradient);\r\n        var right = Shape.Rectangle(R(width, 0, blend, height, Pivot.TOP_RIGHT)).withGradientFill(\"left\", gradient);\r\n        var bottom = Shape.Rectangle(R(0, height, width, blend, Pivot.BOTTOM_LEFT)).withGradientFill(\"up\", gradient);\r\n        var left = Shape.Rectangle(R(0, 0, blend, height)).withGradientFill(\"right\", gradient);\r\n        graphic.addChildren([top, right, bottom, left]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.expand(15).toShape()\r\n        };\r\n    };\r\n    Agar.properties = {\r\n        label: \"Agar cube\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            width: 40,\r\n            height: 40,\r\n            color: \"#b21f2a\",\r\n            diffused: false,\r\n            diffusion: 0.2,\r\n            diffusionColor: DEFAULT_DIFFUSION_COLOUR,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"width\", label: \"Width\",\r\n                min: 15, max: 80, unit: \"mm\"\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Height\",\r\n                min: 15, max: 80, unit: \"mm\"\r\n            },\r\n            {\r\n                spec: \"color\", key: \"color\", label: \"Colour\",\r\n            },\r\n            {\r\n                spec: \"checkbox\", key: \"diffused\", label: \"Diffused\",\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"diffusion\", label: \"Diffusion amount\",\r\n                min: 0.1, max: 0.9, step: 0.01, unit: \"%\",\r\n                visible: function (a) { return a.diffused; }\r\n            },\r\n            {\r\n                spec: \"color\", key: \"diffusionColor\", label: \"Diffusion colour\",\r\n                visible: function (a) { return a.diffused; }\r\n            },\r\n        ],\r\n    };\r\n    return Agar;\r\n}());\r\nexport { Agar };\r\n","import { Group, Path } from \"paper\";\r\nimport { mirrorX } from \"../../draw\";\r\nimport { P, Segments } from \"../common\";\r\nvar styrofoamGradient = [\r\n    [\"#999999\", 0.0],\r\n    [\"#bbbbbb\", 0.1],\r\n    [\"#bbbbbb\", 0.9],\r\n    [\"#888888\", 1.0],\r\n];\r\nvar CalorimetryCup = /** @class */ (function () {\r\n    function CalorimetryCup() {\r\n    }\r\n    CalorimetryCup.prototype.render = function (appearance) {\r\n        var size = appearance.size;\r\n        var radius = size / 4 + 10; // original size is 120, bottom radius 25\r\n        var cup = new Path(Segments([[radius + 1, 12]], [[radius + 2, 0]], [[radius, 0]], [[radius - 15, size]]));\r\n        mirrorX(cup);\r\n        var liquidMask = cup.clone();\r\n        cup.strokeWidth = 3.0;\r\n        cup.setGradientStroke(\"right\", styrofoamGradient);\r\n        var cupOutline = cup.clone();\r\n        cupOutline.strokeWidth = 5.0;\r\n        cupOutline.strokeColor = \"#666666\";\r\n        var graphic = new Group([cupOutline, cup]);\r\n        return {\r\n            graphic: graphic,\r\n            liquidMask: liquidMask,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: [\r\n                graphic.placeable(),\r\n                { type: \"neck\", top: P(0, -2), diameter: (radius) * 2, facing: 0 },\r\n            ]\r\n        };\r\n    };\r\n    CalorimetryCup.properties = {\r\n        label: \"Calorimetry cup\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            size: 120\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Height\",\r\n                min: 60, max: 150, unit: \"mm\"\r\n            }\r\n        ],\r\n    };\r\n    return CalorimetryCup;\r\n}());\r\nexport { CalorimetryCup };\r\n","import { smoothCorner, strokeWidth } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar WaterBath = /** @class */ (function () {\r\n    function WaterBath() {\r\n    }\r\n    WaterBath.prototype.render = function (appearance) {\r\n        var width = appearance.width, height = appearance.height;\r\n        var box = new Path(Segments([[0, 0]], [[width, 0]], [[width, height]], [[0, height]]));\r\n        box.closePath();\r\n        smoothCorner(box.segments[3], 10.0);\r\n        smoothCorner(box.segments[2], 10.0);\r\n        var liquidSpace = new Path(Segments([[10, -20]], [[width - 90, -20]], [[width - 90, height - 20]], [[10, height - 20]]));\r\n        liquidSpace.closePath();\r\n        var container = box.subtract(liquidSpace);\r\n        box.remove();\r\n        var panel = createPanel();\r\n        panel.position = P(width - 45, height - 50);\r\n        container\r\n            .withStroke(strokeWidth(\"default\"), \"#666666\")\r\n            .withGradientFill(\"down\", Gradients.box(\"#cccccc\".color()));\r\n        var graphic = new Group([container, panel]);\r\n        return {\r\n            graphic: graphic,\r\n            liquidMask: liquidSpace,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: [\r\n                {\r\n                    type: \"placeable_surface\",\r\n                    start: liquidSpace.strokeBounds.bottomLeft,\r\n                    end: liquidSpace.strokeBounds.bottomRight,\r\n                },\r\n                container.placeable(),\r\n            ]\r\n        };\r\n    };\r\n    WaterBath.properties = {\r\n        label: \"Water bath\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            width: 490,\r\n            height: 180,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"width\", label: \"Width\",\r\n                min: 280, max: 600\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Height\",\r\n                min: 120, max: 240\r\n            },\r\n        ],\r\n    };\r\n    return WaterBath;\r\n}());\r\nexport { WaterBath };\r\nfunction createPanel() {\r\n    var outside = Shape.Rectangle(R(0, 0, 70, 45), 4)\r\n        .withStroke(strokeWidth(\"default\"), \"#888888\")\r\n        .withFill(\"#f2f2f2\");\r\n    var lcd = Shape.Rectangle(R(10, 10, 50, 10))\r\n        .withStroke(strokeWidth(\"thinner\"), \"#578596\")\r\n        .withFill(\"#88c4db\");\r\n    var button1 = Shape.Rectangle(R(10, 25, 10, 10), 2)\r\n        .withFill(\"#7a7a7a\");\r\n    var button2 = button1.clone();\r\n    button2.position.x += 15;\r\n    var button3 = button1.clone();\r\n    button3.position.x += 30;\r\n    return new Group([outside, lcd, button1, button2, button3]);\r\n}\r\n","import { P, SharedColors, SharedGradients } from \"apparatus/library/common\";\r\nimport { CompoundPath, Group, Path } from \"paper\";\r\n/**\r\n * https://www.timstar.co.uk/en120975-timstar-choice-chamber.html\r\n */\r\nvar ChoiceChamber = /** @class */ (function () {\r\n    function ChoiceChamber() {\r\n    }\r\n    ChoiceChamber.prototype.render = function (appearance) {\r\n        var outline = new Path.Circle(P(0, 0), 100);\r\n        var vertical = new Path.Line(P(0, -100), P(0, 100));\r\n        var horizontal = new Path.Line(P(-100, 0), P(100, 0));\r\n        var graphic = new Group([outline, vertical, horizontal]).withStroke(\"default\");\r\n        if (appearance.darkHalf) {\r\n            graphic.insertChild(0, new Path.Arc(P(0, -100), P(-100, 0), P(0, 100)).close().withFill(\"#444444\"));\r\n        }\r\n        if (appearance.lid) {\r\n            var lid = new CompoundPath([]);\r\n            lid.fillRule = \"evenodd\";\r\n            lid.addChild(new Path.Circle(P(0, 0), 102));\r\n            lid.addChild(new Path.Circle(P(0, 0), 20));\r\n            lid.withStroke(\"default\", SharedColors.glassEdge)\r\n                .withGradientFill(\"right-down\", SharedGradients.glass);\r\n            graphic.addChild(lid);\r\n        }\r\n        graphic.scale(appearance.scale);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    ChoiceChamber.properties = {\r\n        label: \"Choice Chamber\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            scale: 1.0,\r\n            lid: true,\r\n            darkHalf: false,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.7, max: 2, step: 0.01, unit: \"%\"\r\n            },\r\n            {\r\n                spec: \"checkbox-group\", label: \"Options\", checkboxes: [\r\n                    { key: \"lid\", label: \"Add lid\" },\r\n                    { key: \"darkHalf\", label: \"Half-dark\" },\r\n                ]\r\n            }\r\n        ],\r\n    };\r\n    return ChoiceChamber;\r\n}());\r\nexport { ChoiceChamber };\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n// Wrapper for Bootstrap color picker 3.1.2\r\nimport { ComboSlider } from \"components/combo_slider\";\r\nimport * as React from \"react\";\r\n/** CSS class to locate the element that is used to set up the color picker. */\r\nexport var BOOTSTRAP_COLORPICKER_CSS_SELECTOR = \".ui-colorpicker2 .colorpicker-element\";\r\nexport var DEFAULT_SWATCHES = {\r\n    'Blue': '#80cce6',\r\n    'Red': '#e33d4d',\r\n    'Green': '#3ac433',\r\n    'Yellow': '#d7d725',\r\n    'Gray': '#a0a0a0',\r\n    'Purple': '#ca57a4',\r\n};\r\nvar ColorPicker = /** @class */ (function (_super) {\r\n    __extends(ColorPicker, _super);\r\n    function ColorPicker(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.ref = React.createRef();\r\n        _this.state = { value: props.value };\r\n        _this.swatches = props.swatches || DEFAULT_SWATCHES;\r\n        return _this;\r\n    }\r\n    ColorPicker.prototype.componentDidMount = function () {\r\n        var jqElement = $(this.ref.current);\r\n        var self = this;\r\n        // 1. If adding any event handlers, make sure to remove them\r\n        //    in componentWillUnmount\r\n        // 2. When invoking callbacks with color values, remember convert\r\n        //    color values to lower case, so that colors can be compared.\r\n        jqElement\r\n            .val(this.props.value)\r\n            .colorpicker({\r\n            color: this.state.value,\r\n            popover: {\r\n                placement: \"left\",\r\n                boundary: \"window\",\r\n            },\r\n            extensions: [\r\n                {\r\n                    name: 'swatches',\r\n                    options: {\r\n                        colors: this.swatches,\r\n                        nameAsValues: true,\r\n                    }\r\n                },\r\n                { name: \"manualinput\" },\r\n                { name: \"extrabuttons\" },\r\n            ],\r\n        })\r\n            .on('colorpickerChange', function (e) {\r\n            if (e.color) {\r\n                var color = e.color.toString().toLowerCase();\r\n                self.setState({ value: color });\r\n                self.props.onColorChange(color);\r\n            }\r\n        })\r\n            .on('colorpickerHide', function (e) {\r\n            if (e.color) {\r\n                var color = e.color.toString().toLowerCase();\r\n                self.setState({ value: color });\r\n                self.props.onColorEnd(color);\r\n            }\r\n        });\r\n    };\r\n    ColorPicker.prototype.componentDidUpdate = function (prevProps, prevState) {\r\n        // Only update on props changes.\r\n        if (prevProps.value != this.props.value) {\r\n            var jqElement = $(this.ref.current);\r\n            jqElement.colorpicker('setValue', this.props.value);\r\n        }\r\n    };\r\n    ColorPicker.prototype.componentWillUnmount = function () {\r\n        var jqElement = $(this.ref.current);\r\n        var color = jqElement.colorpicker('getValue');\r\n        if (color) {\r\n            this.props.onColorEnd(color.toString().toLowerCase());\r\n        }\r\n        // Hide & Remove event handlers.\r\n        jqElement.off('colorpickerChange');\r\n        jqElement.off('colorpickerHide');\r\n        jqElement.colorpicker('hide');\r\n    };\r\n    ColorPicker.prototype.renderOld = function () {\r\n        return React.createElement(\"div\", { className: \"ui-colorpicker\" },\r\n            React.createElement(\"input\", { ref: this.ref, style: { \"borderRightColor\": this.state.value } }));\r\n    };\r\n    ColorPicker.prototype.maybeMapValueToSwatchName = function () {\r\n        var value = this.state.value;\r\n        for (var name_1 in this.swatches) {\r\n            if (this.swatches[name_1] == value) {\r\n                return name_1;\r\n            }\r\n        }\r\n        return value;\r\n    };\r\n    ColorPicker.prototype.render = function () {\r\n        var _a, _b;\r\n        var opacity = this.props.opacity;\r\n        return React.createElement(\"div\", { className: \"ui-colorpicker2\" },\r\n            React.createElement(\"div\", { ref: this.ref },\r\n                React.createElement(\"div\", { className: \"colorpicker-input-addon\", style: { \"backgroundColor\": this.state.value } }),\r\n                React.createElement(\"input\", { className: \"d-none\" })),\r\n            opacity == undefined\r\n                ? this.maybeMapValueToSwatchName()\r\n                : React.createElement(ComboSlider, { key: \"opacitySlider\", min: ((_a = opacity.range) !== null && _a !== void 0 ? _a : [0, 1])[0], max: ((_b = opacity.range) !== null && _b !== void 0 ? _b : [0, 1])[1], step: 0.01, unit: \"%\", initialValue: opacity.value, onChange: opacity.onChange, onEnd: opacity.onEnd }));\r\n    };\r\n    return ColorPicker;\r\n}(React.Component));\r\nexport { ColorPicker };\r\n","import { strokeWidth } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, Segments } from \"apparatus/library/common\";\r\nimport { Color, Gradient, Group, Path } from \"paper\";\r\nvar Scalpel = /** @class */ (function () {\r\n    function Scalpel() {\r\n    }\r\n    Scalpel.prototype.render = function (appearance) {\r\n        var handle = new Path(Segments([[169, -3], [-13, 0], [10, 0]], [[169, 14], [9, 0], [-22, 0]], [[63, 10]], [[55, -1]]));\r\n        handle.withGradientFill(\"left\", Gradients.simple(\"#eeeeee\".color()))\r\n            .withStroke(strokeWidth(\"thinner\"), \"#cccccc\");\r\n        handle.closePath();\r\n        var blade = new Path(Segments([[1, 1], [2, 8], [5, -3]], [[60, 0]], [[63, 6]], [[57, 9], , [-5, -2]], [[40, 10], [4, -2], [-20, 0]], [[15, 10]]));\r\n        blade.closePath();\r\n        blade.fillColor = new Color(new Gradient(Gradients.cylinder(\"#dddddd\".color(), 3)), P(0, 0), P(40, 40));\r\n        blade.withStroke(strokeWidth(\"thinner\"), \"#aaaaaa\");\r\n        var graphic = new Group([blade, handle]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    Scalpel.properties = {\r\n        label: \"Scalpel\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {},\r\n        appearanceSpecs: [],\r\n    };\r\n    return Scalpel;\r\n}());\r\nexport { Scalpel };\r\n","import { P, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nvar Shoot = /** @class */ (function () {\r\n    function Shoot() {\r\n    }\r\n    Shoot.prototype.render = function (appearance) {\r\n        var height = appearance.height, bend = appearance.bend;\r\n        var cap = appearance.cut ? \"butt\" : \"round\";\r\n        var base = new Path(Segments([[0, 0], , [0, -height * 0.7]], [[0, -height]]));\r\n        var pivot = P(0, -0.6 * height);\r\n        base.segments[1].point = base.segments[1].point.rotate(bend, pivot);\r\n        base.strokeWidth = 20;\r\n        base.strokeCap = cap;\r\n        var highlight = base.clone();\r\n        highlight.position.x -= 5;\r\n        if (appearance.cut && bend < 0) {\r\n            var delta = pivot.subtract(base.segments[1].point).normalize();\r\n            highlight.segments[1].point = highlight.segments[1].point.add(delta.multiply(5));\r\n        }\r\n        base.strokeColor = \"#90bb79\";\r\n        highlight.strokeWidth = 6;\r\n        highlight.strokeColor = \"#b4d3a3\";\r\n        highlight.strokeCap = cap;\r\n        var graphic = new Group([base, highlight]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.strokeBounds.expand(10).toShape(),\r\n            pivot: P(0, 0)\r\n        };\r\n    };\r\n    Shoot.properties = {\r\n        label: \"Straight shoot\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            bend: 0,\r\n            height: 150,\r\n            cut: false,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Height\",\r\n                min: 50, max: 180, unit: \"mm\"\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"bend\", label: \"Bending\",\r\n                min: -40, max: 40\r\n            },\r\n            {\r\n                spec: \"checkbox\", key: \"cut\", label: \"Slice cap\"\r\n            }\r\n        ],\r\n    };\r\n    return Shoot;\r\n}());\r\nexport { Shoot };\r\n","import { CenterR, P, Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, PointText, Shape } from \"paper\";\r\nimport { setDefaultStyle } from \"../../draw\";\r\nvar PhProbe = /** @class */ (function () {\r\n    function PhProbe() {\r\n        this.drivers = [\r\n            {\r\n                type: \"rectangle\",\r\n                minX: -150, maxX: 150,\r\n                minY: 0, maxY: 200,\r\n                toAppearance: function (p) { return ({ probeX: p.x, probeY: p.y }); },\r\n                fromAppearance: function (a) { return P(a.probeX, a.probeY); },\r\n                scale: 1.0,\r\n            }\r\n        ];\r\n    }\r\n    PhProbe.prototype.render = function (appearance) {\r\n        var probeOffsetX = appearance.probeX;\r\n        var probeOffsetY = appearance.probeY;\r\n        // Create a reader\r\n        var casing = Shape.Rectangle(R(0, 0, 60, 100, Pivot.TOP_CENTER), 4);\r\n        casing.fillColor = \"#dddddd\";\r\n        setDefaultStyle(casing);\r\n        var screen = Shape.Rectangle(R(0, 7, 46, 25, Pivot.TOP_CENTER), 2);\r\n        screen.strokeWidth = 2.0;\r\n        screen.strokeColor = \"#777777\";\r\n        screen.fillColor = \"white\";\r\n        var button = Shape.Circle(P(-10, 80), 7);\r\n        button.fillColor = \"#54b347\";\r\n        button.strokeWidth = 2.0;\r\n        button.strokeColor = \"#498241\";\r\n        var button2 = Shape.Circle(P(10, 80), 7);\r\n        button2.fillColor = \"#54b347\";\r\n        button2.strokeWidth = 2.0;\r\n        button2.strokeColor = \"#498241\";\r\n        var display = new PointText({\r\n            point: P(0, 25),\r\n            content: appearance.reading,\r\n            fillColor: 'black',\r\n            fontFamily: 'sans-serif',\r\n            fontSize: 15,\r\n            justification: \"center\",\r\n        });\r\n        var phLabel = new PointText({\r\n            point: P(-20, 50),\r\n            content: \"pH\",\r\n            fillColor: \"#888888\",\r\n            fontFamily: 'sans-serif',\r\n            fontSize: 14,\r\n            justification: \"left\",\r\n        });\r\n        var reader = new Group([casing, screen, display, phLabel, button, button2]);\r\n        // Create the probe\r\n        var probeRod = Shape.Rectangle(CenterR(0, 60, 10, 120));\r\n        probeRod.setGradientFill(\"right\", [[\"#cccccc\", 0.0], [\"#aaaaaa\", 1.0]]);\r\n        var probeTop = Shape.Rectangle(CenterR(0, 15, 15, 30));\r\n        probeTop.fillColor = \"#333333\";\r\n        var probe = new Group([probeRod, probeTop]);\r\n        probe.position = probe.position.add(P(probeOffsetX, probeOffsetY));\r\n        // Create the wire.\r\n        var wire = new Path(Segments([[0, 100], undefined, [0, 50]], // Connects to the casing.\r\n        [[probeOffsetX, probeOffsetY], [0, -50]]));\r\n        setDefaultStyle(wire);\r\n        var graphic = new Group([reader, probe, wire]);\r\n        var hitShapes = [\r\n            probe.bounds.toShape(),\r\n            reader.bounds.toShape(),\r\n        ];\r\n        return {\r\n            graphic: graphic, hitShape: hitShapes, pivot: casing.bounds.center,\r\n        };\r\n    };\r\n    PhProbe.convertToLatest = function (old) {\r\n        if (!old.x) {\r\n            old.probeX = old.position == \"right\" ? 150 : -150;\r\n            old.probeY = 100;\r\n        }\r\n        return old;\r\n    };\r\n    PhProbe.properties = {\r\n        label: \"pH Probe\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            reading: \"7.0\",\r\n            probeX: 150,\r\n            probeY: 100,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"text\", key: \"reading\", label: \"Reading\",\r\n                numbersOnly: true, maxLength: 5,\r\n            },\r\n        ],\r\n    };\r\n    return PhProbe;\r\n}());\r\nexport { PhProbe };\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { g } from \"analytics\";\r\nimport { BACKEND_API } from \"api/api\";\r\nimport { reauthFromCurrentLogin } from \"api/auth/reauth\";\r\nimport { HorizontalButtonsSwitcher } from \"components/button\";\r\nimport { Select } from \"components/select\";\r\nimport { Slider } from \"components/slider\";\r\nimport Flags from \"flags\";\r\nimport * as React from 'react';\r\nimport { useState } from \"react\";\r\nimport { Articles, Bcn } from \"support/beacon\";\r\nimport { TierContext } from \"tiers/context\";\r\nimport { currencyLabel, currencySymbol } from \"tiers/currency\";\r\nimport { BeaconLink } from \"tiers/promo_ui\";\r\nimport { releasedAndFreeItemsCount, releasedItemsCount } from \"../apparatus/specList\";\r\nimport { BOOST_TOTAL_DIAGRAMS, ITEM_CUSTOMISATIONS, MAX_BOOST_DIAGRAM_LAYERS } from \"./promo\";\r\nvar TRIAL_DAYS = 7;\r\nvar SUPPORTED_CURRENCIES = [\"gbp\", \"usd\", \"eur\", \"aud\", \"sgd\", \"mxn\", \"cop\"];\r\nvar BillingSwitcher = /** @class */ (function (_super) {\r\n    __extends(BillingSwitcher, _super);\r\n    function BillingSwitcher() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return BillingSwitcher;\r\n}(HorizontalButtonsSwitcher));\r\nvar PlansGrid = /** @class */ (function (_super) {\r\n    __extends(PlansGrid, _super);\r\n    function PlansGrid(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.render = function () { return (React.createElement(React.Fragment, null,\r\n            React.createElement(\"div\", { className: \"text-center mx-2 mb-3\" },\r\n                React.createElement(\"div\", { className: \"d-inline-block mb-2\" },\r\n                    React.createElement(\"b\", null, \"Currency: \"),\r\n                    React.createElement(Select, { id: \"currency_selector\", key: \"currency_selector\", value: _this.getCurrency(), extraClass: \"w-auto d-inline ml-1 mr-4\", onSelectChange: function (_, current) { return _this.setState({ currency: current }); }, options: SUPPORTED_CURRENCIES.map(function (c) { return ({ value: c, label: currencyLabel(c) }); }) })),\r\n                React.createElement(\"div\", { className: \"d-inline-block mb-2\" },\r\n                    React.createElement(\"b\", null, \"Billing: \"),\r\n                    React.createElement(BillingSwitcher, { className: \"d-inline-block ml-1\", onSwitch: function (b) { return _this.setState({ billing: b }); }, defaultValue: _this.state.billing, extraClass: \"narrower\", options: [\r\n                            { value: \"month\", icon: \"\", buttonLabel: \"Monthly\" },\r\n                            { value: \"year\", icon: \"\", buttonLabel: \"Yearly\" },\r\n                        ] }))),\r\n            React.createElement(\"div\", { className: \"row mx-2\" },\r\n                React.createElement(PlanSelector, { onCheckout: function (p) { return _this.props.onCheckout(p, _this.getCurrency(), _this.state.billing); }, onUpdateSchoolPlan: _this.props.onUpdateSchoolPlan, signedIn: _this.props.signedIn, billing: _this.state.billing, currency: _this.getCurrency() })))); };\r\n        _this.state = { billing: \"year\", showTable: true };\r\n        var self = _this;\r\n        _this.checkoutMessageHandler = function (ev) {\r\n            // Filter any messages that are not from our API,\r\n            // don't relate to this provider or while\r\n            // the button is not active.\r\n            if (ev.origin != BACKEND_API)\r\n                return;\r\n            var response = ev.data;\r\n            self.onReceiveCheckoutSuccessMessage(response);\r\n        };\r\n        window.addEventListener(\"message\", _this.checkoutMessageHandler, true);\r\n        return _this;\r\n    }\r\n    PlansGrid.prototype.onReceiveCheckoutSuccessMessage = function (message) {\r\n        var _a;\r\n        if (message.type == \"checkout_success\") {\r\n            reauthFromCurrentLogin();\r\n            toastr.success(\"You can now enjoy full features of Chemix!\", \"Congratulations! You are now a \" + ((_a = message.tier) === null || _a === void 0 ? void 0 : _a.capitalise()) + \" user!\");\r\n            this.props.onClose();\r\n            g(\"Checkout\", \"Success\");\r\n            if (this.props.analyticsTag) {\r\n                g(\"Checkout-AnalyticsTag\", this.props.analyticsTag);\r\n            }\r\n        }\r\n        else if (message.type == \"checkout_error\") {\r\n            toastr.error(\"Please click on 'My Account' and select 'Refresh Purchase'. If issues persist, email support@chemix.org.\", \"Failed to complete purchase.\");\r\n            g(\"Checkout\", \"Error\");\r\n        }\r\n    };\r\n    PlansGrid.prototype.getCurrency = function () {\r\n        var _a, _b;\r\n        return (_b = (_a = this.state.currency) !== null && _a !== void 0 ? _a : this.props.defaultCurrency) !== null && _b !== void 0 ? _b : \"usd\";\r\n    };\r\n    return PlansGrid;\r\n}(React.Component));\r\nexport { PlansGrid };\r\nvar ExportHighQuality = function () {\r\n    return React.createElement(Item, { icon: \"image\" },\r\n        React.createElement(\"b\", null, \"High\"),\r\n        \" image quality\",\r\n        React.createElement(BeaconLink, { hint: \"4MP (Up to 2400x1600). <br/>Click to learn more\", article: Articles.IMAGE_QUALITY }));\r\n};\r\nexport var BoostFeatureList = function () { return React.createElement(React.Fragment, null,\r\n    React.createElement(Item, { icon: \"arrow-left\" },\r\n        \"Everything included in \",\r\n        React.createElement(\"b\", null, \"Start\")),\r\n    React.createElement(Item, null,\r\n        React.createElement(\"b\", null, ITEM_CUSTOMISATIONS),\r\n        \" extra item customisations\"),\r\n    React.createElement(Item, null,\r\n        \"Easily write formulas, units and symbols with \",\r\n        React.createElement(\"b\", null, \"ChemText\"),\r\n        React.createElement(BeaconLink, { hint: \"When writing text, automatically convert H2SO4 to H\\u2082SO\\u2084. <br/>Click to learn more\", article: Articles.CHEMTEXT })),\r\n    React.createElement(Item, null, \"More text style options\"),\r\n    React.createElement(Item, null,\r\n        \"Add up to \",\r\n        React.createElement(\"b\", null, MAX_BOOST_DIAGRAM_LAYERS),\r\n        \" liquid layers\"),\r\n    Flags.isNewTemplatesEnabled ? React.createElement(Item, null, \"More diagram templates\") : undefined,\r\n    React.createElement(Item, null, \"Download as SVG\"),\r\n    React.createElement(Item, null,\r\n        \"Permission for publishing and commercial use\",\r\n        React.createElement(BeaconLink, { hint: \"Allows mass and commerical distribution of material containing diagrams made with Chemix.<br/>Click to learn more\", article: Articles.LICENSE })),\r\n    React.createElement(Item, null, \"No social widgets\")); };\r\nfunction mapSliderValueToStudents(value) {\r\n    var students = 200;\r\n    students += Math.min(value, 30) * 10;\r\n    value -= 30;\r\n    if (value <= 0)\r\n        return students;\r\n    students += Math.min(value, 30) * 50;\r\n    value -= 30;\r\n    if (value <= 0)\r\n        return students;\r\n    students += value * 100;\r\n    return students;\r\n}\r\n// Computes the total number of diagrams for a school of given student size.\r\n// Derived from https://docs.google.com/spreadsheets/d/1LNK9C4RMyJNWCBTed5ByMtxC3DTq-7JqrJyCvslwzLo/edit#gid=2014288311\r\nfunction diagramLimit(students) {\r\n    var diagrams = Math.log((students + 1150) / 100) / Math.LN10 * 7000 - 7500 + students * 2;\r\n    return diagrams.round(-2);\r\n}\r\nvar PlanSelector = function (props) {\r\n    var _a = useState(30), sliderValue = _a[0], setSliderValue = _a[1]; // 30 is equivalent to 500 students.\r\n    var students = mapSliderValueToStudents(sliderValue);\r\n    var maxDiagrams = diagramLimit(students);\r\n    React.useEffect(function () {\r\n        props.onUpdateSchoolPlan({ students: students, maxDiagrams: maxDiagrams });\r\n    }, [students, maxDiagrams]);\r\n    return React.createElement(TierContext.Consumer, null, function (tiers) { return (React.createElement(React.Fragment, null,\r\n        React.createElement(Plan, null,\r\n            React.createElement(\"div\", { className: \"plan-header\" },\r\n                React.createElement(\"h3\", null,\r\n                    React.createElement(\"i\", { className: \"fa fa-vial mr-2\" }),\r\n                    \"Start\"),\r\n                React.createElement(Price, { currency: props.currency, billing: props.billing }),\r\n                \"Create great lab diagrams. \",\r\n                React.createElement(\"br\", null),\r\n                \"Available for everyone.\",\r\n                React.createElement(\"br\", null),\r\n                \"Free forever.\",\r\n                React.createElement(\"br\", null)),\r\n            React.createElement(SignInButton, { currentTier: tiers.tier, signedIn: props.signedIn, onCheckout: props.onCheckout }),\r\n            React.createElement(\"ul\", { className: \"fa-ul feature-list\" },\r\n                React.createElement(Item, { icon: \"flask\" },\r\n                    React.createElement(\"b\", null, releasedAndFreeItemsCount),\r\n                    \" available apparatus\"),\r\n                React.createElement(Item, { icon: \"image\" },\r\n                    React.createElement(\"b\", null, \"Low\"),\r\n                    \" image quality\",\r\n                    React.createElement(BeaconLink, { hint: \"0.5MP (Up to 800x600). <br/>Click to learn more\", article: Articles.IMAGE_QUALITY })),\r\n                React.createElement(Item, { icon: \"infinity fas\" }, \"Unlimited image exports\"),\r\n                React.createElement(Item, { icon: \"cloud\" },\r\n                    \"Store \",\r\n                    React.createElement(\"b\", null, \"3\"),\r\n                    \" diagrams in Cloud\"),\r\n                React.createElement(\"hr\", null),\r\n                React.createElement(Item, null, \"Download as JPG\"),\r\n                React.createElement(Item, null, \"Download as PNG\"),\r\n                React.createElement(Item, null, \"Transparent PNG\"),\r\n                React.createElement(Item, null,\r\n                    \"For educational use\",\r\n                    React.createElement(BeaconLink, { hint: \"You can use Chemix diagrams in your teaching materials and student handouts distributed in a limited setting, such as a class.<br/>Click to learn more\", article: Articles.LICENSE })))),\r\n        React.createElement(Plan, { extraClass: \"boost\" },\r\n            React.createElement(\"div\", { className: \"plan-header\" },\r\n                React.createElement(\"h3\", null,\r\n                    React.createElement(\"i\", { className: \"fa fa-bolt mr-2\" }),\r\n                    \"Boost\"),\r\n                React.createElement(Price, { price: PRICES[\"boost\"][props.currency][props.billing], currency: props.currency, billing: props.billing }),\r\n                \"Unlock all features.\",\r\n                React.createElement(\"br\", null),\r\n                \"For teachers and students.\",\r\n                React.createElement(\"br\", null),\r\n                TRIAL_DAYS,\r\n                \"-day trial. Billed \",\r\n                props.billing,\r\n                \"ly.\",\r\n                React.createElement(DiscountTag, { billing: props.billing })),\r\n            React.createElement(SignInButton, { tier: \"boost\", currentTier: tiers.tier, signedIn: props.signedIn, onCheckout: props.onCheckout }),\r\n            React.createElement(\"ul\", { className: \"fa-ul feature-list\" },\r\n                React.createElement(Item, { icon: \"flask\" },\r\n                    React.createElement(\"b\", null, releasedItemsCount),\r\n                    \" available apparatus\"),\r\n                React.createElement(ExportHighQuality, null),\r\n                React.createElement(Item, { icon: \"infinity fas\" }, \"Unlimited image exports\"),\r\n                React.createElement(Item, { icon: \"cloud\" },\r\n                    \"Store \",\r\n                    React.createElement(\"b\", null, BOOST_TOTAL_DIAGRAMS),\r\n                    \" diagrams in Cloud\"),\r\n                React.createElement(\"hr\", null),\r\n                React.createElement(BoostFeatureList, null))),\r\n        React.createElement(Plan, { extraClass: \"school\" },\r\n            React.createElement(\"div\", { className: \"plan-header\" },\r\n                React.createElement(\"h3\", null,\r\n                    React.createElement(\"i\", { className: \"fa fa-university mr-2\" }),\r\n                    \"Schools\"),\r\n                React.createElement(Price, { price: schoolPricing(students, props.currency, props.billing), currency: props.currency, billing: props.billing }),\r\n                \"For teachers and students\",\r\n                React.createElement(\"br\", null),\r\n                \"in schools and districts.\",\r\n                React.createElement(\"br\", null),\r\n                \"Estimate for \",\r\n                students,\r\n                \" students.\",\r\n                React.createElement(\"div\", { className: \"mt-3 mr-1\" },\r\n                    React.createElement(Slider, { min: 0, max: 90, step: 1, pipsStep: 30, initialValue: sliderValue, onChange: function (value) { return setSliderValue(value); }, onEnd: function (_, final) { return setSliderValue(final); } })),\r\n                React.createElement(DiscountTag, { billing: props.billing })),\r\n            React.createElement(\"div\", { className: \"p-2\" },\r\n                React.createElement(\"div\", { className: \"d-block ui-button\", onClick: function () { return sendEmail(students); } }, \"Request a quote\")),\r\n            React.createElement(\"ul\", { className: \"fa-ul feature-list\" },\r\n                React.createElement(Item, { icon: \"flask\" },\r\n                    React.createElement(\"b\", null, releasedItemsCount),\r\n                    \" available apparatus\"),\r\n                React.createElement(ExportHighQuality, null),\r\n                React.createElement(Item, { icon: \"infinity fas\" }, \"Unlimited image exports\"),\r\n                React.createElement(Item, { icon: \"cloud\" },\r\n                    \"Store \",\r\n                    React.createElement(\"b\", null, maxDiagrams),\r\n                    \" diagrams in Cloud\"),\r\n                React.createElement(\"hr\", null),\r\n                React.createElement(Item, { icon: \"arrow-left\" },\r\n                    \"Everything included in \",\r\n                    React.createElement(\"b\", null, \"Boost\")),\r\n                React.createElement(Item, null,\r\n                    \"Access for \",\r\n                    React.createElement(\"b\", null, students),\r\n                    \" students\"),\r\n                React.createElement(Item, null, \"Access for teachers included\"),\r\n                React.createElement(Item, null, \"Sign in using school email\"))))); });\r\n};\r\nvar DiscountTag = function (props) { return (props.billing == \"year\"\r\n    ? React.createElement(\"span\", { className: \"discount-tag\" }, \"Save 20%\")\r\n    : null); };\r\nvar sendEmail = function (estimateStudents) {\r\n    Bcn.openSchoolEnquiry(estimateStudents);\r\n    // window.open(\"mailto:info@chemix.org?subject=Chemix: School subscription&body=Please fill in these details. We will get back to you as soon as possible. %0D%0AYour name: %0D%0AContact email: %0D%0ASchool name: %0D%0ANumber of students (estimate):%20\" + estimateStudents)\r\n};\r\nvar SignInButton = function (props) {\r\n    if (!props.signedIn) {\r\n        // If the user is not signed in, they are automatically on the basic tier.\r\n        if (!props.tier)\r\n            return React.createElement(YourCurrentPlan, null);\r\n        return React.createElement(SignInToUpgrade, null);\r\n    }\r\n    if ((!props.tier && !props.currentTier) || props.tier === props.currentTier) {\r\n        return React.createElement(YourCurrentPlan, null);\r\n    }\r\n    else if (props.tier === \"boost\" && !props.currentTier) {\r\n        return React.createElement(UpgradeButton, { tier: \"boost\", onClick: function () { return props.onCheckout(\"boost\"); } });\r\n    }\r\n    else if (props.tier === \"plus\" && !props.currentTier) {\r\n        return React.createElement(UpgradeButton, { tier: \"plus\", onClick: function () { return props.onCheckout(\"plus\"); } });\r\n    }\r\n    else {\r\n        return React.createElement(\"div\", { className: \"invisible\" },\r\n            React.createElement(YourCurrentPlan, null));\r\n    }\r\n};\r\nvar YourCurrentPlan = function () { return (React.createElement(\"div\", { className: \"py-2 px-3 text-center\" },\r\n    React.createElement(\"div\", { className: \"d-block ui-button-inactive\" }, \"Your current plan.\"))); };\r\nvar SignInToUpgrade = function () { return (React.createElement(\"div\", { className: \"mt-auto py-2 px-3\" },\r\n    React.createElement(\"div\", { className: \"d-block ui-button\", \"data-toggle\": \"collapse\", \"data-target\": \"#promoSignInSection\", onClick: function () {\r\n            return $('.remodal-is-opened').animate({\r\n                scrollTop: $(\"#promoSignInSection\").position().top - 300\r\n            }, 700);\r\n        } }, \"Sign in to upgrade\"))); };\r\nvar UPGRADE_BUTTON_TIMEOUT_MS = 4000;\r\n/**\r\n * Upgrade button. Is unclickable for few seconds after being clicked,\r\n * showing a spinner.\r\n */\r\nvar UpgradeButton = function (props) {\r\n    var _a = React.useState(false), pending = _a[0], setPending = _a[1];\r\n    function onClick() {\r\n        if (pending)\r\n            return;\r\n        props.onClick();\r\n        setPending(true);\r\n        setTimeout(function () { setPending(false); }, UPGRADE_BUTTON_TIMEOUT_MS);\r\n    }\r\n    return React.createElement(\"div\", { className: \"mt-auto p-2\" },\r\n        React.createElement(\"div\", { className: \"d-block ui-button\", onClick: onClick },\r\n            \"\\u00A0\",\r\n            pending ?\r\n                React.createElement(\"i\", { className: \"fas fa-lg fa-circle-notch fa-spin\" }) :\r\n                \"Upgrade to \" + props.tier.capitalise(),\r\n            \"\\u00A0\"));\r\n};\r\nvar _Plan = function (props) { return (React.createElement(\"div\", { className: \"col-12 col-sm-6 col-md-4 mb-3 px-1\" },\r\n    React.createElement(\"div\", { className: \"plan d-flex flex-column \" + props.extraClass }, props.children))); };\r\nvar Plan = React.memo(_Plan);\r\nvar Price = function (props) {\r\n    var _a;\r\n    return (React.createElement(\"span\", { className: \"price\" },\r\n        props.from ? React.createElement(\"sub\", null, \"from\") : null,\r\n        React.createElement(\"sup\", null, currencySymbol(props.currency)),\r\n        ((_a = props.price) !== null && _a !== void 0 ? _a : 0).toLocaleFixed(2),\r\n        React.createElement(\"sub\", null, \"/mo\")));\r\n};\r\nexport var Disclaimer = function () { return (React.createElement(\"p\", { className: \"text-muted text-center\" },\r\n    React.createElement(\"i\", null,\r\n        \"Cancel anytime. Learn more about \",\r\n        React.createElement(\"a\", { \"data-beacon-article-modal\": Articles.SUBSCRIPTIONS, href: \"#\" }, \"subscriptions\"),\r\n        \". \",\r\n        React.createElement(\"br\", null),\r\n        \"By upgrading, you agree to our \",\r\n        React.createElement(\"a\", { href: \"http://help.chemix.org/article/tos\", target: \"_blank\" }, \"Terms and Conditions.\")))); };\r\nexport var Item = function (props) { return (React.createElement(\"li\", null,\r\n    React.createElement(\"span\", { className: \"fa-li\" },\r\n        React.createElement(\"i\", { className: \"fa fa-\" + (props.icon || \"check\") })),\r\n    props.children)); };\r\nvar PRICES = {\r\n    boost: {\r\n        gbp: { month: 2.99, year: 2.39 },\r\n        eur: { month: 3.49, year: 2.79 },\r\n        usd: { month: 3.49, year: 2.79 },\r\n        aud: { month: 4.99, year: 3.99 },\r\n        sgd: { month: 4.49, year: 3.59 },\r\n        mxn: { month: 49, year: 39 },\r\n        cop: { month: 8999, year: 7199 },\r\n    },\r\n};\r\n// From https://docs.google.com/spreadsheets/d/1LNK9C4RMyJNWCBTed5ByMtxC3DTq-7JqrJyCvslwzLo/edit#gid=1712682288\r\nvar SCHOOL_DISCOUNTS_BREAKS = [\r\n    [100, -150],\r\n    [200, -10],\r\n    [500, 10],\r\n    [1000, 30],\r\n    [2000, 50],\r\n    [5000, 55],\r\n    [10000, 60],\r\n    [20000, 65],\r\n];\r\nfunction schoolPricing(students, currency, period) {\r\n    var baseMonthlyPrice = PRICES[\"boost\"][currency][\"month\"];\r\n    var pricePerUser = (baseMonthlyPrice / 20).round(4);\r\n    var totalPrice = 0;\r\n    var previousBreak = 0;\r\n    for (var _i = 0, SCHOOL_DISCOUNTS_BREAKS_1 = SCHOOL_DISCOUNTS_BREAKS; _i < SCHOOL_DISCOUNTS_BREAKS_1.length; _i++) {\r\n        var breaks = SCHOOL_DISCOUNTS_BREAKS_1[_i];\r\n        var currentBreak = breaks[0], discount = breaks[1];\r\n        // Max students in this band.\r\n        var maxStudents = currentBreak - previousBreak;\r\n        totalPrice += Math.min(maxStudents, students) * pricePerUser * (1 - discount / 100);\r\n        students -= maxStudents;\r\n        if (students <= 0)\r\n            break;\r\n        previousBreak = currentBreak;\r\n    }\r\n    totalPrice /= 12;\r\n    if (period == \"month\") {\r\n        totalPrice *= 1.25;\r\n    }\r\n    return totalPrice.round(schoolPricingDecimalPlaces(currency));\r\n}\r\nfunction schoolPricingDecimalPlaces(currency) {\r\n    switch (currency) {\r\n        case \"mxn\": return 0;\r\n        case \"cop\": return -2;\r\n        default: return 2;\r\n    }\r\n}\r\n","import { setDefaultStyle, strokeWidth } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nvar Tweezers = /** @class */ (function () {\r\n    function Tweezers() {\r\n    }\r\n    Tweezers.prototype.render = function (appearance) {\r\n        if (appearance.style == \"3d\") {\r\n            return render3d(appearance);\r\n        }\r\n        else {\r\n            return renderSimple(appearance);\r\n        }\r\n    };\r\n    Tweezers.properties = {\r\n        label: \"Tweezers\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            style: \"3d\",\r\n            opening: 0.5\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"style\", label: \"Style\",\r\n                options: [\r\n                    { value: \"3d\", label: \"Default\" },\r\n                    { value: \"simple\", label: \"Simple\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"opening\", label: \"Opening\",\r\n                min: 0.0, max: 1.0, step: 0.1,\r\n            },\r\n        ],\r\n    };\r\n    return Tweezers;\r\n}());\r\nexport { Tweezers };\r\nfunction render3d(appearance) {\r\n    var top = new Path(Segments([[0, 0]], [[16, -9], [-10, 2], [10, -2]], [[40, -8], [-3, 2]], [[45, -11]], [[154, -10], , [9, 0]], [[155, 1], [8, 0]], [[44, -2], , [-10, 0]], [[17, -5], [10, 0], [-7, 0]]));\r\n    top.closePath();\r\n    var bottom = top.clone();\r\n    top.withGradientFill(\"right\", Gradients.cylinder(\"#aaaaaa\".color(), 5))\r\n        .withStroke(strokeWidth(\"thinner\"), \"#999999\");\r\n    bottom.fillColor = \"#666666\";\r\n    bottom.shear(-0.08 * appearance.opening, P(155, -5));\r\n    var graphic = new Group([bottom, top]);\r\n    return {\r\n        graphic: graphic,\r\n        hitShape: graphic.bounds.expand(10).toShape()\r\n    };\r\n}\r\nfunction renderSimple(appearance) {\r\n    var oneSide = new Path(Segments([[-120, 0], , [5, -13]], [[0, 0], [-120, -7]]));\r\n    var otherSide = oneSide.clone();\r\n    var pivot = P(0, 0);\r\n    otherSide.scale(1.0, -1.0, pivot);\r\n    var angle = 5 * appearance.opening + 1;\r\n    oneSide.rotate(angle, P(0, 0));\r\n    otherSide.rotate(-angle, pivot);\r\n    var graphic = new Group([oneSide, otherSide]);\r\n    setDefaultStyle(graphic);\r\n    return {\r\n        graphic: graphic,\r\n        hitShape: graphic.bounds.expand(10).toShape()\r\n    };\r\n}\r\n","import { strokeWidth } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { hsl } from \"color\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar LIGHT_OUTLINE = hsl(0, 0, 40).string();\r\nvar LIGHT_CYLINDER = Gradients.cylinder(hsl(252, 3, 80));\r\nvar LIGHT_GRADIENT = Gradients.simple(hsl(252, 3, 80));\r\nvar DARK_CYLINDER = Gradients.cylinder(hsl(252, 2, 30));\r\nvar METAL = Gradients.cylinder(hsl(252, 8, 70), 10);\r\nvar Microscope = /** @class */ (function () {\r\n    function Microscope() {\r\n    }\r\n    Microscope.prototype.render = function (appearance) {\r\n        var body = new Path(Segments([[6, -30]], [[56, -25], , [19, 15]], [[113, 100], [6, -60], [-7, 80]], [[27, 206], [43, -12]], [[30, 142]], [[84, 91], [-2, 61], [2, -54]], [[9, 36], [37, 0]]));\r\n        body.closePath();\r\n        body.withGradientFill(\"left\", LIGHT_GRADIENT)\r\n            .withStroke(strokeWidth(\"default\"), LIGHT_OUTLINE);\r\n        var leg = new Path(Segments([[57, 145], [-20, 3], [20, -3]], [[103, 231], [-30, -53]], [[47, 239]]));\r\n        leg.closePath();\r\n        leg.withGradientFill(\"left\", LIGHT_GRADIENT)\r\n            .withStroke(strokeWidth(\"default\"), LIGHT_OUTLINE);\r\n        var base = Shape.Rectangle(R(-80, 225, 200, 20), 5)\r\n            .withGradientFill(\"left\", Gradients.simple(\"#cccccc\".color(), 30))\r\n            .withStroke(strokeWidth(\"default\"), LIGHT_OUTLINE);\r\n        var ocularCase = Shape.Rectangle(R(0, 0, 35, 90, Pivot.CENTER), 2.0)\r\n            .withGradientFill(\"right\", LIGHT_CYLINDER)\r\n            .withStroke(strokeWidth(\"default\"), LIGHT_OUTLINE);\r\n        var ocularViewtube = Shape.Rectangle(R(0, -10, 25, 150, Pivot.CENTER), 2.0)\r\n            .withGradientFill(\"right\", DARK_CYLINDER);\r\n        var ocularTurret = Shape.Rectangle(R(-10, 60, 54, 12, Pivot.TOP_CENTER), 2.0)\r\n            .withGradientFill(\"right\", DARK_CYLINDER);\r\n        ocularTurret.rotate(10);\r\n        var lens = Shape.Rectangle(R(2, 65, 18, 25, Pivot.TOP_CENTER))\r\n            .withGradientFill(\"right\", METAL);\r\n        lens.rotate(-5);\r\n        var lens2 = Shape.Rectangle(R(-22, 60, 18, 25, Pivot.TOP_CENTER))\r\n            .withGradientFill(\"right\", METAL);\r\n        lens2.rotate(20, P(-22, 60));\r\n        var ocular = new Group([ocularViewtube, lens, lens2, ocularTurret, ocularCase]);\r\n        ocular.rotate(5, P(0, 0));\r\n        var stage = Shape.Rectangle(R(-10, 132, 120, 12, Pivot.TOP_CENTER), 2.0)\r\n            .withGradientFill(\"right\", DARK_CYLINDER);\r\n        // .withStroke(strokeWidth(\"default\"), DARK_OUTLINE)\r\n        var lightInlet = Shape.Rectangle(R(-10, 143, 30, 20, Pivot.TOP_CENTER))\r\n            .withGradientFill(\"right\", DARK_CYLINDER);\r\n        // .withStroke(strokeWidth(\"default\"), DARK_OUTLINE)\r\n        var lightHolder = Shape.Rectangle(R(-10, 190, 40, 8))\r\n            .withGradientFill(\"right\", DARK_CYLINDER);\r\n        // .withStroke(strokeWidth(\"default\"), DARK_OUTLINE)\r\n        var light = Shape.Rectangle(R(-15, 180, 20, 20))\r\n            .withGradientFill(\"right\", LIGHT_CYLINDER)\r\n            .withStroke(strokeWidth(\"thinner\"), LIGHT_OUTLINE);\r\n        light.rotate(-5);\r\n        var graphic = new Group([light, lightHolder, body, leg, base, ocular, stage, lightInlet]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: [\r\n                base.placeable(),\r\n                stage.topEdgeAsPlaceableSurface(),\r\n            ]\r\n        };\r\n    };\r\n    Microscope.properties = {\r\n        label: \"Microscope\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {},\r\n        appearanceSpecs: [],\r\n    };\r\n    return Microscope;\r\n}());\r\nexport { Microscope };\r\n","import { mirrorY, softShade } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, PointText, Shape } from \"paper\";\r\nvar OUTLINE = \"#8C847F\";\r\n/**\r\n * https://www.youtube.com/watch?v=BAf6HoVK6JI\r\n * https://www.ourweigh.co.uk/mechanical-balances/TBB2610T.html?gclid=Cj0KCQiAkuP9BRCkARIsAKGLE8VCz7xsk1Y2EBnukCDJ5z60JKoC9wxaY7sg_YSDZI4ipA6s-Ai9vYkaAtHyEALw_wcB\r\n * https://www.analytics-shop.com/gb/oh80252052-gb.html?utm_source=google_shopping&utm_medium=cpc&gclid=Cj0KCQiAkuP9BRCkARIsAKGLE8WP2n9EjbjIT_n1M-0A0CCU82JB9BtMBpQht3DY1xyRmEiqzzvwAHoaAg-sEALw_wcB\r\n * https://us.ohaus.com/Ohaus/media/assets/images/product/main-product-fully-labeled.png\r\n *\r\n * Dimensions: https://www.amazon.co.uk/Ohaus-Mechanical-Balance-Capacity-Readability/dp/B0051W8YBE\r\n * - 45.21 x 16.26 x 17.02 cm\r\n * - Weighing plate: 14.3cm\r\n */\r\nvar TripleBeamBalance = /** @class */ (function () {\r\n    function TripleBeamBalance() {\r\n    }\r\n    TripleBeamBalance.prototype.render = function (appearance) {\r\n        var magnifyBeam = appearance.magnifyBeam;\r\n        var base = new Path(Segments([[-115, 48]], // Start\r\n        [[-48, 48]], [[-24, 36]], // Pivot base\r\n        [[10, 36]], [[18, 95]], // Midsection\r\n        [[277, 97]], [[277, -30]], [[312, -29]], [[327, 80]], [[336, 101]], [[335, 120]], [[-144, 120]], [[-128, 100]])).close().withGradientFill(\"right\", [\r\n            [\"#BCB7AE\", 0.03],\r\n            [\"#C3BEB6\", 0.07],\r\n            [\"#BCB7AE\", 0.09],\r\n            [\"#B5B1A8\", 0.091],\r\n            [\"#B5B1A8\", 0.139],\r\n            [\"#C5C2BC\", 0.14],\r\n            [\"#C5C2BC\", 0.26],\r\n            [\"#D2D1CD\", 0.261],\r\n            [\"#D2D1CD\", 0.29],\r\n            [\"#CCCBC6\", 0.3],\r\n            [\"#CCCBC6\", 0.9],\r\n            [\"#B8B3AA\", 1.0],\r\n        ]).withStroke(\"default\", OUTLINE);\r\n        var support = new Path(Segments([[24, 6], , [-37, 0]], [[-24, 17], [20, 0]], [[-106, 17]], // Left edge.\r\n        [[-106, 0]], [[-64, 0], , [30, 0]], [[19, -17], [-63, -1]], [[21, -9]], [[213, -9]], [[213, -14]], [[261, -14]], [[275, -7]], [[262, 0]], [[213, 0]], [[213, -5]], [[22, -5]])).close().withFill(\"#777777\");\r\n        var startX = magnifyBeam ? 20 : 25;\r\n        var startY = magnifyBeam ? -40 : -30;\r\n        var stepY = magnifyBeam ? 25 : 15;\r\n        var beam1 = this.beam(25, 0, 10, 10, appearance.tens, magnifyBeam);\r\n        beam1.position = P(startX, startY);\r\n        var beam2 = this.beam(35, 10, 100, 5, appearance.hundreds, magnifyBeam);\r\n        beam2.position = P(startX, startY + stepY);\r\n        var beam3 = this.beam(15, 20, 1, 10, appearance.units, magnifyBeam);\r\n        beam3.position = P(startX, startY + stepY * 2);\r\n        var tiltShift = -Math.sin(appearance.tilt.toRadians()) * 72;\r\n        var plate = Shape.Rectangle(R(0, 0, 140, 10), 2.0)\r\n            .withGradientFill(\"right\", Gradients.cylinder(\"#cccccc\".color()))\r\n            .withStroke(\"thin\", \"#888888\");\r\n        plate.position = P(-72, -28 + tiltShift);\r\n        var zeroKnobScrew = Shape.Rectangle(R(-106, 9, 10, 5, Pivot.CENTER_RIGHT)).withFill(\"#aaaaaa\");\r\n        var zeroKnob = Shape.Rectangle(R(-116, 9, 8, 12, Pivot.CENTER_RIGHT)).withGradientFill(\"down\", Gradients.cylinder(\"#999999\".color()));\r\n        var poise = new Group([support, beam1, beam2, beam3, zeroKnobScrew, zeroKnob]);\r\n        poise.rotate(appearance.tilt, P(0, 0));\r\n        var fixedPiston = Shape.Rectangle(R(-70, 50, 8, 60, Pivot.BOTTOM_CENTER)).withGradientFill(\"right\", Gradients.cylinder(\"#666666\".color()));\r\n        var movablePiston = Shape.Rectangle(R(-70, 0, 8, 30, Pivot.BOTTOM_CENTER)).withGradientFill(\"right\", Gradients.cylinder(\"#666666\".color()));\r\n        var column1 = Shape.Rectangle(R(-70, 40, 15, 42, Pivot.BOTTOM_CENTER)).withGradientFill(\"right\", Gradients.cylinder(\"#aaaaaa\".color()));\r\n        var column2 = Shape.Rectangle(R(0, 37, 15, 40, Pivot.BOTTOM_CENTER)).withGradientFill(\"right\", Gradients.cylinder(\"#aaaaaa\".color()));\r\n        movablePiston.position.y += tiltShift;\r\n        column1.position.y += tiltShift;\r\n        var pointBg = Shape.Rectangle(R(282, -7, 11, 40, Pivot.CENTER)).withFill(\"#ffffff\");\r\n        var point = new Path(Segments([[0, -20]], [[10, -20]], [[3, -1]], [[1, -1]])).close().withFill(\"#222222\");\r\n        mirrorY(point);\r\n        point.position = P(282, -7);\r\n        var graphic = new Group([\r\n            poise,\r\n            fixedPiston,\r\n            movablePiston,\r\n            column1,\r\n            column2,\r\n            plate,\r\n            base,\r\n            pointBg,\r\n            point,\r\n            softShade(\"edge\", \"default\", base.segments[0].point, base.segments[1].point, OUTLINE + \"60\", 5.0),\r\n            softShade(\"edge\", \"default\", base.segments[3].point, base.segments[4].point, \"#ffffff80\", 6.0)\r\n        ]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            pivot: base.bounds.center,\r\n            snapping: [\r\n                base.placeable(),\r\n                plate.topEdgeAsPlaceableSurface(),\r\n            ]\r\n        };\r\n    };\r\n    TripleBeamBalance.prototype.beam = function (riderSize, extraSize, step, multiple, value, magnify) {\r\n        var beamSize = (magnify ? 220 : 190) + extraSize;\r\n        var riderOffset = riderSize / 2;\r\n        var riderRange = beamSize - riderSize;\r\n        var max = step * multiple;\r\n        // No need to add riderOffset, since position is taken at center.\r\n        var riderX = (value / max) * riderRange;\r\n        var beamHeight = magnify ? 21 : 15;\r\n        var beam = Shape.Rectangle(R(0, 0, beamSize, beamHeight)).withFill(\"#ffffff\").withStroke(1.0, \"black\");\r\n        var group = new Group([beam]);\r\n        // Labels.\r\n        for (var i = 0; i <= multiple; i++) {\r\n            var value_1 = i * step;\r\n            group.addChild(new PointText({\r\n                point: P(riderOffset + (value_1 / max) * riderRange, magnify ? 18 : 13),\r\n                content: value_1.toString(),\r\n                fillColor: \"black\",\r\n                fontFamily: 'sans-serif',\r\n                fontSize: magnify ? 9 : 7,\r\n                justification: \"center\",\r\n            }));\r\n        }\r\n        // Add rider.\r\n        var riderHeight = magnify ? 7 : 5;\r\n        var rider = new Path(Segments([[0, -1]], [[riderSize, -1]], [[riderSize, riderHeight]], [[0, riderHeight]])).close().withFill(\"#bbbbbb\").withStroke(1.0, \"#777777\");\r\n        var highlight = new Path(Segments([[riderSize / 2 - 2, -1]], [[riderSize / 2, riderHeight - 1]])).withStroke(1.0, \"#888888\");\r\n        var highlight2 = new Path(Segments([[riderSize / 2, riderHeight - 1]], [[riderSize / 2 + 2, -1]\r\n        ])).withStroke(1.0, \"#cccccc\");\r\n        var riderGroup = new Group([rider, highlight, highlight2]);\r\n        riderGroup.position.x += riderX;\r\n        group.addChild(riderGroup);\r\n        group.pivot = P(0, 0);\r\n        return group;\r\n    };\r\n    TripleBeamBalance.properties = {\r\n        label: \"Triple Beam Balance\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            hundreds: 200,\r\n            tens: 40,\r\n            units: 1.1,\r\n            tilt: 0,\r\n            magnifyBeam: false,\r\n        },\r\n        appearanceSpecs: [\r\n            { spec: \"checkbox\", key: \"magnifyBeam\", label: \"Beams\", subLabel: \"Magnify\" },\r\n            {\r\n                spec: \"slider\", key: \"hundreds\", label: \"Hundreds\",\r\n                min: 0, max: 500, step: 100, unit: \"g\"\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"tens\", label: \"Tens\",\r\n                min: 0, max: 100, step: 10, unit: \"g\"\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"units\", label: \"Units\",\r\n                min: 0, max: 10, step: 0.1, unit: \"g\"\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"tilt\", label: \"Tilt\",\r\n                min: -4, max: 4, step: 0.1,\r\n            },\r\n        ],\r\n    };\r\n    return TripleBeamBalance;\r\n}());\r\nexport { TripleBeamBalance };\r\n","import { mirrorX } from \"apparatus/draw\";\r\nimport { P, Pivot, R, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { CompoundPath, Group, Path, Shape } from \"paper\";\r\nvar SLIT_PLATE_COLOR = \"#555555\";\r\nvar RayBox = /** @class */ (function () {\r\n    function RayBox() {\r\n    }\r\n    RayBox.prototype.render = function (appearance) {\r\n        var slits = appearance.slits;\r\n        var slitGap = 10;\r\n        var box = new Path(Segments([[30, 0]], [[30, -80]], [[35, -80]], [[35, 60]])).withStroke(\"default\").withFill(\"#444444\").close();\r\n        mirrorX(box);\r\n        var graphic = new Group([box]);\r\n        if (slits !== \"none\") {\r\n            var slitPlate = new CompoundPath([]).withStroke(\"default\", SLIT_PLATE_COLOR);\r\n            slitPlate.moveTo(P(-30, -65));\r\n            for (var i = 0; i < slits; i++) {\r\n                var dx = ((slits - 1) / -2 + i) * slitGap;\r\n                slitPlate.lineTo(P(dx - 1, -65));\r\n                slitPlate.moveBy(P(2, 0));\r\n            }\r\n            slitPlate.lineTo(P(30, -65));\r\n            graphic.insertChild(0, slitPlate);\r\n        }\r\n        var rayThickness = 2.0;\r\n        var rayLength = 200;\r\n        if (appearance.light === \"front\") {\r\n            // First draw the glow.\r\n            if (slits === \"none\") {\r\n                graphic.insertChild(0, Shape.Rectangle(R(0, 0, 60, 200, Pivot.BOTTOM_CENTER)).withGradientFill(\"up\", [[\"#da1414aa\", 0.5], [\"#ff000000\", 1.0]]));\r\n            }\r\n            else {\r\n                graphic.insertChild(0, Shape.Rectangle(R(0, 0, 60, 65, Pivot.BOTTOM_CENTER)).setRadialGradientFill([[\"#da1414aa\", 0.5], [\"#da141440\", 1.0]], P(0, 0), P(30, -65)));\r\n                // Draw rays\r\n                for (var i = 0; i < slits; i++) {\r\n                    var dx = ((slits - 1) / -2 + i) * slitGap;\r\n                    graphic.insertChild(0, new Path.Line(P(dx, -64), P(dx, -(64 + rayLength))).withStroke(rayThickness, SharedColors.ray));\r\n                }\r\n            }\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            pivot: box.bounds.center,\r\n            hitShape: box.bounds.toShape()\r\n        };\r\n    };\r\n    RayBox.properties = {\r\n        label: \"Ray Box\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            light: \"off\",\r\n            slits: \"none\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"toggle-buttons\",\r\n                size: \"text\",\r\n                label: \"Light\",\r\n                key: \"light\",\r\n                options: [\r\n                    { value: \"off\", label: \"Off\", icon: \"\" },\r\n                    { value: \"front\", label: \"On\", icon: \"\" },\r\n                ]\r\n            },\r\n            {\r\n                spec: \"toggle-buttons\",\r\n                size: \"text\",\r\n                label: \"Slits\",\r\n                key: \"slits\",\r\n                options: [\r\n                    { value: \"none\", label: \"None\", icon: \"\" },\r\n                    { value: 1, label: \"1\", icon: \"\" },\r\n                    { value: 3, label: \"3\", icon: \"\" },\r\n                ]\r\n            },\r\n        ],\r\n    };\r\n    return RayBox;\r\n}());\r\nexport { RayBox };\r\n","import { mirrorX, setDefaultStyle, smoothCorner } from \"apparatus/draw\";\r\nimport { Segments } from \"apparatus/library/common\";\r\nimport { Path } from \"paper\";\r\nvar WeightBoat = /** @class */ (function () {\r\n    function WeightBoat() {\r\n    }\r\n    WeightBoat.prototype.render = function (appearance) {\r\n        var size = appearance.size;\r\n        var lipSize = 7;\r\n        var height = 15 + size * 0.15;\r\n        var baseSize = size - height * 0.8;\r\n        var graphic = new Path(Segments([[size / 2 + lipSize, 0]], [[size / 2, 0]], [[baseSize / 2, height]]));\r\n        mirrorX(graphic);\r\n        setDefaultStyle(graphic);\r\n        if (appearance.spout) {\r\n            graphic.segments[2].point.x -= height * 0.8;\r\n            if (graphic.segments[2].point.x < 10) {\r\n                graphic.segments[2].point.x = 10;\r\n            }\r\n        }\r\n        smoothCorner(graphic.segments[3], 3);\r\n        smoothCorner(graphic.segments[2], 3);\r\n        var liquidMask = graphic.clone();\r\n        return {\r\n            graphic: graphic,\r\n            liquidMask: liquidMask,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: graphic.placeable(),\r\n        };\r\n    };\r\n    WeightBoat.properties = {\r\n        label: \"Weight boat\",\r\n        canContainLiquids: true,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            size: 60,\r\n            spout: false,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 45, max: 140, unit: \"mm\",\r\n            },\r\n            { spec: \"checkbox\", key: \"spout\", label: \"Spout\" }\r\n        ],\r\n    };\r\n    return WeightBoat;\r\n}());\r\nexport { WeightBoat };\r\n","import { strokeWidth } from \"apparatus/draw\";\r\nimport { P } from \"apparatus/library/common\";\r\nimport { Group, Shape } from \"paper\";\r\nimport { Random } from \"random/random\";\r\nvar Beads = /** @class */ (function () {\r\n    function Beads() {\r\n    }\r\n    Beads.prototype.render = function (appearance) {\r\n        var boundDiameter = appearance.boundDiameter, color = appearance.color;\r\n        var outlineColor = color.color().ladd(-10).hex();\r\n        var radius = 5;\r\n        var boundRadius = boundDiameter / 2;\r\n        var graphic = new Group();\r\n        var step = 15;\r\n        var r = new Random();\r\n        for (var x = -boundRadius; x < boundRadius; x += step) {\r\n            for (var y = -boundRadius; y < boundRadius; y += step) {\r\n                var position = P(x, y).add(r.randomUnitVector(step / 3));\r\n                if (position.length > boundRadius)\r\n                    continue;\r\n                var bacteria = Shape.Circle(position, radius);\r\n                bacteria.withFill(color).withStroke(strokeWidth(\"default\"), outlineColor);\r\n                graphic.addChild(bacteria);\r\n            }\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            pivot: P(0, 0)\r\n        };\r\n    };\r\n    Beads.properties = {\r\n        label: \"Beads\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            boundDiameter: 100,\r\n            color: \"#72b52f\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"boundDiameter\", label: \"Contained within\",\r\n                min: 25, max: 150, unit: \"mm\"\r\n            },\r\n            {\r\n                spec: \"color\", key: \"color\", label: \"Colour\",\r\n            }\r\n        ],\r\n    };\r\n    return Beads;\r\n}());\r\nexport { Beads };\r\n","import { setDefaultStyle } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { Pivot, R, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar CellCultureFlask = /** @class */ (function () {\r\n    function CellCultureFlask() {\r\n    }\r\n    CellCultureFlask.prototype.render = function (appearance) {\r\n        var bottle = new Path(Segments([[0, 0]], [[135, -1]], [[137, 5]], [[151, 0]], [[156, 19]], [[128, 30]], [[0, 30]])).close();\r\n        setDefaultStyle(bottle);\r\n        var liquidMask = bottle.clone();\r\n        var cap = Shape.Rectangle(R(155, 9, 28, 15, Pivot.CENTER)).withGradientFill(\"right\", Gradients.cylinder(\"#2b4fc3\".color()));\r\n        cap.rotate(70);\r\n        var fold1 = new Path(Segments([[80, 4]], [[76, 24]])).withStroke(\"thinner\", SharedColors.glassFold);\r\n        var fold2 = new Path(Segments([[135, 9]], [[130, 24]])).withStroke(\"thinner\", SharedColors.glassFold);\r\n        var graphic = new Group([bottle, cap, fold1, fold2]);\r\n        graphic.scale(appearance.scale);\r\n        liquidMask.scale(appearance.scale, graphic.bounds.center);\r\n        return {\r\n            graphic: graphic,\r\n            liquidMask: liquidMask,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: bottle.placeable(),\r\n        };\r\n    };\r\n    CellCultureFlask.properties = {\r\n        label: \"Cell Culture Flask\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            scale: 1.0\r\n        },\r\n        flippable: true,\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Size\",\r\n                min: 0.6, max: 1.4, step: 0.01, unit: \"%\"\r\n            }\r\n        ],\r\n    };\r\n    return CellCultureFlask;\r\n}());\r\nexport { CellCultureFlask };\r\n","// Wraper around <input type=\"text\" />\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { TextReplacements } from \"components/text_replacements\";\r\nimport * as React from \"react\";\r\nvar TextInput = /** @class */ (function (_super) {\r\n    __extends(TextInput, _super);\r\n    function TextInput(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.ref = React.createRef();\r\n        _this.render = function () { return (React.createElement(\"input\", { value: _this.state.text, type: _this.props.numbersOnly ? \"number\" : \"text\", maxLength: _this.props.maxLength, className: \"ui-input\", onFocus: function (e) { var _a; return (_a = _this.props.onFocus) === null || _a === void 0 ? void 0 : _a.call(null); }, onChange: function (e) { return _this.onChange(e); }, onBlur: function (e) { return _this.onBlur(e); }, onKeyPress: function (e) { return _this.onKeyPress(e); }, onKeyDown: function (e) { return _this.onKeyDown(e); }, placeholder: _this.props.placeholder, ref: _this.ref })); };\r\n        _this.state = { text: _this.props.text };\r\n        return _this;\r\n    }\r\n    TextInput.prototype.componentWillUnmount = function () {\r\n        this.props.onEnd(this.props.text, this.state.text);\r\n    };\r\n    TextInput.prototype.onChange = function (event) {\r\n        var value = event.target.value;\r\n        this.setState({ text: event.target.value });\r\n        this.props.onChange(value);\r\n    };\r\n    TextInput.prototype.onKeyPress = function (event) {\r\n        if (this.props.enableReplacements === true)\r\n            TextReplacements.onKeyPress(this, event);\r\n    };\r\n    TextInput.prototype.onKeyDown = function (event) {\r\n        if (this.props.enableReplacements === true)\r\n            TextReplacements.onKeyDown(this, event);\r\n    };\r\n    TextInput.prototype.manuallySetText = function (newText, newCursorPosition) {\r\n        var _this = this;\r\n        this.setState({ text: newText }, function () { return _this.ref.current.setSelectionRange(newCursorPosition, newCursorPosition); });\r\n        this.props.onChange(newText);\r\n    };\r\n    TextInput.prototype.onBlur = function (event) {\r\n        this.props.onEnd(this.props.text, this.state.text);\r\n    };\r\n    return TextInput;\r\n}(React.Component));\r\nexport { TextInput };\r\n","import { P, Pivot, R, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nimport { createOutlinedGroup, setLiquidStyle } from \"../../draw\";\r\nvar Faucet = /** @class */ (function () {\r\n    function Faucet() {\r\n    }\r\n    Faucet.prototype.render = function (appearance) {\r\n        var body = new Path(Segments([[-70, 40]], [[-70, 25], , [0, -22]], [[-35, -10], [-22, 0]], [[40, -10]], [[40, 10]], [[-35, 10], , [-8, 0]], [[-50, 25], [0, -8]], [[-50, 40]])).close().withFill(\"#dddddd\");\r\n        var spoutPosition = P(-60, 40);\r\n        var bulge = new Path.Rectangle(R(0, 0, 35, 36, Pivot.CENTER), 2.0).withFill(\"#cccccc\");\r\n        var handleAxle = new Path.Rectangle(R(0, -44, 6, 30, Pivot.TOP_CENTER), 3.0).withFill(\"#999999\");\r\n        var handle = new Path.Rectangle(R(0, -36, 50, 8, Pivot.CENTER), 2.0).withFill(\"#cccccc\");\r\n        var graphic = new Group([\r\n            createOutlinedGroup(\"default\", SharedColors.stroke, body, bulge),\r\n            createOutlinedGroup(\"default\", SharedColors.stroke, handleAxle, handle),\r\n        ]);\r\n        if (appearance.showStream) {\r\n            var streamWidth = appearance.streamStrength, streamLength = appearance.streamLength, bend = appearance.streamBend;\r\n            var water = new Path(Segments([[streamWidth / 2 + streamLength * bend, streamLength]], [[streamWidth / 2, 0], [0, streamLength / 2]], [[-streamWidth / 2, 0], , [0, streamLength / 2]], [[-streamWidth / 2 + streamLength * bend, streamLength]]));\r\n            water.position.x += spoutPosition.x;\r\n            water.position.y += spoutPosition.y;\r\n            setLiquidStyle(water, SharedColors.defaultLiquid);\r\n            graphic.insertChild(0, water);\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            pivot: P(0, 0)\r\n        };\r\n    };\r\n    Faucet.properties = {\r\n        label: \"Tap / Faucet\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            showStream: true,\r\n            streamLength: 120,\r\n            streamStrength: 8,\r\n            streamBend: 0.0,\r\n        },\r\n        appearanceSpecs: [\r\n            { spec: \"checkbox\", key: \"showStream\", label: \"Water flow\", subLabel: \"Show\" },\r\n            {\r\n                spec: \"slider\", key: \"streamStrength\", label: \"Flow Strength\",\r\n                min: 3, max: 18,\r\n                visible: function (a) { return a.showStream; }\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"streamLength\", label: \"Flow Size\",\r\n                min: 10, max: 300,\r\n                visible: function (a) { return a.showStream; }\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"streamBend\", label: \"Flow Bend\",\r\n                min: -0.5, max: 0.5, step: 0.05,\r\n                visible: function (a) { return a.showStream; }\r\n            }\r\n        ],\r\n    };\r\n    return Faucet;\r\n}());\r\nexport { Faucet };\r\n","import * as React from \"react\";\r\nimport { setUpQTip } from \"view/tooltips\";\r\n/**\r\n * Shows the badge to indicate this feature requires an upgrade.\r\n * Showing the promo popup must be handled by the parent.\r\n */\r\nexport var Badge = function (props) {\r\n    var _a, _b;\r\n    var tier = props.tier;\r\n    var ref = React.createRef();\r\n    if ((_a = props.showHint) !== null && _a !== void 0 ? _a : true) {\r\n        React.useEffect(function () {\r\n            setUpQTip(ref.current);\r\n        }, []);\r\n    }\r\n    var icon = tier == \"boost\" ? \"fa-bolt\" : \"fa-star\";\r\n    // Could also use fa-certificate.\r\n    return React.createElement(\"span\", { ref: ref, className: (_b = \"upgrade-badge fa-stack \" + props.extraClass) !== null && _b !== void 0 ? _b : \"\", title: \"Upgrade to use this feature.\" },\r\n        React.createElement(\"i\", { className: \"fal fa-badge fa-stack-2x boost-text-gradient\" }),\r\n        React.createElement(\"i\", { className: \"fas \" + icon + \" fa-stack-1x icon-inside boost-text-gradient\" }));\r\n};\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n// UI representation for a single diagram file.\r\nimport { formatDistance } from \"date-fns\";\r\nimport { CloudFiles, openDiagram } from \"file/api\";\r\nimport * as React from 'react';\r\nimport appStore from \"store/store\";\r\nexport var DiagramFile = function (props) {\r\n    function openFile() {\r\n        openDiagram(props.diagram, /*isTemplate*/ false);\r\n        props.onOpen(props.diagram.id);\r\n    }\r\n    return React.createElement(\"div\", { className: \"col-12 col-sm-4 col-md-3 col-lg-2 mb-2 pr-2\" },\r\n        React.createElement(\"div\", { className: \"thumbnail mb-1\" },\r\n            React.createElement(ActionMenu, __assign({}, props)),\r\n            React.createElement(\"img\", { src: props.diagram.thumbnail, className: \"img-thumbnail\", onClick: openFile })),\r\n        props.diagram.title,\r\n        React.createElement(\"br\", null),\r\n        React.createElement(\"small\", { className: \"text-muted\" },\r\n            React.createElement(\"i\", { className: \"fa fa-clock\" }),\r\n            \" \",\r\n            formatDistance(props.diagram.modified, props.now),\r\n            \" ago\"));\r\n};\r\nvar ActionMenu = function (props) {\r\n    function deleteFile() {\r\n        var loggedIn = appStore.loggedInState();\r\n        if (!loggedIn)\r\n            return;\r\n        var diagram = props.diagram;\r\n        if (!confirm(\"Are you sure you want to delete diagram \\\"\" + diagram.title + \"\\\"?\")) {\r\n            return;\r\n        }\r\n        CloudFiles.remove(loggedIn, diagram, props.onDelete);\r\n    }\r\n    function renameFile() {\r\n        var loggedIn = appStore.loggedInState();\r\n        if (!loggedIn)\r\n            return;\r\n        var title = prompt(\"Enter a new name for your diagram\", props.diagram.title);\r\n        if (title === null)\r\n            return;\r\n        CloudFiles.rename(loggedIn, props.diagram, title, props.onRename);\r\n    }\r\n    return React.createElement(\"div\", { className: \"text-white overlayButton\" },\r\n        React.createElement(\"button\", { type: \"button\", className: \"btn btn-sm btn-outline-secondary\", \"data-toggle\": \"dropdown\" },\r\n            React.createElement(\"i\", { className: \"fa fa-ellipsis-h\" })),\r\n        React.createElement(\"div\", { className: \"dropdown-menu bg-dark text-white\", \"aria-labelledby\": \"dropdownMenuButton\" },\r\n            React.createElement(ActionMenuItem, { icon: \"fa-pencil-alt\", title: \"Rename\", onClick: renameFile }),\r\n            React.createElement(ActionMenuItem, { icon: \"fa-trash\", title: \"Delete\", onClick: deleteFile, css: \"text-danger\" })));\r\n};\r\nvar ActionMenuItem = function (props) {\r\n    var _a;\r\n    return (React.createElement(\"a\", { className: (_a = \"dropdown-item bg-dark text-white \" + props.css) !== null && _a !== void 0 ? _a : \"\", onClick: props.onClick },\r\n        React.createElement(\"i\", { className: \"fa fa-fw mr-2 \" + props.icon }),\r\n        props.title));\r\n};\r\n","import { strokeWidth } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, Pivot, R } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar TapeMeasure = /** @class */ (function () {\r\n    function TapeMeasure() {\r\n    }\r\n    TapeMeasure.prototype.render = function (appearance) {\r\n        var cmlength = appearance.length;\r\n        var length = cmlength * 10;\r\n        var tape = Shape.Rectangle(R(-5, 0, length + 5, 25));\r\n        tape.withStroke(strokeWidth(\"thinner\"), \"#8c6d2e\")\r\n            .withFill(\"#f9cb01\");\r\n        var tapeEnd = Shape.Rectangle(R(length + 7, 5, 20, 15, Pivot.TOP_RIGHT), 2)\r\n            .withFill(\"#222222\");\r\n        var casing = Shape.Rectangle(R(-71, -3, 70, 31), 2.0);\r\n        casing.withStroke(strokeWidth(\"default\"), \"#333333\")\r\n            .withGradientFill(\"right\", Gradients.box(\"#444444\".color()));\r\n        var graphic = new Group([tape]);\r\n        // Add markings\r\n        var mark = 1;\r\n        var markX = length - 10;\r\n        while (markX > 0) {\r\n            var color = mark % 10 == 0 ? \"red\" : \"black\";\r\n            graphic.addChild(new Path.Line(P(markX, 0), P(markX, 10)).withStroke(strokeWidth(\"thinner\"), color));\r\n            markX -= 10;\r\n            mark += 1;\r\n        }\r\n        graphic.addChild(tapeEnd);\r\n        graphic.addChild(casing);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            pivot: casing.bounds.center,\r\n        };\r\n    };\r\n    TapeMeasure.properties = {\r\n        label: \"Tape measure\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            length: 30,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"length\", label: \"Length\",\r\n                min: 0, max: 90, unit: \"cm\"\r\n            }\r\n        ],\r\n    };\r\n    return TapeMeasure;\r\n}());\r\nexport { TapeMeasure };\r\n","import { mirrorX } from \"apparatus/draw\";\r\nimport { P } from \"apparatus/library/common\";\r\nimport { Path } from \"paper\";\r\nvar COLOR = \"#9edef0\";\r\nvar Sellotape = /** @class */ (function () {\r\n    function Sellotape() {\r\n    }\r\n    Sellotape.prototype.render = function (appearance) {\r\n        var width = appearance.width, length = appearance.length;\r\n        var graphic = new Path([]);\r\n        graphic.moveTo(P(length / 2, 0));\r\n        var alternate = false;\r\n        for (var y = 3; y <= width; y += 3) {\r\n            graphic.lineBy(P(alternate ? 3 : -3, 3));\r\n            alternate = !alternate;\r\n        }\r\n        graphic.lineBy(P((alternate ? 1 : -1) * width % 3, width % 3));\r\n        mirrorX(graphic);\r\n        graphic.close()\r\n            .withStroke(\"thinner\", COLOR)\r\n            .withGradientFill(\"right-down\", [\r\n            [\"#e1f6fc80\", 0.3],\r\n            [\"#ffffff80\", 0.5],\r\n            [\"#e1f6fc80\", 0.7],\r\n        ]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.expand(10).toShape(),\r\n        };\r\n    };\r\n    Sellotape.properties = {\r\n        label: \"Adhesive Tape\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            width: 12,\r\n            length: 100,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"width\", label: \"Width\",\r\n                min: 10, max: 30,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"length\", label: \"Length\",\r\n                min: 25, max: 120\r\n            },\r\n        ],\r\n    };\r\n    return Sellotape;\r\n}());\r\nexport { Sellotape };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { addEdgeLips, addMarkers, breakPath, mirrorX, setDefaultStyle } from \"apparatus/draw\";\r\nimport { markerSpacing, P, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nimport { createTap, Tap } from \"./common/tap\";\r\nvar Burette = /** @class */ (function () {\r\n    function Burette() {\r\n    }\r\n    Burette.prototype.render = function (appearance) {\r\n        var size = appearance.size;\r\n        var glass = new Path(Segments([[0, 0]], [[0, size], undefined, [0, 10]], [[appearance.diameter / 2 - 5, size + 15]], [[appearance.diameter / 2 - 5, size + 70]]));\r\n        mirrorX(glass, appearance.diameter / 2);\r\n        var liquidMask = glass.clone();\r\n        if (Tap.isClosed(appearance.tapOpening) && appearance.emptyJet) {\r\n            liquidMask.segments[3].point = liquidMask.segments[5].point;\r\n        }\r\n        addEdgeLips(glass);\r\n        var glassWalls = breakPath(glass, 5);\r\n        setDefaultStyle(glassWalls);\r\n        var stopCock = createTap(appearance.tapOpening);\r\n        stopCock.position.x += appearance.diameter / 2;\r\n        stopCock.position.y = size + 20;\r\n        var graphic = new Group([glassWalls, stopCock]);\r\n        addMarkers(graphic, P(appearance.diameter - 4, size + 15), 8, P(0, markerSpacing * 2));\r\n        var hitShapes = [\r\n            Shape.Rectangle(glass.bounds),\r\n            Shape.Rectangle(stopCock.bounds)\r\n        ];\r\n        return { graphic: graphic, hitShape: hitShapes, liquidMask: liquidMask };\r\n    };\r\n    Burette.properties = {\r\n        label: \"Burette\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: __assign(__assign({ size: 250, diameter: 24 }, Tap.defaultAppearance), { emptyJet: true }),\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 150, max: 600,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"diameter\", label: \"Diameter\",\r\n                min: 18, max: 24, step: 0.1,\r\n            },\r\n            Tap.appearanceSpec,\r\n            {\r\n                spec: \"checkbox\", key: \"emptyJet\", label: \"Empty jet\",\r\n                visible: function (a) { return Tap.isClosed(a.tapOpening); },\r\n            },\r\n        ],\r\n    };\r\n    return Burette;\r\n}());\r\nexport { Burette };\r\n","export function clog() {\r\n    var args = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        args[_i] = arguments[_i];\r\n    }\r\n    console\r\n        .log.apply(console, arguments);\r\n}\r\n","import { P, R } from \"apparatus/library/common\";\r\nimport { Color, Gradient, Group, Shape } from \"paper\";\r\nvar SpottingTile = /** @class */ (function () {\r\n    function SpottingTile() {\r\n    }\r\n    SpottingTile.prototype.render = function (appearance) {\r\n        var wellDiameter = 20 * appearance.scale;\r\n        var gap = 5 * appearance.scale;\r\n        var shadowOffset = 5 * appearance.scale;\r\n        var margin = 10 * appearance.scale;\r\n        var rounded = 3 * appearance.scale;\r\n        var x, y;\r\n        switch (appearance.size) {\r\n            case \"six\":\r\n                x = 3;\r\n                y = 2;\r\n                break;\r\n            case \"sixteen\":\r\n                x = 4;\r\n                y = 4;\r\n                break;\r\n            case \"twelve\":\r\n            default:\r\n                x = 4;\r\n                y = 3;\r\n                break;\r\n        }\r\n        // Create tray.\r\n        var tray = Shape.Rectangle(R(-margin - wellDiameter / 2, -margin - wellDiameter / 2, x * wellDiameter + (x - 1) * gap + 2 * margin, y * wellDiameter + (y - 1) * gap + 2 * margin), rounded);\r\n        tray.fillColor = \"#e0e0e0\";\r\n        tray.strokeColor = \"#aaaaaa\";\r\n        tray.strokeWidth = 2.0;\r\n        var graphic = new Group([tray]);\r\n        // Gradient for the wells.\r\n        var wellGradient = new Gradient([[\"#f3f3f3\", 0.3], [\"#bbbbbb\", 1.0]], true);\r\n        var snapPoints = [];\r\n        // Create wells.\r\n        for (var i = 0; i < x; i++) {\r\n            for (var j = 0; j < y; j++) {\r\n                var well = Shape.Circle(P(0, 0), wellDiameter / 2);\r\n                well.fillColor = new Color(wellGradient, P(0, shadowOffset), P(0, wellDiameter * 1.2));\r\n                var x_1 = i * (wellDiameter + gap);\r\n                var y_1 = j * (wellDiameter + gap);\r\n                well.position.set(x_1, y_1);\r\n                graphic.addChild(well);\r\n                snapPoints.push(P(x_1, y_1 + 1));\r\n            }\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: {\r\n                type: \"spotting_tile\",\r\n                at: snapPoints\r\n            }\r\n        };\r\n    };\r\n    SpottingTile.properties = {\r\n        label: \"Spotting Tile\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            size: \"twelve\",\r\n            scale: 1.5,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"size\", label: \"Wells\", options: [\r\n                    { value: \"six\", label: \"6\" },\r\n                    { value: \"twelve\", label: \"12\" },\r\n                    { value: \"sixteen\", label: \"16\", tier: \"boost\" },\r\n                ]\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 1.0, max: 2.0, step: 0.05, unit: \"%\",\r\n            },\r\n        ],\r\n    };\r\n    return SpottingTile;\r\n}());\r\nexport { SpottingTile };\r\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { querystring } from \"api/querystringlite\";\r\nimport { isSpecialError } from \"api/specialErrorHandler\";\r\nimport { Consts } from \"vars\";\r\nexport var BACKEND_API = Consts.isDev ? \"http://localhost:3000\" : \"https://chemixapp.appspot.com\";\r\n/**\r\n * Helper method to call the API. It's a thin wrapper around fetch, adding:\r\n *  - type safety for request and response types\r\n *  - conversion of request data into stringified URL for GET methods\r\n */\r\nexport function callApi(path, method, auth, request, handlers) {\r\n    var _this = this;\r\n    if (auth === void 0) { auth = null; }\r\n    var headers = {};\r\n    headers[\"Content-Type\"] = \"application/json\";\r\n    if (auth) {\r\n        if (typeof auth === \"string\") {\r\n            headers[\"Authorization\"] = \"Bearer \" + auth;\r\n        }\r\n        else if (auth.state == \"logged_in\") {\r\n            var jwtToken = auth.jwtToken;\r\n            headers[\"Authorization\"] = \"Bearer \" + jwtToken;\r\n        }\r\n    }\r\n    var fetchOptions = {\r\n        headers: headers,\r\n        method: method,\r\n    };\r\n    // Add request data, depending on method.\r\n    if (method == \"GET\") {\r\n        // Stringify\r\n        path += '?' + querystring.stringify(request);\r\n    }\r\n    else {\r\n        fetchOptions[\"body\"] = JSON.stringify(request);\r\n    }\r\n    fetch(BACKEND_API + '/' + path, fetchOptions)\r\n        .then(function (r) { return __awaiter(_this, void 0, void 0, function () {\r\n        var parsedJson, handled, errorJson;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0: return [4 /*yield*/, r.json()];\r\n                case 1:\r\n                    parsedJson = _a.sent();\r\n                    if (r.status == 200) {\r\n                        handlers.success(parsedJson);\r\n                    }\r\n                    else {\r\n                        handled = void 0;\r\n                        if (isSpecialError(parsedJson) && handlers.special) {\r\n                            handled = handlers.special(parsedJson);\r\n                        }\r\n                        else if (handlers.common) {\r\n                            errorJson = parsedJson;\r\n                            handlers.common(errorJson.error);\r\n                            handled = true;\r\n                        }\r\n                        else {\r\n                            handled = false;\r\n                        }\r\n                        if (!handled) {\r\n                            if (handlers.generic) {\r\n                                handlers.generic();\r\n                            }\r\n                            else {\r\n                                console.error(\"Unhandled error: \", parsedJson);\r\n                                toastr.error(\"Unknown error making request.\");\r\n                            }\r\n                        }\r\n                    }\r\n                    // Invoke final callback if specified.\r\n                    if (handlers.finally)\r\n                        handlers.finally();\r\n                    return [2 /*return*/, parsedJson];\r\n            }\r\n        });\r\n    }); })\r\n        .catch(function (e) {\r\n        console.error(e);\r\n        if (handlers.generic) {\r\n            handlers.generic();\r\n        }\r\n        else {\r\n            toastr.error(e, \"Error making request.\");\r\n        }\r\n        if (handlers.finally)\r\n            handlers.finally();\r\n    });\r\n}\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { g } from \"analytics\";\r\nimport { moduleDisplayIcon, moduleDisplayName } from \"apparatus/specs\";\r\nimport { Icon } from \"components/icon\";\r\nimport { SearchBox } from \"components/searchbox\";\r\nimport Flags from \"flags\";\r\nimport { ApparatusList } from \"layout/sidebar/sidebar\";\r\nimport * as React from \"react\";\r\nimport { formatTooltip } from \"view/tooltips\";\r\n/** Component that displays the sidebar on the left. */\r\nvar TabbedSidebar = /** @class */ (function (_super) {\r\n    __extends(TabbedSidebar, _super);\r\n    function TabbedSidebar(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.state = {\r\n            currentTab: \"chemistry\",\r\n            searchTerm: \"\"\r\n        };\r\n        return _this;\r\n    }\r\n    TabbedSidebar.prototype.render = function () {\r\n        var _this = this;\r\n        return React.createElement(\"div\", { id: \"sidebar\" },\r\n            React.createElement(\"div\", { id: \"apparatus-search\" },\r\n                React.createElement(SearchBox, { value: this.state.searchTerm, onChange: function (v) { return _this.setState({ searchTerm: v }); }, onBlur: function (v) { return g(\"SearchApparatus\", v); }, placeholder: \"Search apparatus\", tooltip: formatTooltip(\"Search for apparatus and items\", [{ key: \"F\", ctrl: true }]), throttleMs: 100 })),\r\n            React.createElement(\"div\", { className: \"sidebar-tab-header\" }, this.tabName),\r\n            React.createElement(ApparatusList, { key: \"sideBar\", searchTerm: this.state.searchTerm, module: this.state.currentTab, onSwitchModule: function (m) { return _this.setState({ searchTerm: \"\", currentTab: m }); } }),\r\n            React.createElement(\"div\", { className: \"sidebar-tabs\" },\r\n                React.createElement(\"span\", { className: \"line\" }),\r\n                React.createElement(\"ul\", { \"data-simplebar\": true },\r\n                    this.tab(\"chemistry\"),\r\n                    this.tab(\"measurement\"),\r\n                    this.tab(\"heating\"),\r\n                    this.tab(\"biology\"),\r\n                    Flags.isPhysicsEnabled ? this.tab(\"physics\", true) : null,\r\n                    this.tab(\"distillation\"),\r\n                    this.tab(\"various\"),\r\n                    this.tab(\"shapes\"))));\r\n    };\r\n    TabbedSidebar.prototype.tab = function (module, beta) {\r\n        var _this = this;\r\n        return React.createElement(Tab, { active: !this.isInSearchMode && this.state.currentTab == module, hint: moduleDisplayName(module), icon: moduleDisplayIcon(module), key: module, onClick: function () { return _this.switchTab(module); }, beta: beta });\r\n    };\r\n    TabbedSidebar.prototype.switchTab = function (module) {\r\n        this.setState({ currentTab: module, searchTerm: \"\" });\r\n    };\r\n    Object.defineProperty(TabbedSidebar.prototype, \"tabName\", {\r\n        get: function () {\r\n            return this.isInSearchMode ? \"Search Results\" : moduleDisplayName(this.state.currentTab);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TabbedSidebar.prototype, \"isInSearchMode\", {\r\n        get: function () {\r\n            return this.state.searchTerm.length > 0;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return TabbedSidebar;\r\n}(React.Component));\r\nexport { TabbedSidebar };\r\nvar Tab = function (props) { return (React.createElement(\"li\", { \"data-qtipopts\": \"vertical\", className: props.active ? \"active\" : \"\", onClick: props.onClick },\r\n    React.createElement(Icon, { name: props.icon, fullWidth: false }),\r\n    props.hint,\r\n    props.beta === true ? React.createElement(\"div\", { className: \"badge badge-info ml-1\" }, \"BETA\") : undefined)); };\r\n","import { mirrorX, setDefaultStyleWithStroke } from \"apparatus/draw\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nimport { P } from \"./common\";\r\n/**\r\n * This is a special type of apparatus, used for development only!\r\n * It does not represent any specific apparatus, instead it\r\n * allows its own path segments to be edited live. This is useful\r\n * when trying to draw new apparatus, speeds up the process by\r\n * allowing the developer to see the path as the path is edited.\r\n *\r\n * Note that when specifying the path segments,\r\n * only numbers can be used, variables cannot be used.\r\n */\r\nvar LiveEditApparatus = /** @class */ (function () {\r\n    function LiveEditApparatus() {\r\n    }\r\n    LiveEditApparatus.prototype.render = function (appearance) {\r\n        var isValid = false;\r\n        try {\r\n            var rawSegmentsString = appearance.segments;\r\n            // Remove newlines, then surround with brackets to create an array.\r\n            var segmentsString = \"[\" + rawSegmentsString.replace(\"\\n\", \"\") + \"]\";\r\n            var evalSegments = eval(segmentsString);\r\n            var segments_2 = evalSegments;\r\n            // Validate each segment.\r\n            for (var _i = 0, segments_1 = segments_2; _i < segments_1.length; _i++) {\r\n                var segment = segments_1[_i];\r\n                if (segment.length < 1 || segment.length > 3) {\r\n                    throw new Error(\"Contains invalid segment\");\r\n                }\r\n                // Validate each point.\r\n                for (var _a = 0, segment_1 = segment; _a < segment_1.length; _a++) {\r\n                    var point = segment_1[_a];\r\n                    if (point !== undefined && point.length != 2) {\r\n                        throw new Error(\"Segment contains invalid point\");\r\n                    }\r\n                }\r\n            }\r\n            isValid = true;\r\n            this.lastValidSegments = segments_2;\r\n        }\r\n        catch (_b) {\r\n            // Input is invalid.\r\n        }\r\n        var segments = this.lastValidSegments;\r\n        var path = new Path(segments);\r\n        if (appearance.strokeThickness != \"none\") {\r\n            setDefaultStyleWithStroke(appearance.strokeThickness, path);\r\n        }\r\n        if (appearance.mirrored) {\r\n            mirrorX(path);\r\n        }\r\n        if (appearance.closed) {\r\n            path.fillColor = \"#dddddd80\";\r\n            path.closePath();\r\n        }\r\n        var graphic = new Group([path]);\r\n        if (appearance.xray) {\r\n            // Show the path and control points in yellow.\r\n            path.fullySelected = true;\r\n            path.selectedColor = \"#deb018\";\r\n        }\r\n        if (appearance.highlightFirstAndSecond) {\r\n            // Mark first and second points.\r\n            if (segments.length >= 2) {\r\n                var marker = Shape.Circle(P(segments[0][0][0], segments[0][0][1]), 6.5);\r\n                marker.fillColor = \"black\";\r\n                graphic.addChild(marker);\r\n            }\r\n            if (segments.length >= 3) {\r\n                var marker = Shape.Circle(P(segments[1][0][0], segments[1][0][1]), 5.0);\r\n                marker.fillColor = \"black\";\r\n                graphic.addChild(marker);\r\n            }\r\n        }\r\n        // Draw center.\r\n        graphic.addChild(Shape.Circle(P(0, 0), 2).withFill(\"green\"));\r\n        if (!isValid) {\r\n            graphic.strokeColor = \"red\";\r\n        }\r\n        var hitShape = graphic.bounds.toShape();\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShape,\r\n            pivot: appearance.lockPivot ? P(0, 0) : undefined\r\n        };\r\n    };\r\n    LiveEditApparatus.properties = {\r\n        label: \"Live-Edit\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            segments: \"[[0, 0]],\\n[[100, 0]],\\n[[100, 100]],\\n[[0, 100]]\",\r\n            closed: true,\r\n            mirrored: false,\r\n            xray: true,\r\n            highlightFirstAndSecond: false,\r\n            strokeThickness: \"default\",\r\n            lockPivot: true,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"textarea\", key: \"segments\", label: \"Segments\",\r\n            },\r\n            {\r\n                spec: \"checkbox-group\", label: \"Options\", checkboxes: [\r\n                    { key: \"closed\", label: \"Close path\" },\r\n                    { key: \"mirrored\", label: \"Mirrored\", },\r\n                    { key: \"xray\", label: \"Show X-ray\" },\r\n                    { key: \"highlightFirstAndSecond\", label: \"Highlight 1st and 2nd points\" },\r\n                    { key: \"lockPivot\", label: \"Lock Pivot\" },\r\n                ]\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"strokeThickness\", label: \"Stroke thickness\",\r\n                options: [\r\n                    { value: \"default\", label: \"Default\" },\r\n                    { value: \"thin\", label: \"Thin\" },\r\n                    { value: \"none\", label: \"None\" },\r\n                ],\r\n            }\r\n        ],\r\n    };\r\n    return LiveEditApparatus;\r\n}());\r\nexport { LiveEditApparatus };\r\n","export var Arrays;\r\n(function (Arrays) {\r\n    function includes(arr, item) {\r\n        return arr.indexOf(item) > -1;\r\n    }\r\n    Arrays.includes = includes;\r\n    function maybeExtend(arr, condition, item) {\r\n        if (condition) {\r\n            arr.push(item);\r\n        }\r\n        return arr;\r\n    }\r\n    Arrays.maybeExtend = maybeExtend;\r\n    function shallowStrictEquals(a, b) {\r\n        return a.length === b.length &&\r\n            a.every(function (val, index) { return val == b[index]; });\r\n    }\r\n    Arrays.shallowStrictEquals = shallowStrictEquals;\r\n})(Arrays || (Arrays = {}));\r\n","import { StyledTextCreator } from \"apparatus/draw\";\r\nimport { P, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nvar SimpleAmmeter = /** @class */ (function () {\r\n    function SimpleAmmeter() {\r\n        this.textStyler = new StyledTextCreator({\r\n            fontFamily: \"sans-serif\",\r\n            fillColor: SharedColors.stroke\r\n        });\r\n    }\r\n    SimpleAmmeter.prototype.render = function (appearance) {\r\n        var circle = new Path.Circle(P(0, 0), appearance.size / 2)\r\n            .withStroke(\"default\").withFill(\"white\");\r\n        var text = this.textStyler.create(\"A\", P(0, appearance.size * 0.35 * 0.7), { fontSize: appearance.size * 0.7 });\r\n        var graphic = new Group([circle, text]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    SimpleAmmeter.properties = {\r\n        label: \"Ammeter (Symbol)\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            size: 60\r\n        },\r\n        appearanceSpecs: [],\r\n    };\r\n    return SimpleAmmeter;\r\n}());\r\nexport { SimpleAmmeter };\r\n","import * as React from \"react\";\r\nimport { Articles } from \"support/beacon\";\r\n/** Clickable Chemix Logo. */\r\nexport var Logo = function (props) { return (React.createElement(\"a\", { key: \"logo_wrapper\", id: \"logo\" },\r\n    React.createElement(\"img\", { key: \"logo\", src: \"./images/192.png\", height: 48, width: 48, onClick: function () { return props.onClick(); }, title: \"About Chemix\" }))); };\r\n/** Social links. */\r\nexport var SocialWidgets = function (props) { return (React.createElement(\"span\", { id: \"socialWidgets\", style: { display: props.visible ? \"inline-block\" : \"none\" } },\r\n    React.createElement(\"iframe\", { id: \"fbWidget\", src: \"https://www.facebook.com/plugins/like.php?href=https%3A%2F%2Fwww.facebook.com%2Fchemix.org%2F&width=150&layout=button_count&colorscheme=dark& action=like&size=small&show_faces=true&share=true&height=21&appId\", width: 150, height: 21, style: { border: \"none\", overflow: \"hidden\" }, key: \"fbWidget\", scrolling: \"no\" }),\r\n    React.createElement(\"a\", { href: \"https://twitter.com/ChemixLab?ref_src=twsrc%5Etfw\", className: \"twitter-follow-button\", key: \"twitterWidget\", \"data-show-count\": \"true\", \"data-show-screen-name\": \"false\" }))); };\r\n/**\r\n * Screen-too-small warning.\r\n */\r\nexport var ScreenTooSmallWarning = function (props) {\r\n    return React.createElement(\"div\", { id: \"screen-too-small\" },\r\n        React.createElement(\"span\", { className: \"fa-stack fa-2x d-block mx-auto mb-2\" },\r\n            React.createElement(\"i\", { className: \"fal fa-desktop fa-stack-2x\" }),\r\n            React.createElement(\"i\", { className: \"fal fa-arrows-alt-h fa-stack-1x fa-lg mt-n2\" })),\r\n        React.createElement(\"br\", null),\r\n        React.createElement(\"h3\", null, \"Chemix requires a screen at least 650px\\u00A0wide.\"),\r\n        React.createElement(\"div\", { className: \"my-4 mx-auto\", style: { width: \"100%\", maxWidth: \"400px\" } },\r\n            React.createElement(\"ul\", { className: \"fa-ul text-left\" },\r\n                React.createElement(\"li\", null,\r\n                    React.createElement(\"span\", { className: \"fa-li\" },\r\n                        React.createElement(\"i\", { className: \"fas fa-desktop\" })),\r\n                    \"Use a larger screen (tablet, laptop or computer)\"),\r\n                React.createElement(\"li\", null,\r\n                    React.createElement(\"span\", { className: \"fa-li\" },\r\n                        React.createElement(\"i\", { className: \"fas fa-mobile-android-alt fa-rotate-90\" })),\r\n                    \"Rotate your device to landscape\"),\r\n                React.createElement(\"li\", null,\r\n                    React.createElement(\"span\", { className: \"fa-li\" },\r\n                        React.createElement(\"i\", { className: \"fas fa-info-circle\" })),\r\n                    React.createElement(\"a\", { href: \"#\", \"data-beacon-article\": Articles.ABOUT }, \"Learn more about Chemix\")),\r\n                React.createElement(\"li\", null,\r\n                    React.createElement(\"span\", { className: \"fa-li\" },\r\n                        React.createElement(\"i\", { className: \"fas fa-dollar-sign\" })),\r\n                    React.createElement(\"a\", { href: \"#pricing\", onClick: props.onPricingClick }, \"See pricing\")),\r\n                React.createElement(\"li\", null,\r\n                    React.createElement(\"span\", { className: \"fa-li\" },\r\n                        React.createElement(\"i\", { className: \"fas fa-question-circle\" })),\r\n                    React.createElement(\"a\", { href: \"#\", \"data-beacon-article\": Articles.SCREEN_TOO_SMALL }, \"Why is a wide screen needed?\")))));\r\n};\r\n","import { Segments } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nvar SteelWool = /** @class */ (function () {\r\n    function SteelWool() {\r\n    }\r\n    SteelWool.prototype.render = function (appearance) {\r\n        var scale = appearance.scale, squish = appearance.squish;\r\n        var wire1 = new Path(Segments([[16.5, 13.9], , [16.0, 11.0]], [[38.5, 24.9], [-1.0, 0.0], [0.0, 0.0]], [[12.5, 29.9], [11.2, 4.8], [-3.3, -1.4]], [[21.5, 4.9], [-6.8, 5.2], [9.3, -7.1]], [[31.5, 22.9], [9.6, -10.9], [-5.0, 5.7]], [[14.5, 20.9], [2.1, -0.9], [-2.9, 1.2]], [[30.5, 33.9], [-16.5, 1.1], [13.0, -0.8]], [[33.5, 10.9], [12.0, -1.8], [-26.5, 4.0]], [[1.5, 26.9], [5.3, 1.1], [-2.8, -0.6]], [[17.5, 19.9], [-12.0, -0.3], [19.0, 0.5]], [[44.5, 12.9], [1.2, 5.0], [-1.5, -6.2]], [[17.5, 23.9], [10.0, -6.8], [-1.9, 1.3]], [[27.5, 15.9], [-11.2, 3.1], [5.8, -1.6]], [[44.5, 14.9], [-5.3, 4.7], [3.1, -2.8]], [[35.5, 10.9], [6.7, -5.3], [-15.3, 12.0]], [[21.5, 29.9], [0.7, 1.2], [-2.0, -3.6]], [[22.5, 9.9], [-8.2, 0.9], [4.4, -0.5]], [[26.5, 29.9], [1.4, -1.4], [-0.7, 0.7]], [[23.5, 12.9], [-3.9, 11.4], [3.7, -10.8]], [[39.5, 19.9], [4.0, -13.6], [-3.0, 10.2]], [[11.5, 17.9], [7.2, 12.2], [-3.7, -6.3]], [[10.5, 6.9], [-2.8, 0.0], [11.3, 0.0]], [[36.5, 29.9], [-5.6, 1.5], [9.9, -2.7]], [[41.5, 7.9], [4.9, 6.4], [-3.3, -4.3]], [[12.5, 28.9], [8.8, -7.2], [-1.7, 1.4]], [[18.5, 19.9], [-6.5, 4.3], [7.5, -4.9]], [[43.5, 11.9], [-6.6, 5.5], [4.5, -3.7]], [[27.5, 14.9], [11.5, -13.5], [-7.0, 8.2]], [[17.5, 34.9], [2.0, -7.0], [0.0, 0.0]], [[17.5, 19.9], [0.0, 5.0]])).withStroke(1.5, \"#777777\");\r\n        var wire2 = new Path(Segments([[27.5, 13.6], , [-9.0, 15.0]], [[12.5, 35.6], [2.6, -1.1], [-5.5, 2.3]], [[20.5, 19.6], [-14.9, 5.3], [12.3, -4.4]], [[45.5, 19.6], [-4.2, 4.2], [0.7, -0.7]], [[34.5, 13.6], [9.5, 0.0], [-12.6, 0.0]], [[12.5, 34.6], [1.0, -6.0], [0.0, 0.0]], [[14.5, 32.6], [-1.0, 0.2], [5.3, -1.0]], [[34.5, 28.6], [-4.4, 5.8], [5.4, -7.2]], [[26.5, 9.6], [3.2, 0.1], [-4.1, -0.2]], [[26.5, 29.6], [-8.4, -3.9], [9.1, 4.2]], [[35.5, 16.6], [5.0, 5.7], [-3.8, -4.4]], [[20.5, 31.6], [-4.2, -7.9], [3.4, 6.4]], [[33.5, 25.6], [2.6, 7.6], [-5.0, -14.7]], [[15.5, 13.6], [1.5, -1.3], [-7.9, 6.5]], [[30.5, 38.6], [-10.6, 3.5], [4.2, -1.4]], [[24.5, 13.6], [3.4, 2.6], [-6.4, -4.9]], [[8.5, 27.6], [-7.4, -14.2], [5.6, 10.8]], [[36.5, 32.6], [-1.6, 3.9], [1.1, -2.8]], [[23.5, 21.6], [11.4, -0.7], [-10.8, 0.6]], [[17.5, 34.6], [-4.9, -1.0], [4.0, 0.8]], [[25.5, 28.6], [-1.2, 1.9], [2.6, -4.3]], [[34.5, 29.6], [-0.7, -6.4], [-1.1, -7.0]], [[41.5, 14.6], [-6.3, 1.3], [7.1, -1.4]], [[49.5, 31.6], [5.4, -4.9], [-3.7, 3.5]], [[40.5, 25.6], [0.3, 4.1], [-1.1, -13.0]], [[53.5, 9.6], [-5.6, -5.8], [8.3, 8.7]], [[39.5, 40.6], [3.0, -3.0]])).withStroke(1.5, \"#999999bb\");\r\n        wire2.rotate(-20);\r\n        wire2.position.x -= 5;\r\n        wire2.position.y -= 2;\r\n        var graphic = new Group([wire1, wire2]);\r\n        graphic.rotate(20);\r\n        switch (appearance.state) {\r\n            case \"normal\": break;\r\n            case \"burning\":\r\n                wire2.setRadialGradientStroke([[\"#F7CA6Cbb\", 0.15], [\"#F4D76Abb\", 0.6], [\"#7B6D6Dbb\", 1.0]]);\r\n                var glow = new Path.Circle(wire1.bounds.center, 22.0).setRadialGradientFill([[\"#feee8dff\", 0.0], [\"#f1990d80\", 0.5], [\"#f9e57b00\", 1.0]]);\r\n                glow.enableScalableGradient();\r\n                glow.scale(1.2, 1.0);\r\n                glow.blendMode = \"lighten\";\r\n                graphic.addChild(glow);\r\n                break;\r\n            case \"burnt\":\r\n                wire1.strokeColor = \"#333333\";\r\n                wire2.strokeColor = \"#222222bb\";\r\n        }\r\n        graphic.scale(scale, scale * (1 - squish));\r\n        // const bounds = graphic.bounds.clone().expand(-20)\r\n        // const r = new Random()\r\n        // for (var i = 0; i < 15; i++) {\r\n        //     const p = r.randomInBounds(bounds)\r\n        //     const spark = Shape.Circle(p, 5.0)\r\n        //     spark.setRadialGradientFill([[\"white\", 0.0],[\"#e7c924ff\", 0.4], [\"#f1990d00\", 1.0]])\r\n        //     spark.blendMode = \"hard-light\"\r\n        //     graphic.addChild(spark)\r\n        // }\r\n        // wire1.strokeColor = new Color(\r\n        //     new Gradient([[\"#ffffe2\", 0.0], [\"#fcaf3a\", 0.5],[\"#777777\", 0.9]], true),\r\n        //     wire1.bounds.center,\r\n        //     wire1.bounds.rightCenter,\r\n        // )\r\n        // wire2.strokeColor = new Color(\r\n        //     new Gradient([[\"#fff99ebb\", 0.0], [\"#999999bb\", 1.0]], true),\r\n        //     wire2.bounds.center,\r\n        //     wire2.bounds.rightCenter,\r\n        // )\r\n        // const spark = Shape.Circle(P(25, 25), 20.0)\r\n        // spark.setRadialGradientFill([[\"white\", 0.0],[\"#e7c924ff\", 0.4], [\"#ffd37a00\", 1.0]])\r\n        // spark.blendMode = \"overlay\"\r\n        // spark.opacity = 0.3\r\n        // graphic.addChild(spark)\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.expand(10).toShape(),\r\n            pivot: wire1.bounds.center,\r\n        };\r\n    };\r\n    SteelWool.properties = {\r\n        label: \"Steel Wool\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            scale: 1.0,\r\n            squish: 0.0,\r\n            state: \"normal\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Size\",\r\n                min: 0.75, max: 1.5, step: 0.01, unit: \"%\"\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"squish\", label: \"Squish\",\r\n                min: 0.0, max: 0.5, step: 0.01, unit: \"%\"\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"state\", label: \"\",\r\n                options: [\r\n                    { value: \"normal\", label: \"Normal\" },\r\n                    { value: \"burning\", label: \"Burning\" },\r\n                    { value: \"burnt\", label: \"Burnt\" },\r\n                ],\r\n            }\r\n        ],\r\n    };\r\n    return SteelWool;\r\n}());\r\nexport { SteelWool };\r\n","import { Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\n/** Thickness of the connecting band. */\r\nvar BAND_THICKNESS = 6;\r\n/**\r\n * A plastic joint clip, also known as Keck clip.\r\n * See http://www.sciencemadness.org/smwiki/index.php/Keck_clip\r\n */\r\nvar PlasticJointClip = /** @class */ (function () {\r\n    function PlasticJointClip() {\r\n    }\r\n    PlasticJointClip.prototype.render = function (appearance) {\r\n        // Diameter of top ring.\r\n        var topDiameter = appearance.diameter;\r\n        // Diameter of bottom ring.\r\n        var bottomDiameter = appearance.diameter + 5;\r\n        // Distance between the rings.\r\n        var distanceApart = 15;\r\n        // Thickness of each ring.\r\n        var ringThickness = 8;\r\n        var color = baseColor(appearance.color);\r\n        // Create the rings.\r\n        var topRing = Shape.Rectangle(R(0, 0, topDiameter, ringThickness, Pivot.CENTER), 2.0);\r\n        var bottomRing = Shape.Rectangle(R(0, distanceApart, bottomDiameter, ringThickness, Pivot.CENTER), 2.0);\r\n        setRingGradient(topRing, color);\r\n        setRingGradient(bottomRing, color);\r\n        // Create the connecting bands.\r\n        var bandLeft = new Path(Segments([[-topDiameter / 2, 0], , [-10, 0]], [[-bottomDiameter / 2, distanceApart], [-8, 0]]));\r\n        setBandGradient(bandLeft, color);\r\n        var bandMiddle = new Path(Segments([[0, 0]], [[0, distanceApart]]));\r\n        setBandGradient(bandMiddle, color);\r\n        bandMiddle.strokeCap = \"square\";\r\n        var bandRight = new Path(Segments([[topDiameter / 2, 0], , [10, 0]], [[bottomDiameter / 2, distanceApart], [8, 0]]));\r\n        setBandGradient(bandRight, color);\r\n        // Assemble together.\r\n        var graphic = new Group([topRing, bottomRing, bandLeft, bandRight, bandMiddle]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    PlasticJointClip.properties = {\r\n        label: \"Plastic Joint Clip\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            diameter: 30,\r\n            color: \"red\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"diameter\", label: \"Diameter\",\r\n                min: 20, max: 50\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"color\", label: \"Colour\",\r\n                options: [\r\n                    { value: \"red\", label: \"Red\" },\r\n                    { value: \"green\", label: \"Green\", tier: \"boost\" },\r\n                    { value: \"blue\", label: \"Blue\", tier: \"boost\" },\r\n                    { value: \"yellow\", label: \"Yellow\", tier: \"boost\" },\r\n                    { value: \"white\", label: \"White\", tier: \"boost\" },\r\n                ],\r\n            }\r\n        ],\r\n    };\r\n    return PlasticJointClip;\r\n}());\r\nexport { PlasticJointClip };\r\nfunction baseColor(input) {\r\n    switch (input) {\r\n        case \"red\": return \"#de5a4e\";\r\n        case \"green\": return \"#32a852\";\r\n        case \"blue\": return \"#2266d4\";\r\n        case \"yellow\": return \"#e0d836\";\r\n        case \"white\": return \"#dddddd\";\r\n    }\r\n}\r\nfunction setRingGradient(item, color) {\r\n    var darkerColor = color.color().darken(0.15).hex();\r\n    var outlineColor = color.color().darken(0.4).hex();\r\n    item.setGradientFill(\"right\", [[darkerColor, 0.0], [color, 0.5], [darkerColor, 1.0]]);\r\n    item.withStroke(\"thinner\", outlineColor);\r\n}\r\nfunction setBandGradient(item, color) {\r\n    var darkColor = color.color().darken(0.2).hex();\r\n    var darkerColor = color.color().darken(0.4).hex();\r\n    item.setGradientStroke(\"down\", [[darkColor, 0.0], [darkerColor, 1.0]]);\r\n    item.strokeCap = \"butt\";\r\n    item.strokeWidth = BAND_THICKNESS;\r\n}\r\n","import { createOutlinedGroup, smoothCorner } from \"apparatus/draw\";\r\nimport { R, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nvar LightGate = /** @class */ (function () {\r\n    function LightGate() {\r\n    }\r\n    LightGate.prototype.render = function (appearance) {\r\n        var color = appearance.color;\r\n        var darker = appearance.color.color().darken(0.3).hex();\r\n        var side = new Path.Rectangle(R(0, 0, 8, 120)).withFill(darker);\r\n        smoothCorner(side.segments[1], 2.0);\r\n        var side2 = new Path.Rectangle(R(20, 0, 8, 120)).withFill(darker);\r\n        var front = new Path(Segments([[7, 0]], [[35, 0]], [[35, 120]], [[27, 120]], [[27, 20]], [[15, 20]], [[15, 120]], [[7, 120]])).close().withFill(color);\r\n        smoothCorner(front.segments[1], 2.0);\r\n        var gate = createOutlinedGroup(\"default\", SharedColors.stroke, side, side2, front);\r\n        var graphic = new Group([gate]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    LightGate.properties = {\r\n        label: \"Light Gate\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            color: \"#666666\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"color\", label: \"Colour\",\r\n                options: [\r\n                    { value: \"#666666\", label: \"Black\" },\r\n                    { value: \"#cccccc\", label: \"White\" },\r\n                ],\r\n            }\r\n        ],\r\n    };\r\n    return LightGate;\r\n}());\r\nexport { LightGate };\r\n","var __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { g } from \"analytics\";\r\nimport { commandProcessor, Sequence } from \"command/command\";\r\nimport { Align } from \"editing/arrange/align\";\r\nimport { Distribute } from \"editing/arrange/distribute\";\r\nimport { getDescendantIDs } from \"editing/grouping/operations\";\r\nimport Flags from \"flags\";\r\nimport { createSingleLayerLiquidPropsSection } from \"panel/apparatus_panel_ui\";\r\nimport { createOrderingButtons } from \"panel/ordering_ui\";\r\nexport function sectionsForMultipleItems(selected, app) {\r\n    var elements = [];\r\n    if ((selected.standaloneObjectsCount + selected.groupsCount) > 1) {\r\n        elements.push.apply(elements, createAlignAndDistributeIcons(selected, app));\r\n    }\r\n    // Reordering should happen on items only, on the uncategorised items\r\n    // so that items in groups, can be moved to.\r\n    if ((selected.standaloneObjectsCount + selected.groupsCount) > 0) {\r\n        elements.push(createOrderingButtons(selected.items.map(function (i) { return i.id; })));\r\n    }\r\n    if (selected.shouldAllowGrouping || selected.shouldAllowUngrouping) {\r\n        if (selected.shouldAllowGrouping) {\r\n            elements.push({\r\n                spec: \"button\",\r\n                key: \"groupObjects\",\r\n                label: \"Grouping\",\r\n                buttonLabel: \"Group objects\",\r\n                icon: \"object-group\",\r\n                onClick: function () {\r\n                    var command = selected.createGroupObjectsCommand();\r\n                    if (command) {\r\n                        g(\"Grouping\", \"Group\");\r\n                        commandProcessor.execute(command);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        if (selected.shouldAllowUngrouping) {\r\n            elements.push({\r\n                spec: \"button\",\r\n                key: \"ungroupObjects\",\r\n                label: \"Grouping\",\r\n                buttonLabel: \"Ungroup objects\",\r\n                icon: \"object-ungroup\",\r\n                onClick: function () {\r\n                    var command = selected.createUngroupObjectsCommand();\r\n                    if (command) {\r\n                        g(\"Grouping\", \"Ungroup\");\r\n                        commandProcessor.execute(command);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n    return {\r\n        title: selected.displayString,\r\n        icon: \"mouse-pointer\",\r\n        tabs: __spreadArrays([\r\n            {\r\n                type: \"tools\",\r\n                sections: [\r\n                    {\r\n                        header: \"Tools\",\r\n                        icon: \"wrench\",\r\n                        hideHeaderIfFirst: true,\r\n                        elements: elements,\r\n                    },\r\n                ],\r\n            }\r\n        ], (Flags.isEditingMultipleItemsOfSameTypeEnabled && selected.isItemsWithLiquidOnly ? [\r\n            {\r\n                type: \"liquid\",\r\n                colorDot: selected.getConsistentItemsLiquidColor(),\r\n                sections: [\r\n                    {\r\n                        header: \"Liquid\",\r\n                        icon: \"tint\",\r\n                        hideHeaderIfFirst: true,\r\n                        elements: createSingleLayerLiquidPropsSection(selected.items, app)\r\n                    }\r\n                ]\r\n            }\r\n        ] : []))\r\n    };\r\n}\r\nfunction createAlignAndDistributeIcons(selected, app) {\r\n    // Align is only supported for items and arrows and groups.\r\n    // If an arrow is inside a group, the arrow will be ignored for purposes of alignment.\r\n    var itemComponents = selected.standaloneItems.map(function (i) { return app.getObjectComponent(i.id); });\r\n    var arrowComponents = selected.standaloneArrows.map(function (a) { return app.getObjectComponent(a.id); });\r\n    var groupAlignables = selected.rootGroups.map(function (g) { return new AlignableGroup(g, app); });\r\n    var alignables = __spreadArrays(itemComponents, arrowComponents, groupAlignables);\r\n    return [{\r\n            spec: \"horizontal-icon-buttons\",\r\n            label: \"Align\",\r\n            key: \"HorizontalAlign\",\r\n            buttons: [\r\n                {\r\n                    buttonLabel: \"Align left edges\", icon: \"chemicons-align-left\",\r\n                    onClick: function () {\r\n                        var commands = Align.align(alignables, \"left\");\r\n                        if (commands) {\r\n                            g(\"AlignItems\", \"left\");\r\n                            commandProcessor.execute(new Sequence(commands));\r\n                        }\r\n                    }\r\n                },\r\n                {\r\n                    buttonLabel: \"Align horizontal center\", icon: \"chemicons-align-v-center\",\r\n                    onClick: function () {\r\n                        var commands = Align.alignCenters(alignables, \"x\");\r\n                        if (commands) {\r\n                            g(\"AlignItems\", \"horizontal-centers\");\r\n                            commandProcessor.execute(new Sequence(commands));\r\n                        }\r\n                    }\r\n                },\r\n                {\r\n                    buttonLabel: \"Align right edges\", icon: \"chemicons-align-right\",\r\n                    onClick: function () {\r\n                        var commands = Align.align(alignables, \"right\");\r\n                        if (commands) {\r\n                            g(\"AlignItems\", \"right\");\r\n                            commandProcessor.execute(new Sequence(commands));\r\n                        }\r\n                    }\r\n                }\r\n            ]\r\n        }, {\r\n            spec: \"horizontal-icon-buttons\",\r\n            label: \"\",\r\n            key: \"VerticalAlign\",\r\n            buttons: [\r\n                {\r\n                    buttonLabel: \"Align top edges\", icon: \"chemicons-align-top\",\r\n                    onClick: function () {\r\n                        var commands = Align.align(alignables, \"top\");\r\n                        if (commands) {\r\n                            g(\"AlignItems\", \"top\");\r\n                            commandProcessor.execute(new Sequence(commands));\r\n                        }\r\n                    }\r\n                },\r\n                {\r\n                    buttonLabel: \"Align vertical centers\", icon: \"chemicons-align-h-center\",\r\n                    onClick: function () {\r\n                        var commands = Align.alignCenters(alignables, \"y\");\r\n                        if (commands) {\r\n                            g(\"AlignItems\", \"vertical-centers\");\r\n                            commandProcessor.execute(new Sequence(commands));\r\n                        }\r\n                    }\r\n                },\r\n                {\r\n                    buttonLabel: \"Align bottom edges\", icon: \"chemicons-align-bottom\",\r\n                    onClick: function () {\r\n                        var commands = Align.align(alignables, \"bottom\");\r\n                        if (commands) {\r\n                            g(\"AlignItems\", \"bottom\");\r\n                            commandProcessor.execute(new Sequence(commands));\r\n                        }\r\n                    }\r\n                }\r\n            ]\r\n        }, {\r\n            spec: \"horizontal-icon-buttons\",\r\n            label: \"Distribute\",\r\n            key: \"Distribute\",\r\n            buttons: [\r\n                {\r\n                    buttonLabel: \"Distribute centers horizontally\", icon: \"chemicons-distribute-h-center\",\r\n                    onClick: function () {\r\n                        var commands = Distribute.distributeCenters(alignables, \"x\");\r\n                        if (commands) {\r\n                            g(\"AlignItems\", \"distribute-horizontal-centers\");\r\n                            commandProcessor.execute(new Sequence(commands));\r\n                        }\r\n                    }\r\n                },\r\n                {\r\n                    buttonLabel: \"Distribute horizontal gaps\", icon: \"chemicons-distribute-h-gap\",\r\n                    onClick: function () {\r\n                        var commands = Distribute.distributeGaps(alignables, \"x\");\r\n                        if (commands) {\r\n                            g(\"AlignItems\", \"distribute-horizontal-gaps\");\r\n                            commandProcessor.execute(new Sequence(commands));\r\n                        }\r\n                    }\r\n                },\r\n                {\r\n                    buttonLabel: \"Distribute centers vertically\", icon: \"chemicons-distribute-v-center\",\r\n                    onClick: function () {\r\n                        var commands = Distribute.distributeCenters(alignables, \"y\");\r\n                        if (commands) {\r\n                            g(\"AlignItems\", \"distribute-vertical-centers\");\r\n                            commandProcessor.execute(new Sequence(commands));\r\n                        }\r\n                    }\r\n                },\r\n                {\r\n                    buttonLabel: \"Distribute vertical gaps\", icon: \"chemicons-distribute-v-gap\",\r\n                    onClick: function () {\r\n                        var commands = Distribute.distributeGaps(alignables, \"y\");\r\n                        if (commands) {\r\n                            g(\"AlignItems\", \"distribute-vertical-gaps\");\r\n                            commandProcessor.execute(new Sequence(commands));\r\n                        }\r\n                    }\r\n                },\r\n            ]\r\n        }];\r\n}\r\n/** Provides Alignable implementation for a group. */\r\nvar AlignableGroup = /** @class */ (function () {\r\n    function AlignableGroup(group, app) {\r\n        this.group = group;\r\n        this.app = app;\r\n    }\r\n    Object.defineProperty(AlignableGroup.prototype, \"alignmentBounds\", {\r\n        get: function () {\r\n            var _this = this;\r\n            // Retrieve objects. Only select apparatus items.\r\n            var childIds = getDescendantIDs(this.group).filter(function (i) { return i.type === \"apparatus\"; });\r\n            var allBounds = childIds.map(function (id) { return _this.app.getObjectComponent(id); }).map(function (c) { return c.bounds; });\r\n            // Merge all bounds.\r\n            var bounds = allBounds[0];\r\n            for (var _i = 0, allBounds_1 = allBounds; _i < allBounds_1.length; _i++) {\r\n                var bound = allBounds_1[_i];\r\n                bounds.united(bound);\r\n            }\r\n            return bounds;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AlignableGroup.prototype, \"id\", {\r\n        get: function () {\r\n            return this.group.id;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return AlignableGroup;\r\n}());\r\n","import { mirrorX, smoothCornersIndividual } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nfunction getColours(a) {\r\n    switch (a.color) {\r\n        case \"black\": return { fill: \"#444444\".color(), stroke: \"#333333\" };\r\n        case \"white\": return { fill: \"#eeeeee\".color(), stroke: \"#666666\" };\r\n    }\r\n}\r\nvar Camera = /** @class */ (function () {\r\n    function Camera() {\r\n    }\r\n    Camera.prototype.render = function (appearance) {\r\n        var _a = getColours(appearance), fill = _a.fill, stroke = _a.stroke;\r\n        var body = new Path(Segments([[5, -60]], [[10, -50]], [[22, -50]], [[22, 50]]));\r\n        mirrorX(body);\r\n        body.closePath();\r\n        smoothCornersIndividual(body, {\r\n            0: 2.0,\r\n            2: 3.0,\r\n            3: 3.0,\r\n            4: 3.0,\r\n            5: 3.0,\r\n            7: 2.0,\r\n        });\r\n        body.withStroke(\"default\", stroke)\r\n            .withGradientFill(\"right\", Gradients.box(fill, { delta: 4 }));\r\n        var graphic = new Group([\r\n            Shape.Rectangle(R(22, 5, 50, 60, Pivot.CENTER_LEFT), 2.0)\r\n                .withGradientFill(\"down\", Gradients.cylinder(fill, 2))\r\n                .withStroke(\"default\", stroke),\r\n            body,\r\n        ]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    Camera.properties = {\r\n        label: \"Camera\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            color: \"black\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"color\", label: \"Colour\",\r\n                options: [\r\n                    { value: \"black\", label: \"Black\" },\r\n                    { value: \"white\", label: \"White\", tier: \"boost\" },\r\n                ],\r\n            }\r\n        ],\r\n    };\r\n    return Camera;\r\n}());\r\nexport { Camera };\r\nvar VideoCamera = /** @class */ (function () {\r\n    function VideoCamera() {\r\n    }\r\n    VideoCamera.prototype.render = function (appearance) {\r\n        var _a = getColours(appearance), fill = _a.fill, stroke = _a.stroke;\r\n        var out = new Path(Segments([[140, 20]], [[180, 10]], [[180, 70]], [[140, 60]])).withStroke(\"default\", stroke)\r\n            .withGradientFill(\"down\", Gradients.cylinder(fill, 3));\r\n        var graphic = new Group([\r\n            out,\r\n            Shape.Rectangle(R(0, 15, 12, 20, Pivot.CENTER_RIGHT), 2.0)\r\n                .withFill(stroke),\r\n            Shape.Rectangle(R(0, 0, 140, 80), 2.0)\r\n                .withGradientFill(\"down\", Gradients.box(fill, { delta: 6 }))\r\n                .withStroke(\"default\", stroke),\r\n            Shape.Circle(P(125, 15), 5.0)\r\n                .withStroke(\"thinner\", \"#fc5c51\")\r\n                .withFill(\"#eb4034\")\r\n        ]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    VideoCamera.properties = {\r\n        label: \"Video Camera\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: Camera.properties.defaultAppearance,\r\n        appearanceSpecs: Camera.properties.appearanceSpecs,\r\n    };\r\n    return VideoCamera;\r\n}());\r\nexport { VideoCamera };\r\n","import { mirrorX, strokeWidth } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, Pivot, R, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { hsl } from \"color\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar NichromeLoop = /** @class */ (function () {\r\n    function NichromeLoop() {\r\n    }\r\n    NichromeLoop.prototype.render = function (appearance) {\r\n        var loop = new Path(Segments([[0, 80]], [[-0.5, 15], , [0, -5]], [[5, 5], [0, 4], [0, -3]], [[0, 0], [3, 0]]));\r\n        mirrorX(loop);\r\n        loop.withStroke(strokeWidth(\"thin\"), SharedColors.mediumMetal);\r\n        var graphic = new Group([loop]);\r\n        if (appearance.handle) {\r\n            var handle = Shape.Rectangle(R(0, 80, 10, 140, Pivot.TOP_CENTER), 3.0)\r\n                .withGradientFill(\"right\", Gradients.cylinder(hsl(39, 65, 64)))\r\n                .withStroke(strokeWidth(\"thin\"), hsl(39, 45, 40).string());\r\n            graphic.addChild(handle);\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.expand(20).toShape(),\r\n            watermark: P(0, 80)\r\n        };\r\n    };\r\n    NichromeLoop.properties = {\r\n        label: \"Nichrome Loop\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            handle: true\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"checkbox\", key: \"handle\", label: \"Handle\", subLabel: \"Show\"\r\n            }\r\n        ],\r\n    };\r\n    return NichromeLoop;\r\n}());\r\nexport { NichromeLoop };\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { g } from \"analytics\";\r\nimport { clamp, P, Pp, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { UpdateArrowProperties } from \"arrows/command\";\r\nimport { createInteractionHandleFor } from \"editing/handle\";\r\nimport { Key, Path, Point } from \"paper\";\r\nimport * as React from \"react\";\r\nimport { appStore } from \"store/store\";\r\nimport { ChemMark } from \"text/parse\";\r\nimport { AdvancedText } from \"text/render\";\r\nimport { add } from \"types\";\r\nimport { Adjustable, Interactable, SelectAndMove } from \"../editing/interaction\";\r\n/**\r\n * React component to draw an arrow, accompanied by a text label.\r\n * The \"start\" is one extremity and where the label is placed.\r\n * The \"end\" is the other, and is where the arrow head is placed.\r\n */\r\nvar ArrowComponent = /** @class */ (function (_super) {\r\n    __extends(ArrowComponent, _super);\r\n    function ArrowComponent(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        /** Text cache. */\r\n        _this.textCache = {\r\n            mode: \"basic\",\r\n            input: \"\",\r\n            result: { segments: [] }\r\n        };\r\n        var start = new Point(props.start);\r\n        _this.advancedText = AdvancedText.withInteraction(SelectAndMove(_this));\r\n        _this.textStyle = {\r\n            fontFamily: \"sans-serif\",\r\n            fontSize: _this.props.fontSize,\r\n            textAlign: _this.props.textAlign,\r\n            fillColor: \"black\",\r\n        };\r\n        _this.line = new Path([start, start]);\r\n        _this.line.strokeWidth = 3.0;\r\n        _this.line.selectedColor = SharedColors.selectionGreen;\r\n        _this.hittableLine = new (Interactable(Path, SelectAndMove(_this)))([start, start]);\r\n        _this.hittableLine.strokeWidth = 20.0;\r\n        _this.hittableLine.strokeColor = \"#ffffff20\";\r\n        _this.arrowHead = _this.createArrowHead();\r\n        _this.arrowHead.applyMatrix = false;\r\n        // Create an interaction handler for adjusting the head.\r\n        _this.arrowHeadHint = createInteractionHandleFor(Adjustable({\r\n            setDelta: function (delta) {\r\n                _this.setState({ end: _this.editArrowHead(props, delta) });\r\n            },\r\n            onEnd: function (delta) {\r\n                g(\"UpdateAppearance\", \"Arrow::{driver}_head\");\r\n                return new UpdateArrowProperties([{\r\n                        id: _this.id,\r\n                        value: { start: _this.props.start, end: _this.editArrowHead(props, delta) },\r\n                        previousValue: { start: _this.props.start, end: _this.props.end },\r\n                    }]);\r\n            },\r\n        }));\r\n        // Create an interaction handler for adjusting the tail.\r\n        _this.arrowTailHint = createInteractionHandleFor(Adjustable({\r\n            setDelta: function (delta) {\r\n                _this.setState({ start: _this.editArrowTail(props, delta) });\r\n            },\r\n            onEnd: function (delta) {\r\n                g(\"UpdateAppearance\", \"Arrow::{driver}_start\");\r\n                return new UpdateArrowProperties([{\r\n                        id: _this.id,\r\n                        value: { start: _this.editArrowTail(props, delta), end: _this.props.end },\r\n                        previousValue: { start: _this.props.start, end: _this.props.end },\r\n                    }]);\r\n            },\r\n        }));\r\n        _this.state = {\r\n            start: _this.props.start,\r\n            end: _this.props.end,\r\n            label: _this.props.label,\r\n            fontSize: _this.props.fontSize,\r\n            textColor: _this.props.textColor,\r\n            arrowThickness: _this.props.arrowThickness,\r\n        };\r\n        return _this;\r\n    }\r\n    ArrowComponent.prototype.editArrowHead = function (props, delta) {\r\n        var deltaVectorPosition = add(this.props.end, delta);\r\n        if (Key.modifiers.shift) {\r\n            var arrowStartPoint = Pp(this.props.start);\r\n            var arrowEndPoint = Pp(add(this.props.end, delta));\r\n            var deltaVector = arrowEndPoint.subtract(arrowStartPoint);\r\n            var angle = deltaVector.angle;\r\n            var roundedAngle = ((angle / 45).round()) * 45;\r\n            deltaVector.angle = roundedAngle;\r\n            deltaVectorPosition = add(this.props.start, deltaVector);\r\n        }\r\n        return deltaVectorPosition;\r\n    };\r\n    ArrowComponent.prototype.editArrowTail = function (props, delta) {\r\n        var deltaVectorPosition = add(this.props.start, delta);\r\n        if (Key.modifiers.shift) {\r\n            var arrowStartPoint = Pp(add(this.props.start, delta));\r\n            var arrowEndPoint = Pp(this.props.end);\r\n            var deltaVector = arrowStartPoint.subtract(arrowEndPoint);\r\n            var angle = deltaVector.angle;\r\n            var roundedAngle = ((angle / 45).round()) * 45;\r\n            deltaVector.angle = roundedAngle;\r\n            deltaVectorPosition = add(this.props.end, deltaVector);\r\n        }\r\n        return deltaVectorPosition;\r\n    };\r\n    Object.defineProperty(ArrowComponent.prototype, \"currentPosition\", {\r\n        get: function () {\r\n            return Pp(this.props.end).add(Pp(this.props.start)).divide(2.0);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ArrowComponent.prototype, \"bounds\", {\r\n        get: function () {\r\n            if (this.props.showArrow) {\r\n                return this.line.bounds.unite(this.advancedText.bounds);\r\n            }\r\n            // Without arrow, only the text forms the bounding box.\r\n            return this.advancedText.bounds;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ArrowComponent.prototype, \"alignmentBounds\", {\r\n        get: function () {\r\n            var _a;\r\n            // For alignment, only use the text's bounds.\r\n            // Use the special alignment bounds, which ignore the subscript etc.\r\n            // Fallback on normal bounds, sometimes alignmentBounds can be undefined for some reason?\r\n            // https://sentry.io/share/issue/2c94edea5df7495f8ed74e31c23bf496/\r\n            return (_a = this.advancedText.alignmentBounds) !== null && _a !== void 0 ? _a : this.advancedText.bounds;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ArrowComponent.prototype, \"parentGroup\", {\r\n        get: function () {\r\n            return this.props.parentGroup;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ArrowComponent.prototype, \"id\", {\r\n        get: function () {\r\n            return this.props.id;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ArrowComponent.prototype, \"isSelected\", {\r\n        get: function () {\r\n            return this.props.selected;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ArrowComponent.prototype, \"currentRotation\", {\r\n        get: function () {\r\n            return 0;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    ArrowComponent.prototype.setPositionDelta = function (delta) {\r\n        this.setState({\r\n            start: add(this.props.start, delta),\r\n            end: add(this.props.end, delta)\r\n        });\r\n    };\r\n    ArrowComponent.prototype.setRotationDelta = function (delta, pivot) {\r\n        var newStart = Pp(this.props.start).rotate(delta, pivot);\r\n        var newEnd = Pp(this.props.end).rotate(delta, pivot);\r\n        this.setState({\r\n            start: newStart,\r\n            end: newEnd,\r\n        });\r\n    };\r\n    ArrowComponent.prototype.UNSAFE_componentWillReceiveProps = function (nextProps) {\r\n        this.setState({\r\n            start: nextProps.start,\r\n            end: nextProps.end,\r\n            label: nextProps.label,\r\n            fontSize: nextProps.fontSize,\r\n            textColor: nextProps.textColor,\r\n            arrowThickness: nextProps.arrowThickness,\r\n        });\r\n    };\r\n    ArrowComponent.prototype.componentWillUnmount = function () {\r\n        // Remove all paper elements.\r\n        this.arrowHead.remove();\r\n        this.line.remove();\r\n        this.hittableLine.remove();\r\n        this.advancedText.remove();\r\n        this.arrowHeadHint.remove();\r\n        this.arrowTailHint.remove();\r\n    };\r\n    ArrowComponent.prototype.render = function () {\r\n        var start = Pp(this.state.start);\r\n        var end = Pp(this.state.end);\r\n        // Displacement vector, points from start to end.\r\n        var vector = end.subtract(start);\r\n        this.line.segments[0].point = start;\r\n        // Shorten the end by a bit so it does not overlap the arrow head.\r\n        var lineLength = Math.max(0, vector.length - 10.0);\r\n        this.line.segments[1].point = start.add(vector.normalize().multiply(lineLength));\r\n        // Copy the segments over to the hittable line.\r\n        this.hittableLine.segments[0].point = this.line.segments[0].point;\r\n        this.hittableLine.segments[1].point = this.line.segments[1].point;\r\n        this.arrowHead.position = end;\r\n        this.arrowHead.rotation = vector.angle;\r\n        this.arrowHead.scaling.x = clamp(vector.length / 20.0, 0.1, 1.0);\r\n        // Set color.\r\n        var arrowColor = \"black\";\r\n        this.line.strokeColor = arrowColor;\r\n        this.arrowHead.fillColor = arrowColor;\r\n        // Set text colour.\r\n        var textColor = this.state.textColor;\r\n        this.textStyle.fillColor = textColor;\r\n        // Set alignment.\r\n        this.textStyle.textAlign = this.props.textAlign;\r\n        // Selection outline.\r\n        this.advancedText.container.selected = this.isSelected;\r\n        // Update label text. This needs to be done first before we update its position.\r\n        // Note: Since this relies on setting the style, it needs to be called\r\n        // after the line that sets up the text color.\r\n        this.textStyle.fontSize = this.state.fontSize * 2;\r\n        this.textStyle.fontFamily = this.props.fontFamily;\r\n        var formattedText = getFormattedText(this.textCache, this.state.label, this.props.isChemMarkEnabled);\r\n        this.advancedText.setText(formattedText, this.textStyle);\r\n        // Place the text at the start of the arrow.\r\n        // Note: This has to happen *after* setText.\r\n        this.advancedText.setPosition(start.x, start.y);\r\n        this.adjustLabel(vector.angle);\r\n        if (this.props.endStyle == \"none\") {\r\n            this.arrowHead.fillColor = SharedColors.transparent;\r\n        }\r\n        // Set thickness.\r\n        this.line.strokeWidth = this.state.arrowThickness;\r\n        this.hittableLine.strokeWidth = this.state.arrowThickness + 17.0;\r\n        var arrowScale = this.state.arrowThickness / 3.0;\r\n        this.arrowHead.scaling = P(arrowScale, arrowScale);\r\n        // Adjust hint. Only show it when the arrow is selected.\r\n        this.arrowHeadHint.position = end;\r\n        this.arrowHeadHint.visible = this.props.showAdjustables;\r\n        this.arrowTailHint.position = start;\r\n        this.arrowTailHint.visible = this.props.showAdjustables;\r\n        // Show/Hide arrow.\r\n        if (this.props.showArrow) {\r\n            this.line.visible = true;\r\n            this.hittableLine.visible = true;\r\n            this.arrowHead.visible = true;\r\n        }\r\n        else {\r\n            this.line.visible = false;\r\n            this.hittableLine.visible = false;\r\n            this.arrowHead.visible = false;\r\n            this.arrowHeadHint.visible = false;\r\n            this.arrowTailHint.visible = false;\r\n        }\r\n        return null;\r\n    };\r\n    // Adjust the label's properties based on the arrow's angle,\r\n    // so that it does not overlap the arrow.\r\n    ArrowComponent.prototype.adjustLabel = function (angle) {\r\n        // Add some padding around the label.\r\n        var bounds = this.advancedText.bounds.expand(P(20, 8));\r\n        var vector = intersectCenterRayWithBox(bounds.width, bounds.height, angle);\r\n        this.advancedText.container.position.x -= vector.x;\r\n        this.advancedText.container.position.y -= vector.y;\r\n    };\r\n    // Draw an arrow, pointing to the right.\r\n    ArrowComponent.prototype.createArrowHead = function () {\r\n        var path = new Path(Segments([[0, -8]], [[0, 8]], [[20, 0]]));\r\n        path.pivot = path.segments[2].point;\r\n        path.closePath();\r\n        return path;\r\n    };\r\n    return ArrowComponent;\r\n}(React.Component));\r\nexport default ArrowComponent;\r\n/**\r\n * Returns the formatted text to render.\r\n */\r\nfunction getFormattedText(cache, text, isChemMarkEnabled) {\r\n    if (!isChemMarkEnabled) {\r\n        // Check the cache.\r\n        if (cache.mode != \"basic\" || cache.input != text) {\r\n            cache.mode = \"basic\";\r\n            cache.input = text;\r\n            cache.result = ChemMark.parseBasic(text);\r\n        }\r\n        return cache.result;\r\n    }\r\n    if (!appStore.getState().tier) {\r\n        if (cache.mode != \"cmlimited\" || cache.input != text) {\r\n            cache.mode = \"cmlimited\";\r\n            cache.input = text;\r\n            cache.result = ChemMark.parseSmartLimited(text);\r\n        }\r\n        return cache.result;\r\n    }\r\n    if (cache.mode != \"cm\" || cache.input != text) {\r\n        cache.mode = \"cm\";\r\n        cache.input = text;\r\n        cache.result = ChemMark.parseSmart(text);\r\n    }\r\n    return cache.result;\r\n}\r\n/**\r\n * Computes the vector from the center of a box to its edge.\r\n * Used to position the text box at the end of an arrow\r\n * @param angle Angle in degrees, range = [-180, 180]\r\n */\r\nfunction intersectCenterRayWithBox(width, height, angleDeg) {\r\n    // Assuming fixed x, compute what y would be.\r\n    var candidateX = (angleDeg >= -90 && angleDeg <= 90) ? width / 2 : -width / 2;\r\n    var candidateY = Math.tan(angleDeg.toRadians()) * candidateX;\r\n    // If resulting y is within the box, the intersection occurs on the left or right side.\r\n    if (candidateY <= height / 2 && candidateY >= -height / 2) {\r\n        return P(candidateX, candidateY);\r\n    }\r\n    // Otherwise it occurs on the top or bottom side.\r\n    var y = (angleDeg >= 0) ? height / 2 : -height / 2;\r\n    var x = y / Math.tan(angleDeg.toRadians());\r\n    return P(x, y);\r\n}\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { P, Segments } from \"apparatus/library/common\";\r\nimport { BasicShapes } from \"apparatus/library/shapes/common\";\r\nimport { Path } from \"paper\";\r\nvar Triangle = /** @class */ (function () {\r\n    function Triangle() {\r\n        this.drivers = [\r\n            {\r\n                type: \"rectangle\",\r\n                minX: 8, maxX: 250,\r\n                minY: 8, maxY: 250,\r\n                toAppearance: function (p) { return ({\r\n                    width: p.x * 2,\r\n                    height: p.y * 2\r\n                }); },\r\n                fromAppearance: function (a) { return P(a.width / 2, a.height / 2); },\r\n                scale: 1.0,\r\n            }\r\n        ];\r\n    }\r\n    Triangle.prototype.render = function (appearance) {\r\n        var width = appearance.width, height = appearance.height;\r\n        var apexPosition = P(appearance.apex * width / 2, -height / 2);\r\n        var graphic = new Path(Segments([[apexPosition.x, apexPosition.y]], [[width / 2, height / 2]], [[-width / 2, height / 2]]));\r\n        graphic.close();\r\n        BasicShapes.applyStyle(graphic, appearance);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: BasicShapes.bounds(graphic)\r\n        };\r\n    };\r\n    Triangle.properties = {\r\n        label: \"Triangle\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: __assign({ width: 200, height: 200, apex: 0 }, BasicShapes.defaultAppearance),\r\n        appearanceSpecs: __spreadArrays(BasicShapes.specs, [\r\n            BasicShapes.header,\r\n            {\r\n                spec: \"slider\", key: \"apex\", label: \"Apex position\",\r\n                min: -1, max: 1, step: 0.01,\r\n            }\r\n        ]),\r\n    };\r\n    return Triangle;\r\n}());\r\nexport { Triangle };\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { Button, ToggleHorizontalButtons, VerticalButtons } from \"components/button\";\r\nimport { ColorPicker } from \"components/colorpicker\";\r\nimport { ComboSlider } from \"components/combo_slider\";\r\nimport { Icon } from \"components/icon\";\r\nimport * as React from \"react\";\r\nimport { TierContext } from \"tiers/context\";\r\nimport { setUpQTip } from \"view/tooltips\";\r\nimport { HorizontalIconButtons } from \"./button\";\r\nimport { LabelledCheckboxGroup } from \"./checkbox\";\r\nimport { Radio } from \"./radio\";\r\nimport { Select } from \"./select\";\r\nimport { TextAreaInput } from \"./text_area\";\r\nimport { TextInput } from \"./text_input\";\r\nfunction icon(tabType) {\r\n    switch (tabType) {\r\n        case \"text-style\": return \"paint-roller\";\r\n        case \"property\": return \"sliders-h\";\r\n        case \"liquid\": return \"tint\";\r\n        case \"text\": return \"i-cursor\";\r\n        case \"tools\": return \"wrench\";\r\n        case \"theme\": return \"paint-brush\";\r\n    }\r\n}\r\nfunction display(tabType) {\r\n    switch (tabType) {\r\n        case \"property\": return \"Properties\";\r\n        case \"text-style\": return \"Style\";\r\n        case \"liquid\": return \"Liquid\";\r\n        case \"text\": return \"Text\";\r\n        case \"tools\": return \"Tools\";\r\n        case \"theme\": return \"Theme\";\r\n    }\r\n}\r\nexport function isReactElement(props) {\r\n    return props.spec === undefined;\r\n}\r\nvar PropertyPanel = /** @class */ (function (_super) {\r\n    __extends(PropertyPanel, _super);\r\n    function PropertyPanel(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.ref = React.createRef();\r\n        _this.render = function () {\r\n            // If no tabs are specified, render nothing.\r\n            if (_this.props.tabs.length === 0)\r\n                return null;\r\n            var currentTabType = _this.state.currentTab;\r\n            var currentTab = _this.props.tabs.filter(function (t) { return t.type === currentTabType; })[0];\r\n            return React.createElement(TierContext.Consumer, null, function (tiers) { return (React.createElement(\"div\", { id: \"property-panel\", ref: _this.ref, \"data-simplebar\": true },\r\n                React.createElement(\"div\", { className: \"content-container\" },\r\n                    React.createElement(\"div\", { className: \"property-panel-header\" },\r\n                        React.createElement(\"h2\", null,\r\n                            React.createElement(\"i\", { className: \"fa fa-\" + _this.props.icon + \" mr-hem\" }),\r\n                            _this.props.title),\r\n                        React.createElement(\"div\", { className: \"property-panel-tabs\" }, _this.props.tabs.map(function (t) {\r\n                            return React.createElement(\"button\", { className: t.type === _this.state.currentTab ? \"active\" : \"\", onClick: function (_) { return _this.setState({ currentTab: t.type }); }, key: t.type },\r\n                                React.createElement(\"div\", null,\r\n                                    React.createElement(\"i\", { className: \"fa fa-\" + icon(t.type) + \" mr-1\" }),\r\n                                    display(t.type),\r\n                                    t.colorDot ? React.createElement(\"span\", { className: \"color-dot\", style: { background: t.colorDot } }) : null));\r\n                        }))),\r\n                    _this.createElements(currentTab, tiers)))); });\r\n        };\r\n        _this.state = { currentTab: props.tabs.length > 0 ? props.tabs[0].type : \"property\" };\r\n        return _this;\r\n    }\r\n    PropertyPanel.getDerivedStateFromProps = function (props, currentState) {\r\n        // Check if the current panel exists in the props. If not, reset to first tab.\r\n        var hasTab = props.tabs.filter(function (t) { return t.type === currentState.currentTab; }).length > 0;\r\n        if (hasTab) {\r\n            return currentState;\r\n        }\r\n        return { currentTab: props.tabs[0].type };\r\n    };\r\n    PropertyPanel.prototype.createElements = function (tab, tiers) {\r\n        // Flat list of react children.\r\n        var elements = [];\r\n        var isFirstHeader = true;\r\n        for (var _i = 0, _a = tab.sections; _i < _a.length; _i++) {\r\n            var section = _a[_i];\r\n            // Skip sections with no elements, but only if it's not the first header.\r\n            if (section.elements.length == 0)\r\n                continue;\r\n            // Header. Hide uf this is the first section and the section requests to hide it.\r\n            var header = isFirstHeader && section.hideHeaderIfFirst === true\r\n                ? null\r\n                : React.createElement(SectionHeader, __assign({ key: \"header_\" + section.header }, section));\r\n            // Create the elements.\r\n            var propertyElements = section.elements.map(function (element) {\r\n                // Special case: if it's a ReactElement, just return it.\r\n                if (isReactElement(element)) {\r\n                    return [element];\r\n                }\r\n                var els = [];\r\n                var key = \"label_\" + element.key;\r\n                if (element.spec == \"header\") {\r\n                    els.push(createElement(element));\r\n                }\r\n                else if (!tiers.allow(element) && !(element.spec === \"checkbox-group\")) {\r\n                    // Locked item. Show a label with a badge.\r\n                    // Clicking opens a pop up.\r\n                    els.push(React.createElement(\"div\", { className: \"flex-group\", key: key },\r\n                        React.createElement(\"div\", { key: key, className: \"label\" }, element.label),\r\n                        React.createElement(\"a\", { className: \"unlock\", href: \"#\", onClick: function (e) { e.preventDefault(); tiers.popup(\"PP:\" + key); } },\r\n                            tiers.badge(element),\r\n                            \" Unlock\")));\r\n                }\r\n                else {\r\n                    var wideClass = (element.spec == \"checkbox-group\") && element.wideLabel ? \"wide\" : \"\";\r\n                    els.push(React.createElement(\"div\", { className: \"flex-group\", key: key },\r\n                        React.createElement(\"div\", { key: key, className: \"label \" + wideClass }, element.label),\r\n                        createElement(element)));\r\n                }\r\n                return els;\r\n            });\r\n            elements.push.apply(elements, __spreadArrays([header], propertyElements));\r\n            isFirstHeader = false;\r\n        }\r\n        return elements;\r\n    };\r\n    PropertyPanel.prototype.componentDidUpdate = function () {\r\n        setUpQTip(this.ref.current);\r\n    };\r\n    return PropertyPanel;\r\n}(React.Component));\r\nexport { PropertyPanel };\r\nvar createElement = function (props) {\r\n    switch (props.spec) {\r\n        case \"slider\":\r\n            return React.createElement(ComboSlider, __assign({}, props));\r\n        case \"radio\":\r\n            return React.createElement(\"div\", null,\r\n                React.createElement(Radio, __assign({}, props)));\r\n        case \"select\":\r\n            return React.createElement(Select, __assign({}, props));\r\n        case \"text\":\r\n            return React.createElement(TextInput, __assign({}, props));\r\n        case \"color\":\r\n            return React.createElement(ColorPicker, __assign({}, props));\r\n        case \"button\":\r\n            return React.createElement(Button, __assign({}, props));\r\n        case \"horizontal-icon-buttons\":\r\n            return React.createElement(HorizontalIconButtons, __assign({}, props));\r\n        case \"toggle-horizontal-buttons\":\r\n            return React.createElement(ToggleHorizontalButtons, __assign({}, props));\r\n        case \"vertical-buttons\":\r\n            return React.createElement(VerticalButtons, __assign({}, props));\r\n        case \"textarea\":\r\n            return React.createElement(TextAreaInput, __assign({}, props));\r\n        case \"checkbox-group\":\r\n            return React.createElement(LabelledCheckboxGroup, __assign({}, props));\r\n        case \"header\":\r\n            return React.createElement(SectionHeader, __assign({}, props));\r\n    }\r\n};\r\nvar SectionHeader = function (props) { return (React.createElement(\"h3\", null,\r\n    React.createElement(Icon, { spacing: true, name: props.icon, fullWidth: true }),\r\n    props.header)); };\r\n","import { mirrorX, smoothCorner } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, Pivot, R, Segments, SharedGradients } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar metalGradient = SharedGradients.cylinderMetal;\r\nvar bracketMetalGradient = Gradients.simple(\"#aaaaaa\".color(), -20);\r\nvar softMetalGradient = Gradients.simple(\"#aaaaaa\".color(), -10);\r\nvar HoffmanClamp = /** @class */ (function () {\r\n    function HoffmanClamp() {\r\n    }\r\n    HoffmanClamp.prototype.render = function (appearance) {\r\n        var graphic = (function () {\r\n            switch (appearance.view) {\r\n                case \"front\": return frontView;\r\n                case \"side\": return sideView;\r\n            }\r\n        })()(appearance);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            pivot: P(0, 5),\r\n        };\r\n    };\r\n    HoffmanClamp.properties = {\r\n        label: \"Hoffman Clamp\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            view: \"front\",\r\n            clamping: 0.5,\r\n            size: 30,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"view\", label: \"View\",\r\n                options: [\r\n                    { value: \"side\", label: \"Side\" },\r\n                    { value: \"front\", label: \"Front\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 25, max: 50, step: 0.1, unit: \"mm\"\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"clamping\", label: \"Clamping\",\r\n                min: 0.0, max: 1.0, step: 0.01, unit: \"%\",\r\n            },\r\n        ],\r\n    };\r\n    return HoffmanClamp;\r\n}());\r\nexport { HoffmanClamp };\r\nfunction createScrew(height) {\r\n    return new Group([\r\n        Shape.Rectangle(R(0, height - 5, 8, height, Pivot.BOTTOM_CENTER)).withGradientFill(\"right\", metalGradient),\r\n        Shape.Rectangle(R(0, -5, 20, 8, Pivot.BOTTOM_CENTER), 2.0).withGradientFill(\"right\", metalGradient),\r\n    ]);\r\n}\r\nfunction frontView(appearance) {\r\n    var height = appearance.size;\r\n    var halfWidth = height / 3 * 2;\r\n    var slide = (height - 10) * (1 - appearance.clamping);\r\n    var bracket = new Path(Segments([[-halfWidth, height]], [[-halfWidth, 0]]));\r\n    mirrorX(bracket);\r\n    smoothCorner(bracket.segments[2], 3);\r\n    smoothCorner(bracket.segments[1], 3);\r\n    bracket.strokeWidth = 5.0;\r\n    bracket.setGradientStroke(\"right-down\", bracketMetalGradient);\r\n    var bottom = Shape.Rectangle(R(0, height, halfWidth * 2 + 10, 5, Pivot.CENTER), 2.0).withGradientFill(\"down\", softMetalGradient);\r\n    var slidingPart = Shape.Rectangle(R(0, height - 5 - slide, halfWidth * 2 + 10, 5, Pivot.CENTER), 2.0).withGradientFill(\"down\", softMetalGradient);\r\n    var screw = createScrew(height);\r\n    screw.position.y -= slide;\r\n    return new Group([screw, bracket, bottom, slidingPart]);\r\n}\r\nfunction sideView(appearance) {\r\n    var height = appearance.size;\r\n    var slide = (height - 10) * (1 - appearance.clamping);\r\n    var bracket = Shape.Rectangle(R(0, 0, 16, height, Pivot.TOP_CENTER), 2.0);\r\n    bracket.setGradientFill(\"right-down\", bracketMetalGradient);\r\n    var bottom = Shape.Rectangle(R(0, height, 18, 5, Pivot.CENTER), 2.0).withGradientFill(\"down\", softMetalGradient);\r\n    var slidingPart = Shape.Rectangle(R(0, height - 5 - slide, 18, 5, Pivot.CENTER), 2.0).withGradientFill(\"down\", softMetalGradient);\r\n    var screw = createScrew(height);\r\n    screw.position.y -= slide;\r\n    return new Group([screw, bracket, bottom, slidingPart]);\r\n}\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { formatShortcuts } from \"./keyboard_shortucts\";\r\n// Helper methods related to tooltips.\r\n/**\r\n * Sets up tooltips using QTip, which is the library used to\r\n * display the tooltips.\r\n */\r\nexport function setUpQTip(el, delay, force) {\r\n    if (el === void 0) { el = \"body\"; }\r\n    if (delay === void 0) { delay = 16; }\r\n    if (force === void 0) { force = false; }\r\n    var defaultQtipOptions = {\r\n        style: {\r\n            classes: \"qtip-tipsy\",\r\n            tip: {\r\n                corner: true,\r\n                width: 16,\r\n                height: 8,\r\n            }\r\n        },\r\n        hide: {\r\n            event: \"unfocus mouseleave\",\r\n        },\r\n        show: {\r\n            delay: delay,\r\n            effect: false,\r\n        },\r\n        position: {\r\n            effect: false,\r\n            my: 'top center',\r\n            at: 'bottom center',\r\n            viewport: $(window),\r\n            adjust: {\r\n                method: 'flip'\r\n            },\r\n        },\r\n    };\r\n    var verticalQtipOptions = __assign(__assign({}, defaultQtipOptions), { position: {\r\n            effect: false,\r\n            my: 'center left',\r\n            at: 'center right',\r\n            viewport: $(window),\r\n            adjust: {\r\n                method: 'flip'\r\n            },\r\n        } });\r\n    $(el).find('[title]').qtip(defaultQtipOptions);\r\n    if ($(el).attr(\"title\") || force) {\r\n        $(el).qtip(defaultQtipOptions);\r\n    }\r\n    ;\r\n    $(el).find('[data-qtipopts=\"vertical\"]').qtip(verticalQtipOptions);\r\n}\r\n/** Formats a tooltip content so that it looks nice. */\r\nexport function formatTooltip(text, shortcuts) {\r\n    var content = text;\r\n    if (shortcuts && shortcuts.length > 0) {\r\n        content += '<div class=\"shortcut\">Shortcut: ' + formatShortcuts.apply(void 0, shortcuts) + \"</div>\";\r\n    }\r\n    return content;\r\n}\r\n","/** Deliberately broken apparatus. */\r\nvar Borked = /** @class */ (function () {\r\n    function Borked() {\r\n    }\r\n    Borked.prototype.render = function (appearance) {\r\n        return {\r\n            graphic: undefined,\r\n            hitShape: undefined\r\n        };\r\n    };\r\n    Borked.properties = {\r\n        label: \"Borked\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {},\r\n        appearanceSpecs: [],\r\n    };\r\n    return Borked;\r\n}());\r\nexport { Borked };\r\n","import { g } from \"analytics\";\r\nimport store from \"store/store\";\r\nimport { switchTool } from \"./store/actions\";\r\n/** Returns the CSS cursor name that should be used for each tool. */\r\nexport function toolCursors(tool) {\r\n    switch (tool) {\r\n        case \"select\": return \"auto\";\r\n        case \"pan\": return \"move\";\r\n        case \"arrow\": return \"url(\" + textBase64 + \"), crosshair\";\r\n        case \"freehand\": return \"url(\" + pencilBase64 + \") 5 5, crosshair\";\r\n        case \"pathedit\": return \"crosshair\";\r\n    }\r\n}\r\n/** Switches the current active tool. */\r\nexport function selectTool(tool, interaction) {\r\n    g(\"Toolbox: \" + tool, interaction);\r\n    store.dispatch(switchTool(tool));\r\n}\r\nvar pencilBase64 = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAGYktHRAD/AP8A/6C9p5MAAAEpSURBVFhH7ZRBagJBEEV7H8g6ERJMsvQQ8U4eJN7IZJNTJERBIZcQ/U+moGm6dRZVs+oPD50W+r+pnjH19FRyavAn5iI8tXJjEomylNyLb2ESzyIsNQGyEEfB2q8IkyiLCWWU/ouDCJUwgbvLVUpPgjLW9uJd7IbrEAnb/Esw9p/h2uAZWIowiVdhm9uZl1BaSri+HblEi1LC/e1Agk3L4pzwSbDZ2EmYLJ/uxzFmEvnb4S7BZrck+D10EmMkmMRq+O4uQMZIgJXDRri+HWx67cHMy02WyYT9WeWwVpYb/KM+CLeUEhSyVis31sI1JmF3zphb5eAuQJCwO+esa8WA5KMIy6eoFQPlSIaGCeTPhLEVb2KScJf5M4DQi5g0nPPHwIyFnp52UjoDlvrZbV1lPrwAAAAASUVORK5CYII=\";\r\nvar textBase64 = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAvVBMVEUAAAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADTQ/BeAAAAPnRSTlMAAAECCAkQERYZGx8hIiMkJScoKiwtLzIzNDU2Nzg5Ojs8PUBETmFvcnl6mqy3zM3O1tfY3N3h5urs8PT6/GYLJh4AAADLSURBVHjadc7XEoJADAXQYO9iRbChYu+95/8/yxtcB3TW+5JyZidLLCEjiOp9oAAC9/demsKJDGIC6PhxOoZy5iwAewPPLuv9DeW6Xa0OzDkDaxzgu4PaBnio0QvnBQzAghAH4Eiz5KL63HMkcxNgSTPmnAI3LrMNaEiT2CQUkB8LYNM7X1CXGzqoAlo6qADapBKGEqCjAxPQ1UEB4P6Dng7KgL4Oav9u2ICmDoYAT61jAVRnO8Buav68mPAn828wO5VMMpW3Wl6dJC/vOCLvpGT5yQAAAABJRU5ErkJggg==\";\r\n","import { SVG } from \"apparatus/svg\";\r\n/**\r\n * Peg drawn according to https://edulab.com/product/test-tube-holder-peg-type-pk10/.\r\n * Default size is 18cm.\r\n */\r\nvar Peg = /** @class */ (function () {\r\n    function Peg() {\r\n    }\r\n    Peg.isBoostRequiredForAppearance = function (a) {\r\n        return a.view === \"top\";\r\n    };\r\n    Peg.prototype.render = function (appearance) {\r\n        var graphic = svgs[appearance.view]();\r\n        graphic.scale(appearance.length / 18, 1.0);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    Peg.properties = {\r\n        label: \"Test Tube Holder Peg\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            view: \"side\",\r\n            length: 20\r\n        },\r\n        flippable: true,\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"view\", label: \"View\",\r\n                options: [\r\n                    { value: \"top\", label: \"Top view\", tier: \"boost\" },\r\n                    { value: \"side\", label: \"Side view\" },\r\n                ],\r\n                allowSelectingTierLockedOptions: true,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"length\", label: \"Length\",\r\n                min: 18, max: 25, unit: \"cm\",\r\n            }\r\n        ],\r\n    };\r\n    return Peg;\r\n}());\r\nexport { Peg };\r\nvar svgs = {\r\n    \"top\": SVG.Peg.top,\r\n    \"side\": SVG.Peg.side,\r\n};\r\n","import { Group, Path, Rectangle, Shape } from \"paper\";\r\nimport { metalRod, mirrorX, setDefaultStyle, smoothCorner } from \"../draw\";\r\nimport { P, Segments, SharedGradients } from \"./common\";\r\nvar RetortStand = /** @class */ (function () {\r\n    function RetortStand() {\r\n        this.drivers = [\r\n            {\r\n                type: \"rectangle\",\r\n                minX: 0, maxX: 0,\r\n                minY: -600, maxY: -350,\r\n                fromAppearance: function (a) { return P(0, -a.height); },\r\n                toAppearance: function (p) { return ({ height: -p.y }); },\r\n                scale: 1.0,\r\n            }\r\n        ];\r\n    }\r\n    RetortStand.prototype.render = function (appearance) {\r\n        var baseWidth = appearance.direction != \"front\" ? 200 : 125;\r\n        var rodOffset = 40;\r\n        var height = appearance.height;\r\n        var baseHeight = 15;\r\n        var _a = metalRod(P(0, 0), P(0, -height)), rod = _a[0], rodHighlight = _a[1];\r\n        var base = new Path(Segments([[baseWidth / 2, 0]], [[0, 0]], [[0, baseHeight]]));\r\n        smoothCorner(base.segments[1], 5.0);\r\n        mirrorX(base, baseWidth / 2);\r\n        setDefaultStyle(base);\r\n        switch (appearance.direction) {\r\n            case \"front\":\r\n                base.position.x -= baseWidth / 2;\r\n                break;\r\n            case \"left\":\r\n                base.position.x += (rodOffset - baseWidth);\r\n                break;\r\n            case \"right\":\r\n                base.position.x -= rodOffset;\r\n        }\r\n        base.setGradientFill(\"down\", SharedGradients.metal);\r\n        var graphic = new Group([rod, rodHighlight, base]);\r\n        var hitShapes = [\r\n            // Covers the rod.\r\n            Shape.Rectangle(new Rectangle(-20, -height, 40, height)),\r\n            // Covers the base.\r\n            Shape.Rectangle(base.bounds),\r\n        ];\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShapes,\r\n            pivot: P(0, 0),\r\n            snapping: [\r\n                {\r\n                    type: \"attachable_on\",\r\n                    start: P(0, 0),\r\n                    end: P(0, -height)\r\n                },\r\n                graphic.placeable(),\r\n                base.topEdgeAsPlaceableSurface(),\r\n            ]\r\n        };\r\n    };\r\n    RetortStand.properties = {\r\n        label: \"Retort stand\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            direction: \"right\",\r\n            height: 450,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"direction\", label: \"Direction\",\r\n                options: [\r\n                    { value: \"left\", label: \"Facing left\" },\r\n                    { value: \"front\", label: \"Facing front/back\" },\r\n                    { value: \"right\", label: \"Facing right\" },\r\n                ]\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Height\",\r\n                min: 350, max: 600\r\n            }\r\n        ],\r\n    };\r\n    return RetortStand;\r\n}());\r\nexport { RetortStand };\r\n","export default \"3.33.3\";\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { mirrorX, setDefaultStyle } from \"apparatus/draw\";\r\nimport { DEFAULT_LIQUID_DATA, P, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar Crucible = /** @class */ (function () {\r\n    function Crucible() {\r\n    }\r\n    Crucible.prototype.render = function (appearance) {\r\n        var width = appearance.diameter;\r\n        var height = appearance.height;\r\n        var graphic = new Path(Segments([[0, 0]], [[width / 5, height], [-width / 5, 0]], [[width / 2, height]]));\r\n        mirrorX(graphic, width / 2);\r\n        var liquidMask = graphic.clone();\r\n        setDefaultStyle(graphic);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            liquidMask: liquidMask,\r\n            snapping: graphic.placeable()\r\n        };\r\n    };\r\n    Crucible.properties = {\r\n        label: \"Crucible\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            diameter: 39, height: 43\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"diameter\", label: \"Diameter\",\r\n                min: 25, max: 70,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Height\",\r\n                min: 35, max: 70,\r\n            }\r\n        ],\r\n        defaultLiquidData: __assign(__assign({}, DEFAULT_LIQUID_DATA), { amountRatio: 0.3, color: \"#aaaaaa\" })\r\n    };\r\n    return Crucible;\r\n}());\r\nexport { Crucible };\r\nvar CrucileCover = /** @class */ (function () {\r\n    function CrucileCover() {\r\n    }\r\n    CrucileCover.prototype.render = function (appearance) {\r\n        var width = appearance.diameter;\r\n        var cover = new Path(Segments([[-5, 5], undefined, [0, -3]], [[0, 0]], [[width / 2, -5], [-width / 4, 0]]));\r\n        mirrorX(cover, width / 2);\r\n        var handle = Shape.Circle(P(width / 2, -10), 5);\r\n        var graphic = new Group([cover, handle]);\r\n        setDefaultStyle(graphic);\r\n        return { graphic: graphic, hitShape: graphic.bounds.toShape() };\r\n    };\r\n    CrucileCover.properties = {\r\n        label: \"Crucible Cover\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            diameter: Crucible.properties.defaultAppearance.diameter\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"diameter\", label: \"Diameter\",\r\n                min: 25, max: 70,\r\n            },\r\n        ],\r\n    };\r\n    return CrucileCover;\r\n}());\r\nexport { CrucileCover };\r\n","import { setDefaultStyle } from \"apparatus/draw\";\r\nimport { DEFAULT_LIQUID_DATA, P } from \"apparatus/library/common\";\r\nimport { Shape } from \"paper\";\r\nvar PetriTop = /** @class */ (function () {\r\n    function PetriTop() {\r\n    }\r\n    PetriTop.prototype.render = function (appearance) {\r\n        var dish = Shape.Circle(P(0, 0), appearance.diameter / 2);\r\n        setDefaultStyle(dish);\r\n        dish.fillColor = appearance.color.color().alpha(appearance.opacity).string();\r\n        var graphic = dish;\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    PetriTop.properties = {\r\n        label: \"Petri Dish (Top view)\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            diameter: 100,\r\n            color: DEFAULT_LIQUID_DATA.color,\r\n            opacity: DEFAULT_LIQUID_DATA.alpha\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"diameter\", label: \"Diameter\",\r\n                min: 35, max: 150, step: 5, unit: \"mm\",\r\n            },\r\n            {\r\n                spec: \"color\", key: \"color\", label: \"Contents colour\",\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"opacity\", label: \"Contents opacity\",\r\n                min: 0.2, max: 0.9, step: 0.01, unit: \"%\",\r\n            }\r\n        ],\r\n    };\r\n    return PetriTop;\r\n}());\r\nexport { PetriTop };\r\n","// Hacky wraper for jquery slider pips.\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as React from \"react\";\r\nvar Slider = /** @class */ (function (_super) {\r\n    __extends(Slider, _super);\r\n    function Slider(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.ref = React.createRef();\r\n        _this.suspendUpdates = false;\r\n        _this.state = { value: props.initialValue };\r\n        return _this;\r\n    }\r\n    // Called when slider changed by setting a value.\r\n    Slider.prototype.onChange = function (value) {\r\n        if (this.suspendUpdates)\r\n            return;\r\n        if (this.state.value == value)\r\n            return;\r\n        this.props.onEnd(this.props.initialValue, value);\r\n        this.setState({ value: value });\r\n    };\r\n    Slider.prototype.onSlideStart = function (_) {\r\n        var _a;\r\n        if (this.suspendUpdates)\r\n            return;\r\n        (_a = this.props.onStart) === null || _a === void 0 ? void 0 : _a.call(null);\r\n    };\r\n    // Called when slider changed by sliding\r\n    Slider.prototype.onSlide = function (value) {\r\n        if (this.suspendUpdates)\r\n            return;\r\n        this.props.onChange(value);\r\n    };\r\n    /** Called when the user has stopped interacting with slider by sliding. */\r\n    Slider.prototype.onSlideStop = function (value) {\r\n        if (this.suspendUpdates)\r\n            return;\r\n        // Component could have died, check that state is valid.\r\n        if (this.state) {\r\n            this.setState({ value: value });\r\n            this.props.onEnd(this.props.initialValue, value);\r\n        }\r\n    };\r\n    Slider.prototype.componentDidUpdate = function (prevProps, prevState) {\r\n        if (prevProps.initialValue != this.props.initialValue) {\r\n            if (prevState.value != this.props.initialValue) {\r\n                // Props updated externally. Update current state but don't invoke any callbacks.\r\n                this.setState({\r\n                    value: this.props.initialValue\r\n                });\r\n                // Update the slider.\r\n                this.suspendUpdates = true;\r\n                var slider = $(this.ref.current);\r\n                slider.slider({ value: this.props.initialValue });\r\n                this.suspendUpdates = false;\r\n            }\r\n        }\r\n    };\r\n    Slider.prototype.componentDidMount = function () {\r\n        // Unfortunately pips does not have typedefs so without cast to <any>\r\n        // the rest would not compile.\r\n        var slider = $(this.ref.current);\r\n        // jQuery will override this in components\r\n        var self = this;\r\n        this.setState({ value: this.props.initialValue });\r\n        slider.slider({\r\n            min: this.props.min,\r\n            max: this.props.max,\r\n            range: \"min\",\r\n            value: this.props.initialValue,\r\n            step: this.props.step || 1.0,\r\n            animate: \"fast\"\r\n            // orientation: \"vertical\"\r\n            // }).slider(\"float\", {\r\n            //     formatLabel: this.props.formatLabel || (v => v)\r\n        }).on(\"slidechange\", function (_, ui) {\r\n            self.onChange(ui.value);\r\n        }).on(\"slidestart\", function (_, ui) {\r\n            self.onSlideStart(ui.value);\r\n        }).on(\"slide\", function (_, ui) {\r\n            self.onSlide(ui.value);\r\n        }).on(\"slidestop\", function (_, ui) {\r\n            self.onSlideStop(ui.value);\r\n        });\r\n        if (this.props.pipsStep) {\r\n            slider.slider(\"pips\", {\r\n                first: false,\r\n                last: false,\r\n                rest: \"pip\",\r\n                step: this.props.pipsStep,\r\n            });\r\n        }\r\n    };\r\n    Slider.prototype.componentWillUnmount = function () {\r\n        // Permanently suspend updates.\r\n        this.suspendUpdates = true;\r\n        var slider = $(this.ref.current);\r\n        slider.off(\"slidestart\");\r\n        slider.off(\"slidechange\");\r\n        slider.off(\"slide\");\r\n        slider.off(\"slidestop\");\r\n    };\r\n    Slider.prototype.render = function () {\r\n        var _a;\r\n        return React.createElement(\"div\", { className: \"slider \" + ((_a = this.props.extraClass) !== null && _a !== void 0 ? _a : \"\"), ref: this.ref });\r\n    };\r\n    return Slider;\r\n}(React.Component));\r\nexport { Slider };\r\n","import { smoothCornersIndividual } from \"apparatus/draw\";\r\nimport { P, R, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path, PointText, Shape } from \"paper\";\r\n/**\r\n * https://www.youtube.com/watch?v=JzNe-Bk2shQ\r\n */\r\nvar Spectrophotometer = /** @class */ (function () {\r\n    function Spectrophotometer() {\r\n    }\r\n    Spectrophotometer.prototype.render = function (appearance) {\r\n        var outerColor = SharedColors.deviceGrey.color();\r\n        var outer = new Path(Segments([[0, 0]], // 0\r\n        [[110, 0]], // 1 - Start well\r\n        [[110, 100]], [[185, 100]], [[185, 0]], // 4 - End well\r\n        [[200, 0]], [[200, 110]], [[0, 110]])).close().withStroke(\"default\")\r\n            .withGradientFill(\"down\", [\r\n            [outerColor.hex(), 0.62],\r\n            [outerColor.ladd(-10).hex(), 0.68],\r\n            [outerColor.ladd(-20).hex(), 1.0]\r\n        ]);\r\n        smoothCornersIndividual(outer, { 0: 8, 2: 5, 3: 5, 5: 8, 6: 8, 7: 8 });\r\n        var screenCase = Shape.Rectangle(R(10, 10, 90, 50), 5.0)\r\n            .withStroke(\"default\", SharedColors.devicePanel.stroke)\r\n            .withFill(SharedColors.devicePanel.fill);\r\n        var screen = Shape.Rectangle(R(15, 15, 40, 27), 3.0)\r\n            .withStroke(2.0, \"white\").withFill(SharedColors.lcdScreen);\r\n        var dpad = this.dpad();\r\n        dpad.position.x = 77;\r\n        dpad.position.y = 30;\r\n        dpad.rotate(45);\r\n        var textAbs = new PointText({\r\n            point: P(50, 27),\r\n            content: appearance.absorbance,\r\n            fillColor: \"black\",\r\n            fontFamily: 'sans-serif',\r\n            fontWeight: 'bold',\r\n            fontSize: 10,\r\n            justification: \"right\",\r\n        });\r\n        var textWavelength = new PointText({\r\n            point: P(50, 37),\r\n            content: appearance.wavelength + \" nm\",\r\n            fillColor: \"black\",\r\n            fontFamily: 'sans-serif',\r\n            fontWeight: 'bold',\r\n            fontSize: 8,\r\n            justification: \"right\",\r\n        });\r\n        var graphic = new Group([outer, screenCase, screen, dpad, textAbs, textWavelength]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            watermark: screen.bounds.bottomRight.add([5, 5]),\r\n            snapping: [\r\n                outer.placeable(),\r\n                { type: \"placeable_surface\", start: P(110, 100), end: P(185, 100) }\r\n            ]\r\n        };\r\n    };\r\n    Spectrophotometer.prototype.dpad = function () {\r\n        var button = Shape.Rectangle(R(0, 0, 9, 9), 2.0).withFill(\"white\");\r\n        var button2 = button.clone();\r\n        var button3 = button.clone();\r\n        var button4 = button.clone();\r\n        button2.position.x += 12;\r\n        button3.position.y += 12;\r\n        button4.position.x += 12;\r\n        button4.position.y += 12;\r\n        return new Group([button, button2, button3, button4]);\r\n    };\r\n    Spectrophotometer.properties = {\r\n        label: \"Spectrophotometer\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            wavelength: \"540\",\r\n            absorbance: \"0.042\",\r\n        },\r\n        appearanceSpecs: [\r\n            { spec: \"text\", key: \"absorbance\", label: \"Absorbance\", maxLength: 5 },\r\n            { spec: \"text\", key: \"wavelength\", label: \"Wavelength\", maxLength: 4, numbersOnly: true }\r\n        ],\r\n    };\r\n    return Spectrophotometer;\r\n}());\r\nexport { Spectrophotometer };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { Snap } from \"editing/snapping/type\";\r\nimport { areRotationsClose } from \"math\";\r\n/** Allowed tolerance of rotation differences to allow a placeable to be snapped onto a surface. */\r\nvar PLACEABLE_SURFACE_ROTATION_TOLERANCE = 5.0;\r\n/** Allowed tolerance in angle difference for 2 connectables to snap to each other. */\r\nvar CONNECTABLE_ROTATION_TOLERANCE = 15.0;\r\n/** Precomputes snapping information */\r\nexport function precomputeSnapping(selected, all) {\r\n    var _a;\r\n    var precomputed = [];\r\n    // First categorise the currently selected apparatus by snap type.\r\n    var placeables = [];\r\n    var attachables = [];\r\n    var connectables = [];\r\n    var spottingTilePlaceable = [];\r\n    var tlcSpots = [];\r\n    var pluggables = [];\r\n    for (var _i = 0, selected_1 = selected; _i < selected_1.length; _i++) {\r\n        var a = selected_1[_i];\r\n        for (var _b = 0, _c = a.globalSnapping; _b < _c.length; _b++) {\r\n            var snapping = _c[_b];\r\n            if (snapping.type == \"placeable\") {\r\n                placeables.push({ snapping: snapping, rotation: a.props.rotation + ((_a = snapping.facing) !== null && _a !== void 0 ? _a : 0) });\r\n            }\r\n            else if (snapping.type == \"attachable\") {\r\n                attachables.push(snapping);\r\n            }\r\n            else if (snapping.type == \"connectable\") {\r\n                // Modify the \"facing\" attribute to take into account the rotation.\r\n                var adjustedFacing = (a.props.rotation + snapping.facing + 360) % 360;\r\n                connectables.push(__assign(__assign({}, snapping), { facing: adjustedFacing }));\r\n            }\r\n            else if (snapping.type == \"spotting_tile_placeable\") {\r\n                spottingTilePlaceable.push(__assign({}, snapping));\r\n            }\r\n            else if (snapping.type == \"tlc_spot\") {\r\n                tlcSpots.push(snapping);\r\n            }\r\n            else if (snapping.type == \"pluggable\") {\r\n                pluggables.push({ id: a.id, snapping: snapping });\r\n            }\r\n            a.setState({\r\n                visualiseSnapping: [\"placeable\", \"attachable\", \"connectable\", \"spotting_tile_placeable\", \"tlc_spot\", \"pluggable\"]\r\n            });\r\n        }\r\n    }\r\n    // Sort remaining items by type, depending on the snap types\r\n    // of currently selected apparatus, e.g. find \"placeable_surface\"\r\n    // for \"placeable\" items, but only if there are currently selected\r\n    // items with snap type \"placeable\".\r\n    for (var _d = 0, all_1 = all; _d < all_1.length; _d++) {\r\n        var other = all_1[_d];\r\n        if (other.isSelected)\r\n            continue;\r\n        var snapTypeMask = {};\r\n        for (var _e = 0, _f = other.globalSnapping; _e < _f.length; _e++) {\r\n            var snapping = _f[_e];\r\n            if (placeables.length > 0 && snapping.type === \"placeable_surface\") {\r\n                for (var _g = 0, placeables_1 = placeables; _g < placeables_1.length; _g++) {\r\n                    var placeable = placeables_1[_g];\r\n                    // Rotation of the placeable surface.\r\n                    var surfaceRotation = other.props.rotation + Snap.getFacing(snapping);\r\n                    if (areRotationsClose(placeable.rotation, surfaceRotation, PLACEABLE_SURFACE_ROTATION_TOLERANCE)) {\r\n                        var potentialSnapping = precomputePlaceable(placeable.snapping, snapping);\r\n                        if (potentialSnapping) {\r\n                            precomputed.push(potentialSnapping);\r\n                            snapTypeMask.placeable_surface = true;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if (attachables.length > 0 && snapping.type === \"attachable_on\") {\r\n                for (var _h = 0, attachables_1 = attachables; _h < attachables_1.length; _h++) {\r\n                    var attachable = attachables_1[_h];\r\n                    precomputed.push(precomputePointToLine(attachable, snapping));\r\n                    snapTypeMask.attachable_on = true;\r\n                }\r\n            }\r\n            if (connectables.length > 0 && snapping.type === \"connectable\") {\r\n                // For connectables, evaluate them on the spot.\r\n                var otherAngle = (other.props.rotation + snapping.facing + 540) % 360; // 540 = 360 + 180. Additioal 360 because modulo can return negative.\r\n                for (var _j = 0, connectables_1 = connectables; _j < connectables_1.length; _j++) {\r\n                    var connectable = connectables_1[_j];\r\n                    if (areRotationsClose(connectable.facing, otherAngle, CONNECTABLE_ROTATION_TOLERANCE)) {\r\n                        precomputed.push({ type: \"point_to_point\", delta: snapping.at.subtract(connectable.at) });\r\n                        snapTypeMask.connectable = true;\r\n                    }\r\n                }\r\n            }\r\n            if (spottingTilePlaceable.length > 0 && snapping.type === \"spotting_tile\") {\r\n                var _loop_1 = function (placeable) {\r\n                    var snaps = snapping.at.map(function (at) { return ({ type: \"point_to_point\", delta: at.subtract(placeable.at) }); });\r\n                    precomputed.push.apply(precomputed, snaps);\r\n                };\r\n                for (var _k = 0, spottingTilePlaceable_1 = spottingTilePlaceable; _k < spottingTilePlaceable_1.length; _k++) {\r\n                    var placeable = spottingTilePlaceable_1[_k];\r\n                    _loop_1(placeable);\r\n                }\r\n                snapTypeMask.spotting_tile = true;\r\n            }\r\n            if (tlcSpots.length > 0 && snapping.type === \"tlc_plate\") {\r\n                for (var _l = 0, tlcSpots_1 = tlcSpots; _l < tlcSpots_1.length; _l++) {\r\n                    var spot = tlcSpots_1[_l];\r\n                    precomputed.push(precomputePointToLine(spot, snapping));\r\n                }\r\n                snapTypeMask.tlc_plate = true;\r\n            }\r\n            if (pluggables.length > 0 && snapping.type === \"neck\") {\r\n                for (var _m = 0, pluggables_1 = pluggables; _m < pluggables_1.length; _m++) {\r\n                    var pluggable = pluggables_1[_m];\r\n                    // Check rotation of neck.\r\n                    var neckRotation = other.props.rotation + snapping.facing;\r\n                    precomputed.push({\r\n                        type: \"point_to_point\",\r\n                        delta: snapping.top.subtract(pluggable.snapping.at),\r\n                        // Also set the appearance specs on the pluggable.\r\n                        appearanceChange: {\r\n                            id: pluggable.id,\r\n                            partialSpecs: pluggable.snapping.requestDiameter(snapping.diameter),\r\n                            rotation: neckRotation,\r\n                        }\r\n                    });\r\n                    snapTypeMask.neck = true;\r\n                }\r\n            }\r\n        }\r\n        var snapTypeFilter = Snap.typeFilterFrom(snapTypeMask);\r\n        if (snapTypeFilter.length > 0) {\r\n            other.setState({ visualiseSnapping: snapTypeFilter });\r\n        }\r\n    }\r\n    return precomputed;\r\n}\r\nfunction precomputePlaceable(placeable, surface) {\r\n    // Compute start and end positions in Move Space.\r\n    var start = surface.start.subtract(placeable.at);\r\n    var end = surface.end.subtract(placeable.at);\r\n    var surfaceVector = end.subtract(start);\r\n    return {\r\n        type: \"point_to_line\",\r\n        start: start,\r\n        surfaceVector: surfaceVector,\r\n        surfaceVectorNorm: surfaceVector.normalize()\r\n    };\r\n}\r\nfunction precomputePointToLine(attachable, on) {\r\n    // Compute start and end positions in Move Space.\r\n    var start = on.start.subtract(attachable.at);\r\n    var end = on.end.subtract(attachable.at);\r\n    var surfaceVector = end.subtract(start);\r\n    return {\r\n        type: \"point_to_line\",\r\n        start: start,\r\n        surfaceVector: surfaceVector,\r\n        surfaceVectorNorm: surfaceVector.normalize()\r\n    };\r\n}\r\n/**\r\n * Evaluates an array of precomputed snappings and returns the vector it should snap to\r\n * or returns undefined if the point should not be snapped.\r\n */\r\nexport function evaluatePrecomputedSnappings(rawDeltaVector, snappings, snapDistance) {\r\n    for (var _i = 0, snappings_1 = snappings; _i < snappings_1.length; _i++) {\r\n        var snapping = snappings_1[_i];\r\n        switch (snapping.type) {\r\n            case \"point_to_line\":\r\n                var fromStartToDelta = rawDeltaVector.subtract(snapping.start);\r\n                var project = fromStartToDelta.dot(snapping.surfaceVectorNorm);\r\n                // Allow overhang by snapDistance.\r\n                if (project < 0 && project > -snapDistance) {\r\n                    project = 0;\r\n                }\r\n                else if (project > snapping.surfaceVector.length && project - snapDistance < snapping.surfaceVector.length) {\r\n                    project = snapping.surfaceVector.length;\r\n                }\r\n                // Check the projection lies on the surface vector.\r\n                if (project >= 0 && project <= snapping.surfaceVector.length) {\r\n                    // Compute the nearest point on line.\r\n                    var nearestPoint = snapping.start.add(snapping.surfaceVectorNorm.multiply(project));\r\n                    // Measure the distance.\r\n                    if (rawDeltaVector.isClose(nearestPoint, snapDistance)) {\r\n                        return { delta: nearestPoint };\r\n                    }\r\n                }\r\n                break;\r\n            case \"point_to_point\":\r\n                if (rawDeltaVector.isClose(snapping.delta, snapDistance)) {\r\n                    return { delta: snapping.delta, appearanceChange: snapping.appearanceChange };\r\n                }\r\n                break;\r\n        }\r\n    }\r\n    return;\r\n}\r\n","import { setDefaultStyle } from \"apparatus/draw\";\r\nimport { lerp, P, R } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar TLCPlate = /** @class */ (function () {\r\n    function TLCPlate() {\r\n    }\r\n    TLCPlate.isBoostRequiredForAppearance = function (appearance) {\r\n        return appearance.lanes >= 4;\r\n    };\r\n    TLCPlate.prototype.render = function (appearance) {\r\n        var zoom = appearance.view == \"zoom\" ? 4 : 1;\r\n        var baselineOffset = appearance.view == \"zoom\" ? 40 : 15;\r\n        var maxFrontOffset = appearance.view == \"zoom\" ? 25 : 10;\r\n        var spots = appearance.lanes;\r\n        var widthPerSpot = 15 * zoom;\r\n        var height = appearance.height * zoom;\r\n        var totalWidth = spots * widthPerSpot;\r\n        var frontOffset = lerp(height, maxFrontOffset, appearance.solventFrontAdvance);\r\n        var plate = Shape.Rectangle(R(0, 0, totalWidth, height));\r\n        setDefaultStyle(plate);\r\n        plate.fillColor = \"#f2f2f2\";\r\n        var baseline = new Path.Line(P(2, height - baselineOffset), P(totalWidth - 2, height - baselineOffset));\r\n        baseline.withStroke(2.0, \"#888888\");\r\n        var graphic = new Group([plate, baseline]);\r\n        if (appearance.solventFront) {\r\n            var solventFront = new Path.Line(P(2, frontOffset), P(totalWidth - 2, frontOffset));\r\n            solventFront.withStroke(3.0, \"#c1dcfb\");\r\n            // const soak = new Path.Rectangle(R(2, frontOffset, totalWidth - 4, height - frontOffset))\r\n            // soak.fillColor = \"#c1dcfb40\"\r\n            graphic.addChild(solventFront);\r\n        }\r\n        // Compute the snapping lines.\r\n        var snapping = [];\r\n        if (appearance.view == \"zoom\") {\r\n            for (var i = 0; i < spots; i++) {\r\n                var x = (i + 0.5) * widthPerSpot;\r\n                snapping.push({ type: \"tlc_plate\", start: P(x, height - baselineOffset), end: P(x, frontOffset) });\r\n            }\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: snapping\r\n        };\r\n    };\r\n    TLCPlate.properties = {\r\n        label: \"Chromatography paper\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            view: \"zoom\",\r\n            height: 80,\r\n            lanes: 1,\r\n            solventFront: true,\r\n            solventFrontAdvance: 1.0,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"view\", label: \"View size\",\r\n                options: [\r\n                    { value: \"real\", label: \"Real size\" },\r\n                    { value: \"zoom\", label: \"Zoomed\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Size\",\r\n                min: 60, max: 120, unit: \"mm\"\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"lanes\", label: \"Lanes\",\r\n                min: 1, max: 8, pipsStep: 1,\r\n            },\r\n            {\r\n                spec: \"checkbox\", key: \"solventFront\", label: \"Solvent front\", subLabel: \"Show\",\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"solventFrontAdvance\", label: \"Solvent front distance\",\r\n                min: 0.0, max: 1.0, step: 0.01, unit: \"%\", tier: \"boost\",\r\n                visible: function (a) { return a.solventFront; }\r\n            }\r\n        ],\r\n    };\r\n    return TLCPlate;\r\n}());\r\nexport { TLCPlate };\r\n","import { Pivot, R, UIColors } from \"apparatus/library/common\";\r\nimport { Interactable } from \"editing/interaction\";\r\nimport { Path } from \"paper\";\r\n/**\r\n * Creates an interactable handle (a golden diamond) that can be dragged,\r\n * to adjust a property.\r\n */\r\nexport function createInteractionHandleFor(interaction) {\r\n    var handleKlass = Interactable(Path.Rectangle, interaction);\r\n    var handle = new handleKlass(R(0, 0, 12, 12, Pivot.CENTER));\r\n    handle.rotate(45);\r\n    handle.fillColor = UIColors.hintFill;\r\n    handle.strokeColor = UIColors.hintOutline;\r\n    handle.strokeWidth = 3.0;\r\n    return handle;\r\n}\r\n","import { mirrorX, mirrorY } from \"apparatus/draw\";\r\nimport { P, Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, PointText } from \"paper\";\r\nimport { S } from \"../common\";\r\nvar DEFAULT_YELLOW = \"#f5c50a\";\r\nvar PH_COLORS_1 = [\r\n    \"#cb3b53\",\r\n    \"#dc4949\",\r\n    \"#e04d2f\",\r\n    \"#d56d47\",\r\n    \"#d18c34\",\r\n    \"#d29d23\",\r\n    \"#b39541\",\r\n    \"#757a3b\",\r\n    \"#3e5248\",\r\n    \"#30323c\",\r\n    \"#343242\",\r\n    \"#393157\",\r\n    \"#352342\",\r\n    \"#3f254b\",\r\n];\r\nvar PhPaper = /** @class */ (function () {\r\n    function PhPaper() {\r\n    }\r\n    PhPaper.prototype.render = function (appearance) {\r\n        var dipped = appearance.dipped, ph = appearance.ph, scale = appearance.scale, length = appearance.length;\r\n        var graphic = new Path.Rectangle(R(0, 0, 15, length));\r\n        if (dipped) {\r\n            var phColor = PH_COLORS_1[ph - 1].color();\r\n            var front = 1 - appearance.front;\r\n            graphic.withGradientFill(\"down\", [\r\n                [DEFAULT_YELLOW, front],\r\n                [phColor.ladd(-10).string(), front + 0.01],\r\n                [phColor.ladd(5).string(), front + 0.05],\r\n                [phColor.string(), front + 0.1],\r\n            ]);\r\n        }\r\n        else {\r\n            graphic.withFill(DEFAULT_YELLOW);\r\n        }\r\n        graphic.scale(scale);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.expand(15).toShape()\r\n        };\r\n    };\r\n    PhPaper.properties = {\r\n        label: \"pH Paper Strip\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            dipped: false,\r\n            ph: 5,\r\n            front: 0.4,\r\n            length: 70,\r\n            scale: 1.0\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"length\", label: \"Length\",\r\n                min: 30, max: 100, unit: \"mm\",\r\n            },\r\n            { spec: \"checkbox\", key: \"dipped\", label: \"Dipped\" },\r\n            {\r\n                spec: \"slider\", key: \"ph\", label: \"pH\",\r\n                min: 1, max: 14, step: 1,\r\n                visible: function (a) { return a.dipped; }\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"front\", label: \"Front distance\",\r\n                min: 0.2, max: 0.7, step: 0.01, unit: \"%\",\r\n                visible: function (a) { return a.dipped; }\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.7, max: 3.0, step: 0.1, unit: \"%\",\r\n            }\r\n        ],\r\n    };\r\n    return PhPaper;\r\n}());\r\nexport { PhPaper };\r\nvar PhPaperPack = /** @class */ (function () {\r\n    function PhPaperPack() {\r\n    }\r\n    PhPaperPack.prototype.render = function (appearance) {\r\n        switch (appearance.type) {\r\n            case \"roll\": return this.renderRoll(appearance);\r\n            case \"book\": return this.renderBook(appearance);\r\n        }\r\n    };\r\n    PhPaperPack.prototype.renderBook = function (appearance) {\r\n        var scale = appearance.scale, showLabels = appearance.showLabels;\r\n        var outsideCase = new Path.Rectangle(R(0, 0, 148, 45, Pivot.TOP_CENTER), 2.0)\r\n            .close()\r\n            .withDefaultStyle()\r\n            .withGradientFill(\"right\", [[\"#999999\", 0.0], [\"#eeeeee\", 0.08]]);\r\n        var innerFlap = new Path(Segments([[-74, 2]], [[-64, 5]], [[-5, 5]])).close().withDefaultStyle()\r\n            .withGradientFill(\"right\", [[\"#eeeeee\", 0.14], [\"#dddddd\", 0.15]]);\r\n        mirrorY(innerFlap, 45 / 2);\r\n        var innerPaper1 = new Path.Rectangle(R(0, 7, 20, 14, Pivot.TOP_RIGHT)).withFill(DEFAULT_YELLOW);\r\n        var innerPaper2 = new Path.Rectangle(R(0, 24, 20, 14, Pivot.TOP_RIGHT)).withFill(DEFAULT_YELLOW);\r\n        var xStep = 60 / 7;\r\n        var sampleHeight = 16;\r\n        var sample = new Path.Rectangle(R(0, 1, xStep - 1, sampleHeight)).withFill(PH_COLORS_1[0]);\r\n        var graphic = new Group([outsideCase, innerPaper1, innerPaper2, innerFlap, sample]);\r\n        for (var i = 0; i < 14; i++) {\r\n            var x = Math.floor(i / 2) * xStep + 15;\r\n            var dy = (i % 2 == 0) ? 0 : 45 - 2 - sampleHeight;\r\n            var ty = (i % 2 == 0) ? 20 : 27;\r\n            // Label\r\n            if (showLabels) {\r\n                graphic.addChild(new PointText({\r\n                    point: P(x, ty),\r\n                    content: (i + 1).toString(),\r\n                    fillColor: \"black\",\r\n                    fontFamily: 'sans-serif',\r\n                    fontSize: 3,\r\n                    justification: \"center\",\r\n                }));\r\n            }\r\n            if (i > 0) {\r\n                var cloneSample = sample.clone().withFill(PH_COLORS_1[i]);\r\n                cloneSample.position.x = x;\r\n                cloneSample.position.y += dy;\r\n                graphic.addChild(cloneSample);\r\n            }\r\n            else {\r\n                sample.position.x = x;\r\n            }\r\n        }\r\n        graphic.scale(scale);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.expand(10).toShape()\r\n        };\r\n    };\r\n    PhPaperPack.prototype.renderRoll = function (appearance) {\r\n        var scale = appearance.scale, showLabels = appearance.showLabels;\r\n        var outsideCase = new Path.Circle(P(0, 0), 30.0)\r\n            .withDefaultStyle();\r\n        outsideCase.setRadialGradientFill([\r\n            [\"#f0f0f0\", 0.3],\r\n            [\"#eeeeee\", 0.9],\r\n            [\"#bbbbbb\", 1.0],\r\n        ]);\r\n        var angleStep = 360 / 14;\r\n        var sample = new Path([\r\n            S(P(0.0, -27.0).rotate(angleStep / 2 - 2), P(-2, -1.3)),\r\n            S(P(0.0, -16.0).rotate(angleStep / 2 - 2))\r\n        ]).withFill(PH_COLORS_1[0]).close();\r\n        mirrorX(sample);\r\n        var graphic = new Group([outsideCase, sample]);\r\n        for (var i = 0; i < 14; i++) {\r\n            // Label\r\n            if (showLabels) {\r\n                graphic.addChild(new PointText({\r\n                    point: P(0, -13).rotate(angleStep * i).add([0, 1.2]),\r\n                    content: (i + 1).toString(),\r\n                    fillColor: \"black\",\r\n                    fontFamily: 'sans-serif',\r\n                    fontSize: 3,\r\n                    justification: \"center\",\r\n                }));\r\n            }\r\n            if (i > 0) {\r\n                var cloneSample = sample.clone().withFill(PH_COLORS_1[i]);\r\n                cloneSample.rotate(angleStep * i, P(0, 0));\r\n                graphic.addChild(cloneSample);\r\n            }\r\n        }\r\n        graphic.scale(scale);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.expand(10).toShape()\r\n        };\r\n    };\r\n    PhPaperPack.properties = {\r\n        label: \"pH Paper Pack\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            type: \"roll\",\r\n            scale: 1.0,\r\n            showLabels: false,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"type\", label: \"Type\",\r\n                options: [\r\n                    { value: \"roll\", label: \"Roll\" },\r\n                    { value: \"book\", label: \"Booklet\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 1.0, max: 3.0, step: 0.1, unit: \"%\"\r\n            },\r\n            { spec: \"checkbox\", key: \"showLabels\", label: \"Show pH labels\" }\r\n        ],\r\n    };\r\n    return PhPaperPack;\r\n}());\r\nexport { PhPaperPack };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { g } from \"analytics\";\r\nimport { AddArrow, DeleteArrows } from \"arrows/command\";\r\nimport { AddApparatus, DeleteApparatus, Deselect } from \"command/basic\";\r\nimport { commandProcessor, Sequence } from \"command/command\";\r\nimport { GroupObjects } from \"editing/grouping/commands\";\r\nimport { getRootGroup } from \"editing/grouping/operations\";\r\nimport { Arrays } from \"ext/array\";\r\nimport { ID } from \"store/id\";\r\nimport store from \"store/store\";\r\nimport { add } from \"types\";\r\n/** Distance to paste each copy from the previous. */\r\nexport var DELTA = 50;\r\n/** Handles clipboard operations for apparatus and other items. */\r\nvar Clipboard = /** @class */ (function () {\r\n    function Clipboard() {\r\n        var _this = this;\r\n        /**\r\n         * The contents of the clipboard, i.e. what to create when pasting.\r\n         */\r\n        this.contents = {\r\n            apparatusNotInGroup: [],\r\n            arrowsNotInGroup: [],\r\n            groups: []\r\n        };\r\n        // Number of DELTA steps to paste the new items from the original.\r\n        this.deltaSteps = 0;\r\n        this.createApparatusData = function (a) {\r\n            return __assign(__assign({}, a), { id: ID.mint(\"apparatus\"), x: a.x + DELTA * _this.deltaSteps, y: a.y + DELTA * _this.deltaSteps, parentGroup: undefined });\r\n        };\r\n        this.createArrow = function (a) {\r\n            return __assign(__assign({}, a), { id: ID.mint(\"arrow\"), start: add(a.start, { x: DELTA * _this.deltaSteps, y: DELTA * _this.deltaSteps }), end: add(a.end, { x: DELTA * _this.deltaSteps, y: DELTA * _this.deltaSteps }), parentGroup: undefined });\r\n        };\r\n    }\r\n    /**\r\n     * Inspects the current store state and stores selected items in the clipboard\r\n     * Returns true if there were selected items, false otherwise.\r\n     */\r\n    Clipboard.prototype.fillContentsFromStore = function () {\r\n        if (store.selectedArrows().length + store.selectedItems().length == 0)\r\n            return false;\r\n        var newContents = {\r\n            apparatusNotInGroup: [],\r\n            arrowsNotInGroup: [],\r\n            groups: []\r\n        };\r\n        // Track groups already added.\r\n        var alreadyAddedRootGroupIds = [];\r\n        for (var _i = 0, _a = store.selectedItems(); _i < _a.length; _i++) {\r\n            var apparatus = _a[_i];\r\n            if (apparatus.parentGroup) {\r\n                var rootGroup = getRootGroup(apparatus.parentGroup);\r\n                if (!Arrays.includes(alreadyAddedRootGroupIds, rootGroup.id)) {\r\n                    newContents.groups.push(this.templatizeGroup(rootGroup));\r\n                    alreadyAddedRootGroupIds.push(rootGroup.id);\r\n                }\r\n            }\r\n            else {\r\n                newContents.apparatusNotInGroup.push(apparatus);\r\n            }\r\n        }\r\n        for (var _b = 0, _c = store.selectedArrows(); _b < _c.length; _b++) {\r\n            var arrow = _c[_b];\r\n            if (arrow.parentGroup) {\r\n                var rootGroup = getRootGroup(arrow.parentGroup);\r\n                if (!Arrays.includes(alreadyAddedRootGroupIds, rootGroup.id)) {\r\n                    newContents.groups.push(this.templatizeGroup(rootGroup));\r\n                    alreadyAddedRootGroupIds.push(rootGroup.id);\r\n                }\r\n            }\r\n            else {\r\n                newContents.arrowsNotInGroup.push(arrow);\r\n            }\r\n        }\r\n        this.contents = newContents;\r\n        return true;\r\n    };\r\n    /** Turn a group into a templated group. */\r\n    Clipboard.prototype.templatizeGroup = function (group) {\r\n        var _this = this;\r\n        return {\r\n            items: group.items.map(function (childId) {\r\n                var idf = ID.matching(childId);\r\n                switch (childId.type) {\r\n                    case \"apparatus\":\r\n                        return { type: \"apparatus\", data: store.selectedItems().filter(idf)[0] };\r\n                    case \"arrow\":\r\n                        return { type: \"arrow\", data: store.selectedArrows().filter(idf)[0] };\r\n                    case \"group\":\r\n                        return { type: \"group\", data: _this.templatizeGroup(store.groups().filter(idf)[0]) };\r\n                }\r\n            })\r\n        };\r\n    };\r\n    Clipboard.prototype.cut = function () {\r\n        if (!this.fillContentsFromStore())\r\n            return;\r\n        this.deltaSteps = 0;\r\n        commandProcessor.execute(new Sequence([\r\n            new DeleteApparatus(store.selectedItems()),\r\n            new DeleteArrows(store.selectedArrows()),\r\n        ]));\r\n    };\r\n    Clipboard.prototype.copy = function () {\r\n        if (!this.fillContentsFromStore())\r\n            return;\r\n        this.deltaSteps = 1;\r\n    };\r\n    Clipboard.prototype.paste = function () {\r\n        var _this = this;\r\n        commandProcessor.execute(new Sequence(__spreadArrays([\r\n            new AddApparatus(this.contents.apparatusNotInGroup.map(this.createApparatusData)),\r\n            new AddArrow(this.contents.arrowsNotInGroup.map(this.createArrow))\r\n        ], flatten(this.contents.groups.map(function (g) { return _this.createPasteCommandsForGroup(g); })), [\r\n            // Deselect currently selected items\r\n            new Deselect(__spreadArrays(store.selectedItems().map(function (a) { return a.id; }), store.selectedArrows().map(function (a) { return a.id; }))),\r\n        ])));\r\n        this.deltaSteps++;\r\n    };\r\n    Clipboard.prototype.createPasteCommandsForGroup = function (group, groupId) {\r\n        var commands = [];\r\n        var childIds = [];\r\n        for (var _i = 0, _a = group.items; _i < _a.length; _i++) {\r\n            var child = _a[_i];\r\n            switch (child.type) {\r\n                case \"apparatus\":\r\n                    var apparatus = this.createApparatusData(child.data);\r\n                    childIds.push(apparatus.id);\r\n                    commands.push(new AddApparatus([apparatus]));\r\n                    break;\r\n                case \"arrow\":\r\n                    var arrow = this.createArrow(child.data);\r\n                    childIds.push(arrow.id);\r\n                    commands.push(new AddArrow([arrow]));\r\n                    break;\r\n                case \"group\":\r\n                    var childGroupId = ID.mint(\"group\");\r\n                    childIds.push(childGroupId);\r\n                    commands.push.apply(commands, this.createPasteCommandsForGroup(child.data, childGroupId));\r\n                    break;\r\n            }\r\n        }\r\n        commands.push(new GroupObjects(childIds, groupId));\r\n        return commands;\r\n    };\r\n    return Clipboard;\r\n}());\r\nfunction flatten(commands) {\r\n    return commands.reduce(function (acc, els) { acc.push.apply(acc, els); return acc; }, []);\r\n}\r\n/** Clipboard that also logs events to Google Analytics. */\r\nvar LoggingClipboard = /** @class */ (function () {\r\n    function LoggingClipboard() {\r\n        this.clipboard = new Clipboard();\r\n    }\r\n    LoggingClipboard.prototype.cut = function (source) {\r\n        g(\"Cut\", source);\r\n        this.clipboard.cut();\r\n    };\r\n    LoggingClipboard.prototype.copy = function (source) {\r\n        g(\"Copy\", source);\r\n        this.clipboard.copy();\r\n    };\r\n    LoggingClipboard.prototype.paste = function (source) {\r\n        g(\"Paste\", source);\r\n        this.clipboard.paste();\r\n    };\r\n    return LoggingClipboard;\r\n}());\r\nexport default new LoggingClipboard();\r\n","String.prototype.formattedAsDate = function () {\r\n    var date = new Date(this);\r\n    return date.formattedAsDate();\r\n};\r\nString.prototype.capitalise = function () {\r\n    return this.charAt(0).toUpperCase() + this.substring(1);\r\n};\r\nString.prototype.last = function (n) {\r\n    n = Math.min(n, this.length);\r\n    if (n == 1)\r\n        return this.charAt(this.length - 1);\r\n    return this.substr(this.length - n);\r\n};\r\nString.prototype.first = function (n) {\r\n    n = Math.min(n, this.length);\r\n    if (n == 1)\r\n        return this.charAt(0);\r\n    return this.substr(0, n);\r\n};\r\nString.prototype.replaceLast = function (n, append) {\r\n    return this.substr(0, this.length - n) + append;\r\n};\r\nString.prototype.displaySpecial = function () {\r\n    return this[0] === \"_\" ? this.substring(5) : this.toString();\r\n};\r\nString.prototype.if = function (condition) {\r\n    return condition ? this : \"\";\r\n};\r\nDate.prototype.formattedAsDate = function () {\r\n    return this.toLocaleString();\r\n};\r\nNumber.prototype.toRadians = function () {\r\n    return this * Math.PI / 180;\r\n};\r\nNumber.prototype.toDegrees = function () {\r\n    return this * 180 / Math.PI;\r\n};\r\nNumber.prototype.round = function (decimals) {\r\n    if (decimals === void 0) { decimals = 0; }\r\n    if (decimals == 0)\r\n        return Math.round(this);\r\n    var factor = Math.pow(10, decimals);\r\n    return Math.round((this + 0.000001) * factor) / factor;\r\n};\r\nNumber.prototype.toLocaleFixed = function (places) {\r\n    return this.toLocaleString(undefined, { minimumFractionDigits: places, maximumFractionDigits: places });\r\n};\r\nexport {};\r\n","import { Gradients } from \"apparatus/gradients\";\r\nimport { P, Pivot, R } from \"apparatus/library/common\";\r\nimport { Group, Shape } from \"paper\";\r\nimport { Random } from \"random/random\";\r\nvar Bacteria = /** @class */ (function () {\r\n    function Bacteria() {\r\n    }\r\n    Bacteria.prototype.render = function (appearance) {\r\n        var size = appearance.size;\r\n        var color = appearance.color;\r\n        var graphic = new Group();\r\n        var bounds;\r\n        if (appearance.clipped) {\r\n            var shape = Shape.Circle(P(0, 0), size / 2);\r\n            graphic.addChild(shape);\r\n            graphic.clipped = true;\r\n            bounds = shape.bounds;\r\n        }\r\n        else {\r\n            bounds = R(0, 0, size, size, Pivot.CENTER);\r\n        }\r\n        var step = 7;\r\n        var r = new Random();\r\n        var r2 = new Random();\r\n        for (var x = bounds.left; x < bounds.right; x += step) {\r\n            for (var y = bounds.top; y < bounds.bottom; y += step) {\r\n                var size_1 = r.randomBetween(3, 7);\r\n                var offset = r.randomUnitVector(step / 2);\r\n                if (r2.randomBetween(0, 1) > appearance.density)\r\n                    continue;\r\n                var bacteria = Shape.Circle(P(x, y).add(offset), size_1);\r\n                bacteria.setRadialGradientFill(Gradients.fade(color.color(), { offset: 0.3, finalAlpha: 0.3 }));\r\n                graphic.addChild(bacteria);\r\n            }\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            pivot: P(0, 0)\r\n        };\r\n    };\r\n    Bacteria.properties = {\r\n        label: \"Bacteria culture\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            size: 45,\r\n            density: 0.5,\r\n            clipped: false,\r\n            clipShape: \"circle\",\r\n            color: \"#cccccc\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 35, max: 150, unit: \"mm\"\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"density\", label: \"Culture density\",\r\n                min: 0.05, max: 0.95, step: 0.01, unit: \"%\",\r\n            },\r\n            {\r\n                spec: \"checkbox\", key: \"clipped\", label: \"Clip to circle\"\r\n            },\r\n            {\r\n                spec: \"color\", key: \"color\", label: \"Colour\",\r\n            }\r\n        ],\r\n    };\r\n    return Bacteria;\r\n}());\r\nexport { Bacteria };\r\n","import { strokeWidth } from \"apparatus/draw\";\r\nimport { P } from \"apparatus/library/common\";\r\nimport { SVG } from \"apparatus/svg\";\r\nvar HotPlate = /** @class */ (function () {\r\n    function HotPlate() {\r\n    }\r\n    HotPlate.prototype.render = function (appearance) {\r\n        var graphic = SVG.hotPlate();\r\n        graphic.scale(2.0 * appearance.scale, P(0, 0));\r\n        graphic.children[0].children[3].strokeWidth = strokeWidth(\"thin\");\r\n        graphic.children[0].children[6].strokeWidth = strokeWidth(\"thin\");\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: [\r\n                graphic.topEdgeAsPlaceableSurface(),\r\n                graphic.placeable()\r\n            ]\r\n        };\r\n    };\r\n    HotPlate.properties = {\r\n        label: \"Hot Plate\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            scale: 1.0\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.8, max: 1.75, step: 0.01\r\n            }\r\n        ],\r\n    };\r\n    return HotPlate;\r\n}());\r\nexport { HotPlate };\r\n","import { Gradients } from \"apparatus/gradients\";\r\nimport { P, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nvar metal = Gradients.cylinder(SharedColors.lightMetal.color());\r\nvar VernierCaliper = /** @class */ (function () {\r\n    function VernierCaliper() {\r\n    }\r\n    VernierCaliper.prototype.render = function (appearance) {\r\n        // Note the caliper is initially drawn at 2x.\r\n        var cms = appearance.cms, inches = appearance.inches;\r\n        var mainBody = new Path(Segments([[0, -48]], [[15, 0], [1, -43]], [[415, 0]], [[415, 34]], [[0, 34]], [[0, 128], , [-23, 0]], [[-38, 41], [17, 62]], [[-38, -10]], [[0, -10]])).close()\r\n            .withStroke(\"default\")\r\n            .withGradientFill(\"right-down\", metal);\r\n        var inchSlider = new Path(Segments([[0, -47]], [[0, -10]], [[110, -10]], [[110, -2]], [[-10, -2], [20, 0], [-8, -33]])).close()\r\n            .withStroke(\"default\")\r\n            .withGradientFill(\"right-down\", metal);\r\n        inchSlider.pivot = P(0, 0);\r\n        inchSlider.position = P(inches * 25.4 * 2, 0);\r\n        var cmSlider = new Path(Segments([[0, 0]], [[110, 0]], [[110, 19]], [[40, 19], [20, 1], [-13, 0]], [[0, 93], [27, -5]])).close()\r\n            .withStroke(\"default\")\r\n            .withGradientFill(\"right-down\", metal);\r\n        cmSlider.pivot = P(0, 0);\r\n        cmSlider.position = P(cms * 10 * 2, 34);\r\n        var graphic = new Group([inchSlider, mainBody, cmSlider]);\r\n        graphic.scale(0.5 * appearance.scale);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    VernierCaliper.properties = {\r\n        label: \"Vernier Caliper\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            inches: 1,\r\n            cms: 3,\r\n            scale: 1\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Size\",\r\n                min: 1, max: 2, step: 0.1, unit: \"x\"\r\n            },\r\n            {\r\n                spec: \"header\", header: \"Sliders\", icon: \"sliders-h\",\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"inches\", label: \"Inches\",\r\n                min: 0, max: 5.5, step: 0.1, unit: \"in\"\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"cms\", label: \"Centimetres\",\r\n                min: 0, max: 15, step: 0.1, unit: \"cm\"\r\n            }\r\n        ],\r\n    };\r\n    return VernierCaliper;\r\n}());\r\nexport { VernierCaliper };\r\n","import { P, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nvar FreehandDrawing = /** @class */ (function () {\r\n    function FreehandDrawing() {\r\n    }\r\n    FreehandDrawing.prototype.render = function (appearance) {\r\n        var path = new Path(Segments.apply(void 0, appearance.points));\r\n        var graphic;\r\n        switch (appearance.drawStyle) {\r\n            case \"stroke\":\r\n                graphic = renderStroke(path, appearance);\r\n                break;\r\n            case \"shape\":\r\n                graphic = renderShape(path, appearance);\r\n                break;\r\n            case \"tube\":\r\n                graphic = renderTube(path, appearance);\r\n                break;\r\n        }\r\n        var snapping = [];\r\n        if (appearance.drawStyle == \"tube\") {\r\n            var p1 = appearance.points[0];\r\n            var vec1Out = P(p1[2][0], p1[2][1]);\r\n            snapping.push({\r\n                type: \"connectable\",\r\n                at: P(p1[0][0], p1[0][1]),\r\n                facing: vec1Out.angle - 90,\r\n            });\r\n            var pN = appearance.points[appearance.points.length - 1];\r\n            var vecNOut = P(pN[1][0], pN[1][1]);\r\n            snapping.push({\r\n                type: \"connectable\",\r\n                at: P(pN[0][0], pN[0][1]),\r\n                facing: vecNOut.angle - 90,\r\n            });\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.strokeBounds.toShape(),\r\n            snapping: snapping,\r\n        };\r\n    };\r\n    FreehandDrawing.properties = {\r\n        label: \"Freehand drawing\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            points: [],\r\n            drawStyle: \"stroke\",\r\n            strokeColor: SharedColors.stroke,\r\n            strokeWidth: 4.0,\r\n            tubeWidth: 10.0,\r\n            tubeWallThickness: 4.0,\r\n        },\r\n        appearanceSpecs: [\r\n            // {\r\n            //     spec: \"radio\", key: \"drawStyle\", label: \"Draw Style\",\r\n            //     options: [\r\n            //         { value: \"stroke\", label: \"Drawing\" },\r\n            //         { value: \"tube\", label: \"Tube\" },\r\n            //         { value: \"shape\", label: \"Shape\" },\r\n            //     ],\r\n            // },\r\n            {\r\n                spec: \"toggle-buttons\", key: \"drawStyle\", label: \"Draw Style\",\r\n                options: [\r\n                    { value: \"stroke\", label: \"Drawing\", icon: \"signature\" },\r\n                    { value: \"shape\", label: \"Shape\", icon: \"draw-polygon\" },\r\n                    { value: \"tube\", label: \"Tube\", icon: \"check-double fa-flip-horizontal\" },\r\n                ],\r\n                size: \"large\",\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"strokeWidth\", label: \"Stroke width\",\r\n                min: 1.0, max: 20.0, step: 0.05,\r\n                visible: function (a) { return a.drawStyle == \"shape\" || a.drawStyle == \"stroke\"; },\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"tubeWidth\", label: \"Tube width\",\r\n                min: 6.0, max: 20.0, step: 0.05,\r\n                visible: function (a) { return a.drawStyle == \"tube\"; }\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"tubeWallThickness\", label: \"Tube wall thickness\",\r\n                min: 1.0, max: 6.0, step: 0.05,\r\n                visible: function (a) { return a.drawStyle == \"tube\"; }\r\n            },\r\n        ],\r\n    };\r\n    return FreehandDrawing;\r\n}());\r\nexport { FreehandDrawing };\r\nfunction renderStroke(path, appearance) {\r\n    path.strokeColor = appearance.strokeColor;\r\n    path.strokeWidth = appearance.strokeWidth;\r\n    return path;\r\n}\r\nfunction renderShape(path, appearance) {\r\n    path.closePath();\r\n    path.strokeColor = appearance.strokeColor;\r\n    path.strokeWidth = appearance.strokeWidth;\r\n    path.fillColor = \"red\";\r\n    return path;\r\n}\r\nfunction renderTube(path, appearance) {\r\n    path.strokeColor = appearance.strokeColor;\r\n    path.strokeWidth = appearance.tubeWidth + appearance.tubeWallThickness * 2;\r\n    var inside = path.clone();\r\n    inside.strokeColor = \"white\";\r\n    inside.strokeWidth = appearance.tubeWidth;\r\n    return new Group([path, inside]);\r\n}\r\n","import { P, R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape, Symbol } from \"paper\";\r\nvar WireGauze = /** @class */ (function () {\r\n    function WireGauze() {\r\n    }\r\n    WireGauze.prototype.render = function (appearance) {\r\n        switch (appearance.view) {\r\n            case \"side\":\r\n                return sideView(appearance);\r\n            case \"top\":\r\n                return topView(appearance);\r\n        }\r\n    };\r\n    WireGauze.properties = {\r\n        label: \"Wire Gauze\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            size: 100,\r\n            view: \"side\",\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 50, max: 150, step: 10, unit: \"mm\"\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"view\", label: \"View\",\r\n                options: [\r\n                    { value: \"top\", label: \"From the top\" },\r\n                    { value: \"side\", label: \"From the side\" }\r\n                ]\r\n            }\r\n        ],\r\n    };\r\n    return WireGauze;\r\n}());\r\nexport { WireGauze };\r\nfunction sideView(appearance) {\r\n    var squiggle = new Path(Segments([[0, 0], undefined, [5, 9]], [[10, 0], [-5, -9], [5, 9]]));\r\n    squiggle.strokeWidth = 2.5;\r\n    squiggle.strokeColor = \"#5c6c84\";\r\n    var count = appearance.size / 10;\r\n    var graphic = new Group([squiggle]);\r\n    for (var i = 2; i < count; i++) {\r\n        squiggle.addSegments(Segments([[i * 10, 0], [-5, -9], [5, 9]]));\r\n    }\r\n    return {\r\n        graphic: graphic,\r\n        hitShape: graphic.strokeBounds.expand(10).toShape(),\r\n        snapping: [{\r\n                type: \"placeable\",\r\n                at: graphic.bounds.bottomCenter.add(P(0, 5)),\r\n            }, {\r\n                type: \"placeable_surface\",\r\n                start: graphic.bounds.topLeft.add(P(0, -5)),\r\n                end: graphic.bounds.topRight.add(P(0, -5))\r\n            }]\r\n    };\r\n}\r\nfunction topView(appearance) {\r\n    var line = Shape.Rectangle(R(0, 0, appearance.size, 2.0));\r\n    line.fillColor = \"#5c6c84\";\r\n    var lineSymbol = new Symbol(line, true);\r\n    var count = appearance.size / 10;\r\n    var offset = appearance.size / 2 + 5;\r\n    var graphic = new Group();\r\n    for (var i = 1; i < count + 1; i++) {\r\n        graphic.addChild(lineSymbol.place(P(0, 10 * i - offset)));\r\n        var orthogonalPlaced = lineSymbol.place(P(i * 10 - offset, 0));\r\n        orthogonalPlaced.rotate(90);\r\n        graphic.addChild(orthogonalPlaced);\r\n    }\r\n    var pad = Shape.Circle(graphic.bounds.center, appearance.size / 3);\r\n    pad.fillColor = \"#dbcfbaee\";\r\n    graphic.addChild(pad);\r\n    var hitShape = Shape.Rectangle(graphic.strokeBounds.expand(10));\r\n    return { graphic: graphic, hitShape: hitShape };\r\n}\r\n","import { setDefaultStyle } from \"apparatus/draw\";\r\nimport { P, R } from \"apparatus/library/common\";\r\nimport { Raster, Shape } from \"paper\";\r\n/** Loads a raster image. Currently used only for development. */\r\nvar RasterImage = /** @class */ (function () {\r\n    function RasterImage() {\r\n        this.loadedUrl = \"\";\r\n        this.hitShape = Shape.Rectangle(R(0, 0, 10, 10));\r\n    }\r\n    RasterImage.prototype.render = function (appearance) {\r\n        var _this = this;\r\n        var _a;\r\n        if (appearance.source == \"\") {\r\n            var dummy = Shape.Rectangle(R(0, 0, 100, 100));\r\n            setDefaultStyle(dummy);\r\n            return {\r\n                graphic: dummy,\r\n                hitShape: dummy.clone()\r\n            };\r\n        }\r\n        var raster;\r\n        if (appearance.source != this.loadedUrl) {\r\n            (_a = this.currentRaster) === null || _a === void 0 ? void 0 : _a.remove();\r\n            raster = new Raster(appearance.source);\r\n            raster.onLoad = function () {\r\n                _this.hitShape.bounds = raster.bounds;\r\n            };\r\n            this.currentRaster = raster;\r\n            this.loadedUrl = appearance.source;\r\n        }\r\n        else {\r\n            raster = this.currentRaster;\r\n        }\r\n        raster.scaling = P(appearance.size, appearance.size);\r\n        return {\r\n            graphic: raster,\r\n            hitShape: this.hitShape,\r\n        };\r\n    };\r\n    RasterImage.properties = {\r\n        label: \"Image\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            source: \"\",\r\n            size: 1,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"text\", key: \"source\", label: \"Image URL\",\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 0.25, max: 2.0, step: 0.005,\r\n            }\r\n        ],\r\n    };\r\n    return RasterImage;\r\n}());\r\nexport { RasterImage };\r\n","import { breakPath, mirrorX, setDefaultStyle, strokeWidth } from \"apparatus/draw\";\r\nimport { P, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Tap } from \"apparatus/library/common/tap\";\r\nimport { Group, Path } from \"paper\";\r\nvar Hofmann = /** @class */ (function () {\r\n    function Hofmann() {\r\n    }\r\n    Hofmann.prototype.render = function (appearance) {\r\n        var shape = new Path(Segments(\r\n        // Start at the top.\r\n        [[10, -410]], [[10, -400], , [15, 7]], [[30, -375], [0, -9], [0, 22]], [[5, -345]], [[5, -8]], \r\n        // Burette on one side.\r\n        [[70, -8]], [[70, -280], , [0, -15]], [[80, -310]], [[80, -350]], // Peak\r\n        [[90, -350]], [[90, -310]], [[100, -280], [0, -15]], [[100, 50]], [[70, 50]], [[70, 8]]));\r\n        mirrorX(shape);\r\n        shape.closePath();\r\n        var customLiquidMask = shape.clone();\r\n        var leftLiquidHeight = -10 - appearance.leftLevel * 300;\r\n        var middleLiquidHeight = -10 - appearance.waterLevel * 400;\r\n        var rightLiquidHeight = -10 - appearance.rightLevel * 300;\r\n        var liquid = new Path(Segments(\r\n        // Left column.\r\n        [[-100, leftLiquidHeight]], [[-70, leftLiquidHeight]], \r\n        // Middle column.\r\n        [[-40, middleLiquidHeight]], [[40, middleLiquidHeight]], \r\n        // Right column.\r\n        [[70, rightLiquidHeight]], [[100, rightLiquidHeight]], \r\n        // Fixed bottom level.\r\n        [[100, 50]], [[-100, 50]]));\r\n        liquid.fillColor = SharedColors.defaultLiquid + \"4D\";\r\n        liquid.withStroke(strokeWidth(\"thin\"), SharedColors.defaultLiquid);\r\n        var liquidGroup = new Group([customLiquidMask, liquid]);\r\n        liquidGroup.clipped = true;\r\n        var glassWalls = breakPath(shape, 9, 13, 17, 21);\r\n        setDefaultStyle(glassWalls);\r\n        var tap1 = Tap.create(appearance.rightTap, true).withPosition(P(85, -310));\r\n        tap1.rotation = 180;\r\n        var tap2 = Tap.create(appearance.leftTap, true).withPosition(P(-85, -310));\r\n        tap2.rotation = 180;\r\n        var graphic = new Group([liquidGroup, glassWalls, tap1, tap2]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            pivot: glassWalls.bounds.center,\r\n        };\r\n    };\r\n    Hofmann.properties = {\r\n        label: \"Hoffman Voltameter\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            leftTap: 1.0,\r\n            rightTap: 1.0,\r\n            leftLevel: 0.75,\r\n            rightLevel: 0.5,\r\n            waterLevel: 0.9,\r\n        },\r\n        appearanceSpecs: [\r\n            { spec: \"slider\", key: \"leftLevel\", label: \"Left water level\", min: 0.0, max: 1.0, step: 0.01, unit: \"%\" },\r\n            { spec: \"slider\", key: \"waterLevel\", label: \"Middle water level\", min: 0.0, max: 1.0, step: 0.01, unit: \"%\" },\r\n            { spec: \"slider\", key: \"rightLevel\", label: \"Right water level\", min: 0.0, max: 1.0, step: 0.01, unit: \"%\" },\r\n            Tap.appearanceSpecFor(\"leftTap\", \"Left tap\"),\r\n            Tap.appearanceSpecFor(\"rightTap\", \"Right tap\"),\r\n        ],\r\n    };\r\n    return Hofmann;\r\n}());\r\nexport { Hofmann };\r\n","import { Gradients } from \"apparatus/gradients\";\r\nimport { P, Pivot, SharedColors } from \"apparatus/library/common\";\r\nimport { Color, Gradient, Group, Path, Segment, Shape } from \"paper\";\r\nimport { metalRod, strokeWidth } from \"../draw\";\r\nimport { lerp, R } from \"./common\";\r\nvar CLAMP_LENGTH = 180;\r\nvar clampSizeProp = {\r\n    spec: \"slider\", key: \"clampSize\", label: \"Clamp size\",\r\n    min: 30, max: 130\r\n};\r\nvar clampColorProp = {\r\n    spec: \"radio\", key: \"clampColor\", label: \"Material\",\r\n    options: [\r\n        { value: \"metal\", label: \"Metal\" },\r\n        { value: \"blue\", label: \"Blue rubber\" },\r\n    ]\r\n};\r\n/**\r\n * https://imgaz1.staticbg.com/thumb/large/oaupload/banggood/images/65/38/1992bd64-406b-476d-bb34-b6d63962c28d.JPG.webp\r\n */\r\nvar Clamp = /** @class */ (function () {\r\n    function Clamp() {\r\n        this.drivers = [\r\n            {\r\n                type: \"rectangle\",\r\n                minX: 20, maxX: CLAMP_LENGTH + 20,\r\n                minY: -20, maxY: -20,\r\n                fromAppearance: function (a) { return P(a.shift * CLAMP_LENGTH + 20, -20); },\r\n                toAppearance: function (p) { return ({ shift: (p.x - 20) / CLAMP_LENGTH }); },\r\n                scale: 1.0,\r\n            }\r\n        ];\r\n    }\r\n    Clamp.prototype.render = function (appearance) {\r\n        var length = CLAMP_LENGTH;\r\n        var handleThickness = 15;\r\n        var handleWidth = appearance.clampSize;\r\n        // Create the bolt.\r\n        var bolt = createBolt();\r\n        // Create the rod and the handler.\r\n        var _a = metalRod(P(0, 0), P(length, 0)), rod = _a[0], rodHighlight = _a[1];\r\n        var handleR = R(length, -handleThickness / 2, handleWidth, handleThickness);\r\n        var handle = new Path.Rectangle(handleR, 4.0);\r\n        setHandleColor(handle, appearance.clampColor);\r\n        var handleHighlight = new Path.Line(P(6, 0), P(handleWidth - 6, 0));\r\n        handleHighlight.position.x += length;\r\n        handleHighlight.position.y -= handleThickness / 2 - 3;\r\n        handleHighlight.strokeWidth = 3.0;\r\n        handleHighlight.strokeColor = \"#ffffff40\";\r\n        handleHighlight.strokeCap = \"round\";\r\n        // Move the rod.\r\n        var shiftable = new Group([rod, rodHighlight, handle, handleHighlight]);\r\n        shiftable.position.x -= lerp(0.95, 0, appearance.shift) * length;\r\n        // Assemble and compute hit shape.\r\n        var graphic = new Group([shiftable, bolt]);\r\n        var hitShape = Shape.Rectangle(graphic.bounds);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShape,\r\n            pivot: P(0, 0),\r\n            snapping: { type: \"attachable\", at: P(0, 0) }\r\n        };\r\n    };\r\n    Clamp.properties = {\r\n        label: \"Retort clamp\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            shift: 0.8,\r\n            clampSize: 45,\r\n            clampColor: \"blue\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"shift\", label: \"Shift\",\r\n                min: 0, max: 1, step: 0.01\r\n            },\r\n            clampSizeProp,\r\n            clampColorProp,\r\n        ],\r\n    };\r\n    return Clamp;\r\n}());\r\nexport { Clamp };\r\nvar FrontClamp = /** @class */ (function () {\r\n    function FrontClamp() {\r\n    }\r\n    FrontClamp.prototype.render = function (appearance) {\r\n        var clampSize = appearance.clampSize, clampColor = appearance.clampColor;\r\n        // Clamp.\r\n        var back = Shape.Rectangle(R(0, 0, clampSize, 10, Pivot.CENTER), 5.0)\r\n            .withGradientFill(\"right\", Gradients.reflected([\"#888888\", 0.0], [\"#666666\", 0.25], [\"#444444\", 0.4]));\r\n        var reflection = new Path.Line(P(-clampSize / 2 + 5, -2), P(clampSize / 2 - 5, -2))\r\n            .withStroke(2.0, \"#ffffff30\");\r\n        var left = Shape.Circle(P(-clampSize / 2, 0), 7.0);\r\n        var right = Shape.Circle(P(clampSize / 2, 0), 7.0);\r\n        setHandleColorForFront(left, clampColor);\r\n        setHandleColorForFront(right, clampColor);\r\n        // Bolt (side view).\r\n        var bolt = Shape.Rectangle(R(-5, 0, 8, 20, Pivot.CENTER_RIGHT), 2.0);\r\n        bolt.withStroke(\"thin\", SharedColors.stroke)\r\n            .withGradientFill(\"down\", [[\"#888888\", 0.0], [\"#666666\", 0.2], [SharedColors.darkMetal, 1.0]]);\r\n        var graphic = new Group([bolt, back, reflection, left, right]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.expand(15).toShape(),\r\n            pivot: P(0, 0),\r\n            snapping: { type: \"attachable\", at: P(0, 0) }\r\n        };\r\n    };\r\n    FrontClamp.properties = {\r\n        label: \"Retort clamp (Front view)\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            clampSize: 45,\r\n            clampColor: \"blue\"\r\n        },\r\n        appearanceSpecs: [\r\n            clampSizeProp,\r\n            clampColorProp,\r\n        ],\r\n    };\r\n    return FrontClamp;\r\n}());\r\nexport { FrontClamp };\r\nexport function createBolt() {\r\n    var steps = 7;\r\n    var stepAngle = 360 / steps;\r\n    var segmentA = new Segment(P(0, -10), P(-1, 2), P(2, -1));\r\n    var segmentB = new Segment(P(0, -10).rotate(stepAngle / 2, P(0, 0)), P(-2, -1).rotate(stepAngle / 2), P(1, 2).rotate(stepAngle / 2));\r\n    var bolt = new Path();\r\n    for (var i = 0; i < steps; i++) {\r\n        segmentA = segmentA.clone();\r\n        rotateSegment(segmentA, stepAngle, P(0, 0));\r\n        segmentB = segmentB.clone();\r\n        rotateSegment(segmentB, stepAngle, P(0, 0));\r\n        bolt.addSegments([segmentA, segmentB]);\r\n    }\r\n    bolt.closePath();\r\n    bolt.withStroke(\"thin\", SharedColors.stroke);\r\n    bolt.setRadialGradientFill([\r\n        [\"#555555\", 0.4],\r\n        [SharedColors.darkMetal, 0.5],\r\n        [\"#666666\", 0.6],\r\n        [SharedColors.darkMetal, 0.7],\r\n        [\"#666666\", 0.95],\r\n    ], P(0, 0));\r\n    return bolt;\r\n}\r\nfunction rotateSegment(segment, angle, pivot) {\r\n    segment.point = segment.point.rotate(angle, pivot);\r\n    if (segment.handleIn)\r\n        segment.handleIn = segment.handleIn.rotate(angle);\r\n    if (segment.handleOut)\r\n        segment.handleOut = segment.handleOut.rotate(angle);\r\n}\r\nvar Ring = /** @class */ (function () {\r\n    function Ring() {\r\n    }\r\n    Ring.prototype.render = function (appearance) {\r\n        var length = 180;\r\n        var ringWidth = appearance.ringSize;\r\n        var ringHeight = 5.0 + ringWidth * 0.15;\r\n        // Create the bolt.\r\n        var bolt = createBolt();\r\n        // Create the rod.\r\n        var _a = metalRod(P(0, 0), P(length, 0)), rod = _a[0], rodHighlight = _a[1];\r\n        // Create the ring.\r\n        var ring = Shape.Ellipse(R(length, -ringHeight / 2, ringWidth, ringHeight));\r\n        ring.strokeWidth = 8.0;\r\n        ring.strokeColor = SharedColors.darkMetal;\r\n        // Create ring reflections.\r\n        var reflectionSize = ringWidth * 0.3;\r\n        var reflection1 = ringReflection(ring, 1, reflectionSize);\r\n        var reflection2 = ringReflection(ring, -2.3, reflectionSize);\r\n        reflection1.position.x += length;\r\n        reflection2.position.x += length;\r\n        // Move the rod.\r\n        var shiftable = new Group([rod, rodHighlight, ring, reflection1, reflection2]);\r\n        shiftable.position.x -= lerp(0.95, 0, appearance.shift) * length;\r\n        // Assemble and compute hit shape.\r\n        var graphic = new Group([shiftable, bolt]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.strokeBounds.toShape(),\r\n            pivot: P(0, 0),\r\n            snapping: { type: \"attachable\", at: P(0, 0) }\r\n        };\r\n    };\r\n    Ring.properties = {\r\n        label: \"Retort Ring\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            shift: 0.8,\r\n            ringSize: 77,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"shift\", label: \"Shift\",\r\n                min: 0, max: 1, step: 0.01\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"ringSize\", label: \"Clamp size\",\r\n                min: 35, max: 130\r\n            },\r\n        ],\r\n    };\r\n    return Ring;\r\n}());\r\nexport { Ring };\r\nfunction ringReflection(ring, angle, width) {\r\n    var ringWidth = ring.bounds.width;\r\n    var ringHeight = ring.bounds.height;\r\n    var reflectionGradient = new Gradient([[\"#ffffff60\", 0.0], [\"#ffffff00\", 1.0]], true);\r\n    var reflection = Shape.Ellipse(R(0, 0, width, 8));\r\n    reflection.fillColor = new Color(reflectionGradient, P(width / 2, 4), P(width, 8));\r\n    reflection.position.x = ringWidth / 2 + Math.cos(angle) * ringWidth / 2;\r\n    reflection.position.y = Math.sin(angle) * ringHeight / 2;\r\n    return reflection;\r\n}\r\nfunction setHandleColor(handle, color) {\r\n    var gradient;\r\n    switch (color) {\r\n        case \"blue\":\r\n            handle.strokeColor = \"#26527f\";\r\n            gradient = new Gradient([\r\n                [\"#3c82c9\", 0.1],\r\n                [\"#56a0ea\", 0.3],\r\n                [\"#478cd1\", 0.7],\r\n                [\"#3c82c9\", 0.9],\r\n            ]);\r\n            break;\r\n        case \"metal\":\r\n        default:\r\n            handle.strokeColor = SharedColors.darkMetal;\r\n            gradient = new Gradient([\r\n                [\"#777777\", 0.1],\r\n                [\"#aaaaaa\", 0.22],\r\n                [\"#888888\", 0.7],\r\n                [\"#444444\", 1.0],\r\n            ]);\r\n    }\r\n    handle.strokeWidth = strokeWidth(\"thin\");\r\n    handle.fillColor = new Color(gradient, handle.bounds.leftCenter, handle.bounds.rightCenter);\r\n}\r\nfunction setHandleColorForFront(item, color) {\r\n    var stroke;\r\n    var fill;\r\n    switch (color) {\r\n        case \"blue\":\r\n            stroke = \"#26527f\";\r\n            fill = \"#3c82c9\";\r\n            break;\r\n        case \"metal\":\r\n            stroke = SharedColors.darkMetal;\r\n            fill = \"#888888\";\r\n            break;\r\n    }\r\n    item.withFill(fill);\r\n    item.withStroke(\"thin\", stroke);\r\n}\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { LIQUID_OPACITY_MAX, SharedColors } from \"apparatus/library/common\";\r\nimport appStore from \"store/store\";\r\nexport var MultiLiquid;\r\n(function (MultiLiquid) {\r\n    function addLayer(layers) {\r\n        var newLayer;\r\n        if (layers.length > 0) {\r\n            var lastLayer = layers[0];\r\n            newLayer = {\r\n                position: lastLayer.position * 0.66,\r\n                blending: 0,\r\n                alpha: SharedColors.defaultLiquidAlpha,\r\n                color: lastLayer.color.color().rotate(90).hex()\r\n            };\r\n        }\r\n        else {\r\n            newLayer = {\r\n                position: 0.66,\r\n                alpha: SharedColors.defaultLiquidAlpha,\r\n                color: SharedColors.defaultLiquid2,\r\n                blending: 0\r\n            };\r\n        }\r\n        return __spreadArrays([newLayer], layers);\r\n    }\r\n    MultiLiquid.addLayer = addLayer;\r\n    function createSimpleGradient(color, alpha) {\r\n        return [\r\n            {\r\n                position: 0.1,\r\n                alpha: (alpha + LIQUID_OPACITY_MAX) / 2,\r\n                color: color.color().darken(0.1).round().hex(),\r\n                blending: 1.0\r\n            }\r\n        ];\r\n    }\r\n    MultiLiquid.createSimpleGradient = createSimpleGradient;\r\n    function removeBottomLayer(data) {\r\n        return data.length == 0 ? [] : data.slice(1, data.length);\r\n    }\r\n    MultiLiquid.removeBottomLayer = removeBottomLayer;\r\n    /**\r\n     * @param data Must have length > 0\r\n     * @param topLayerColor Must include alpha and be a string\r\n     */\r\n    function toGradientStops(data, topLayerColor) {\r\n        var stops = [];\r\n        // Precompute all the colours.\r\n        var colors = data.map(function (d) { return d.color.color().alpha(d.alpha).toString(); });\r\n        colors.push(topLayerColor);\r\n        for (var i = 0; i < data.length; i++) {\r\n            stops.push([colors[i], data[i].position]);\r\n            // Depending on blending, place the next stop:\r\n            // blending == 0: No blending: place the stop as close to the current layer as possible\r\n            // blending == 1: Maximum blending, place the stop as close to the next layer.\r\n            var blendUpper = i == data.length - 1 ? 1 : data[i + 1].position;\r\n            var blendRange = blendUpper - data[i].position;\r\n            var blend = data[i].blending;\r\n            stops.push([colors[i + 1], data[i].position + blend * blendRange]);\r\n        }\r\n        stops.push([topLayerColor, 1.0]);\r\n        return stops;\r\n    }\r\n    MultiLiquid.toGradientStops = toGradientStops;\r\n    function adjustNumeric(data, index, key, value) {\r\n        var _a;\r\n        var newData = __spreadArrays(data);\r\n        newData[index] = __assign(__assign({}, data[index]), (_a = {}, _a[key] = value, _a));\r\n        if (key == \"position\") {\r\n            newData.sort(function (a, b) { return a.position - b.position; });\r\n        }\r\n        return newData;\r\n    }\r\n    MultiLiquid.adjustNumeric = adjustNumeric;\r\n    function adjustString(data, index, key, value) {\r\n        var _a;\r\n        var newData = __spreadArrays(data);\r\n        if (key == \"color\") {\r\n            value = value.toLowerCase();\r\n        }\r\n        newData[index] = __assign(__assign({}, data[index]), (_a = {}, _a[key] = value, _a));\r\n        return newData;\r\n    }\r\n    MultiLiquid.adjustString = adjustString;\r\n})(MultiLiquid || (MultiLiquid = {}));\r\nvar UpdateLiquidLayers = /** @class */ (function () {\r\n    function UpdateLiquidLayers(id, layers, unsafePreviousLayers) {\r\n        this.id = id;\r\n        this.layers = layers;\r\n        // Copy previous layers.\r\n        this.previousLayers = __spreadArrays(unsafePreviousLayers);\r\n    }\r\n    UpdateLiquidLayers.prototype.execute = function () {\r\n        appStore.dispatchFn(\"updateLiquidLayers\", this.mutator(this.layers));\r\n    };\r\n    UpdateLiquidLayers.prototype.undo = function () {\r\n        appStore.dispatchFn(\"updateLiquidLayers\", this.mutator(this.previousLayers));\r\n    };\r\n    UpdateLiquidLayers.prototype.mutator = function (layers) {\r\n        var _this = this;\r\n        return (function (store) {\r\n            var newStore = __assign({}, store);\r\n            newStore.items = store.items.map(function (i) { return i.id === _this.id && i.liquid\r\n                ? __assign(__assign({}, i), { liquid: __assign(__assign({}, i.liquid), { layers: layers }) }) : i; });\r\n            return newStore;\r\n        });\r\n    };\r\n    return UpdateLiquidLayers;\r\n}());\r\nexport { UpdateLiquidLayers };\r\n","import { addEdgeLipsReversed, mirrorX, setDefaultStyle } from \"apparatus/draw\";\r\nimport * as p from \"paper\";\r\nimport { Segments } from \"./common\";\r\nvar ReagentBottle = /** @class */ (function () {\r\n    function ReagentBottle() {\r\n    }\r\n    ReagentBottle.prototype.render = function (appearance) {\r\n        var height = appearance.height;\r\n        var width = appearance.width;\r\n        var neck = width / 2.333;\r\n        var bottle = new p.Path(Segments([[neck, 0]], [[neck - 2, 25], undefined, [neck, 0]], [[width, 40], [0, -10]], [[width, height]]));\r\n        mirrorX(bottle);\r\n        var liquidMask = bottle.clone();\r\n        addEdgeLipsReversed(bottle);\r\n        var graphic = new p.Group([bottle]);\r\n        if (appearance.lid != \"none\") {\r\n            var lid1 = new p.Path(Segments([[neck + 3, -5]], [[neck + 3, 0]]));\r\n            mirrorX(lid1);\r\n            lid1.closePath();\r\n            var lid2 = new p.Path(Segments([[neck - 3, 0]], [[neck - 6, 20]]));\r\n            mirrorX(lid2);\r\n            var lid = new p.Group([lid1, lid2]);\r\n            switch (appearance.lid) {\r\n                case \"closed\":\r\n                    lid.position.y -= 5;\r\n                    break;\r\n                case \"lifted\":\r\n                    lid.position.y -= 40;\r\n                    break;\r\n                case \"tilted\":\r\n                    lid.position.y -= 30;\r\n                    lid.position.x += 30;\r\n                    lid.rotation = 30;\r\n                    break;\r\n            }\r\n            graphic.addChild(lid);\r\n        }\r\n        setDefaultStyle(graphic);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            liquidMask: liquidMask,\r\n            snapping: graphic.placeable(),\r\n        };\r\n    };\r\n    ReagentBottle.properties = {\r\n        label: \"Reagent bottle\",\r\n        canContainLiquids: true,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            lid: \"closed\",\r\n            height: 131,\r\n            width: 35,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Height\",\r\n                min: 90, max: 150,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"width\", label: \"Diameter\",\r\n                min: 25, max: 40,\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"lid\", label: \"Lid appearance\",\r\n                options: [\r\n                    { value: \"none\", label: \"No lid\" },\r\n                    { value: \"closed\", label: \"Closed\" },\r\n                    { value: \"lifted\", label: \"Lifted above\" },\r\n                    { value: \"tilted\", label: \"Lift tilted\" },\r\n                ]\r\n            }\r\n        ],\r\n    };\r\n    return ReagentBottle;\r\n}());\r\nexport { ReagentBottle };\r\n","import { P, Segments } from \"apparatus/library/common\";\r\nimport { DEFAULT_SWATCHES } from \"components/colorpicker\";\r\nimport { Group, Path } from \"paper\";\r\nimport { createCompoundPath } from \"../../../paper_ext\";\r\nvar crystalOutlineStrokeWidth = \"thinner\";\r\nvar crystalInlineStrokeWidth = 1.0;\r\nvar Crystals = /** @class */ (function () {\r\n    function Crystals() {\r\n    }\r\n    Crystals.isBoostRequiredForAppearance = function (a) {\r\n        return a.type == \"cubic\" || a.type == \"rhombic\";\r\n    };\r\n    Crystals.prototype.render = function (appearance) {\r\n        var color = appearance.color;\r\n        var count = appearance.count;\r\n        // The appearance colour is used for the stroke.\r\n        // Figure out the fill colour by slightly lightening it.\r\n        var colorLightness = color.color().lightness();\r\n        // Lightness runs from 0 (dark) to 100 (light). Compute\r\n        // the new lightness as midway between current lightness and max light.\r\n        var newLightness = (100 + colorLightness) / 2;\r\n        var fillColor = color.color().lightness(newLightness).hex();\r\n        var crystal = createCrystal(appearance.type, color, fillColor);\r\n        var graphic = new Group([crystal]);\r\n        for (var i = 1; i < count; i++) {\r\n            var _a = OFFSETS[i - 1], offset = _a[0], rotation = _a[1];\r\n            var copy = crystal.clone();\r\n            copy.position = copy.position.add(offset);\r\n            copy.rotation = rotation;\r\n            graphic.addChild(copy);\r\n        }\r\n        graphic.scale(appearance.scale);\r\n        return { graphic: graphic, hitShape: graphic.bounds.expand(15).toShape() };\r\n    };\r\n    Crystals.properties = {\r\n        label: \"Crystals\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            type: \"octahedron\",\r\n            count: 1,\r\n            color: \"#6ca6ba\",\r\n            scale: 1.5,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"type\", label: \"Type / Shape\",\r\n                options: [\r\n                    { value: \"octahedron\", label: \"Octahedral\" },\r\n                    { value: \"cubic\", label: \"Cubic\", tier: \"boost\" },\r\n                    { value: \"rhombic\", label: \"Rhombic\", tier: \"boost\" },\r\n                ],\r\n                allowSelectingTierLockedOptions: true,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"count\", label: \"Number of crystals\",\r\n                min: 1, max: 6,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 1.0, max: 3.0, step: 0.1, unit: \"%\"\r\n            },\r\n            {\r\n                spec: \"color\", key: \"color\", label: \"Colour\",\r\n                swatches: DEFAULT_SWATCHES,\r\n            }\r\n        ],\r\n    };\r\n    return Crystals;\r\n}());\r\nexport { Crystals };\r\nfunction createCrystal(type, strokeColor, fillColor) {\r\n    switch (type) {\r\n        case \"octahedron\":\r\n            return createOctagonalCrystal(strokeColor, fillColor);\r\n        case \"cubic\":\r\n            return createCubicCrystal(strokeColor, fillColor);\r\n        case \"rhombic\":\r\n            return createRhombicCrystal(strokeColor, fillColor);\r\n    }\r\n}\r\nfunction createOctagonalCrystal(strokeColor, fillColor) {\r\n    var outline = new Path(Segments([[0, 0]], [[6, 8]], [[0, 16]], [[-6, 8]]));\r\n    outline.closePath();\r\n    var fill = outline.clone();\r\n    fill.fillColor = fillColor;\r\n    outline.withStroke(crystalOutlineStrokeWidth, strokeColor);\r\n    var centerPoint = [2, 10];\r\n    var crystalInsideHorizontal = new Path(Segments([[-6, 8]], [centerPoint], [[6, 8]]));\r\n    crystalInsideHorizontal.strokeWidth = crystalInlineStrokeWidth;\r\n    crystalInsideHorizontal.strokeColor = strokeColor;\r\n    var crystalInsideVertical = new Path(Segments([[0, 0]], [centerPoint], [[0, 16]]));\r\n    crystalInsideVertical.strokeWidth = crystalInlineStrokeWidth;\r\n    crystalInsideVertical.strokeColor = strokeColor;\r\n    // Lighter shade the top left face.\r\n    var shade1 = new Path(Segments([[0, 0]], [[-6, 8]], [centerPoint]));\r\n    shade1.fillColor = fillColor.color().lighten(0.1).hex();\r\n    // Darker shade the bottom right face.\r\n    var shade2 = new Path(Segments([[6, 8]], [[0, 16]], [centerPoint]));\r\n    shade2.fillColor = fillColor.color().darken(0.1).hex();\r\n    var crystal = new Group([fill, shade1, shade2, crystalInsideHorizontal, crystalInsideVertical, outline]);\r\n    return crystal;\r\n}\r\nfunction createRhombicCrystal(strokeColor, fillColor) {\r\n    // Draw a skewed hexagonal shape, start with topCorner, go clockwise\r\n    var outline = new Path(Segments([[0, 0]], [[6, 8]], [[6, 12]], [[0, 20]], [[-6, 12]], [[-6, 8]]));\r\n    outline.closePath();\r\n    var fill = outline.clone();\r\n    fill.fillColor = fillColor;\r\n    outline.withStroke(crystalOutlineStrokeWidth, strokeColor);\r\n    var inlines = createCompoundPath([\"moveTo\", -6, 12], [\"lineTo\", 0, 4], /* center point */ [\"lineTo\", 6, 12], [\"moveTo\", 0, 4], [\"lineTo\", 0, 0]);\r\n    inlines.strokeWidth = crystalInlineStrokeWidth;\r\n    inlines.strokeColor = strokeColor;\r\n    var shade1 = new Path(Segments([[0, 4]], [[6, 12]], [[6, 8]], [[0, 0]]));\r\n    shade1.fillColor = fillColor.color().darken(0.1).hex();\r\n    var shade2 = new Path(Segments([[0, 4]], [[-6, 12]], [[-6, 8]], [[0, 0]]));\r\n    shade2.fillColor = fillColor.color().lighten(0.1).hex();\r\n    var crystal = new Group([fill, shade1, shade2, inlines, outline]);\r\n    return crystal;\r\n}\r\nfunction createCubicCrystal(strokeColor, fillColor) {\r\n    // Draw a hexagonal shape for outline, start with top corner, go clockwise.\r\n    var outline = new Path(Segments([[0, 0]], [[10, 6]], [[10, 16]], [[0, 22]], [[-10, 16]], [[-10, 6]]));\r\n    outline.closePath();\r\n    var fill = outline.clone();\r\n    fill.fillColor = fillColor;\r\n    outline.withStroke(crystalOutlineStrokeWidth, strokeColor);\r\n    var inlines = createCompoundPath([\"moveTo\", -10, 6], [\"lineTo\", 0, 12], /* center */ [\"lineTo\", 0, 22], [\"moveTo\", 0, 12], [\"lineTo\", 10, 6]);\r\n    inlines.strokeWidth = crystalInlineStrokeWidth;\r\n    inlines.strokeColor = strokeColor;\r\n    var shade1 = new Path(Segments([[-10, 6]], [[0, 0]], [[10, 6]], [[0, 12]]));\r\n    shade1.fillColor = fillColor.color().lighten(0.1).hex();\r\n    var shade2 = new Path(Segments([[10, 6]], [[10, 16]], [[0, 22]], [[0, 12]]));\r\n    shade2.fillColor = fillColor.color().darken(0.1).hex();\r\n    var crystal = new Group([fill, shade1, shade2, inlines, outline]);\r\n    crystal.scale(0.8);\r\n    return crystal;\r\n}\r\n// Position offsets and rotations for subsequent crystals\r\nvar OFFSETS = [\r\n    [P(10, 7), 62],\r\n    [P(-6, 10), -28],\r\n    [P(9, -6), 208],\r\n    [P(11, 13), -43],\r\n    [P(17, -2), 82],\r\n];\r\n","import { setDefaultStyle } from \"apparatus/draw\";\r\nimport { Group, Path, Rectangle, Shape } from \"paper\";\r\nimport { Random } from \"random/random\";\r\nimport { P, R, Segments } from \"../common\";\r\nvar DISPERSE = 7;\r\nvar SandBath = /** @class */ (function () {\r\n    function SandBath() {\r\n    }\r\n    SandBath.prototype.render = function (appearance) {\r\n        var width = appearance.width;\r\n        var height = appearance.height;\r\n        var container = new Path(Segments([[0, 0]], [[0, height]], [[width, height]], [[width, 0]]));\r\n        setDefaultStyle(container);\r\n        var sand = Shape.Rectangle(R(0, height * (1 - appearance.sandRatio), width, height * appearance.sandRatio));\r\n        sand.strokeColor = \"#e0cc4a\";\r\n        sand.strokeWidth = 3.0;\r\n        sand.fillColor = \"#ebdc7c\";\r\n        // Create sand grains.\r\n        var grains = new Group();\r\n        var r = new Random();\r\n        for (var y = height * (1 - appearance.sandRatio) + DISPERSE; y <= height - DISPERSE; y += DISPERSE * 2) {\r\n            for (var x = DISPERSE; x <= width - DISPERSE; x += DISPERSE * 2) {\r\n                var grain = Shape.Circle(P(x, y).add(r.randomUnitVector(DISPERSE * 0.7)), 2.0);\r\n                grains.addChild(grain);\r\n            }\r\n        }\r\n        grains.fillColor = \"#e0cc4a\";\r\n        var graphic = new Group([sand, grains, container]);\r\n        var rect = new Rectangle(0, 0, width, height);\r\n        var hitShape = Shape.Rectangle(rect);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShape,\r\n            snapping: graphic.placeable(),\r\n        };\r\n    };\r\n    SandBath.properties = {\r\n        label: \"Sand bath\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            width: 200,\r\n            height: 80,\r\n            sandRatio: 0.6\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"width\", label: \"Width\",\r\n                min: 120, max: 300\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Height\",\r\n                min: 40, max: 150\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"sandRatio\", label: \"Amount of sand\",\r\n                min: 0.0, max: 1.0, step: 0.01\r\n            },\r\n        ],\r\n    };\r\n    return SandBath;\r\n}());\r\nexport { SandBath };\r\n","import { Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Path } from \"paper\";\r\nvar MetalStrip = /** @class */ (function () {\r\n    function MetalStrip() {\r\n    }\r\n    MetalStrip.prototype.render = function (appearance) {\r\n        var graphic = createShape(appearance);\r\n        graphic.closePath();\r\n        var baseColor = appearance.color;\r\n        // Set the stroke by darkening the base color.\r\n        graphic.withStroke(\"thinner\", baseColor.color().darken(0.2).hex());\r\n        // Create a gradient composed of:\r\n        // baseColor -------- highlightColor ------ baseColor\r\n        // where the highlightColor is baseColor lightened up.\r\n        // Make the highlight section tighter by moving the\r\n        // baseColor stops to position closer to 0.5.\r\n        var fillGradient = [\r\n            [baseColor, 0.3],\r\n            [baseColor.color().lighten(0.2).hex(), 0.5],\r\n            [baseColor, 0.7]\r\n        ];\r\n        graphic.setGradientFill(\"right-down\", fillGradient);\r\n        var hitShape = graphic.strokeBounds.expand(10).toShape();\r\n        return { graphic: graphic, hitShape: hitShape };\r\n    };\r\n    MetalStrip.properties = {\r\n        label: \"Metal Strip\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            length: 60,\r\n            width: 20,\r\n            shape: \"bent\",\r\n            color: SharedColors.copper,\r\n        },\r\n        flippable: true,\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"length\", label: \"Length\",\r\n                min: 40, max: 100\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"width\", label: \"Width\",\r\n                min: 5, max: 50\r\n            },\r\n            {\r\n                spec: \"color\", key: \"color\", label: \"Color/Material\",\r\n                swatches: {\r\n                    \"Zinc\": \"#BAC4C8\",\r\n                    \"Silver\": SharedColors.lightMetal,\r\n                    \"Aluminium\": SharedColors.aluminum,\r\n                    \"Gold\": SharedColors.gold,\r\n                    \"Copper\": SharedColors.copper,\r\n                    \"Iron\": SharedColors.darkMetal,\r\n                }\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"shape\", label: \"Shape\",\r\n                options: [\r\n                    { value: \"straight\", label: \"Straight\" },\r\n                    { value: \"bent\", label: \"Bent\" }\r\n                ]\r\n            }\r\n        ],\r\n    };\r\n    return MetalStrip;\r\n}());\r\nexport { MetalStrip };\r\nfunction createShape(appearance) {\r\n    var length = appearance.length;\r\n    var width = appearance.width;\r\n    switch (appearance.shape) {\r\n        case \"straight\":\r\n            return new Path(Segments([[0, 0]], [[0, length]], [[width, length]], [[width, 0]]));\r\n        case \"bent\":\r\n            var bendheight = length * 0.6;\r\n            var twistOffset = width * 1.25;\r\n            var curveHandleLength = bendheight * 0.4;\r\n            return new Path(Segments([[0, 0]], [[width, 0]], [[width, bendheight], undefined, [0, curveHandleLength]], [[twistOffset, length]], [[twistOffset - width, length]], [[0, bendheight], [0, curveHandleLength]]));\r\n    }\r\n}\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { mirrorX, setDefaultStyle } from \"apparatus/draw\";\r\nimport { R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nvar GasJar = /** @class */ (function () {\r\n    function GasJar() {\r\n    }\r\n    GasJar.prototype.render = function (appearance) {\r\n        var height = appearance.height;\r\n        var width = 30 + appearance.height / 10; // 50x200, 60x300\r\n        var bottomLid = new Path(Segments([[0, 0]], [[-6, 10]]));\r\n        mirrorX(bottomLid, width / 2);\r\n        bottomLid.closePath();\r\n        var wall1 = new Path(Segments([[0, 0]], [[0, -height]]));\r\n        var wall2 = new Path(Segments([[width, 0]], [[width, -height]]));\r\n        var liquiMask = new Path.Rectangle(R(0, 0, width, -height));\r\n        var graphic = new Group([bottomLid, wall1, wall2]);\r\n        var pivot = graphic.bounds.center;\r\n        var hitShapes = [graphic.bounds.clone().toShape()];\r\n        // Top lid.\r\n        if (appearance.lid != \"none\") {\r\n            var topLid = new Path(Segments([[0, 0]], [[-6, -10]]));\r\n            mirrorX(topLid, width / 2);\r\n            topLid.closePath();\r\n            switch (appearance.lid) {\r\n                case \"lifted\":\r\n                    topLid.position.y -= height + 40;\r\n                    break;\r\n                case \"edge\":\r\n                    topLid.position.y -= height;\r\n                    topLid.position.x += width / 1.7;\r\n                    break;\r\n                case \"closed\":\r\n                    topLid.position.y -= height;\r\n                    break;\r\n                case \"tilted\":\r\n                    topLid.position.y -= height + 10;\r\n                    topLid.position.x += width * 2;\r\n                    topLid.rotate(30);\r\n                    break;\r\n                case \"side\":\r\n                    topLid.position.y -= height - 10;\r\n                    topLid.position.x += width + 20;\r\n                    topLid.rotate(180);\r\n            }\r\n            graphic.addChild(topLid);\r\n            hitShapes.push(topLid.bounds.toShape());\r\n        }\r\n        var snapping = [bottomLid.placeable()];\r\n        if (appearance.lid == \"none\" || appearance.lid == \"closed\" || appearance.lid == \"side\") {\r\n            snapping.push(__assign(__assign({}, graphic.placeable()), { facing: 180 }));\r\n        }\r\n        setDefaultStyle(graphic);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShapes,\r\n            liquidMask: liquiMask,\r\n            pivot: pivot,\r\n            snapping: snapping\r\n        };\r\n    };\r\n    GasJar.properties = {\r\n        label: \"Gas Jar\",\r\n        canContainLiquids: true,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            lid: \"closed\",\r\n            height: 200,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Height\",\r\n                min: 200, max: 300,\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"lid\", label: \"Lid\",\r\n                options: [\r\n                    { value: \"none\", label: \"No lid\" },\r\n                    { value: \"closed\", label: \"Closed\" },\r\n                    { value: \"edge\", label: \"On the edge\" },\r\n                    { value: \"lifted\", label: \"Lifted above\" },\r\n                    { value: \"tilted\", label: \"Lift tilted\" },\r\n                    { value: \"side\", label: \"To one side\" },\r\n                ]\r\n            }\r\n        ],\r\n    };\r\n    return GasJar;\r\n}());\r\nexport { GasJar };\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { g } from \"analytics\";\r\nimport { Remodal } from \"components/remodal\";\r\nimport { openDiagram } from \"file/api\";\r\nimport { ChemixDocuments } from \"file/loading\";\r\nimport * as React from 'react';\r\nimport { TierContext } from \"tiers/context\";\r\nimport { callApi } from \"../../api/api\";\r\n/** \"About Chemix\" modal dialog. */\r\nvar NewTemplateModal = /** @class */ (function (_super) {\r\n    __extends(NewTemplateModal, _super);\r\n    function NewTemplateModal(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.state = {\r\n            state: \"not loaded\",\r\n            isOpened: false,\r\n            diagrams: []\r\n        };\r\n        return _this;\r\n    }\r\n    NewTemplateModal.prototype.onOpen = function () {\r\n        if (this.state.state === \"not loaded\") {\r\n            this.setState({ state: \"loading\" });\r\n            this.fetch();\r\n        }\r\n    };\r\n    NewTemplateModal.prototype.confirmPrompt = function () {\r\n        if (confirm(\"This will erase your current diagram. Are you sure?\") == true) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    NewTemplateModal.prototype.onCreateBlankFile = function () {\r\n        if (!this.confirmPrompt())\r\n            return;\r\n        var blankDocument = ChemixDocuments.getBlankDocument();\r\n        var blankDiagram = {\r\n            id: \"\",\r\n            title: \"\",\r\n            thumbnail: \"\",\r\n            modified: new Date(),\r\n            created: new Date(),\r\n            rawData: JSON.stringify(blankDocument),\r\n        };\r\n        openDiagram(blankDiagram, /*isTemplate*/ true);\r\n        this.close();\r\n    };\r\n    NewTemplateModal.prototype.onCreateFromCloudTemplate = function (rawDiagram) {\r\n        if (!this.confirmPrompt())\r\n            return;\r\n        g(\"NewFromTemplate\", rawDiagram.title);\r\n        openDiagram(rawDiagram, /*isTemplate*/ true);\r\n        this.close();\r\n    };\r\n    NewTemplateModal.prototype.render = function () {\r\n        var _this = this;\r\n        return React.createElement(Remodal.Container, { parent: this, class: \"template-modal\", title: \"Create New\", icon: this.state.state == \"loading\" ? \"loading\" : \"fa-sparkles\" },\r\n            React.createElement(\"h3\", null, \"Select template\"),\r\n            React.createElement(TierContext.Consumer, null, function (tiers) {\r\n                return React.createElement(\"div\", { className: \"row file-grid\" },\r\n                    React.createElement(Template, { key: \"Blank\", title: \"Blank\", thumbnail: \"./images/blank.png\", tiers: tiers, onOpen: function () { return _this.onCreateBlankFile(); } }),\r\n                    _this.state.state == \"loading\"\r\n                        ? React.createElement(\"h4\", { key: \"loading\", className: \"d-inline-block text-muted ml-3\" }, \"Loading...\")\r\n                        : undefined,\r\n                    _this.state.diagrams.map(function (d) {\r\n                        return React.createElement(Template, { key: d.id, title: d.title, thumbnail: d.thumbnail, id: d.id, tiers: tiers, onOpen: function () { return _this.onCreateFromCloudTemplate(d); } });\r\n                    }));\r\n            }));\r\n    };\r\n    /** Fetches and updates the current state with latest templates. */\r\n    NewTemplateModal.prototype.fetch = function () {\r\n        var _this = this;\r\n        callApi(\"diagram/templates\", \"GET\", null, undefined, {\r\n            success: function (response) {\r\n                _this.setState({\r\n                    state: \"done\",\r\n                    diagrams: response.diagrams.map(function (d) { return ({\r\n                        id: d.id,\r\n                        title: d.title,\r\n                        thumbnail: d.thumbnailBase64,\r\n                        rawData: d.data,\r\n                        created: new Date(d.created),\r\n                        modified: new Date(d.modified),\r\n                    }); })\r\n                });\r\n            },\r\n            generic: function () {\r\n                g(\"NewTemplate:FailToLoad\");\r\n            }\r\n        });\r\n    };\r\n    return NewTemplateModal;\r\n}(Remodal));\r\nexport { NewTemplateModal };\r\nexport var Template = function (props) {\r\n    // HACK: If the name ends in \"_\", it's a template that requires Boost.\r\n    var isBoost = props.title.charAt(props.title.length - 1) == \"_\";\r\n    var tier = { tier: isBoost ? \"boost\" : undefined };\r\n    var isAllowed = props.tiers.allow(tier);\r\n    return React.createElement(\"div\", { className: \"col-12 col-sm-4 col-md-3 mb-2 pr-2\" },\r\n        React.createElement(\"div\", { className: \"thumbnail mb-1\" },\r\n            React.createElement(\"img\", { src: props.thumbnail, className: \"img-thumbnail\", onClick: isAllowed\r\n                    ? props.onOpen\r\n                    : function () { return props.tiers.popup(\"NewTemplate-\" + props.title); } })),\r\n        isBoost ? props.title.substring(0, props.title.length - 1) : props.title,\r\n        props.tiers.badge(tier));\r\n};\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { breakPath, mirrorX, setDefaultStyle } from \"apparatus/draw\";\r\nimport { DEFAULT_LIQUID_DATA, P, Segments } from \"apparatus/library/common\";\r\nimport { Path } from \"paper\";\r\nvar GasWashBottle = /** @class */ (function () {\r\n    function GasWashBottle() {\r\n    }\r\n    GasWashBottle.prototype.render = function (appearance) {\r\n        var tubeHWidth = 10 / 2;\r\n        var flipped = appearance.endsFacing == \"same\";\r\n        var shift = appearance.extension * 80;\r\n        var bottle = new Path(Segments([[tubeHWidth, 0], undefined, [5, 0]], [[15, 12], [0, -7]], [[15, 52], undefined, [0, 3]], [[30, 60], [0, -5]], [[30, 200], undefined, [20, 1]]));\r\n        mirrorX(bottle);\r\n        bottle.insertSegments(2, Segments([[15, 20]], // A\r\n        [[20, 20], undefined, [10, 0]], // B\r\n        [[30, 10]], // C\r\n        [[30, -10], undefined, [0, -14]], // D\r\n        [[50, -30], [-13, 0]], // E\r\n        [[60, -30]], // F (mouth)\r\n        [[60, -20]], // F\r\n        [[50, -20], undefined, [-10, 0]], // E\r\n        [[40, -10]], // D\r\n        [[40, 10], undefined, [0, 13]], // C\r\n        [[20, 30], [13, 0]], // B\r\n        [[15, 30]]));\r\n        var liquidMask = bottle.clone();\r\n        var graphic = breakPath(bottle, 8);\r\n        var tube = new Path(Segments([[-5, 180]], // C\r\n        [[-5, -10], undefined, [0, -14]], // D\r\n        [[15, -30], [-13, 0]], // E\r\n        [[25, -30]], // F (mouth)\r\n        [[25, -20]], // F\r\n        [[15, -20], undefined, [-10, 0]], // E\r\n        [[5, -10]], // D\r\n        [[5, 180], undefined, [0, 13]]));\r\n        tube.scale(flipped ? 1 : -1, 1, P(0, 0));\r\n        tube.position.y -= shift;\r\n        graphic.addChildren(breakPath(tube, 4).children);\r\n        tube.remove();\r\n        setDefaultStyle(graphic);\r\n        return {\r\n            graphic: graphic,\r\n            liquidMask: liquidMask,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: [\r\n                { type: \"connectable\", at: P(60, -25), facing: 90 },\r\n                { type: \"connectable\", at: P(-25 * (flipped ? -1 : 1), -25 - shift), facing: flipped ? 90 : -90 }\r\n            ]\r\n        };\r\n    };\r\n    GasWashBottle.properties = {\r\n        label: \"Gas Wash Bottle\",\r\n        canContainLiquids: true,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            endsFacing: \"opposite\",\r\n            extension: 0.1\r\n        },\r\n        defaultLiquidData: __assign(__assign({}, DEFAULT_LIQUID_DATA), { amountRatio: 0.35 }),\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"endsFacing\", label: \"Ends facing\",\r\n                options: [\r\n                    { value: \"opposite\", label: \"Opposite direction\" },\r\n                    { value: \"same\", label: \"Same direction\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"extension\", label: \"Extension\",\r\n                min: 0, max: 1, step: 0.01\r\n            }\r\n        ],\r\n    };\r\n    return GasWashBottle;\r\n}());\r\nexport { GasWashBottle };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { Path, Rectangle, Shape } from \"paper\";\r\nimport { addEdgeLips, breakPath, mirrorX, setDefaultStyle } from \"../../draw\";\r\nimport { P, Segments } from \"../common\";\r\nvar BoilingTube = /** @class */ (function () {\r\n    function BoilingTube() {\r\n    }\r\n    BoilingTube.prototype.render = function (appearance) {\r\n        var width = appearance.width;\r\n        var height = appearance.height;\r\n        var graphic = new Path();\r\n        graphic.addSegments(Segments([[0, 0]], [[0, height - width / 2], undefined, [0, width / 1.55]]));\r\n        mirrorX(graphic, width / 2);\r\n        addEdgeLips(graphic, 2.0);\r\n        var liquidMask = graphic.clone();\r\n        setDefaultStyle(graphic);\r\n        var hitShape = Shape.Rectangle(new Rectangle(0, 0, width, height));\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShape,\r\n            liquidMask: liquidMask,\r\n            snapping: [\r\n                { type: \"neck\", top: P(width / 2, 0), diameter: width, facing: 0 }\r\n            ]\r\n        };\r\n    };\r\n    BoilingTube.properties = {\r\n        label: \"Boiling tube\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            width: 40,\r\n            height: 180,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\",\r\n                key: \"width\",\r\n                label: \"Width\",\r\n                min: 20,\r\n                max: 60,\r\n            },\r\n            {\r\n                spec: \"slider\",\r\n                key: \"height\",\r\n                label: \"Height\",\r\n                min: 75,\r\n                max: 300,\r\n            },\r\n        ]\r\n    };\r\n    return BoilingTube;\r\n}());\r\nexport { BoilingTube };\r\nvar BoilingTubeWithSideArm = /** @class */ (function () {\r\n    function BoilingTubeWithSideArm() {\r\n    }\r\n    BoilingTubeWithSideArm.prototype.render = function (appearance) {\r\n        var width = appearance.width;\r\n        var height = appearance.height;\r\n        var offset = 30;\r\n        var holeRadius = appearance.holeDiameter / 2;\r\n        var sideArmLength = 15;\r\n        var tube = new Path();\r\n        tube.addSegments(Segments([[0, 0]], [[0, height - width / 2], undefined, [0, width / 1.55]]));\r\n        mirrorX(tube, width / 2);\r\n        tube.insertSegments(3, Segments([[width, offset + holeRadius]], [[width + sideArmLength, offset + holeRadius]], [[width + sideArmLength, offset - holeRadius]], [[width, offset - holeRadius]]));\r\n        addEdgeLips(tube, 2.0);\r\n        var liquidMask = tube.clone();\r\n        var graphics = breakPath(tube, 6);\r\n        setDefaultStyle(graphics);\r\n        var hitShape = Shape.Rectangle(new Rectangle(0, 0, width + sideArmLength, height));\r\n        return {\r\n            graphic: graphics,\r\n            hitShape: hitShape,\r\n            liquidMask: liquidMask,\r\n            snapping: [\r\n                { type: \"connectable\", at: P(width + sideArmLength, offset), facing: 90, },\r\n                { type: \"neck\", top: P(width / 2, 0), diameter: width, facing: 0 }\r\n            ]\r\n        };\r\n    };\r\n    BoilingTubeWithSideArm.properties = {\r\n        label: \"Boiling Tube with side arm\",\r\n        canContainLiquids: true,\r\n        flippable: true,\r\n        defaultAppearance: __assign(__assign({}, BoilingTube.properties.defaultAppearance), { holeDiameter: 10 }),\r\n        appearanceSpecs: __spreadArrays(BoilingTube.properties.appearanceSpecs, [\r\n            {\r\n                spec: \"slider\", key: \"holeDiameter\", label: \"Hole diameter\",\r\n                min: 8, max: 20,\r\n            }\r\n        ]),\r\n    };\r\n    return BoilingTubeWithSideArm;\r\n}());\r\nexport { BoilingTubeWithSideArm };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, Pivot, R } from \"apparatus/library/common\";\r\nimport { BasicShapes } from \"apparatus/library/shapes/common\";\r\nimport \"ext/color\";\r\nimport { Group, Path } from \"paper\";\r\nvar Cylinder = /** @class */ (function () {\r\n    function Cylinder() {\r\n        this.drivers = [\r\n            {\r\n                type: \"rectangle\",\r\n                minX: 6, maxX: 250,\r\n                minY: 8, maxY: 300,\r\n                toAppearance: function (p) { return ({\r\n                    diameter: p.x * 2,\r\n                    height: p.y * 2\r\n                }); },\r\n                fromAppearance: function (a) { return P(a.diameter / 2, a.height / 2); },\r\n                scale: 1.0,\r\n            }\r\n        ];\r\n    }\r\n    Cylinder.isBoostRequiredForAppearance = function (appearance) {\r\n        return appearance.shading === \"3d\";\r\n    };\r\n    Cylinder.prototype.render = function (appearance) {\r\n        var diameter = appearance.diameter, height = appearance.height, stroke = appearance.stroke, style = appearance.style, strokeThickness = appearance.strokeThickness, shading = appearance.shading;\r\n        var top = new Path.Ellipse(R(0, 0, diameter, diameter / 2, Pivot.CENTER));\r\n        var bottom = top.clone();\r\n        top.position.y -= height / 2;\r\n        bottom.position.y += height / 2;\r\n        var body = new Path.Rectangle(R(0, 0, diameter, height, Pivot.CENTER));\r\n        var body3d = body.unite(bottom).subtract(top);\r\n        var graphic = new Group([body3d, top]);\r\n        if (style == \"full\" || style == \"stroke-only\") {\r\n            var outline = body.unite(bottom).unite(top);\r\n            outline.withStroke(strokeThickness, stroke);\r\n            graphic.addChild(outline);\r\n        }\r\n        var fillColor = BasicShapes.fillColor(appearance).color();\r\n        if (shading == \"3d\") {\r\n            top.withGradientFill(\"left\", Gradients.simple(fillColor.ladd(10)));\r\n            body3d.withGradientFill(\"left\", Gradients.cylinder(fillColor, 3));\r\n        }\r\n        else {\r\n            top.fillColor = fillColor.ladd(10).string();\r\n            body3d.withFill(fillColor.string());\r\n        }\r\n        bottom.remove();\r\n        body.remove();\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: BasicShapes.bounds(graphic)\r\n        };\r\n    };\r\n    Cylinder.properties = {\r\n        label: \"Cylinder\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: __assign(__assign({}, BasicShapes.defaultAppearance), { diameter: 120, height: 150, shading: \"flat\" }),\r\n        appearanceSpecs: __spreadArrays(BasicShapes.specs, [\r\n            BasicShapes.header,\r\n            {\r\n                spec: \"radio\", key: \"shading\", label: \"Shading\",\r\n                options: [\r\n                    { value: \"flat\", label: \"Flat\" },\r\n                    { value: \"3d\", label: \"3D\", tier: \"boost\" },\r\n                ],\r\n                allowSelectingTierLockedOptions: true,\r\n            }\r\n        ]),\r\n    };\r\n    return Cylinder;\r\n}());\r\nexport { Cylinder };\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { g } from \"analytics\";\r\nimport { releasedItemsCount } from \"apparatus/specList\";\r\nimport { Cookie } from \"browser/cookie\";\r\nimport { Remodal } from \"components/remodal\";\r\nimport \"ext/js\";\r\nimport * as React from 'react';\r\nimport { runTutorial } from \"tutorial\";\r\nvar MAX_SHOW_WELCOME_SCREEN = 3;\r\n/** Welcome modal dialog. */\r\nvar WelcomeModal = /** @class */ (function (_super) {\r\n    __extends(WelcomeModal, _super);\r\n    function WelcomeModal() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.render = function () { return (React.createElement(Remodal.Container, { parent: _this, class: \"welcome-modal\", title: null, center: true },\r\n            React.createElement(SplashImage, null),\r\n            React.createElement(\"div\", { className: \"ml-4 mb-1 text-left\", style: { marginTop: '-80px' } },\r\n                React.createElement(\"img\", { src: \"./images/64.png\", className: \"mb-1\", srcSet: \"./images/64.png 1x, ./images/128.png 2x\" })),\r\n            React.createElement(\"h1\", null,\r\n                \"Draw science experiments and lab\\u00A0instructions\\u00A0easily with \",\r\n                React.createElement(\"span\", { className: \"boost-text-gradient\" },\r\n                    React.createElement(\"b\", null, \"Chemix\"))),\r\n            React.createElement(\"div\", { className: \"mx-3 chemix-green\" },\r\n                React.createElement(\"div\", { className: \"d-inline-block mr-3\" },\r\n                    React.createElement(\"i\", { className: \"fas fa-vial mr-1\" }),\r\n                    releasedItemsCount,\r\n                    \" available items\"),\r\n                React.createElement(\"div\", { className: \"d-inline-block mr-3\" },\r\n                    React.createElement(\"i\", { className: \"fas fa-image mr-1\" }),\r\n                    \"Unlimited image downloads\"),\r\n                React.createElement(\"div\", { className: \"d-inline-block mr-3\" },\r\n                    React.createElement(\"i\", { className: \"fas fa-cloud-upload mr-1\" }),\r\n                    \"Save & edit anywhere\")),\r\n            React.createElement(\"div\", { className: \"button-group my-4\" },\r\n                React.createElement(\"div\", { className: \"ui-button highlight mb-2 hide-if-too-narrow\", onClick: function () { writeCookieToNotShowAgain(); g(\"Welcome:Tutorial\"); runTutorial(); }, \"data-remodal-action\": \"confirm\" },\r\n                    React.createElement(\"i\", { className: \"fas fa-magic mr-2\" }),\r\n                    React.createElement(\"b\", null, \"Quick Tour\")),\r\n                React.createElement(\"div\", { className: \"ui-button\", onClick: function () { writeCookieToNotShowAgain(); g(\"Welcome:Skip\"); }, \"data-remodal-action\": \"confirm\" }, \"Skip\")),\r\n            React.createElement(\"p\", { className: \"mx-auto faded\", style: { maxWidth: \"66%\" } },\r\n                React.createElement(PromoStat, null)))); };\r\n        return _this;\r\n    }\r\n    return WelcomeModal;\r\n}(Remodal));\r\nexport { WelcomeModal };\r\nexport function maybeShowWelcome(welcome) {\r\n    var _a;\r\n    var welcomeScreenShown = +((_a = Cookie.read(\"WELCOME_SCREEN_SHOWN\")) !== null && _a !== void 0 ? _a : \"0\");\r\n    if (welcomeScreenShown < MAX_SHOW_WELCOME_SCREEN) {\r\n        Cookie.write(\"WELCOME_SCREEN_SHOWN\", \"\" + (welcomeScreenShown + 1));\r\n        welcome.open();\r\n        g(\"Welcome:Open\");\r\n    }\r\n}\r\nfunction writeCookieToNotShowAgain() {\r\n    Cookie.write(\"WELCOME_SCREEN_SHOWN\", \"\" + MAX_SHOW_WELCOME_SCREEN);\r\n}\r\nexport var SplashImage = function () { return React.createElement(\"div\", { className: \"splash-image\" }); };\r\nexport var PromoStat = function () { return React.createElement(React.Fragment, null,\r\n    \"In 2020, we helped\\u00A0\",\r\n    React.createElement(\"span\", { className: \"chemix-green\" },\r\n        (109521).toLocaleFixed(0),\r\n        \" people\"),\r\n    \" create\\u00A0\",\r\n    React.createElement(\"span\", { className: \"chemix-green\" },\r\n        (220530).toLocaleFixed(0),\r\n        \" diagrams\"),\r\n    \".\",\r\n    React.createElement(\"br\", null),\r\n    \"That's 1\\u00A0diagram every\\u00A02.4\\u00A0minutes.\"); };\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { g } from \"analytics\";\r\nimport { unitVector } from \"apparatus/draw\";\r\nimport ArrowTool from \"arrows/tool\";\r\nimport { commandProcessor } from \"command/command\";\r\nimport { Move } from \"editing/move\";\r\nimport MultiTool from \"editing/multitool\";\r\nimport { PathEditTool } from \"editing/pathedit/tool\";\r\nimport { RotationOverlay } from \"editing/rotation/rotation_overlay\";\r\nimport { ZoomSlider } from \"editing/zoom\";\r\nimport { FreehandTool } from \"freehand/tool\";\r\nimport { focusMainApp, Keys, keyToDirection, registerKeyboardShortcutHandler } from \"keyboard\";\r\nimport { EditorCanvasComponent } from \"layout/editor/editor_canvas\";\r\nimport { SelectionOverlay } from \"layout/editor/selection_overlay\";\r\nimport * as React from \"react\";\r\nimport { ID } from \"store/id\";\r\nimport store from \"store/store\";\r\nimport { convertFromPaperToHTMLCoordinates } from \"types\";\r\nimport { PanTool } from \"view/pan\";\r\nimport { add } from \"../../types\";\r\n/** How many pixels to move by when moving items using keyboard. */\r\nvar MOVE_BY_KEY_DISTANCE = 10;\r\n/** How much to multiply the distance by when moving by large increments. */\r\nvar MOVE_BY_KEY_LARGE_MULTIPLIER = 5;\r\n/** How much to multiply the distance by when moving by small increments. */\r\nvar MOVE_BY_KEY_SMALL_MULTIPLIER = 0.2;\r\n/**\r\n * Container for the area that contains the editor, i.e.\r\n * the canvas, zoom slider, property panel but e.g.\r\n * not the sidebar.\r\n */\r\nvar EditorContainer = /** @class */ (function (_super) {\r\n    __extends(EditorContainer, _super);\r\n    function EditorContainer(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        /** Ref to the canvas editor. */\r\n        _this.editorCanvasRef = React.createRef();\r\n        /** Ref to the rotation overlay. */\r\n        _this.rotationOverlayRef = React.createRef();\r\n        /** Ref to the selection overlay. */\r\n        _this.selectionOverlayRef = React.createRef();\r\n        _this.state = {\r\n            isMoving: false,\r\n            isInteracting: false,\r\n        };\r\n        return _this;\r\n    }\r\n    EditorContainer.prototype.componentDidMount = function () {\r\n        var _this = this;\r\n        var editorCanvas = this.editorCanvasRef.current;\r\n        // Update zoom.\r\n        this.setZoom(this.props.zoom);\r\n        // Set up tools and activate.\r\n        this.arrowTool = new ArrowTool(editorCanvas.layers, this),\r\n            this.allTools = {\r\n                select: new MultiTool(editorCanvas.layers, this),\r\n                arrow: this.arrowTool,\r\n                pan: new PanTool(this),\r\n                freehand: new FreehandTool(this),\r\n                pathedit: new PathEditTool(this)\r\n            };\r\n        // Activate tool.\r\n        this.currentTool = this.allTools[this.props.tool];\r\n        this.currentTool.activate();\r\n        // Set up keyboard shortcuts.\r\n        registerKeyboardShortcutHandler(function (e) {\r\n            // Moving by key. Hold shift to make big jumps.\r\n            if (e.which >= Keys.LEFT && e.which <= Keys.DOWN) {\r\n                var direction = keyToDirection(e.which);\r\n                var multiplier = ((e.ctrlKey || e.metaKey) && e.shiftKey)\r\n                    ? MOVE_BY_KEY_SMALL_MULTIPLIER\r\n                    : (e.shiftKey\r\n                        ? MOVE_BY_KEY_LARGE_MULTIPLIER\r\n                        : 1);\r\n                var distance = MOVE_BY_KEY_DISTANCE * multiplier;\r\n                _this.moveByKey(direction, distance);\r\n            }\r\n        });\r\n    };\r\n    // TODO: Clean this up, this is needed to compute the selection\r\n    // box correctly but does not grant access to arrows.\r\n    EditorContainer.prototype.getApparatusComponent = function (id) {\r\n        return this.editorCanvasRef.current.getApparatusComponent(id);\r\n    };\r\n    EditorContainer.prototype.getObjectComponent = function (id) {\r\n        return this.editorCanvasRef.current.getObjectComponent(id);\r\n    };\r\n    EditorContainer.prototype.setArrow = function (data) {\r\n        this.editorCanvasRef.current.setState({\r\n            arrow: data\r\n        });\r\n    };\r\n    EditorContainer.prototype.componentDidUpdate = function (prevProps) {\r\n        var _this = this;\r\n        // Activate current tool, if changed.\r\n        if (prevProps.tool != this.props.tool) {\r\n            this.currentTool = this.allTools[this.props.tool];\r\n            this.currentTool.activate();\r\n        }\r\n        // Update the selection and rotation overlays.\r\n        var selectionOverlay = this.selectionOverlayRef.current;\r\n        var selectedItems = this.props.selected.items;\r\n        var selectionMetrics = this.editorCanvasRef.current.computeSelectionMetrics();\r\n        // Notify rotation handler of components corresponding to currently selected items.\r\n        selectionOverlay.rotationHandler.selection = selectionMetrics;\r\n        selectionOverlay.rotationHandler.selectedApparatus = selectedItems.map(function (item) { return _this.getApparatusComponent(item.id); }).filter(function (a) { return a !== null; });\r\n        selectionOverlay.rotationHandler.selectedArrows = this.props.selected.arrows.map(function (a) { return (_this.getObjectComponent(a.id)); });\r\n        // Convert from Paper to HTML coordinates. These are used by the\r\n        // overlay components that are in HTML DOM rather than canvas.\r\n        var convertedMetrics = convertFromPaperToHTMLCoordinates(selectionMetrics);\r\n        // Update state on the selection overlay.\r\n        this.selectionOverlayRef.current.setState({\r\n            isVisible: !this.props.selected.isEmpty,\r\n            center: convertedMetrics.pivot,\r\n            bounds: convertedMetrics.bounds,\r\n        });\r\n        // Update state on the rotation overlay.\r\n        this.rotationOverlayRef.current.setState({\r\n            pivot: convertedMetrics.pivot\r\n        });\r\n    };\r\n    EditorContainer.prototype.render = function () {\r\n        var _this = this;\r\n        return React.createElement(\"div\", { id: \"editor-container\", key: \"editorContainer\" },\r\n            React.createElement(EditorCanvasComponent, __assign({}, this.props, { key: \"editor_canvas\", tool: this.props.tool, ref: this.editorCanvasRef, isMoving: this.state.isMoving })),\r\n            React.createElement(RotationOverlay, { key: \"rotationOverlay\", ref: this.rotationOverlayRef }),\r\n            React.createElement(SelectionOverlay, { key: \"selectionOverlay\", ref: this.selectionOverlayRef, hideDueToInteraction: this.state.isInteracting || this.state.isMoving, onStartRotation: function (t) { return _this.onStartRotation(t); }, onUpdateRotation: function (a) { return _this.onUpdateRotation(a); }, onEndRotation: function () { return _this.onEndRotation(); } }),\r\n            React.createElement(ZoomSlider, { key: \"zoomSlider\", zoom: this.props.zoom, onStartZoom: function () { return _this.onStartZoom(); }, onUpdateZoom: function (z) { return _this.onUpdateZoom(z); }, onEndZoom: function () { return _this.onEndZoom(); } }));\r\n    };\r\n    // Temporarily sets the zoom to this value.\r\n    EditorContainer.prototype.setZoom = function (zoom) {\r\n        var canvasEditor = this.editorCanvasRef.current;\r\n        if (canvasEditor) {\r\n            canvasEditor.setZoom(zoom);\r\n        }\r\n    };\r\n    EditorContainer.prototype.onStartRotation = function (type) {\r\n        this.setIsInteracting(true);\r\n        this.rotationOverlayRef.current.setState({\r\n            type: type,\r\n            angle: 0\r\n        });\r\n    };\r\n    EditorContainer.prototype.onUpdateRotation = function (angle) {\r\n        this.rotationOverlayRef.current.setState({ angle: angle });\r\n    };\r\n    EditorContainer.prototype.onEndRotation = function () {\r\n        this.setIsInteracting(false);\r\n        this.rotationOverlayRef.current.setState({ type: undefined });\r\n        focusMainApp();\r\n    };\r\n    EditorContainer.prototype.onStartZoom = function () {\r\n        this.setIsInteracting(true);\r\n    };\r\n    EditorContainer.prototype.onUpdateZoom = function (zoom) {\r\n        this.editorCanvasRef.current.setZoom(zoom);\r\n    };\r\n    EditorContainer.prototype.onEndZoom = function () {\r\n        this.setIsInteracting(false);\r\n    };\r\n    EditorContainer.prototype.setIsInteracting = function (value) {\r\n        this.setState({ isInteracting: value });\r\n    };\r\n    EditorContainer.prototype.setIsMovingItems = function (isMoving) {\r\n        this.setState({ isMoving: isMoving });\r\n    };\r\n    EditorContainer.prototype.moveByKey = function (direction, distance) {\r\n        var selectedItemIds = store.selectedObjectsID();\r\n        if (selectedItemIds.length == 0)\r\n            return;\r\n        g(\"MoveByKey\");\r\n        var delta = unitVector(direction).multiply(distance);\r\n        commandProcessor.executeReplacingLastCommand(function (lastCommand) {\r\n            if (!(lastCommand instanceof Move))\r\n                return false;\r\n            if (!ID.equals(lastCommand.ids, selectedItemIds))\r\n                return false;\r\n            var combinedDelta = add(delta, lastCommand.delta);\r\n            return new Move(selectedItemIds, combinedDelta);\r\n        }, new Move(selectedItemIds, delta));\r\n    };\r\n    /** Exports current canvas contents to various image formats. */\r\n    EditorContainer.prototype.exportImages = function () {\r\n        return this.editorCanvasRef.current.export();\r\n    };\r\n    EditorContainer.prototype.exportThumbnail = function () {\r\n        return this.editorCanvasRef.current.exportThumbnail();\r\n    };\r\n    EditorContainer.prototype.setArrowTemplate = function (data) {\r\n        this.arrowTool.updateTemplateArrow(data);\r\n    };\r\n    return EditorContainer;\r\n}(React.Component));\r\nexport { EditorContainer };\r\n","import { Gradients } from \"apparatus/gradients\";\r\nimport { P, Pivot, R, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar SlottedWeight = /** @class */ (function () {\r\n    function SlottedWeight() {\r\n    }\r\n    SlottedWeight.prototype.render = function (appearance) {\r\n        var showHook = appearance.hook, hookLength = appearance.hookLength, count = appearance.count, width = appearance.width, height = appearance.height;\r\n        var graphic = new Group([]);\r\n        for (var i = 0; i < count; i++) {\r\n            graphic.addChild(Shape.Rectangle(R(0, i * height, width, height, Pivot.TOP_CENTER), 3.0)\r\n                .withGradientFill(\"right\", Gradients.cylinder(SharedColors.lightMetal.color()))\r\n                .withStroke(\"thin\", SharedColors.mediumMetal));\r\n        }\r\n        if (showHook) {\r\n            var hook = new Path(Segments([[0, 0]], [[0, -hookLength], , [10, -5]], [[0, -hookLength - 20], [10, 0], [-10, 0]], [[-10, -hookLength - 10]])).withStroke(\"default\");\r\n            graphic.addChild(hook);\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            pivot: showHook ? P(0, -hookLength - 20) : undefined,\r\n            snapping: [\r\n                { type: \"placeable\", at: P(0, height * count) },\r\n                { type: \"placeable_surface\", start: P(-width / 2, 0), end: P(width / 2, 0) }\r\n            ]\r\n        };\r\n    };\r\n    SlottedWeight.properties = {\r\n        label: \"Slotted Weight\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            hook: true,\r\n            hookLength: 40,\r\n            count: 1,\r\n            width: 60,\r\n            height: 18,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"count\", label: \"Number\",\r\n                min: 1, max: 10,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"width\", label: \"Weight diameter\",\r\n                min: 20, max: 120, unit: \"mm\"\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Weight thickness\",\r\n                min: 8, max: 25, unit: \"mm\"\r\n            },\r\n            { spec: \"checkbox\", key: \"hook\", label: \"Hanger hook\", subLabel: \"Show\" },\r\n            {\r\n                spec: \"slider\", key: \"hookLength\", label: \"\",\r\n                min: 10, max: 100, unit: \"mm\"\r\n            }\r\n        ],\r\n    };\r\n    return SlottedWeight;\r\n}());\r\nexport { SlottedWeight };\r\n","import { addMarkers, mirrorX, setDefaultStyle } from \"apparatus/draw\";\r\nimport { P, Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar EppendorfTube = /** @class */ (function () {\r\n    function EppendorfTube() {\r\n    }\r\n    EppendorfTube.prototype.render = function (appearance) {\r\n        var shape = new Path(Segments([[8, 0]], [[8, appearance.size - 25]], [[0, appearance.size], appearance.bottom == \"round\" ? [10, 0] : [5, 0]]));\r\n        mirrorX(shape);\r\n        var liquidMask = shape.clone();\r\n        setDefaultStyle(shape);\r\n        var graphic = new Group();\r\n        addMarkers(graphic, P(2, 45), 0, P(0, 10));\r\n        // Create a cap and the linking plastic.\r\n        var capTop = new Path.Line(P(-8, -4), P(8, -4));\r\n        capTop.strokeWidth = 5.0 * appearance.zoom;\r\n        capTop.strokeCap = \"round\";\r\n        capTop.setGradientStroke(\"right\", [[\"#aaaaaa\", 0.0], [\"#999999\", 1.0]]);\r\n        var capInsert = Shape.Rectangle(R(0, -4, 14, 10, Pivot.TOP_CENTER), 2.0);\r\n        capInsert.setGradientFill(\"right\", [[\"#666666\", 0.0], [\"#444444\", 1.0]]);\r\n        capInsert.opacity = 0.45;\r\n        var linking = new Path(Segments([[-8, 0], undefined, [-10, 0]], appearance.cap == \"open\" ? [[-18, -9]] : [[-8, -4], [-10, -3]]));\r\n        linking.withStroke(3.0 * appearance.zoom, \"#cccccc\");\r\n        if (appearance.cap == \"open\") {\r\n            capTop.rotate(-130, P(-14, -4));\r\n            capInsert.rotate(-130, P(-14, -4));\r\n        }\r\n        graphic.addChildren([linking, shape, capInsert, capTop]);\r\n        // Finally, zoom the graphic.\r\n        graphic.scale(appearance.zoom);\r\n        liquidMask.scale(appearance.zoom, graphic.bounds.center);\r\n        return {\r\n            graphic: graphic,\r\n            liquidMask: liquidMask,\r\n            hitShape: graphic.bounds.toShape(),\r\n            pivot: shape.bounds.center,\r\n        };\r\n    };\r\n    EppendorfTube.properties = {\r\n        label: \"Eppendorf Tube\",\r\n        canContainLiquids: true,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            size: 50,\r\n            zoom: 1.0,\r\n            cap: \"open\",\r\n            bottom: \"sharp\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 50, max: 70, step: 1,\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"cap\", label: \"Cap\",\r\n                options: [\r\n                    { value: \"open\", label: \"Open\" },\r\n                    { value: \"closed\", label: \"Closed\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"bottom\", label: \"Bottom shape\",\r\n                options: [\r\n                    { value: \"sharp\", label: \"Sharp\" },\r\n                    { value: \"round\", label: \"Round\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"zoom\", label: \"Zoom\",\r\n                min: 1.0, max: 2.0, step: 0.01, unit: \"%\"\r\n            },\r\n        ],\r\n    };\r\n    return EppendorfTube;\r\n}());\r\nexport { EppendorfTube };\r\n","import { g } from \"analytics\";\r\nimport { DeleteArrows } from \"arrows/command\";\r\nimport { DeleteApparatus } from \"command/basic\";\r\nimport { commandProcessor, Sequence } from \"command/command\";\r\nimport store from \"store/store\";\r\n/** Deletes currently selected items. */\r\nexport function deleteSelected(source) {\r\n    // Retrieve currently selected items\r\n    var items = store.selectedItems();\r\n    var arrows = store.selectedArrows();\r\n    if (items.length + arrows.length == 0)\r\n        return;\r\n    var deleteCommand = new DeleteApparatus(items);\r\n    var deleteArrowCommands = new DeleteArrows(arrows);\r\n    commandProcessor.execute(new Sequence([deleteCommand, deleteArrowCommands]));\r\n    g(\"DeleteSelected\", source);\r\n}\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { g } from \"analytics\";\r\nimport { DeleteArrows } from \"arrows/command\";\r\nimport { Cookie } from \"browser/cookie\";\r\nimport { DeleteApparatus, Deselect } from \"command/basic\";\r\nimport { commandProcessor, Sequence } from \"command/command\";\r\nimport Flags from \"flags\";\r\nimport { Keys } from \"keyboard\";\r\nimport { ExportImage } from \"layout/modals/export_image\";\r\nimport { HelpModal } from \"layout/modals/help\";\r\nimport { NewTemplateModal } from \"layout/modals/new\";\r\nimport * as React from \"react\";\r\nimport { Component } from \"react\";\r\nimport store from \"store/store\";\r\nimport { Articles, Bcn } from \"support/beacon\";\r\nimport { Badge } from \"tiers/badge\";\r\nimport { TierContext } from \"tiers/context\";\r\nimport { fadColors } from \"tiers/promo\";\r\nimport { isIOS } from \"utils\";\r\nimport { Consts } from \"vars\";\r\nimport { formatTooltip } from \"view/tooltips\";\r\nimport { registerKeyboardShortcutHandler } from \"../../keyboard\";\r\nimport { setCloudDiagram } from \"../../store/actions\";\r\nimport { appStore } from \"../../store/store\";\r\nimport { formatShortcuts } from \"../../view/keyboard_shortucts\";\r\n/**\r\n * Main menu for main actions: New, Save Image etc.\r\n */\r\nvar MainMenu = /** @class */ (function (_super) {\r\n    __extends(MainMenu, _super);\r\n    function MainMenu() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.helpModalRef = React.createRef();\r\n        _this.exportImageModalRef = React.createRef();\r\n        _this.newModalRef = React.createRef();\r\n        _this.render = function () { return (React.createElement(TierContext.Consumer, null, function (tiers) { return (React.createElement(React.Fragment, null,\r\n            React.createElement(\"div\", { id: \"menubar\", key: \"menubar\" },\r\n                React.createElement(MenuItem, { key: \"new\", title: \"New\", icon: \"s fa-plus-circle\", hint: \"Create a new blank diagram\" + (Flags.isNewTemplatesEnabled ? \"<br/>or a diagram from a template\" : \"\"), shortcut: { ctrl: true, key: \"N\" }, onClick: function () { return _this.createNew(\"click\"); } }),\r\n                React.createElement(MenuItem, { key: \"download\", title: \"Download Image\", icon: \"s fa-download\", hint: \"Save your diagram<br/> as a picture\", shortcut: { ctrl: true, key: \"E\" }, onClick: function () { return _this.saveImage(\"click\"); }, id: \"menu-export\" }),\r\n                _this.props.auth.state == \"logged_in\" ? React.createElement(CloudMenu, __assign({}, _this.props)) : React.createElement(SignedOutCloudMenu, __assign({}, _this.props)),\r\n                React.createElement(MenuItem, { key: \"help\", title: \"Help\", icon: \"s fa-question-circle\", hint: \"Tutorial and other help topics\", shortcut: { key: \"?\" }, onClick: function () { return _this.openHelp(\"click\"); }, cssClass: \"help\" }),\r\n                React.createElement(WhatsNew, { key: \"whats_new\" }),\r\n                Flags.isPromoEnabled ? React.createElement(MenuItem, { key: \"promo\", cssClass: \"text-danger\", title: \"Holiday Deal!\", icon: \"d fa-hat-santa\", iconStyle: fadColors(\"white\", \"crimson\"), hint: \"Get 15% off for 1 year!\", onClick: function () { tiers.popup(\"XmasPromo MenuItem\"); } })\r\n                    : null),\r\n            React.createElement(HelpModal, { key: \"help_modal\", ref: _this.helpModalRef }),\r\n            React.createElement(ExportImage, { key: \"export_image\", ref: _this.exportImageModalRef }),\r\n            Flags.isNewTemplatesEnabled ? React.createElement(NewTemplateModal, { key: \"template_modal\", ref: _this.newModalRef }) : null)); })); };\r\n        return _this;\r\n    }\r\n    MainMenu.prototype.componentDidMount = function () {\r\n        var _this = this;\r\n        registerKeyboardShortcutHandler(function (e) {\r\n            var isCtrlDown = e.ctrlKey || e.metaKey;\r\n            if (e.keyCode == Keys.QUESTION_MARK) {\r\n                _this.openHelp(\"keyboard\");\r\n            }\r\n            else if (e.keyCode == Keys.S && isCtrlDown) {\r\n                e.preventDefault();\r\n                toastr.info(\"Keyboard shortcut to 'Download Image' has changed to \" + formatShortcuts({ ctrl: true, key: \"E\" }));\r\n            }\r\n            else if (e.keyCode == Keys.E && isCtrlDown) {\r\n                e.preventDefault();\r\n                _this.saveImage(\"keyboard\");\r\n            }\r\n            else if (e.keyCode == Keys.N && isCtrlDown) {\r\n                e.preventDefault();\r\n                _this.createNew(\"keyboard\");\r\n            }\r\n        });\r\n    };\r\n    MainMenu.prototype.openHelp = function (source) {\r\n        g(\"Help\", source);\r\n        this.helpModalRef.current.open();\r\n    };\r\n    MainMenu.prototype.createNew = function (source) {\r\n        if (Flags.isNewTemplatesEnabled) {\r\n            this.newModalRef.current.open();\r\n            return;\r\n        }\r\n        if (confirm(\"This will erase your current diagram. Are you sure?\") == true) {\r\n            var commands = [\r\n                new Deselect(store.selectedObjectsID()),\r\n                new DeleteApparatus(store.items()),\r\n                new DeleteArrows(store.arrows()),\r\n            ];\r\n            commandProcessor.execute(new Sequence(commands));\r\n            commandProcessor.markClean();\r\n            appStore.dispatch(setCloudDiagram(undefined));\r\n            g(\"New\", source);\r\n        }\r\n        else {\r\n            g(\"New-Cancelled\");\r\n        }\r\n    };\r\n    /**\r\n      * Starts a flow to export image, by opening a modal\r\n      * dialog and triggering the export in the background.\r\n      */\r\n    MainMenu.prototype.saveImage = function (source) {\r\n        var _this = this;\r\n        var exportImageModal = this.exportImageModalRef.current;\r\n        if (exportImageModal.state.isExportInProgress)\r\n            return;\r\n        if (store.items().length + store.arrows().length == 0) {\r\n            toastr.error(\"Image is empty. Add some items before saving\");\r\n            return;\r\n        }\r\n        g('ExportToImage', source);\r\n        /** Log some stats about the image. */\r\n        g('ExportedImageStats::strokeThickness', appStore.getState().theme.strokeThickness);\r\n        exportImageModal.setState({ isExportInProgress: true, exportedImages: undefined });\r\n        exportImageModal.open();\r\n        // Execute on background thread.\r\n        setTimeout(function () {\r\n            // This will potentially take a long time.\r\n            var imageExportOutput = _this.props.file.exportImages();\r\n            exportImageModal.setState({\r\n                isExportInProgress: false,\r\n                exportedImages: imageExportOutput,\r\n            });\r\n        }, 100);\r\n    };\r\n    return MainMenu;\r\n}(Component));\r\nexport { MainMenu };\r\nvar MenuItem = function (item) { return (React.createElement(\"a\", { title: createHint(item), id: item.id, className: item.cssClass + \" menuBarItem\", onClick: function () { return (item.onClick != undefined ? item.onClick() : {}); }, href: item.href, target: \"_blank\" },\r\n    React.createElement(\"i\", { className: \"fa\" + item.icon, style: item.iconStyle }),\r\n    React.createElement(\"span\", null,\r\n        item.title,\r\n        \" \"),\r\n    item.badge ? React.createElement(Badge, { tier: item.badge }) : null)); };\r\nvar SignedOutCloudMenu = function (props) { return (React.createElement(Dropdown, { key: \"signedOutCloud\", id: \"cloud-menu\", title: \"Save to Cloud\", icon: \"s fa-cloud-upload\", hint: \"Save your diagrams to the cloud and edit them anywhere.\" },\r\n    React.createElement(DropdownItem, { key: \"signin\", title: \"Sign in to save your diagram.\", icon: \"s fa-user-circle\", hint: \"Save diagrams for later editing to the cloud. Access them anywhere. <br/>This feature requires you to sign in.\", onClick: function () { return props.openLogin(function () { return props.file.saveToCloud(); }); } }))); };\r\nvar CloudMenu = function (props) { return (React.createElement(Dropdown, { key: \"cloud\", id: \"cloud-menu\", title: \"Cloud\", icon: \"s fa-cloud\", hint: \"Save your diagrams and access previously saved diagrams.\" },\r\n    React.createElement(DropdownItem, { key: \"open\", title: \"Open\", icon: \"fa-folder-open\", hint: \"Open diagram from cloud\", onClick: function () { return props.file.fetchDiagramsFromCloud(); } }),\r\n    React.createElement(\"hr\", null),\r\n    React.createElement(DropdownItem, { key: \"save\", title: \"Save\", icon: \"fa-cloud-upload\", hint: \"Save diagram to cloud\", onClick: function () { return props.file.saveToCloud(); } }),\r\n    React.createElement(DropdownItem, { key: \"save_new\", title: \"Save as new\", icon: \"fa-cloud-upload\", hint: \"Save diagram to cloud\", onClick: function () { return props.file.saveToCloud({ forceNew: true }); } }),\r\n    props.cloudDiagramTitle ?\r\n        React.createElement(\"div\", { className: \"bg-secondary small mt-1 py-1 pl-4 pr-2\" },\r\n            React.createElement(\"b\", null, \"Current file:\"),\r\n            React.createElement(\"br\", null),\r\n            props.cloudDiagramTitle)\r\n        : undefined)); };\r\nvar Dropdown = /** @class */ (function (_super) {\r\n    __extends(Dropdown, _super);\r\n    function Dropdown() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.ref = React.createRef();\r\n        _this.hint = function () {\r\n            // Disable hint on iOS\r\n            return isIOS ? undefined : _this.props.hint;\r\n        };\r\n        _this.render = function () {\r\n            var _a;\r\n            return React.createElement(\"div\", { className: \"dropdown\", id: (_a = _this.props.id) !== null && _a !== void 0 ? _a : \"\", ref: _this.ref },\r\n                React.createElement(\"div\", { className: \"menuBarItem\", \"data-toggle\": \"dropdown\", title: _this.hint() },\r\n                    React.createElement(\"i\", { className: \"fa\" + _this.props.icon }),\r\n                    _this.props.title,\r\n                    _this.props.badge ? React.createElement(\"span\", { className: \"ml-1 badge badge-secondary align-text-top\" }, _this.props.badge) : null),\r\n                React.createElement(\"div\", { className: \"dropdown-menu dropdown-mainmenu-dropdown bg-dark text-white border\" }, _this.props.children));\r\n        };\r\n        return _this;\r\n    }\r\n    Dropdown.prototype.componentDidMount = function () {\r\n        // Fix for Bootstrap dropdown positioning.\r\n        $(this.ref.current).on('show.bs.dropdown', function (e) {\r\n            var menu = $(e.target).find('.dropdown-menu');\r\n            menu.appendTo('body');\r\n            $(this).on('hidden.bs.dropdown', function () {\r\n                menu.appendTo(e.target);\r\n            });\r\n        });\r\n    };\r\n    return Dropdown;\r\n}(React.Component));\r\nvar WhatsNew = /** @class */ (function (_super) {\r\n    __extends(WhatsNew, _super);\r\n    function WhatsNew(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        var lastSeenVersion = Cookie.read(\"LAST_SEEN_VERSION\");\r\n        if (lastSeenVersion) {\r\n            lastSeenVersion = lastSeenVersion.match(\"[0-9]*\\.[0-9]*\")[0];\r\n        }\r\n        _this.state = { isHighlighted: lastSeenVersion != Consts.majorVersion };\r\n        return _this;\r\n    }\r\n    /** Called when the \"What's new\" link is clicked */\r\n    WhatsNew.prototype.onClick = function () {\r\n        Bcn.article(Articles.NEW, \"modal\");\r\n        Cookie.write(\"LAST_SEEN_VERSION\", Consts.majorVersion);\r\n        this.setState({ isHighlighted: false });\r\n    };\r\n    WhatsNew.prototype.render = function () {\r\n        var _this = this;\r\n        return React.createElement(MenuItem, { cssClass: this.state.isHighlighted ? \"text-warning\" : \"\", title: \"What's New\", icon: \"s fa-bullhorn\", hint: \"See what's new\", onClick: function () { return _this.onClick(); } });\r\n    };\r\n    return WhatsNew;\r\n}(React.Component));\r\n// TODO: Not all features of MenuBarItem are implemented.\r\nvar DropdownItem = function (props) { return (React.createElement(\"a\", { className: \"dropdown-item bg-dark\", onClick: props.onClick, title: createHint(props) },\r\n    React.createElement(\"i\", { className: \"fas \" + props.icon + \" mr-2\" }),\r\n    props.title)); };\r\nvar createHint = function (item) { return (item.shortcut ? formatTooltip(item.hint, [item.shortcut]) : formatTooltip(item.hint)); };\r\n","import { strokeWidth } from \"apparatus/draw\";\r\nimport { SVG } from \"apparatus/svg\";\r\nvar Mortar = /** @class */ (function () {\r\n    function Mortar() {\r\n    }\r\n    Mortar.prototype.render = function (appearance) {\r\n        var graphic = SVG.mortar();\r\n        graphic.scale(2.0);\r\n        graphic.strokeWidth = strokeWidth(\"default\");\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: graphic.placeable(),\r\n        };\r\n    };\r\n    Mortar.properties = {\r\n        label: \"Mortar\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {},\r\n        appearanceSpecs: [],\r\n    };\r\n    return Mortar;\r\n}());\r\nexport { Mortar };\r\nvar Pestle = /** @class */ (function () {\r\n    function Pestle() {\r\n    }\r\n    Pestle.prototype.render = function (appearance) {\r\n        var graphic = SVG.pestle();\r\n        graphic.scale(2.5);\r\n        graphic.strokeWidth = strokeWidth(\"default\");\r\n        return { graphic: graphic, hitShape: graphic.bounds.toShape() };\r\n    };\r\n    Pestle.properties = {\r\n        label: \"Pestle\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {},\r\n        appearanceSpecs: [],\r\n    };\r\n    return Pestle;\r\n}());\r\nexport { Pestle };\r\n","import { mirrorX, strokeWidth } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar PlantPot = /** @class */ (function () {\r\n    function PlantPot() {\r\n    }\r\n    PlantPot.prototype.render = function (appearance) {\r\n        var radius = appearance.size / 2;\r\n        var height = appearance.size;\r\n        var pot = new Path(Segments([[radius, 5]], [[radius - 10, height]]));\r\n        mirrorX(pot);\r\n        pot.closePath();\r\n        pot.withGradientFill(\"right\", Gradients.cylinder(\"#8b5e46\".color(), 2))\r\n            .withStroke(strokeWidth(\"default\"), \"#674837\");\r\n        var top = Shape.Rectangle(R(0, 0, radius * 2 + 10, 5 + appearance.size / 8, Pivot.TOP_CENTER));\r\n        top.withGradientFill(\"right\", Gradients.cylinder(\"#8b5e46\".color(), 2))\r\n            .withStroke(strokeWidth(\"default\"), \"#674837\");\r\n        var graphic = new Group([pot, top]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: pot.placeable(),\r\n        };\r\n    };\r\n    PlantPot.properties = {\r\n        label: \"Plant pot\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            size: 90\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 60, max: 140\r\n            }\r\n        ],\r\n    };\r\n    return PlantPot;\r\n}());\r\nexport { PlantPot };\r\n","import { Gradients } from \"apparatus/gradients\";\r\nimport { P, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nimport { Random } from \"random/random\";\r\nvar Dirt = /** @class */ (function () {\r\n    function Dirt() {\r\n    }\r\n    Dirt.prototype.render = function (appearance) {\r\n        var shape = new Path(Segments([[-52, -52], [-18, 3], [-5, -15]], [[-12, -55], [-5, -14], [15, -14]], [[29, -47], [0, -10], [10, -17]], [[63, -34], [12, -13], [8, 4]], [[60, -3], [20, 0], [11, 9]], [[56, 29], [16, -5], [9, 4]], [[44, 50], [13, 4], [-6, 11]], [[9, 46], [11, 10], [-18, 15]], [[-36, 47], [9, 8], [-14, 11]], [[-64, 40], [-1, 11], [-20, 0]], [[-62, 11], [-8, 7], [-20, 0]], [[-67, -19], [-13, 9], [-9, -5]]));\r\n        shape.closePath();\r\n        shape.fillColor = \"#8c5c4a\";\r\n        var fill = shape.clone();\r\n        var graphic = new Group([shape, fill]);\r\n        graphic.clipped = true;\r\n        var r = new Random();\r\n        for (var x = shape.bounds.left; x < shape.bounds.right; x += 40) {\r\n            for (var y = shape.bounds.top; y < shape.bounds.bottom; y += 40) {\r\n                var dirt = Shape.Circle(P(x, y).add(r.randomUnitVector(20)), r.randomBetween(10, 30));\r\n                dirt.setRadialGradientFill(Gradients.fade(\"#774f40\".color()));\r\n                graphic.addChild(dirt);\r\n            }\r\n        }\r\n        graphic.scale(appearance.scale);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    Dirt.properties = {\r\n        label: \"Dirt\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            scale: 0.5\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.25, max: 1.0, step: 0.01\r\n            }\r\n        ],\r\n    };\r\n    return Dirt;\r\n}());\r\nexport { Dirt };\r\n","import { UpdateArrowProperties } from \"arrows/command\";\r\nimport { commandProcessor, Sequence } from \"command/command\";\r\nimport { MoveIndividual } from \"editing/move\";\r\nimport { RotateItems } from \"editing/rotation/rotate_command\";\r\nimport * as paper from \"paper\";\r\nvar RotationHandler = /** @class */ (function () {\r\n    function RotationHandler() {\r\n        /** Point object, helps with calculating angles. */\r\n        this.vector = new paper.Point(0, 0);\r\n        /** Offset to apply before snapping. */\r\n        this.snapOffset = 0;\r\n        this.pivot = new paper.Point(0, 0);\r\n    }\r\n    RotationHandler.prototype.onStart = function () {\r\n        if (this.isNothingSelected())\r\n            return;\r\n        // Set up pivot and reset last angle.\r\n        this.pivot.set(this.selection.pivot.x, this.selection.pivot.y);\r\n        if (this.selectedApparatus.length == 1) {\r\n            // If there is one selected apparatus, set up the snap offset.\r\n            this.snapOffset = this.selectedApparatus[0].currentRotation;\r\n            return \"rotation\";\r\n        }\r\n        else if (this.selectedArrows.length == 1) {\r\n            this.snapOffset = 0;\r\n            return \"delta\";\r\n        }\r\n        else {\r\n            this.snapOffset = 0;\r\n            return \"delta\";\r\n        }\r\n    };\r\n    RotationHandler.prototype.onRotate = function (x, y, snaps) {\r\n        var _this = this;\r\n        if (this.isNothingSelected())\r\n            return 0;\r\n        var angle = this.getAngle(x, y);\r\n        if (snaps > 0) {\r\n            angle = this.snap(angle + this.snapOffset, snaps) - this.snapOffset;\r\n        }\r\n        this.selectedApparatus.map(function (apparatus) { return apparatus.setRotationDelta(angle, _this.pivot); });\r\n        this.selectedArrows.map(function (arrow) { return arrow.setRotationDelta(angle, _this.pivot); });\r\n        // If there is only one apparatus, report its overall rotation,\r\n        // otherwise report the delta\r\n        if (this.selectedApparatus.length == 1) {\r\n            return this.anglify(this.selectedApparatus[0].currentRotation + angle);\r\n        }\r\n        else {\r\n            return angle;\r\n        }\r\n    };\r\n    RotationHandler.prototype.onEnd = function () {\r\n        var _this = this;\r\n        if (this.isNothingSelected())\r\n            return;\r\n        // Commit these changes. This relies on original values still\r\n        // being set on the apparatus components as props.\r\n        var values = this.selectedApparatus.map(function (apparatus) { return ({\r\n            id: apparatus.id,\r\n            rotation: _this.anglify(apparatus.visibleRotation),\r\n            originalRotation: apparatus.currentRotation,\r\n        }); });\r\n        var moves = new MoveIndividual(this.selectedApparatus.map(function (a) { return ({ id: a.id, delta: a.visiblePosition.subtract(a.currentPosition) }); }));\r\n        var rotateArrowCommand = new UpdateArrowProperties(this.selectedArrows.map(function (a) { return ({\r\n            id: a.id,\r\n            value: { start: a.state.start, end: a.state.end },\r\n            previousValue: { start: a.props.start, end: a.props.end },\r\n        }); }));\r\n        var sequence = new Sequence([new RotateItems(values), moves, rotateArrowCommand]);\r\n        commandProcessor.execute(sequence);\r\n    };\r\n    RotationHandler.prototype.isNothingSelected = function () {\r\n        return this.selectedApparatus.length + this.selectedArrows.length == 0;\r\n    };\r\n    /** Returns angle from given direction vector, in degrees. */\r\n    RotationHandler.prototype.getAngle = function (x, y) {\r\n        // Compute the delta angle, with up-pointing vector as 0 degrees.\r\n        // We can use paper's Point, angle is measured against x-axis so\r\n        // we just need to swap the coordinates\r\n        this.vector.set(-y, x);\r\n        return this.vector.angle;\r\n    };\r\n    RotationHandler.prototype.anglify = function (angle) {\r\n        return (angle + 180) % 360 - 180;\r\n    };\r\n    RotationHandler.prototype.snap = function (angle, snaps) {\r\n        return Math.round(angle / 360 * snaps) / snaps * 360;\r\n    };\r\n    return RotationHandler;\r\n}());\r\nexport { RotationHandler };\r\n","import { setDefaultStyle } from \"apparatus/draw\";\r\nimport { Segments } from \"apparatus/library/common\";\r\nimport { Color, Gradient, Path } from \"paper\";\r\nvar Seed = /** @class */ (function () {\r\n    function Seed() {\r\n    }\r\n    Seed.prototype.render = function (appearance) {\r\n        var graphic = new Path(Segments([[34, -22], [4, -15], [-5, 19]], [[29, 31], [-2, -15], [2, 21]], [[-33, 28], [12, 36], [-13, -40]], [[-8, -45], [-16, 8], [19, -9]]));\r\n        graphic.closePath();\r\n        setDefaultStyle(graphic);\r\n        graphic.fillColor = new Color(new Gradient([\r\n            [\"#c5d872\", 0.0],\r\n            [\"#83a622\", 1.0],\r\n        ], true), graphic.bounds.leftCenter, graphic.bounds.rightCenter);\r\n        graphic.strokeColor = \"#609a3a\";\r\n        graphic.scale(0.2 * appearance.scale);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.expand(10.0).toShape()\r\n        };\r\n    };\r\n    Seed.properties = {\r\n        label: \"Seed\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            scale: 1.0\r\n        },\r\n        flippable: true,\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 1.0, max: 5.0, step: 0.1, unit: \"%\",\r\n            }\r\n        ],\r\n    };\r\n    return Seed;\r\n}());\r\nexport { Seed };\r\n","export var ID;\r\n(function (ID) {\r\n    function equals(a, b) {\r\n        if (Array.isArray(a) && Array.isArray(b)) {\r\n            if (a.length !== b.length)\r\n                return false;\r\n            for (var i = 0; i < a.length; i++) {\r\n                if (a[i].id !== b[i].id)\r\n                    return false;\r\n                if (a[i].type !== b[i].type)\r\n                    return false;\r\n            }\r\n            return true;\r\n        }\r\n        else if (!Array.isArray(a) && !Array.isArray(b) && a && b) {\r\n            return a.id === b.id && a.type === b.type;\r\n        }\r\n        // Mixed types => not equal.\r\n        return false;\r\n    }\r\n    ID.equals = equals;\r\n    /** To be used as callback to .filter() */\r\n    function matching(id) {\r\n        var ids = Array.isArray(id) ? id : [id];\r\n        return function (hasId) {\r\n            return ids.indexOf(hasId.id) !== -1;\r\n        };\r\n    }\r\n    ID.matching = matching;\r\n    function notMatching(id) {\r\n        var ids = Array.isArray(id) ? id : [id];\r\n        return function (hasId) {\r\n            return ids.indexOf(hasId.id) === -1;\r\n        };\r\n    }\r\n    ID.notMatching = notMatching;\r\n    function string(id) {\r\n        return id.type + \"_\" + id.id;\r\n    }\r\n    ID.string = string;\r\n    /** ID to use for currently drawn arrows. */\r\n    function mint(type) {\r\n        return { type: type, id: idCounters[type]++ };\r\n    }\r\n    ID.mint = mint;\r\n    ID.TEMP_ARROW = { type: \"arrow\", id: -1 };\r\n    /**\r\n     * Resets the current ID counters so they can be used\r\n     * when editing given document.\r\n     */\r\n    function resetFor(doc) {\r\n        var maxArrowId = doc.arrows.reduce(function (id, a) { return Math.max(id, a.id.id); }, 0);\r\n        var maxApparatusId = doc.items.reduce(function (id, a) { return Math.max(id, a.id.id); }, 0);\r\n        var maxGroupId = doc.groups.reduce(function (id, a) { return Math.max(id, a.id.id); }, 0);\r\n        idCounters[\"arrow\"] = maxArrowId + 1;\r\n        idCounters[\"apparatus\"] = maxApparatusId + 1;\r\n        idCounters[\"group\"] = maxGroupId + 1;\r\n    }\r\n    ID.resetFor = resetFor;\r\n    function __resetForTesting() {\r\n        idCounters.arrow = 0;\r\n        idCounters.apparatus = 0;\r\n        idCounters.group = 0;\r\n    }\r\n    ID.__resetForTesting = __resetForTesting;\r\n})(ID || (ID = {}));\r\n/** Tracks unique IDs across different types. */\r\nvar idCounters = {\r\n    \"arrow\": 0,\r\n    \"apparatus\": 0,\r\n    \"group\": 0,\r\n};\r\n","import { strokeWidth } from \"apparatus/draw\";\r\nimport { Interpolator, P, Pivot, R, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { SVG } from \"apparatus/svg\";\r\nimport { Group, Path, PointText, Shape } from \"paper\";\r\nvar wavelengthInterpolator = new Interpolator([400, 640], [280, 0]);\r\nvar SpetrophotometerSchematic = /** @class */ (function () {\r\n    function SpetrophotometerSchematic() {\r\n    }\r\n    SpetrophotometerSchematic.prototype.render = function (appearance) {\r\n        var bulb = SVG.bulb();\r\n        bulb.scale(4.0);\r\n        bulb.position = P(0, 16);\r\n        bulb.strokeWidth = strokeWidth(\"thin\");\r\n        var collimator = new Path.Circle(P(70, 0), 50);\r\n        collimator.setRadialGradientFill([[\"#ffffff\", 0.5], [\"#777777\", 1.0]]);\r\n        collimator.opacity = 0.5;\r\n        collimator.applyMatrix = false;\r\n        collimator.scale(0.25, 1.0);\r\n        var light = new Path(Segments([[15, -20]], [[70, -20]], [[170, 0]], [[70, 20]], [[15, 20]])).withGradientFill(\"right\", [[\"#fff18900\", 0.0], [\"#fff18980\", 0.2]]);\r\n        var prism = new Path(Segments([[-50, 43]], [[0, -43]], [[50, 43]], [[48, 50]], [[-48, 50]])).close()\r\n            .withStroke(\"default\", \"#aaaaaa\")\r\n            .withGradientFill(\"right-down\", [[\"#f0f0f0\", 0.5], [\"#e6e6e6\", 0.6], [\"#f0f0f0\", 0.7]]);\r\n        prism.position.x += 170;\r\n        var prismLine = new Path.Line(P(50, 43), P(-50, 43)).withStroke(\"thinner\", \"#bbbbbb\");\r\n        prismLine.position.x += 170;\r\n        var rayHue = wavelengthInterpolator.interpolate(appearance.rayNm);\r\n        var base = \"hsl(280, 90%, 60%)\".color();\r\n        var shift = rayHue / 280 * 50;\r\n        var rainbow = new Path(Segments([[10, 0]], [[90, -shift - 2.5]], [[90, -shift + 50 + 2.5]])).withGradientFill(\"down\", [\r\n            [base.hue(0).hex(), 0.0],\r\n            [base.hue(70).hex(), 0.25],\r\n            [base.hue(140).hex(), 0.5],\r\n            [base.hue(210).hex(), 0.75],\r\n            [base.hue(280).hex(), 1.0],\r\n        ]);\r\n        rainbow.position.x += 170;\r\n        var _a = [\r\n            new Path.Line(P(260, -60), P(260, -2.5)).withStroke(6.0),\r\n            new Path.Line(P(260, 60), P(260, 2.5)).withStroke(6.0)\r\n        ], slitUp = _a[0], slitDown = _a[1];\r\n        var ray = new Path.Line(P(260, 0), P(400, 0)).withStroke(5.0, base.hue(rayHue).string());\r\n        var detector = Shape.Rectangle(R(400, 0, 20, 100, Pivot.CENTER), 2.0).withFill(\"#444444\");\r\n        var wire = new Path(Segments([[410, 0], , [20, 20]], [[440, 0], [-20, -20]])).withStroke(2.0, \"#888888\");\r\n        var casing = Shape.Rectangle(R(440, 0, 120, 50, Pivot.CENTER_LEFT), 6.0)\r\n            .withStroke(\"default\", SharedColors.devicePanel.stroke)\r\n            .withFill(SharedColors.devicePanel.fill);\r\n        var screen = Shape.Rectangle(R(450, 0, 100, 30, Pivot.CENTER_LEFT), 3.0)\r\n            .withStroke(5.0, \"white\")\r\n            .withFill(SharedColors.lcdScreen);\r\n        var textAbs = new PointText({\r\n            point: P(540, 8),\r\n            content: appearance.absorbance,\r\n            fillColor: \"black\",\r\n            fontFamily: 'sans-serif',\r\n            fontWeight: 'bold',\r\n            fontSize: 20,\r\n            justification: \"right\",\r\n        });\r\n        var graphic = new Group([\r\n            bulb, light, collimator, rainbow, prism, prismLine, ray, slitUp, slitDown, wire, detector, casing, screen, textAbs\r\n        ]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            watermark: rainbow.segments[0].point.add([10, 0]),\r\n            pivot: P(260, 0),\r\n        };\r\n    };\r\n    SpetrophotometerSchematic.properties = {\r\n        label: \"Spectrophotometer (Schematic)\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            absorbance: \"0.042\",\r\n            rayNm: 590,\r\n        },\r\n        appearanceSpecs: [\r\n            { spec: \"text\", key: \"absorbance\", label: \"Absorbance\", maxLength: 5 },\r\n            {\r\n                spec: \"slider\", key: \"rayNm\", label: \"Wavelength\",\r\n                min: 400, max: 640\r\n            }\r\n        ],\r\n    };\r\n    return SpetrophotometerSchematic;\r\n}());\r\nexport { SpetrophotometerSchematic };\r\n","var __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { setDefaultStyle } from \"apparatus/draw\";\r\nimport { LIQUID_OPACITY_RANGE, P, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nimport { setLiquidStyle } from \"../../draw\";\r\nimport { DEFAULT_LIQUID_DATA } from \"../common\";\r\n/** Handle ratio to create a circular shape. */\r\nexport var CIRCULAR_RATIO = 0.55;\r\nvar OsmosisTube = /** @class */ (function () {\r\n    function OsmosisTube() {\r\n    }\r\n    OsmosisTube.prototype.render = function (appearance) {\r\n        // Length above the bend.\r\n        var length = appearance.size * 2;\r\n        var diameter = 30;\r\n        var innerRadius = appearance.size;\r\n        var outerRadius = innerRadius + diameter;\r\n        var outerShell = new Path(uShapeSegment(outerRadius, length));\r\n        var innerShell = new Path(uShapeSegment(innerRadius, length));\r\n        setDefaultStyle(outerShell, innerShell);\r\n        innerShell.reverse();\r\n        var leftFluid = new (Path.bind.apply(Path, __spreadArrays([void 0], innerShell.segments.slice(2).map(function (s) { return s.clone(); }), outerShell.segments.slice(0, 3).map(function (s) { return s.clone(); }))))();\r\n        var rightFluid = new (Path.bind.apply(Path, __spreadArrays([void 0], outerShell.segments.slice(2).map(function (s) { return s.clone(); }), innerShell.segments.slice(0, 3).map(function (s) { return s.clone(); }))))();\r\n        // Choose levels on either side. Keep it below length.\r\n        var rightLevel = appearance.rightLevel * length;\r\n        var leftLevel = appearance.leftLevel * length;\r\n        leftFluid.segments[2].point.y = -leftLevel;\r\n        leftFluid.segments[3].point.y = -leftLevel;\r\n        rightFluid.segments[2].point.y = -rightLevel;\r\n        rightFluid.segments[3].point.y = -rightLevel;\r\n        // Set colours.\r\n        setLiquidStyle(leftFluid, appearance.leftColor, appearance.leftOpacity);\r\n        setLiquidStyle(rightFluid, appearance.rightColor, appearance.rightOpacity);\r\n        // Add a barrier.\r\n        var barrier = new Path.Line(P(0, innerRadius), P(0, outerRadius));\r\n        barrier.withStroke(4.0, SharedColors.stroke);\r\n        barrier.dashArray = [3, 3];\r\n        var graphic = new Group([leftFluid, rightFluid, barrier, innerShell, outerShell]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            watermark: graphic.bounds.bottomCenter,\r\n        };\r\n    };\r\n    OsmosisTube.properties = {\r\n        label: \"Osmosis Tube\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            size: 60,\r\n            leftColor: SharedColors.defaultLiquid,\r\n            leftOpacity: DEFAULT_LIQUID_DATA.alpha,\r\n            leftLevel: 0.5,\r\n            rightColor: SharedColors.defaultLiquid,\r\n            rightOpacity: DEFAULT_LIQUID_DATA.alpha,\r\n            rightLevel: 0.5,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 40, max: 80\r\n            },\r\n            { spec: \"header\", icon: \"tint\", header: \"Left liquid\" },\r\n            {\r\n                spec: \"color\", key: \"leftColor\", label: \"Colour\",\r\n                opacity: { key: \"leftOpacity\", range: LIQUID_OPACITY_RANGE }\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"leftLevel\", label: \"Level\",\r\n                min: 0.0, max: 1.0, step: 0.01\r\n            },\r\n            { spec: \"header\", icon: \"tint\", header: \"Right liquid\" },\r\n            {\r\n                spec: \"color\", key: \"rightColor\", label: \"Colour\",\r\n                opacity: { key: \"rightOpacity\", range: LIQUID_OPACITY_RANGE }\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"rightLevel\", label: \"  Level\",\r\n                min: 0.0, max: 1.0, step: 0.01\r\n            }\r\n        ],\r\n    };\r\n    return OsmosisTube;\r\n}());\r\nexport { OsmosisTube };\r\nvar uShapeSegment = function (radius, length) { return Segments([[-radius, -length]], [[-radius, 0], undefined, [0, radius * CIRCULAR_RATIO]], [[0, radius], [-radius * CIRCULAR_RATIO, 0], [radius * CIRCULAR_RATIO, 0]], [[radius, 0], [0, radius * CIRCULAR_RATIO]], [[radius, -length]]); };\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { Remodal } from \"components/remodal\";\r\nimport { PromoStat, SplashImage } from \"layout/modals/welcome\";\r\nimport * as React from 'react';\r\n/** \"About Chemix\" modal dialog. */\r\nvar AboutModal = /** @class */ (function (_super) {\r\n    __extends(AboutModal, _super);\r\n    function AboutModal() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.render = function () { return (React.createElement(Remodal.Container, { parent: _this, class: \"about-modal\", title: null },\r\n            React.createElement(SplashImage, null),\r\n            React.createElement(\"div\", { className: \"mx-3\" },\r\n                React.createElement(\"div\", { className: \"d-flex mb-2\", style: { marginTop: '-85px' } },\r\n                    React.createElement(\"img\", { src: \"./images/64.png\", className: \"mb-1\", srcSet: \"./images/64.png 1x, ./images/128.png 2x\" }),\r\n                    React.createElement(\"h1\", null,\r\n                        \"Chemix\\u00A0\",\r\n                        React.createElement(\"small\", { className: \"boost-text-gradient\" },\r\n                            _this.props.version,\r\n                            \" \"))),\r\n                React.createElement(\"p\", null, \"Chemix is an online editor for drawing science lab diagrams and school experiment apparatus. The app provides easy sketching for both students and teachers.\"),\r\n                React.createElement(\"p\", null,\r\n                    React.createElement(PromoStat, null)),\r\n                React.createElement(\"p\", null, \"If you like Chemix, support us by sharing it with your friends or follow us for updates.\"),\r\n                React.createElement(\"p\", null,\r\n                    React.createElement(\"iframe\", { src: facebookIframeSrc, width: \"180\", height: \"28\", style: { border: \"none\", overflow: \"hidden\" }, allow: \"encrypted-media\" }),\r\n                    React.createElement(\"span\", { className: \"mr-4\" }),\r\n                    React.createElement(\"a\", { href: \"https://twitter.com/ChemixLab?ref_src=twsrc%5Etfw\", className: \"twitter-follow-button\", \"data-show-count\": \"true\", \"data-size\": \"large\" }, \"Follow @ChemixLab\")),\r\n                React.createElement(\"p\", null,\r\n                    \"Chemix is developed by Codelite Ltd, UK. \\u00A9 2007-\",\r\n                    new Date().getFullYear(),\r\n                    \".\")),\r\n            React.createElement(\"p\", { style: { textAlign: \"center\" } },\r\n                React.createElement(\"button\", { \"data-remodal-action\": \"confirm\", className: \"remodal-confirm ui-button highlight\" }, \"OK\")))); };\r\n        return _this;\r\n    }\r\n    return AboutModal;\r\n}(Remodal));\r\nexport { AboutModal };\r\nvar facebookIframeSrc = \"https://www.facebook.com/plugins/like.php?href=https%3A%2F%2Ffacebook.com%2FChemix.org&width=147&layout=button_count&action=like&size=large&show_faces=false&share=true&height=46&appId\";\r\n","import { Move } from \"../move\";\r\n// Contains methods for aligning objects.\r\nexport var Align;\r\n(function (Align) {\r\n    /**\r\n     * Aligns objects to a certain direction. Returns commands to be\r\n     * executed to align the objects.\r\n     */\r\n    function align(components, direction) {\r\n        if (components.length <= 1)\r\n            return;\r\n        var property = direction;\r\n        var axis = direction == \"left\" || direction == \"right\" ? \"x\" : \"y\";\r\n        var operator = direction == \"left\" || direction == \"top\" ? \"min\" : \"max\";\r\n        // Detect left-most edge.\r\n        var extremity = components.reduce(function (v, c) { return Math[operator](v, c.alignmentBounds[property]); }, components[0].alignmentBounds[property]);\r\n        // Move all items towards this edge.\r\n        return components.map(function (c) {\r\n            var delta = { x: 0, y: 0 };\r\n            delta[axis] = extremity - c.alignmentBounds[property];\r\n            return Move.one(c.id, delta);\r\n        });\r\n    }\r\n    Align.align = align;\r\n    function alignCenters(components, axis) {\r\n        if (components.length <= 1)\r\n            return;\r\n        var center = components.reduce(function (v, c) { return v + c.alignmentBounds.center[axis]; }, 0) / components.length;\r\n        // Move all items towards this edge.\r\n        return components.map(function (c) {\r\n            var delta = { x: 0, y: 0 };\r\n            delta[axis] = center - c.alignmentBounds.center[axis];\r\n            return Move.one(c.id, delta);\r\n        });\r\n    }\r\n    Align.alignCenters = alignCenters;\r\n})(Align || (Align = {}));\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { g } from \"analytics\";\r\nimport { LoginButton } from \"api/auth/login_button\";\r\nimport { Remodal } from \"components/remodal\";\r\nimport { MyAccountModal } from \"layout/modals/my_account\";\r\nimport { clog } from \"log\";\r\nimport * as React from \"react\";\r\nimport { storeToken } from \"../../api/auth/storage\";\r\nimport { setUpQTip } from \"../../view/tooltips\";\r\nvar AccountBar = /** @class */ (function (_super) {\r\n    __extends(AccountBar, _super);\r\n    function AccountBar() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.accountRef = React.createRef();\r\n        _this.render = function () { return (React.createElement(\"div\", null,\r\n            React.createElement(MyAccountModal, { auth: _this.props.auth, ref: _this.accountRef }),\r\n            React.createElement(\"div\", { key: \"accountBar\", className: \"accountBar\" }, _this.props.auth.state == \"logged_in\" ?\r\n                React.createElement(\"div\", { key: \"loggedIn\", className: \"menuBarItem\", onClick: function () { g(\"MyAccount\"); _this.accountRef.current.open(); } },\r\n                    React.createElement(\"img\", { src: _this.props.auth.user.avatarUrl, width: \"32\", height: \"32\" }),\r\n                    \" My account\") :\r\n                React.createElement(\"div\", { key: \"loggedOut\", className: \"menuBarItem\", onClick: function () { g(\"LoginPopup\"); _this.props.openLogin(); } },\r\n                    React.createElement(\"i\", { className: \"fad fa-2x mb-1 mt-1 fa-user-circle\" }),\r\n                    React.createElement(\"br\", null),\r\n                    \"Sign in\")))); };\r\n        return _this;\r\n    }\r\n    return AccountBar;\r\n}(React.Component));\r\nexport { AccountBar };\r\nvar LoginModal = /** @class */ (function (_super) {\r\n    __extends(LoginModal, _super);\r\n    function LoginModal(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.render = function () { return (React.createElement(Remodal.Container, { parent: _this, class: \"account-login-modal\", title: \"Sign in\", icon: \"fa-user-circle\", center: true },\r\n            React.createElement(\"p\", null, \"Sign in to store your diagrams to Cloud.\"),\r\n            React.createElement(LoginButton, { providerName: \"google\", key: \"google\", auth: _this.props.auth, active: _this.state.isOpened, onClick: function () { return g(\"SignInButton\", \"account:google\"); }, onSuccess: function (token, _) { return _this.onLoginSuccess(token); } }),\r\n            React.createElement(LoginButton, { providerName: \"microsoft\", key: \"microsoft\", auth: _this.props.auth, active: _this.state.isOpened, onClick: function () { return g(\"SignInButton\", \"account:microsoft\"); }, onSuccess: function (token, _) { return _this.onLoginSuccess(token); } }),\r\n            React.createElement(LoginButton, { key: \"twitter\", providerName: \"twitter\", auth: _this.props.auth, active: _this.state.isOpened, onClick: function () { return g(\"SignInButton\", \"account:twitter\"); }, onSuccess: function (token, _) { return _this.onLoginSuccess(token); } }),\r\n            React.createElement(LoginButton, { key: \"facebook\", providerName: \"facebook\", auth: _this.props.auth, active: _this.state.isOpened, onClick: function () { return g(\"SignInButton\", \"account:facebook\"); }, onSuccess: function (token, _) { return _this.onLoginSuccess(token); } }),\r\n            React.createElement(LoginButton, { key: \"code\", providerName: \"code\", auth: _this.props.auth, active: _this.state.isOpened, onClick: function () { return g(\"SignInButon\", \"account:code\"); }, onSuccess: function (token, _) { return _this.onLoginSuccess(token); } }),\r\n            React.createElement(\"div\", { className: \"mx-3 text-left\" },\r\n                React.createElement(StaySignedInCheckbox, { key: \"stayLoggedIn\", value: _this.state.staySignedIn, onChange: function (v) { return _this.toggleStayLoggedIn(v); } })))); };\r\n        _this.state = {\r\n            isOpened: false,\r\n            staySignedIn: false\r\n        };\r\n        return _this;\r\n    }\r\n    LoginModal.prototype.onLoginSuccess = function (token) {\r\n        if (this.state.staySignedIn) {\r\n            clog(\"Token written to storage\");\r\n            storeToken(token);\r\n        }\r\n        this.close();\r\n        if (this.onLoginSuccessCallback) {\r\n            // Trigger this with a delay.\r\n            var callback = this.onLoginSuccessCallback.bind(this);\r\n            setTimeout(callback, 500);\r\n        }\r\n    };\r\n    LoginModal.prototype.open = function () {\r\n        _super.prototype.open.call(this);\r\n        this.onLoginSuccessCallback = undefined;\r\n    };\r\n    LoginModal.prototype.openWithCallback = function (callback) {\r\n        _super.prototype.open.call(this);\r\n        this.onLoginSuccessCallback = callback;\r\n    };\r\n    LoginModal.prototype.componentDidMount = function () {\r\n        _super.prototype.componentDidMount.call(this);\r\n        setUpQTip(this.ref.current);\r\n    };\r\n    LoginModal.prototype.toggleStayLoggedIn = function (stayLoggedIn) {\r\n        this.setState({\r\n            staySignedIn: stayLoggedIn\r\n        });\r\n    };\r\n    return LoginModal;\r\n}(Remodal));\r\nexport { LoginModal };\r\nexport var StaySignedInCheckbox = function (props) {\r\n    var id = \"stay_signed_in_\" + Math.round(Math.random() * 100);\r\n    return React.createElement(\"div\", { className: \"custom-control custom-checkbox my-2\" },\r\n        React.createElement(\"input\", { id: id, type: \"checkbox\", className: \"custom-control-input\", checked: props.value, onChange: function (e) { return props.onChange(e.target.checked); } }),\r\n        React.createElement(\"label\", { className: \"stay-signed-in custom-control-label\", htmlFor: id, title: STAY_SIGNED_IN_TOOLTIP }, \"Stay logged in. This is a personal device.\"));\r\n};\r\nvar STAY_SIGNED_IN_TOOLTIP = \"\\nTick this if you'd like to be automatically signed in on each visit. <br/>\\nTo keep your account secure, use this option <b>only on your personal devices.</b>\\n\";\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { g } from \"analytics\";\r\nimport { apparatusClass } from \"apparatus/library\";\r\nimport { Flip, UpdateAppearanceProperties, UpdateLiquidAlpha, UpdateLiquidAmount, UpdateLiquidColor } from \"command/basic\";\r\nimport { commandProcessor, Sequence } from \"command/command\";\r\nimport { Button } from \"components/button\";\r\nimport { MultiLiquid, UpdateLiquidLayers } from \"editing/multilayerliquids\";\r\nimport { chemMarkPropsSection, convertAppearanceSpecs } from \"panel/appearance_spec_converter\";\r\nimport { createOrderingButtons } from \"panel/ordering_ui\";\r\nimport * as React from \"react\";\r\nimport { isItemUnlocked } from \"tiers/apparatus\";\r\nimport { Badge } from \"tiers/badge\";\r\nimport { LIQUID_OPACITY_RANGE } from \"../apparatus/library/common\";\r\nimport { RotateItems } from \"../editing/rotation/rotate_command\";\r\nvar MAX_TOTAL_EXTRA_LAYERS = 4;\r\nvar MAX_EXTRA_LAYERS_FOR_FREE_TIER = 1;\r\nexport function sectionsForOneApparatus(item, app, tiers, selected) {\r\n    var sections = [];\r\n    var apparatusKlass = apparatusClass(item.type);\r\n    // Obtain the appearance spec.\r\n    var appearanceSpecs = apparatusKlass.properties.appearanceSpecs;\r\n    // Convert to element props for building UI.\r\n    var elements = convertAppearanceSpecs(appearanceSpecs, item, [item], app, tiers);\r\n    // Check if this item is allowed. If not show an upgrade banner.\r\n    if (!isItemUnlocked(item, tiers.tier)) {\r\n        elements.unshift(React.createElement(UpgradeHint, { key: \"UpgradeHint\", onClick: function () { return tiers.popup(item.type); } }));\r\n    }\r\n    sections.push({\r\n        header: \"Style\",\r\n        icon: \"sliders-h\",\r\n        hideHeaderIfFirst: true,\r\n        elements: elements\r\n    });\r\n    // Does the apparatus support ChemMark?\r\n    if (apparatusKlass.properties.chemMarkAppearanceKey) {\r\n        sections.push(chemMarkPropsSection([item], apparatusKlass.properties.chemMarkAppearanceKey));\r\n    }\r\n    var toolSectionElements = [];\r\n    var appearanceButtons = [];\r\n    if (apparatusKlass.properties.appearanceSpecs.length > 0) {\r\n        appearanceButtons.push({\r\n            buttonLabel: \"Reset to default\", icon: \"undo\",\r\n            onClick: function () {\r\n                var defaultAppearance = apparatusKlass.properties.defaultAppearance;\r\n                var currentAppearance = item.appearance;\r\n                // If the appearances are the same, don't execute.\r\n                if (JSON.stringify(defaultAppearance) == JSON.stringify(currentAppearance)\r\n                    && !item.flipped\r\n                    && item.rotation == 0)\r\n                    return;\r\n                g(\"UpdateAppearance\", item.type + \"::resetAppearance\");\r\n                var commands = [\r\n                    new RotateItems([{ id: item.id, rotation: 0, originalRotation: item.rotation }]),\r\n                    new UpdateAppearanceProperties(item.id, defaultAppearance, currentAppearance),\r\n                ];\r\n                if (item.flipped) {\r\n                    // Must be first otherwise it overwrites rotation.\r\n                    commands.unshift(new Flip(item));\r\n                }\r\n                commandProcessor.execute(new Sequence(commands));\r\n            },\r\n        });\r\n    }\r\n    if (apparatusKlass.properties.flippable) {\r\n        appearanceButtons.push({\r\n            buttonLabel: \"Flip horizontally\", icon: \"arrows-alt-h\",\r\n            onClick: function () {\r\n                g(\"UpdateAppearance\", item.type + \"::flipHorizontally\");\r\n                commandProcessor.execute(new Flip(item, { adjustRotation: true, vertical: false }));\r\n            },\r\n        }, {\r\n            buttonLabel: \"Flip vertically\", icon: \"arrows-alt-v\",\r\n            onClick: function () {\r\n                g(\"UpdateAppearance\", item.type + \"::flipVertically\");\r\n                commandProcessor.execute(new Flip(item, { adjustRotation: true, vertical: true }));\r\n            },\r\n        });\r\n    }\r\n    if (appearanceButtons.length > 0) {\r\n        toolSectionElements.push({\r\n            spec: \"vertical-buttons\",\r\n            key: \"appearance\",\r\n            label: \"Appearance\",\r\n            buttons: appearanceButtons\r\n        });\r\n    }\r\n    toolSectionElements.push(createOrderingButtons([item.id]));\r\n    sections.push({\r\n        header: \"Tools\",\r\n        icon: \"wrench\",\r\n        elements: toolSectionElements\r\n    });\r\n    if (selected.shouldAllowRegrouping) {\r\n        sections.push({\r\n            header: \"Grouping\",\r\n            icon: \"object-group\",\r\n            elements: [\r\n                {\r\n                    spec: \"button\",\r\n                    key: \"regroupObjects\",\r\n                    label: \"Regroup object\",\r\n                    buttonLabel: \"Regroup object\",\r\n                    icon: \"object-group\",\r\n                    onClick: function () {\r\n                        var command = selected.createRegroupObjectsCommand();\r\n                        if (command) {\r\n                            g(\"Grouping\", \"Regroup\");\r\n                            commandProcessor.execute(command);\r\n                        }\r\n                    }\r\n                }\r\n            ]\r\n        });\r\n    }\r\n    var props = {\r\n        title: apparatusKlass.properties.label,\r\n        icon: \"flask\",\r\n        tabs: [\r\n            {\r\n                type: \"property\",\r\n                sections: sections,\r\n            },\r\n        ]\r\n    };\r\n    // If the apparatus can contain liquids, add options for those.\r\n    if (apparatusKlass.properties.canContainLiquids && item.liquid) {\r\n        props.tabs.push({\r\n            type: \"liquid\",\r\n            colorDot: item.liquid.color,\r\n            sections: [createLiquidPropsSection(item, item.liquid, app, tiers)]\r\n        });\r\n    }\r\n    return props;\r\n}\r\nexport function createSingleLayerLiquidPropsSection(items, app) {\r\n    var liquidData = items[0].liquid; // Take liquid data of first item.\r\n    var elements = [\r\n        {\r\n            spec: \"slider\", label: \"Amount\",\r\n            min: 0, max: 1, step: 0.01, initialValue: liquidData.amountRatio,\r\n            key: \"liquid_amount\", unit: \"%\",\r\n            onChange: function (value) {\r\n                for (var _i = 0, items_1 = items; _i < items_1.length; _i++) {\r\n                    var item = items_1[_i];\r\n                    var component = app.getApparatusComponent(item.id);\r\n                    if (!component || !component.state.liquid)\r\n                        continue;\r\n                    component.updateLiquidData(__assign(__assign({}, component.state.liquid), { amountRatio: value }));\r\n                }\r\n            },\r\n            onEnd: function (previous, final) {\r\n                g(\"UpdateAppearance\", items[0].type + \"::liquid::amount\");\r\n                var command = new UpdateLiquidAmount(items.map(function (i) { return ({\r\n                    id: i.id,\r\n                    value: final,\r\n                    previousValue: i.liquid.amountRatio\r\n                }); }));\r\n                commandProcessor.execute(command);\r\n            }\r\n        },\r\n    ];\r\n    // The next section can only be added if there is a single item, or if multiple items all\r\n    // don't have extra layers.\r\n    if (items.length == 1 || items.every(function (i) { var _a; return ((_a = i.liquid) === null || _a === void 0 ? void 0 : _a.layers.length) == 0; })) {\r\n        elements.push({\r\n            spec: \"color\", label: \"Colour\",\r\n            key: \"liquid_color\" + \"_\" + items[0].id.id,\r\n            value: liquidData.color,\r\n            onColorChange: function (value) {\r\n                for (var _i = 0, items_2 = items; _i < items_2.length; _i++) {\r\n                    var item = items_2[_i];\r\n                    var component = app.getApparatusComponent(item.id);\r\n                    if (!component || !item.liquid)\r\n                        continue;\r\n                    component.updateLiquidData(__assign(__assign({}, item.liquid), { color: value }));\r\n                }\r\n            },\r\n            onColorEnd: function (final) {\r\n                if (final == items[0].liquid.color)\r\n                    return;\r\n                g(\"UpdateAppearance\", items[0].type + \"::liquid::colour\");\r\n                var command = new UpdateLiquidColor(items.filter(function (i) { return i.liquid !== undefined; }).map(function (i) { return ({\r\n                    id: i.id,\r\n                    value: final,\r\n                    previousValue: i.liquid.color\r\n                }); }));\r\n                commandProcessor.execute(command);\r\n            },\r\n            opacity: {\r\n                value: liquidData.alpha,\r\n                range: LIQUID_OPACITY_RANGE,\r\n                onChange: function (value) {\r\n                    for (var _i = 0, items_3 = items; _i < items_3.length; _i++) {\r\n                        var item = items_3[_i];\r\n                        var component = app.getApparatusComponent(item.id);\r\n                        if (!component || !component.state.liquid)\r\n                            continue;\r\n                        component.updateLiquidData(__assign(__assign({}, component.state.liquid), { alpha: value }));\r\n                    }\r\n                },\r\n                onEnd: function (_, final) {\r\n                    g(\"UpdateAppearance\", items[0].type + \"::liquid::alpha\");\r\n                    var command = new UpdateLiquidAlpha(items.map(function (i) { return ({\r\n                        id: i.id,\r\n                        value: final,\r\n                        previousValue: i.liquid.alpha\r\n                    }); }));\r\n                    commandProcessor.execute(command);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    return elements;\r\n}\r\nfunction createLiquidPropsSection(item, liquidData, app, tiers) {\r\n    var elements = createSingleLayerLiquidPropsSection([item], app);\r\n    var _loop_1 = function (i) {\r\n        var layer = liquidData.layers[i];\r\n        var index = i;\r\n        elements.push(React.createElement(\"hr\", { key: \"liquid_hr_\" + i }), React.createElement(\"h4\", { key: \"liquid_label_\" + i },\r\n            \"Liquid Layer #\",\r\n            liquidData.layers.length - i));\r\n        elements.push({\r\n            spec: \"slider\", label: \"Position\",\r\n            min: 0, max: 1, step: 0.01, initialValue: layer.position,\r\n            key: \"liquid_position_\" + i, unit: \"%\",\r\n            onChange: function (value) {\r\n                // CALLBACK! Do NOT refer to \"i\".\r\n                var component = app.getApparatusComponent(item.id);\r\n                if (!component || !component.state.liquid)\r\n                    return;\r\n                var newLayers = MultiLiquid.adjustNumeric(liquidData.layers, index, \"position\", value);\r\n                component.updateLiquidData(__assign(__assign({}, component.state.liquid), { layers: newLayers }));\r\n            },\r\n            onEnd: function (previous, final) {\r\n                if (previous == final)\r\n                    return;\r\n                // CALLBACK! Do NOT refer to \"i\".\r\n                var newLayers = MultiLiquid.adjustNumeric(liquidData.layers, index, \"position\", final);\r\n                commandProcessor.execute(new UpdateLiquidLayers(item.id, newLayers, liquidData.layers));\r\n            }\r\n        }, {\r\n            spec: \"color\", label: \"Colour\",\r\n            key: \"liquid_color_\" + item.id.id + \"_\" + i,\r\n            value: layer.color,\r\n            onColorChange: function (value) {\r\n                // CALLBACK! Do NOT refer to \"i\".\r\n                var component = app.getApparatusComponent(item.id);\r\n                if (!component || !component.state.liquid)\r\n                    return;\r\n                var newLayers = MultiLiquid.adjustString(liquidData.layers, index, \"color\", value);\r\n                component.updateLiquidData(__assign(__assign({}, component.state.liquid), { layers: newLayers }));\r\n            },\r\n            onColorEnd: function (final) {\r\n                // Careful here! We need to compare lowercase because the output\r\n                // will be uppercase from the bootstrap color picker! Also\r\n                // onColorEnd is called when the component is unmounted, so it's\r\n                // possible that this layer no longer exists. Be careful!\r\n                if (final.toLowerCase() == layer.color.toLowerCase())\r\n                    return;\r\n                // CALLBACK! Do NOT refer to \"i\".\r\n                var newLayers = MultiLiquid.adjustString(liquidData.layers, index, \"color\", final);\r\n                commandProcessor.execute(new UpdateLiquidLayers(item.id, newLayers, liquidData.layers));\r\n            },\r\n            opacity: {\r\n                value: layer.alpha,\r\n                range: LIQUID_OPACITY_RANGE,\r\n                onChange: function (value) {\r\n                    // CALLBACK! Do NOT refer to \"i\".\r\n                    var component = app.getApparatusComponent(item.id);\r\n                    if (!component || !component.state.liquid)\r\n                        return;\r\n                    var newLayers = MultiLiquid.adjustNumeric(liquidData.layers, index, \"alpha\", value);\r\n                    component.updateLiquidData(__assign(__assign({}, component.state.liquid), { layers: newLayers }));\r\n                },\r\n                onEnd: function (previous, final) {\r\n                    if (previous == final)\r\n                        return;\r\n                    // CALLBACK! Do NOT refer to \"i\".\r\n                    var newLayers = MultiLiquid.adjustNumeric(liquidData.layers, index, \"alpha\", final);\r\n                    commandProcessor.execute(new UpdateLiquidLayers(item.id, newLayers, liquidData.layers));\r\n                }\r\n            }\r\n        }, {\r\n            spec: \"slider\", label: \"Blending\",\r\n            min: 0, max: 1, step: 0.01, initialValue: layer.blending,\r\n            key: \"liquid_blending_\" + i, unit: \"%\",\r\n            onChange: function (value) {\r\n                // CALLBACK! Do NOT refer to \"i\".\r\n                var component = app.getApparatusComponent(item.id);\r\n                if (!component || !component.state.liquid)\r\n                    return;\r\n                var newLayers = MultiLiquid.adjustNumeric(liquidData.layers, index, \"blending\", value);\r\n                component.updateLiquidData(__assign(__assign({}, component.state.liquid), { layers: newLayers }));\r\n            },\r\n            onEnd: function (previous, final) {\r\n                if (previous == final)\r\n                    return;\r\n                // CALLBACK! Do NOT refer to \"i\".\r\n                var newLayers = MultiLiquid.adjustNumeric(liquidData.layers, index, \"blending\", final);\r\n                commandProcessor.execute(new UpdateLiquidLayers(item.id, newLayers, liquidData.layers));\r\n            }\r\n        });\r\n    };\r\n    // Present the layers in reverse order, so that it visually matches\r\n    // with how the layers are rendered.\r\n    for (var i = liquidData.layers.length - 1; i >= 0; i--) {\r\n        _loop_1(i);\r\n    }\r\n    var buttons = [];\r\n    var currentExtraLayers = liquidData.layers.length;\r\n    if (currentExtraLayers < MAX_TOTAL_EXTRA_LAYERS) {\r\n        if (currentExtraLayers < MAX_EXTRA_LAYERS_FOR_FREE_TIER || tiers.allow(\"boost\")) {\r\n            buttons.push(React.createElement(Button, { buttonLabel: \"Add layer\", icon: \"plus\", key: \"addLayer\", onClick: function () {\r\n                    g(\"UpdateAppearance\", item.type + \"::liquid::add_layer\");\r\n                    var newLayers = MultiLiquid.addLayer(liquidData.layers);\r\n                    commandProcessor.execute(new UpdateLiquidLayers(item.id, newLayers, liquidData.layers));\r\n                } }));\r\n        }\r\n        else {\r\n            buttons.push(React.createElement(Button, { buttonLabel: \"Add layer\", icon: \"plus\", key: \"addLayer\", tierLock: \"boost\", onClick: function () {\r\n                    tiers.popup(\"Add Liquid Layer\");\r\n                } }));\r\n        }\r\n    }\r\n    if (liquidData.layers.length === 0) {\r\n        buttons.push(React.createElement(Button, { buttonLabel: \"Quick blend\", icon: \"fill-drip\", key: \"quick_blend\", onClick: function () {\r\n                g(\"UpdateAppearance\", item.type + \"::liquid::quick_blend\");\r\n                var newLayers = MultiLiquid.createSimpleGradient(liquidData.color, liquidData.alpha);\r\n                commandProcessor.execute(new UpdateLiquidLayers(item.id, newLayers, liquidData.layers));\r\n            } }));\r\n    }\r\n    if (liquidData.layers.length > 0) {\r\n        buttons.push(React.createElement(Button, { buttonLabel: \"Remove layer\", icon: \"minus\", key: \"removeLayer\", onClick: function () {\r\n                g(\"UpdateAppearance\", item.type + \"::liquid::remove_layer\");\r\n                var newLayers = MultiLiquid.removeBottomLayer(liquidData.layers);\r\n                commandProcessor.execute(new UpdateLiquidLayers(item.id, newLayers, liquidData.layers));\r\n            } }));\r\n    }\r\n    if (buttons.length > 0) {\r\n        elements.push(React.createElement(\"div\", { className: \"flex-group\", key: \"liquidLayerButtons\" },\r\n            React.createElement(\"div\", { className: \"label\" }),\r\n            React.createElement(\"div\", { className: \"verticalButtonGroup mt-2\", key: \"liquidLayerButtons\" }, buttons)));\r\n    }\r\n    return {\r\n        header: \"Liquid\",\r\n        icon: \"tint\",\r\n        hideHeaderIfFirst: true,\r\n        elements: elements\r\n    };\r\n}\r\n/**\r\n * Element shown if the user does not have a subscription for given\r\n * item.\r\n */\r\nvar UpgradeHint = function (props) {\r\n    return React.createElement(\"div\", { className: \"boxed-hint border-success text-success mt-2\" },\r\n        \"To use this item, you need a subscription. \",\r\n        React.createElement(Badge, { tier: \"boost\" }),\r\n        React.createElement(\"button\", { className: \"ui-button highlight text-center mt-1\", onClick: props.onClick }, \"Upgrade\"));\r\n};\r\n","import { breakPathClosed, glassFold, setDefaultStyle } from \"apparatus/draw\";\r\nimport { P, Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { Path } from \"paper\";\r\nimport { smoothCorner } from \"../../draw\";\r\nvar DistillationHead = /** @class */ (function () {\r\n    function DistillationHead() {\r\n    }\r\n    DistillationHead.prototype.render = function (appearance) {\r\n        // Distillation head is similar to a 3-way tube. We will\r\n        // draw this by unioning two rectangles, a \"vertical\" one\r\n        // and a tilted \"outlet\" one.\r\n        var topGroundJoint = new Path(Segments([[-10, -10]], [[-7.5, 10]], [[7.5, 10]], [[10, -10]]));\r\n        var bottomGroundJoint = new Path(Segments([[-10, 60]], [[-7, 85]], [[7, 85]], [[10, 60]]));\r\n        bottomGroundJoint.closePath();\r\n        var vertical = new Path.Rectangle(R(0, 10, 18, 51, Pivot.TOP_CENTER));\r\n        var pivot = P(0, 30);\r\n        var angle = 15;\r\n        var outletSize = 50;\r\n        var outlet = new Path.Rectangle(R(pivot.x, pivot.y, outletSize, 15, Pivot.CENTER_LEFT));\r\n        outlet.rotate(15, P(0, 40));\r\n        var shape = (vertical.unite(outlet).unite(topGroundJoint).unite(bottomGroundJoint));\r\n        // Smooth out the joints between the outlet and the vertical pipe.\r\n        smoothCorner(shape.segments[9], 3.0);\r\n        smoothCorner(shape.segments[6], 5.0);\r\n        var graphic = breakPathClosed(shape, 3, 9, 15);\r\n        setDefaultStyle(graphic);\r\n        graphic.addChildren([\r\n            glassFold(5, 31, { rotation: 90 }),\r\n            glassFold(0, 12, { size: 6 }),\r\n            glassFold(0, 63, { size: 8 }),\r\n        ]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: [\r\n                { type: \"connectable\", at: P(0, -3), facing: 0 },\r\n                { type: \"connectable\", at: P(0, 83), facing: 180 },\r\n                { type: \"connectable\", at: pivot.add(P(outletSize, 0)).rotate(15, pivot), facing: 90 + angle },\r\n            ]\r\n        };\r\n    };\r\n    DistillationHead.properties = {\r\n        label: \"Distillation Head\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {},\r\n        appearanceSpecs: [],\r\n    };\r\n    return DistillationHead;\r\n}());\r\nexport { DistillationHead };\r\n","import { P, R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, PointText, Shape } from \"paper\";\r\nimport { mirrorX } from \"../../draw\";\r\nvar DigitalThermometer = /** @class */ (function () {\r\n    function DigitalThermometer() {\r\n    }\r\n    DigitalThermometer.prototype.render = function (appearance) {\r\n        var displayString = appearance.reading + \" \" + appearance.unit;\r\n        switch (appearance.brand) {\r\n            case \"flinn\":\r\n                return renderFlinn(displayString);\r\n            case \"vernier\":\r\n                return renderVernier(displayString);\r\n        }\r\n    };\r\n    DigitalThermometer.properties = {\r\n        label: \"Digital thermometer\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            brand: \"vernier\",\r\n            reading: \"20\",\r\n            unit: \"C\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"brand\", label: \"Brand\",\r\n                options: [\r\n                    { value: \"flinn\", label: \"Flinn\" },\r\n                    { value: \"vernier\", label: \"Vernier\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"text\", key: \"reading\", label: \"Reading\",\r\n            },\r\n            {\r\n                spec: \"toggle-buttons\", key: \"unit\", label: \"Units\", size: \"text\",\r\n                options: [\r\n                    { value: \"C\", label: \"C\", icon: \"\" },\r\n                    { value: \"F\", label: \"F\", icon: \"\" },\r\n                    { value: \"K\", label: \"K\", icon: \"\" },\r\n                    { value: \"\", label: \"-\", icon: \"\" },\r\n                ],\r\n            }\r\n        ],\r\n    };\r\n    return DigitalThermometer;\r\n}());\r\nexport { DigitalThermometer };\r\n// https://www.flinnsci.com/flinn-digital-thermometer/ap8716/\r\n// Probe length 8 in (20cm), overall length 11 in (28cm)\r\nfunction renderFlinn(displayString) {\r\n    var probe = Shape.Rectangle(R(-4, 80, 8, 200));\r\n    probe.setGradientFill(\"right\", [\r\n        [\"#d0232f\", 0.1],\r\n        [\"#e75753\", 0.6],\r\n        [\"#d0232f\", 0.9],\r\n    ]);\r\n    var handle = new Path(Segments([[4, 80], undefined, [0, -6]], [[12, 70], [0, 6]], [[12, 5], undefined, [0, -4]]));\r\n    mirrorX(handle);\r\n    handle.fillColor = \"#111122\";\r\n    var screen = Shape.Rectangle(R(-9, 16, 18, 46), 9);\r\n    screen.fillColor = \"#eeeeee\";\r\n    var decor1 = Shape.Rectangle(R(-12, 10, 24, 2));\r\n    decor1.fillColor = \"#d0232f\";\r\n    var decor2 = Shape.Rectangle(R(-12, 66, 24, 2));\r\n    decor2.fillColor = \"#d0232f\";\r\n    var display = new PointText({\r\n        point: P(0, 43),\r\n        content: displayString,\r\n        fillColor: 'black',\r\n        fontFamily: 'sans-serif',\r\n        fontSize: 14,\r\n        justification: \"center\",\r\n    });\r\n    display.rotate(-90, P(0, 38));\r\n    var graphic = new Group([probe, handle, screen, decor1, decor2, display]);\r\n    return { graphic: graphic, hitShape: graphic.bounds.toShape() };\r\n}\r\n// https://www.vernier.com/products/sensors/temperature-sensors/irt-bta/\r\nfunction renderVernier(displayString) {\r\n    var casing = new Path(Segments([[20, 0], [-2, -2]], [[20, 37], undefined, [-4, 7]], [[12, 55], [0, -7]], [[12, 150], undefined, [0, 2]]));\r\n    mirrorX(casing);\r\n    casing.fillColor = \"#333344\";\r\n    var screen = Shape.Rectangle(R(-16, 12, 32, 18));\r\n    screen.fillColor = \"#eeeeee\";\r\n    var button = Shape.Circle(P(0, 46), 7);\r\n    button.fillColor = \"#d0232f\";\r\n    var display = new PointText({\r\n        point: P(0, 26),\r\n        content: displayString,\r\n        fillColor: 'black',\r\n        fontFamily: 'sans-serif',\r\n        fontSize: 12,\r\n        justification: \"center\",\r\n    });\r\n    var graphic = new Group([casing, button, screen, display]);\r\n    return { graphic: graphic, hitShape: graphic.bounds.toShape() };\r\n}\r\n","import { Group, Path, Point, Segment } from \"paper\";\r\nimport { addEdgeLipsReversed, addMarkers, breakPath, mirrorX, removeLastSegment, setDefaultStyle, smoothCorner } from \"../draw\";\r\nimport { markerSpacing, P, Segments } from \"./common\";\r\nvar ConicalFlask = /** @class */ (function () {\r\n    function ConicalFlask() {\r\n    }\r\n    ConicalFlask.prototype.render = function (appearance) {\r\n        var _a = baseFlaskGraphic(appearance), graphic = _a.graphic, markers = _a.markers, neckWidth = _a.neckWidth, neckHeight = _a.neckHeight;\r\n        addEdgeLipsReversed(graphic);\r\n        var liquidMask = graphic.clone();\r\n        setDefaultStyle(graphic);\r\n        var graphicWithMarkers = new Group([graphic, markers]);\r\n        return {\r\n            graphic: graphicWithMarkers,\r\n            hitShape: graphic.bounds.toShape(),\r\n            liquidMask: liquidMask,\r\n            snapping: [\r\n                graphic.placeable(),\r\n                { type: \"neck\", top: P(0, -neckHeight), diameter: neckWidth, facing: 0 },\r\n            ]\r\n        };\r\n    };\r\n    // Based on: https://www.amazon.co.uk/dp/B07CQNWN4C/ref=twister_B07CQ1ZX9L?_encoding=UTF8&th=1\r\n    ConicalFlask.properties = {\r\n        label: \"Conical flask\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            size: 100,\r\n        },\r\n        appearanceSpecs: [{\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 80, max: 200,\r\n            }]\r\n    };\r\n    return ConicalFlask;\r\n}());\r\nexport { ConicalFlask };\r\nvar ConicalFlaskWithSideArm = /** @class */ (function () {\r\n    function ConicalFlaskWithSideArm() {\r\n    }\r\n    ConicalFlaskWithSideArm.prototype.render = function (appearance) {\r\n        var holeRadius = 5;\r\n        var sideArmLength = 15;\r\n        var offset = -17;\r\n        var _a = baseFlaskGraphic(appearance, 35), graphic = _a.graphic, markers = _a.markers, neckWidth = _a.neckWidth, neckHeight = _a.neckHeight;\r\n        // Insert the spout\r\n        graphic.insertSegments(1, Segments([[neckWidth / 2, offset - holeRadius]], [[neckWidth / 2 + sideArmLength, offset - holeRadius]], [[neckWidth / 2 + sideArmLength, offset + holeRadius]], [[neckWidth / 2, offset + holeRadius]]));\r\n        addEdgeLipsReversed(graphic);\r\n        var liquidMask = graphic.clone();\r\n        var parts = breakPath(graphic, 4);\r\n        setDefaultStyle(parts);\r\n        var graphicWithMarkers = new Group([parts, markers]);\r\n        return {\r\n            graphic: graphicWithMarkers,\r\n            hitShape: graphic.bounds.toShape(),\r\n            liquidMask: liquidMask,\r\n            snapping: [\r\n                graphic.placeable(),\r\n                { type: \"connectable\", at: P(neckWidth / 2 + sideArmLength, offset), facing: 90 },\r\n                { type: \"neck\", top: P(0, -neckHeight), diameter: neckWidth, facing: 0 },\r\n            ]\r\n        };\r\n    };\r\n    ConicalFlaskWithSideArm.properties = {\r\n        label: \"Conical flask with side arm\",\r\n        canContainLiquids: true,\r\n        flippable: true,\r\n        defaultAppearance: ConicalFlask.properties.defaultAppearance,\r\n        appearanceSpecs: ConicalFlask.properties.appearanceSpecs,\r\n    };\r\n    return ConicalFlaskWithSideArm;\r\n}());\r\nexport { ConicalFlaskWithSideArm };\r\nfunction baseFlaskGraphic(appearance, minNeckHeight) {\r\n    if (minNeckHeight === void 0) { minNeckHeight = 0; }\r\n    var ratio = appearance.size / 150;\r\n    var neckHeight = Math.max(minNeckHeight, 40 * ratio);\r\n    var neckWidth = 20 + Math.sqrt(ratio) * 20;\r\n    var baseHeight = 150 * ratio;\r\n    var baseWidth = 145 * ratio;\r\n    var corner = 10.0 + ratio * 20;\r\n    var graphic = new Path();\r\n    graphic.addSegments([\r\n        // Neck.\r\n        new Segment(new Point(neckWidth / 2, -neckHeight)),\r\n        new Segment(new Point(neckWidth / 2, 0)),\r\n        // Base\r\n        new Segment(new Point(baseWidth / 2, baseHeight)),\r\n        new Segment(new Point(0, baseHeight))\r\n    ]);\r\n    smoothCorner(graphic.segments[2], corner);\r\n    removeLastSegment(graphic);\r\n    mirrorX(graphic, 0);\r\n    // Create markers.\r\n    var markers = new Group();\r\n    var bottomRightCorner = new Point((baseWidth - neckWidth) / 2 - 3.0, baseHeight);\r\n    var scaleRatio = bottomRightCorner.y / markerSpacing;\r\n    var markSpacingVector = bottomRightCorner.divide(scaleRatio);\r\n    var markStart = bottomRightCorner.add([neckWidth / 2 - 7.0, 0]);\r\n    addMarkers(markers, markStart, 0, markSpacingVector);\r\n    return { graphic: graphic, markers: markers, neckWidth: neckWidth, neckHeight: neckHeight };\r\n}\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { g } from \"analytics\";\r\nimport { BACKEND_API } from \"api/api\";\r\nimport { loginProviderDisplayName, loginProviderIcon } from \"api/auth/login_button\";\r\nimport { reauthFromCurrentLogin } from \"api/auth/reauth\";\r\nimport { Remodal } from \"components/remodal\";\r\nimport { format } from \"date-fns\";\r\nimport { StaySignedInCheckbox } from \"layout/top_bar/account\";\r\nimport { clog } from \"log\";\r\nimport * as React from \"react\";\r\nimport store from \"store/store\";\r\nimport { TierContext } from \"tiers/context\";\r\nimport { BoostFeatureList, Item } from \"tiers/promo_plus\";\r\nimport { callApi } from \"../../api/api\";\r\nimport { clearToken, retrieveToken, storeToken } from \"../../api/auth/storage\";\r\nimport { logOut } from \"../../store/actions\";\r\nimport { Badge } from \"../../tiers/badge\";\r\nimport { opensWindow } from \"../../utils\";\r\nimport { setUpQTip } from \"../../view/tooltips\";\r\nvar MyAccountModal = /** @class */ (function (_super) {\r\n    __extends(MyAccountModal, _super);\r\n    function MyAccountModal(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.cancelSubscription = function () {\r\n            callApi(\"plans/cancel\", \"POST\", _this.props.auth, undefined, {\r\n                success: function () {\r\n                    toastr.success(\"Successfully canceled your subscription. Your plan will continue to be active until it expires.\");\r\n                    _this.refreshAccountDetails();\r\n                },\r\n                generic: function () {\r\n                    toastr.error(\"Please try again or contact support@chemix.org if you continue to have issues.\", \"Failed to cancel plan.\");\r\n                }\r\n            });\r\n        };\r\n        _this.resumeSubscription = function () {\r\n            g(\"OpenStripePortal\");\r\n            callApi(\"plans/resume\", \"POST\", _this.props.auth, undefined, {\r\n                success: function () {\r\n                    toastr.success(\"Successfully resumed your subscription.\");\r\n                    _this.refreshAccountDetails();\r\n                },\r\n                generic: function () {\r\n                    toastr.error(\"Please try again or contact support@chemix.org if you continue to have issues.\", \"Failed to resume plan.\");\r\n                }\r\n            });\r\n        };\r\n        _this.openStripeCustomerPortal = function () {\r\n            opensWindow(function (opener) {\r\n                callApi(\"account/stripe_customer_portal\", \"POST\", _this.props.auth, undefined, {\r\n                    success: function (response) {\r\n                        opener(response.url);\r\n                    },\r\n                    generic: function () {\r\n                        toastr.error(\"Could not open the portal. If you get this error repeatedly, please report this to support@chemix.org\");\r\n                    }\r\n                });\r\n            });\r\n        };\r\n        _this.refreshPurchase = function (loggedIn) {\r\n            var token = loggedIn.jwtToken;\r\n            var headers = new Headers();\r\n            headers.set(\"Authorization\", \"Bearer \" + token);\r\n            return fetch(BACKEND_API + \"/plans/refresh\", {\r\n                method: \"POST\",\r\n                headers: headers,\r\n            }).then(function (r) {\r\n                if (r.status == 200) {\r\n                    toastr.success(\"Successfully refreshed.\");\r\n                    reauthFromCurrentLogin();\r\n                    _this.refreshAccountDetails();\r\n                }\r\n                else if (r.status == 404) {\r\n                    toastr.error(\"Could not retrieve purchase.\");\r\n                }\r\n            });\r\n        };\r\n        _this.render = function () { return (React.createElement(Remodal.Container, { key: \"myAccount\", parent: _this, class: \"my-account-modal\", title: \"My account\", icon: \"fa-user-circle\" }, _this.props.auth.state == \"logged_in\" ? _this.renderLoggedIn(_this.props.auth) : _this.renderLoggedOut())); };\r\n        _this.renderLoggedIn = function (state) { return (React.createElement(React.Fragment, null,\r\n            React.createElement(Row, { heading: \"Account\" },\r\n                React.createElement(\"div\", { className: \"account-summary\", key: \"summary\" },\r\n                    React.createElement(\"div\", { className: \"avatar\" },\r\n                        React.createElement(\"img\", { height: \"48\", src: state.user.avatarUrl }),\r\n                        React.createElement(\"span\", { className: \"provider_icon fa-stack fa-2x\" },\r\n                            React.createElement(\"i\", { className: \"fas fa-circle fa-stack-2x\" }),\r\n                            React.createElement(\"i\", { className: loginProviderIcon(state.provider) + \" fa-stack-1x fa-inverse\" }))),\r\n                    React.createElement(\"span\", null,\r\n                        \"You are currently signed in using \",\r\n                        loginProviderDisplayName(state.provider),\r\n                        \" as \",\r\n                        React.createElement(\"b\", null, state.user.handle),\r\n                        \".\")),\r\n                React.createElement(StaySignedInCheckbox, { key: \"stayLoggedIn\", value: _this.state.staySignedIn, onChange: function (v) { return _this.toggleStayLoggedIn(v); } })),\r\n            _this.subscriptionRow(state, _this.state.accountDetails),\r\n            React.createElement(\"div\", { className: \"my-1 text-center\" },\r\n                React.createElement(\"div\", { className: \"ui-button\", onClick: function () { return _this.signOut(); }, key: \"logoutButton\" },\r\n                    React.createElement(\"i\", { className: \"fas fa-sign-out-alt mr-2\" }),\r\n                    \"Sign out\"),\r\n                React.createElement(\"button\", { className: \"ui-button ml-1\", onClick: function () { return _this.close(); }, key: \"closeButton\" }, \"Close\")))); };\r\n        _this.subscriptionRow = function (auth, accountDetails) { return (React.createElement(Row, { heading: \"Subscription\" }, (function () {\r\n            if (!accountDetails)\r\n                return _this.individualAccountDetails(auth, undefined);\r\n            switch (accountDetails.type) {\r\n                case \"domain\": return _this.domainAccountDetails(accountDetails);\r\n                case \"managed\": return _this.managedAccountDetails(accountDetails);\r\n                case \"individual\": return _this.individualAccountDetails(auth, accountDetails);\r\n            }\r\n        })())); };\r\n        _this.individualAccountDetails = function (auth, accountDetails) { return (React.createElement(React.Fragment, null,\r\n            accountDetails ?\r\n                _this.renderCurrentAccountDetails(accountDetails)\r\n                : _this.renderStartAccountDetails(),\r\n            accountDetails && !accountDetails.auto_renew ?\r\n                React.createElement(\"div\", { className: \"ui-button mr-1 mb-1\", onClick: _this.resumeSubscription },\r\n                    React.createElement(\"i\", { className: \"\" }),\r\n                    \"Resume plan\")\r\n                : undefined,\r\n            !accountDetails ?\r\n                React.createElement(TierContext.Consumer, null, function (tiers) { return (React.createElement(\"div\", { className: \"ui-button mr-1 mb-1 highlight\", onClick: function () { return tiers.popup(\"MyAccount\"); }, key: \"plan\" },\r\n                    React.createElement(\"i\", { className: \"\" }),\r\n                    \"Upgrade plan\")); })\r\n                : /* Otherwise show a \"Manage subscription\" button that takes users to Stripe portal. */\r\n                    React.createElement(\"div\", { className: \"ui-button mr-1 mb-1\", onClick: _this.openStripeCustomerPortal, key: \"manage\" },\r\n                        React.createElement(\"i\", { className: \"\" }),\r\n                        \"Manage\"),\r\n            React.createElement(\"div\", { className: \"ui-button mr-1\", onClick: function () { return _this.refreshPurchase(auth); } },\r\n                React.createElement(\"i\", { className: \"\" }),\r\n                \"Refresh\"),\r\n            accountDetails && accountDetails.auto_renew && !_this.state.showCancelDialog ?\r\n                React.createElement(\"div\", { className: \"ui-button mr-1 mb-1\", onClick: function () { return _this.setState({ showCancelDialog: true }); } },\r\n                    React.createElement(\"i\", { className: \"\" }),\r\n                    \"Cancel plan\")\r\n                : undefined,\r\n            _this.state.showCancelDialog ?\r\n                React.createElement(CancelPlanConfirmation, { onConfirm: function () { _this.cancelSubscription(); _this.setState({ showCancelDialog: false }); }, onNoop: function () { return _this.setState({ showCancelDialog: false }); } })\r\n                : undefined,\r\n            React.createElement(\"div\", { className: \"text-muted my-1\" },\r\n                \"For any queries, please email \",\r\n                React.createElement(\"a\", { href: \"mailto:support@chemix.org\", target: \"_blank\" }, \"support@chemix.org\"),\r\n                \".\"))); };\r\n        _this.domainAccountDetails = function (details) { return (React.createElement(React.Fragment, null,\r\n            React.createElement(\"p\", null,\r\n                \"Current plan: \",\r\n                React.createElement(Badge, { tier: details.tier, showHint: false }),\r\n                React.createElement(\"b\", null,\r\n                    details.tier.capitalise(),\r\n                    \" \"),\r\n                \" \",\r\n                React.createElement(\"br\", null)),\r\n            React.createElement(\"p\", null,\r\n                \"Your account is part of the \",\r\n                React.createElement(\"b\", null, details.domain),\r\n                \" domain.\"))); };\r\n        _this.managedAccountDetails = function (details) { return (React.createElement(React.Fragment, null,\r\n            React.createElement(\"p\", null,\r\n                \"Current plan: \",\r\n                React.createElement(Badge, { tier: details.tier, showHint: false }),\r\n                React.createElement(\"b\", null,\r\n                    details.tier.capitalise(),\r\n                    \" \"),\r\n                \" \",\r\n                React.createElement(\"br\", null)),\r\n            React.createElement(\"p\", null,\r\n                \"Your account is managed by \",\r\n                React.createElement(\"b\", null, details.managedBy),\r\n                \".\"))); };\r\n        /** Renders the account summary if the user does not have a paid subscription. */\r\n        _this.renderStartAccountDetails = function () { return (React.createElement(\"p\", null,\r\n            \"Current plan: \",\r\n            React.createElement(\"b\", null, \"Start\"))); };\r\n        _this.renderCurrentAccountDetails = function (details) {\r\n            var next_payment_date = React.createElement(\"b\", null, format(details.next_payment_date, \"d MMM yyyy\"));\r\n            var payment = React.createElement(\"b\", null,\r\n                details.currency,\r\n                \"\\u00A0\",\r\n                details.payment);\r\n            return React.createElement(\"p\", null,\r\n                \"Current plan: \",\r\n                React.createElement(Badge, { tier: details.tier, showHint: false }),\r\n                React.createElement(\"b\", null,\r\n                    details.tier.capitalise(),\r\n                    \" \"),\r\n                \" \",\r\n                React.createElement(\"br\", null),\r\n                details.auto_renew ?\r\n                    details.is_trial ?\r\n                        React.createElement(\"span\", null,\r\n                            \"You are on a free trial until \",\r\n                            next_payment_date,\r\n                            \". You will then be charged \",\r\n                            payment,\r\n                            \".\")\r\n                        :\r\n                            React.createElement(\"span\", null,\r\n                                \"Your plan will automatically renew on \",\r\n                                next_payment_date,\r\n                                \". You will be charged \",\r\n                                payment,\r\n                                \".\")\r\n                    : React.createElement(\"span\", null,\r\n                        \"Your plan is valid until and will expire on \",\r\n                        next_payment_date,\r\n                        \".\"));\r\n        };\r\n        _this.renderLoggedOut = function () { return (React.createElement(\"div\", null, \"You are signed out.\")); };\r\n        _this.state = {\r\n            isOpened: false,\r\n            fetchedAccountDetails: false,\r\n            staySignedIn: retrieveToken() != null,\r\n            showCancelDialog: false,\r\n        };\r\n        return _this;\r\n    }\r\n    MyAccountModal.prototype.signOut = function () {\r\n        store.dispatch(logOut());\r\n        this.close();\r\n    };\r\n    MyAccountModal.prototype.componentDidMount = function () {\r\n        _super.prototype.componentDidMount.call(this);\r\n        setUpQTip(this.ref.current);\r\n    };\r\n    MyAccountModal.prototype.onOpen = function () {\r\n        this.setState({ fetchedAccountDetails: false });\r\n        this.refreshAccountDetails();\r\n    };\r\n    MyAccountModal.prototype.toggleStayLoggedIn = function (staySignedIn) {\r\n        if (this.props.auth.state == \"logged_in\") {\r\n            if (staySignedIn) {\r\n                // Store token.\r\n                clog(\"store token to storage\");\r\n                storeToken(this.props.auth.jwtToken);\r\n            }\r\n            else {\r\n                // Erase token.\r\n                clog(\"Clear token\");\r\n                clearToken();\r\n            }\r\n            toastr.success(\"Preference saved.\");\r\n            this.setState({\r\n                staySignedIn: staySignedIn\r\n            });\r\n        }\r\n    };\r\n    MyAccountModal.prototype.refreshAccountDetails = function () {\r\n        var _this = this;\r\n        callApi(\"account/details\", \"GET\", this.props.auth, undefined, {\r\n            success: function (response) {\r\n                // Convert the response to state.\r\n                var accountDetails = response.planDetails;\r\n                _this.setState({ fetchedAccountDetails: true });\r\n                _this.setState((function () {\r\n                    if (!accountDetails) {\r\n                        return { accountDetails: undefined };\r\n                    }\r\n                    switch (accountDetails.type) {\r\n                        case \"individual\":\r\n                            return {\r\n                                accountDetails: {\r\n                                    type: accountDetails.type,\r\n                                    tier: accountDetails.tier,\r\n                                    payment: accountDetails.payment,\r\n                                    currency: accountDetails.currency,\r\n                                    interval: accountDetails.interval,\r\n                                    next_payment_date: new Date(accountDetails.next_payment_date),\r\n                                    auto_renew: accountDetails.auto_renew,\r\n                                    is_trial: accountDetails.is_trial,\r\n                                }\r\n                            };\r\n                        case \"managed\":\r\n                        case \"domain\":\r\n                            return { accountDetails: accountDetails };\r\n                    }\r\n                })());\r\n            },\r\n        });\r\n    };\r\n    return MyAccountModal;\r\n}(Remodal));\r\nexport { MyAccountModal };\r\n/** A row (or section) containing some settings. */\r\nvar Row = function (props) { return React.createElement(React.Fragment, null,\r\n    React.createElement(\"div\", { className: \"row\" },\r\n        React.createElement(\"div\", { className: \"col-12 col-sm-3 text-muted text-sm-right\" },\r\n            React.createElement(\"b\", null, props.heading)),\r\n        React.createElement(\"div\", { className: \"col-12 col-sm-9 text-left\" }, props.children)),\r\n    React.createElement(\"hr\", null)); };\r\nvar CancelPlanConfirmation = function (props) { return (React.createElement(\"div\", { className: \"mt-2 border border-danger rounded text-left p-2\" },\r\n    React.createElement(\"span\", { className: \"text-danger\" },\r\n        React.createElement(\"b\", null, \"Are you sure you want to cancel your subscription? You will lose the following benefits:\")),\r\n    React.createElement(\"ul\", { className: \"fa-ul feature-list mt-1\" },\r\n        React.createElement(Item, { icon: \"image\" },\r\n            React.createElement(\"b\", null, \"High Quality\"),\r\n            \" image export\"),\r\n        React.createElement(BoostFeatureList, null)),\r\n    React.createElement(\"button\", { className: \"ui-button mr-1\", onClick: props.onNoop }, \"No, keep subscription.\"),\r\n    React.createElement(\"button\", { className: \"ui-button mr-1 danger\", onClick: props.onConfirm }, \"Yes, cancel\"))); };\r\n","import { strokeWidth } from \"apparatus/draw\";\r\nimport { SVG } from \"apparatus/svg\";\r\nimport { Group, Shape } from \"paper\";\r\nvar Pump = /** @class */ (function () {\r\n    function Pump() {\r\n    }\r\n    Pump.prototype.render = function (appearance) {\r\n        var _a = SVG.pump(), body = _a.body, insert = _a.insert, cog = _a.cog;\r\n        body.children[0].children[2].strokeWidth = strokeWidth(\"default\");\r\n        insert.children[0].children[1].strokeWidth = strokeWidth(\"thin\");\r\n        cog.children[0].children[1].strokeWidth = strokeWidth(\"thin\");\r\n        insert.rotate(90);\r\n        insert.position.x -= 21;\r\n        insert.position.y -= -18 + 55 * appearance.insertion;\r\n        cog.position.x += 3;\r\n        cog.position.y += 5;\r\n        var graphic = new Group([insert, cog, body]);\r\n        graphic.scale(1.5);\r\n        var hitShape = Shape.Rectangle(graphic.bounds);\r\n        return {\r\n            graphic: graphic, hitShape: hitShape, pivot: body.bounds.center\r\n        };\r\n    };\r\n    Pump.properties = {\r\n        label: \"Pump\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            insertion: 0.5\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"insertion\", label: \"Slide\",\r\n                min: 0, max: 1, step: 0.01, unit: \"%\",\r\n            }\r\n        ],\r\n    };\r\n    return Pump;\r\n}());\r\nexport { Pump };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport store from \"store/store\";\r\nvar ZoomCommand = /** @class */ (function () {\r\n    function ZoomCommand(from, to) {\r\n        this.from = from;\r\n        this.to = to;\r\n    }\r\n    ZoomCommand.prototype.execute = function () {\r\n        store.dispatchFn(\"Zoom\", mutator(this.to));\r\n    };\r\n    ZoomCommand.prototype.undo = function () {\r\n        store.dispatchFn(\"Zoom\", mutator(this.from));\r\n    };\r\n    return ZoomCommand;\r\n}());\r\nexport { ZoomCommand };\r\nfunction mutator(zoom) {\r\n    return function (state) { return (__assign(__assign({}, state), { zoom: zoom })); };\r\n}\r\n","import { setDefaultStyle } from \"apparatus/draw\";\r\nimport { P, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar Spatula = /** @class */ (function () {\r\n    function Spatula() {\r\n    }\r\n    Spatula.prototype.render = function (appearance) {\r\n        var spatula = new Path(Segments([[-20, 0]], [[0, 0]], [[45, -90]]));\r\n        setDefaultStyle(spatula);\r\n        var graphic = new Group([spatula]);\r\n        if (appearance.contents != \"empty\") {\r\n            var contentsColor = appearance.color;\r\n            var strokeColor = contentsColor.color().darken(0.3).hex();\r\n            var pile = new Path(Segments([[-20, 0], undefined, [5, -15]], [[2, 0], [-5, -15]]));\r\n            pile.strokeColor = strokeColor;\r\n            pile.strokeWidth = 2.0;\r\n            pile.fillColor = contentsColor;\r\n            graphic.insertChild(0, pile);\r\n            if (appearance.contents == \"mixture\") {\r\n                // Add some dots.\r\n                var dots = new Group([\r\n                    Shape.Circle(P(-18, -5), 2.0),\r\n                    Shape.Circle(P(-12, -7), 2.0),\r\n                    Shape.Circle(P(-8, -3), 2.0),\r\n                    Shape.Circle(P(-3, -7), 2.0),\r\n                ]);\r\n                dots.fillColor = strokeColor;\r\n                graphic.addChild(dots);\r\n            }\r\n        }\r\n        var hitShape = Shape.Rectangle(graphic.bounds);\r\n        return { graphic: graphic, hitShape: hitShape };\r\n    };\r\n    Spatula.properties = {\r\n        label: \"Spatula\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            contents: \"empty\",\r\n            color: \"#90cc89\",\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"contents\", label: \"Contents\",\r\n                options: [\r\n                    { value: \"empty\", label: \"Empty\" },\r\n                    { value: \"pure\", label: \"Solid\" },\r\n                    { value: \"mixture\", label: \"Powder\" }\r\n                ]\r\n            },\r\n            {\r\n                spec: \"color\", key: \"color\", label: \"Contents colour\",\r\n                visible: function (a) { return a.contents != \"empty\"; }\r\n            }\r\n        ],\r\n    };\r\n    return Spatula;\r\n}());\r\nexport { Spatula };\r\n","import { strokeWidth } from \"apparatus/draw\";\r\nimport { P } from \"apparatus/library/common\";\r\nimport { SVG } from \"apparatus/svg\";\r\nimport { Group, Shape } from \"paper\";\r\nvar Lamp = /** @class */ (function () {\r\n    function Lamp() {\r\n    }\r\n    Lamp.convertToLatest = function (input) {\r\n        if (\"light\" in input) {\r\n            switch (input.light) {\r\n                case \"off\": return { color: \"off\", glow: \"small\", scale: 1.0 };\r\n                case \"noglow\": return { color: \"yellow\", glow: \"off\", scale: 1.0 };\r\n                case \"small\": return { color: \"yellow\", glow: \"small\", scale: 1.0 };\r\n                case \"large\": return { color: \"yellow\", glow: \"large\", scale: 1.0 };\r\n            }\r\n        }\r\n        return input;\r\n    };\r\n    Lamp.prototype.render = function (appearance) {\r\n        var lamp = SVG.bulb();\r\n        lamp.scale(4.0);\r\n        lamp.strokeWidth = strokeWidth(\"thin\");\r\n        var _a = this.lampColors(appearance.color), fill = _a[0], stroke = _a[1], glowColor = _a[2];\r\n        var graphic = new Group([lamp]);\r\n        lamp.children[0].children[0].fillColor = fill;\r\n        lamp.children[0].children[0].strokeColor = stroke;\r\n        if (appearance.color !== \"off\" && appearance.glow != \"off\") {\r\n            // Add glow.\r\n            var radius = appearance.glow == \"large\" ? 150.0 : 50;\r\n            var glow = Shape.Circle(P(5, -5), radius);\r\n            glow.setRadialGradientFill([[glowColor + \"b0\", 0.2], [glowColor + \"00\", 1.0]]);\r\n            graphic.addChild(glow);\r\n        }\r\n        graphic.scale(appearance.scale);\r\n        return { graphic: graphic, hitShape: lamp.bounds.toShape(), pivot: lamp.bounds.center };\r\n    };\r\n    Lamp.prototype.lampColors = function (color) {\r\n        switch (color) {\r\n            case \"off\": return [\"#eeeeee\", \"#bbbbbb\", \"#ffffff\" /* unused */];\r\n            case \"yellow\": return [\"#fce94f\", \"#c4a000\", \"#fff189\"];\r\n            case \"red\": return [\"#ffb99e\", \"#fd3939\", \"#ff957a\"];\r\n            case \"green\": return [\"#def779\", \"#97d435\", \"#aafc83\"];\r\n            case \"blue\": return [\"#75ffff\", \"#3ea8e6\", \"#5192f5\"];\r\n        }\r\n    };\r\n    Lamp.properties = {\r\n        label: \"Bulb\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            color: \"yellow\",\r\n            glow: \"small\",\r\n            scale: 1.0,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.7, max: 2.0, step: 0.01, unit: \"%\",\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"color\", label: \"Color\",\r\n                options: [\r\n                    { value: \"off\", label: \"Off\" },\r\n                    { value: \"yellow\", label: \"Yellow\" },\r\n                    { value: \"red\", label: \"Red\" },\r\n                    { value: \"green\", label: \"Green\" },\r\n                    { value: \"blue\", label: \"Blue\" },\r\n                ]\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"glow\", label: \"Glow\",\r\n                options: [\r\n                    { value: \"off\", label: \"None\" },\r\n                    { value: \"small\", label: \"Small\" },\r\n                    { value: \"large\", label: \"Large\" },\r\n                ],\r\n                visible: function (a) { return a.color !== \"off\"; }\r\n            }\r\n        ],\r\n    };\r\n    return Lamp;\r\n}());\r\nexport { Lamp };\r\n","import { strokeWidth } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar HIGHLIGHT = [\r\n    [\"#fde9ae60\", 0.0],\r\n    [\"#fde9ae00\", 1.0],\r\n];\r\nvar Potato = /** @class */ (function () {\r\n    function Potato() {\r\n    }\r\n    Potato.prototype.render = function (appearance) {\r\n        var graphic = renderFns[appearance.type](appearance);\r\n        graphic.scale(appearance.scale);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.strokeBounds.toShape(),\r\n        };\r\n    };\r\n    Potato.properties = {\r\n        label: \"Potato\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            type: \"whole\",\r\n            scale: 1.0,\r\n            length: 70,\r\n            diameter: 15,\r\n        },\r\n        flippable: true,\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.5, max: 2.0, step: 0.01, unit: \"%\",\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"type\", label: \"Type\",\r\n                options: [\r\n                    { value: \"whole\", label: \"Whole potato\" },\r\n                    { value: \"chip\", label: \"Chip\" },\r\n                    { value: \"cylinder\", label: \"Cylinder (Core)\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"length\", label: \"Length\",\r\n                min: 20, max: 100, unit: \"mm\",\r\n                visible: function (a) { return a.type === \"chip\" || a.type === \"cylinder\"; }\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"diameter\", label: \"Diameter\",\r\n                min: 10, max: 30, unit: \"mm\"\r\n            }\r\n        ],\r\n    };\r\n    return Potato;\r\n}());\r\nexport { Potato };\r\nvar renderFns = {\r\n    \"whole\": renderWhole,\r\n    \"chip\": renderChip,\r\n    \"cylinder\": renderCore,\r\n};\r\nfunction renderWhole(_) {\r\n    var shape = new Path(Segments([[-30, -30], [-21, 15], [27, -20]], [[53, -40], [-18, -13], [26, 19]], [[53, 17], [10, -4], [-43, 18]], [[-40, 32], [45, 22], [-22, -11]]));\r\n    shape.closePath();\r\n    shape.setGradientFill(\"right-down\", [\r\n        [\"#e2b15d\", 0.0],\r\n        [\"#d5a14d\", 0.4],\r\n        [\"#a56314\", 0.9],\r\n    ]);\r\n    shape.withStroke(strokeWidth(\"default\"), \"#775025\");\r\n    var highlight1 = Shape.Circle(P(-25, -12), 30);\r\n    highlight1.setRadialGradientFill(HIGHLIGHT);\r\n    highlight1.scale(1.0, 0.5);\r\n    highlight1.rotate(-30);\r\n    var highlight2 = Shape.Circle(P(30, -26), 20);\r\n    highlight2.setRadialGradientFill(HIGHLIGHT);\r\n    highlight2.scale(1.0, 0.8);\r\n    highlight2.rotate(40);\r\n    return new Group([shape, highlight1, highlight2]);\r\n}\r\nfunction renderChip(a) {\r\n    var diameter = a.diameter, length = a.length;\r\n    return new Group([\r\n        // Light shade.\r\n        Shape.Rectangle(R(0, 0, 0.625 * diameter, length)).withFill(\"#edd090\"),\r\n        // Dark shade.\r\n        Shape.Rectangle(R(0.624 * diameter, 0, 0.376 * diameter, length)).withFill(\"#d9b462\"),\r\n        // Outline.\r\n        Shape.Rectangle(R(0, 0, diameter, length), 2.0).withStroke(strokeWidth(\"thin\"), \"#9a7744\"),\r\n    ]);\r\n}\r\nfunction renderCore(a) {\r\n    var diameter = a.diameter, length = a.length;\r\n    var top = new Path.Ellipse(R(0, 0, diameter, diameter / 2, Pivot.CENTER));\r\n    var bottom = top.clone();\r\n    bottom.position.y += length;\r\n    var body = new Path.Rectangle(R(0, 0, diameter, length, Pivot.TOP_CENTER));\r\n    top.fillColor = \"#f7e1b0\";\r\n    var body3d = body.unite(bottom);\r\n    var outline = body3d.unite(top);\r\n    body3d.withGradientFill(\"left\", Gradients.simple(\"#edd090\".color()));\r\n    bottom.remove();\r\n    body.remove();\r\n    outline.withStroke(strokeWidth(\"default\"), \"#9a7744\");\r\n    return new Group([\r\n        body3d, top, outline\r\n    ]);\r\n}\r\n","import * as React from \"react\";\r\nimport { Articles } from \"support/beacon\";\r\nimport { ChemMark } from \"text/parse\";\r\nimport { Badge } from \"tiers/badge\";\r\nimport { TierContext } from \"tiers/context\";\r\n/**\r\n * Hint UI element explaning how ChemMark works, to be used in the Property panel.\r\n * @param props: showUpgradeHint: if set to true, the upgrade hint will be shown if the user is not upgraded.\r\n */\r\nexport var PropertyPanelHint = function (props) {\r\n    return React.createElement(TierContext.Consumer, null, function (tiers) {\r\n        return React.createElement(\"div\", { className: \"boxed-hint\" },\r\n            \"Automatically converts\",\r\n            React.createElement(\"ul\", null,\r\n                React.createElement(\"li\", null, \"H2SO4 to H\\u2082SO\\u2084\"),\r\n                React.createElement(\"li\", null, \"Mg2+ to Mg\\u00B2\\u207A\"),\r\n                React.createElement(\"li\", null, \"cm3 to cm\\u00B3 \\u2026\")),\r\n            React.createElement(\"a\", { href: \"#\", \"data-beacon-article-sidebar\": Articles.CHEMTEXT }, \"Learn more\"),\r\n            React.createElement(\"br\", null),\r\n            !tiers.tier && props.showUpgradeHint ? React.createElement(\"div\", null,\r\n                React.createElement(\"hr\", null),\r\n                \"On free tier, this feature is \",\r\n                React.createElement(\"b\", null,\r\n                    \"limited to first \",\r\n                    ChemMark.FREE_TIER_CHAR_LIMIT),\r\n                \" letters. After that, \\u26A0\\uFE0F is added. Upgrade to remove this restriction \",\r\n                React.createElement(Badge, { tier: \"boost\" }),\r\n                React.createElement(\"button\", { className: \"ui-button highlight text-center mt-1\", onClick: function () { return tiers.popup(\"ChemText\"); } }, \"Upgrade\")) : undefined);\r\n    });\r\n};\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { DEFAULT_SWATCHES } from \"components/colorpicker\";\r\nvar defaultSwatches = __assign({ \"Black\": \"#000000\", \"Grey 1\": \"#333333\", \"Grey 2\": \"#666666\", \"Grey 3\": \"#999999\", \"Grey 4\": \"#cccccc\", \"White\": \"#ffffff\" }, DEFAULT_SWATCHES);\r\nvar demoSwatches = {\r\n    \"Black\": \"#333333\",\r\n    \"Grey\": \"#666666\",\r\n    'Blue': '#80cce6',\r\n    'Red': '#e33d4d',\r\n    'Green': '#3ac433',\r\n};\r\nvar DEFAULT_STROKE = \"#333333\";\r\nvar DEFAULT_STROKE_THICKNESS = 4.0;\r\nvar MIN_BOUNDS = 40;\r\nexport var BasicShapes;\r\n(function (BasicShapes) {\r\n    var StrokeOnly;\r\n    (function (StrokeOnly) {\r\n        StrokeOnly.defaultAppearance = {\r\n            stroke: DEFAULT_STROKE,\r\n            strokeThickness: DEFAULT_STROKE_THICKNESS\r\n        };\r\n        StrokeOnly.specs = [\r\n            { spec: \"header\", header: \"Stroke\", icon: \"r,square\" },\r\n            {\r\n                spec: \"color\", key: \"stroke\", label: \"Colour\",\r\n                swatches: defaultSwatches,\r\n                demoSwatches: demoSwatches,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"strokeThickness\", label: \"Thickness\",\r\n                tier: \"boost\",\r\n                min: 1, max: 20,\r\n            },\r\n        ];\r\n        function apply(item, appearance) {\r\n            item.strokeWidth = appearance.strokeThickness;\r\n            item.strokeColor = appearance.stroke;\r\n        }\r\n        StrokeOnly.apply = apply;\r\n    })(StrokeOnly = BasicShapes.StrokeOnly || (BasicShapes.StrokeOnly = {}));\r\n    BasicShapes.defaultAppearance = {\r\n        style: \"full\",\r\n        fill: \"#cccccc\",\r\n        fillAlpha: 1.0,\r\n        stroke: DEFAULT_STROKE,\r\n        strokeThickness: DEFAULT_STROKE_THICKNESS\r\n    };\r\n    BasicShapes.header = { spec: \"header\", header: \"Options\", icon: \"shapes\" };\r\n    BasicShapes.specs = [\r\n        {\r\n            spec: \"toggle-buttons\", key: \"style\", label: \"Style\", size: \"large\",\r\n            options: [\r\n                { value: \"full\", label: \"With border\", icon: \"d,square fa-swap-opacity\" },\r\n                { value: \"fill-only\", label: \"No border\", icon: \"square\" },\r\n            ],\r\n        },\r\n        { spec: \"header\", header: \"Fill\", icon: \"square\", visible: function (a) { return a.style == \"full\" || a.style == \"fill-only\"; } },\r\n        {\r\n            spec: \"color\", key: \"fill\", label: \"Colour\",\r\n            swatches: DEFAULT_SWATCHES,\r\n            demoSwatches: demoSwatches,\r\n            opacity: { key: \"fillAlpha\", range: [0, 1] },\r\n            visible: function (a) { return a.style == \"full\" || a.style == \"fill-only\"; }\r\n        },\r\n        { spec: \"header\", header: \"Border\", icon: \"r,square\", visible: function (a) { return a.style == \"full\" || a.style == \"stroke-only\"; } },\r\n        {\r\n            spec: \"color\", key: \"stroke\", label: \"Colour\",\r\n            tier: \"boost\",\r\n            swatches: DEFAULT_SWATCHES,\r\n            demoSwatches: demoSwatches,\r\n            visible: function (a) { return a.style == \"full\" || a.style == \"stroke-only\"; }\r\n        },\r\n        {\r\n            spec: \"slider\", key: \"strokeThickness\", label: \"Thickness\",\r\n            tier: \"boost\",\r\n            min: 1, max: 10,\r\n            visible: function (a) { return a.style == \"full\" || a.style == \"stroke-only\"; }\r\n        },\r\n    ];\r\n    function applyStyle(item, appearance) {\r\n        if (appearance.style == \"full\" || appearance.style == \"stroke-only\") {\r\n            // Draw stroke.\r\n            StrokeOnly.apply(item, appearance);\r\n        }\r\n        if (appearance.style == \"full\" || appearance.style == \"fill-only\") {\r\n            // Draw fill.\r\n            item.fillColor = fillColor(appearance);\r\n        }\r\n    }\r\n    BasicShapes.applyStyle = applyStyle;\r\n    function applyCustom(appearance, setFill, setStroke) {\r\n        if (appearance.style == \"full\" || appearance.style == \"stroke-only\") {\r\n            // Draw stroke.\r\n            setStroke(appearance.strokeThickness, appearance.stroke);\r\n        }\r\n        if (appearance.style == \"full\" || appearance.style == \"fill-only\") {\r\n            // Draw fill.\r\n            setFill(fillColor(appearance));\r\n        }\r\n    }\r\n    BasicShapes.applyCustom = applyCustom;\r\n    function fillColor(appearance) {\r\n        return appearance.fill.color().alpha(appearance.fillAlpha).string();\r\n    }\r\n    BasicShapes.fillColor = fillColor;\r\n    function bounds(item) {\r\n        var bounds = item.strokeBounds;\r\n        var diff = MIN_BOUNDS - Math.min(bounds.height, bounds.width);\r\n        if (diff > 0) {\r\n            bounds = bounds.expand(diff);\r\n        }\r\n        return bounds.toShape();\r\n    }\r\n    BasicShapes.bounds = bounds;\r\n})(BasicShapes || (BasicShapes = {}));\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { setUpQTip } from \"./view/tooltips\";\r\nvar colorClipboard = \"\";\r\n/** Registers extensions for bootstrap color picker */\r\nexport function registerBootstrapColorpickerExtensions() {\r\n    var ExtensionClass = $.colorpicker.Extension;\r\n    $.colorpicker.extensions[\"extrabuttons\"] = /** @class */ (function (_super) {\r\n        __extends(class_1, _super);\r\n        function class_1(a, b) {\r\n            var _this = _super.call(this, a, b) || this;\r\n            _this.element = null;\r\n            return _this;\r\n        }\r\n        class_1.prototype.onCreate = function (e) {\r\n            var colorpicker = this.colorpicker;\r\n            this.element = $(\"<div class='mt-2 clearfix'>\" +\r\n                \"<div class='horizontal-button-group d-block float-left fs-16'>\" +\r\n                \"<div class='ui-button squarer' title='Copy colour'><i class='far fa-copy fa-fw' />&#8203;</div>\" +\r\n                \"<div class='ui-button squarer' title='Paste colour'><i class='far fa-clipboard fa-fw' />&#8203;</div>\" +\r\n                \"</div>\" +\r\n                \"<div class='ui-button squarer d-block float-right fs-16' title='Close'>\" +\r\n                \"<i class='fas fa-times fa-fw' />&#8203;\" +\r\n                \"</div>\" +\r\n                \"</div>\");\r\n            colorpicker.picker.append(this.element);\r\n            // Copy.\r\n            this.element.get(0).childNodes[0].childNodes[0].onclick = function (e) {\r\n                colorClipboard = colorpicker.getValue();\r\n            };\r\n            // Paste.\r\n            this.element.get(0).childNodes[0].childNodes[1].onclick = function (e) {\r\n                if (colorClipboard !== \"\") {\r\n                    colorpicker.setValue(colorClipboard);\r\n                }\r\n            };\r\n            // Close.\r\n            this.element.get(0).childNodes[1].onclick = function (e) {\r\n                // First call to hide does not stick. Have to call it twice.\r\n                colorpicker.hide();\r\n                colorpicker.hide();\r\n            };\r\n            setUpQTip(this.element);\r\n        };\r\n        class_1.prototype.resolveColor = function () { };\r\n        return class_1;\r\n    }(ExtensionClass));\r\n    $.colorpicker.extensions[\"manualinput\"] = /** @class */ (function (_super) {\r\n        __extends(class_2, _super);\r\n        function class_2(a, b) {\r\n            var _this = _super.call(this, a, b) || this;\r\n            _this.element = null;\r\n            return _this;\r\n        }\r\n        class_2.prototype.onCreate = function (e) {\r\n            var colorpicker = this.colorpicker;\r\n            this.element = $(\"<div class='mt-2'>\" +\r\n                \"<input type='text' class='ui-input w-100' />\" +\r\n                \"</div>\");\r\n            colorpicker.picker.append(this.element);\r\n            // Input.\r\n            this.inputField = this.element.get(0).childNodes[0];\r\n            this.inputField.value = colorpicker.getValue();\r\n            this.inputField.onchange = function (e) {\r\n                colorpicker.setValue(e.target.value);\r\n            };\r\n        };\r\n        class_2.prototype.onUpdate = function () {\r\n            var colorpicker = this.colorpicker;\r\n            if (this.inputField) {\r\n                this.inputField.value = colorpicker.getValue();\r\n            }\r\n        };\r\n        return class_2;\r\n    }(ExtensionClass));\r\n}\r\n","var __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, Pivot, R, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar BOTTOM_EDGE_BIT = [\r\n    [[130, 0]],\r\n    [[128, 4], [2, 0]],\r\n    [[115, 4]],\r\n    [[115, 0]],\r\n    [[85, 0]],\r\n    [[85, 4]],\r\n    [[72, 4], , [-2, 0]],\r\n    [[70, 2]],\r\n    [[70, 0]],\r\n    [[8, 0], , [0, -3]],\r\n    [[-8, 0], [0, -3]],\r\n    [[-20, 0]],\r\n];\r\nvar DropCounter = /** @class */ (function () {\r\n    function DropCounter() {\r\n    }\r\n    DropCounter.prototype.render = function (appearance) {\r\n        var top = new Path(Segments.apply(void 0, __spreadArrays([[[-15, -5]],\r\n            [[130, -5]]], BOTTOM_EDGE_BIT))).withFill(\"#777777\").close();\r\n        var shade = new Path(Segments.apply(void 0, __spreadArrays([[[-15, -5]],\r\n            [[130, -5]]], BOTTOM_EDGE_BIT.map(function (s) { return [[s[0][0], s[0][1] + 10], s[1], s[2]]; }), [[[-20, 0]]]))).close();\r\n        var outline = shade.clone();\r\n        outline.withStroke(\"default\", SharedColors.stroke);\r\n        shade.withGradientFill(\"right\", [\r\n            [\"#444444\", 0.08],\r\n            [\"#333333\", 0.081],\r\n            [\"#555555\", 0.18],\r\n            [\"#444444\", 0.181],\r\n            [\"#444444\", 0.59],\r\n            [\"#555555\", 0.61],\r\n            // first bit sticking out.\r\n            [\"#555555\", 0.69],\r\n            [\"#444444\", 0.70],\r\n            // depression bit.\r\n            [\"#444444\", 0.89],\r\n            [\"#555555\", 0.9],\r\n        ]);\r\n        var screw = Shape.Rectangle(R(-15, 3, 20, 5, Pivot.CENTER_RIGHT), 0.0).withFill(\"#aaaaaa\");\r\n        var screwTop = Shape.Rectangle(R(-32, 3, 8, 16, Pivot.CENTER_RIGHT), 2.0)\r\n            .withStroke(\"thin\", SharedColors.stroke)\r\n            .withGradientFill(\"up\", Gradients.simple(\"#555555\".color()));\r\n        var graphic = new Group([screw, screwTop, shade, top, outline]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: [\r\n                { type: \"attachable\", at: P(0, 0) }\r\n            ]\r\n        };\r\n    };\r\n    DropCounter.properties = {\r\n        label: \"Drop Counter\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {},\r\n        appearanceSpecs: [],\r\n    };\r\n    return DropCounter;\r\n}());\r\nexport { DropCounter };\r\n","import { P } from \"apparatus/library/common\";\r\nimport { createTap, Tap as CommonTap } from \"apparatus/library/common/tap\";\r\nvar Tap = /** @class */ (function () {\r\n    function Tap() {\r\n    }\r\n    Tap.prototype.render = function (appearance) {\r\n        var graphic = createTap(appearance.tapOpening);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.expand(10).toShape(),\r\n            pivot: P(0, 0)\r\n        };\r\n    };\r\n    Tap.properties = {\r\n        label: \"Tap\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: CommonTap.defaultAppearance,\r\n        appearanceSpecs: [CommonTap.appearanceSpec],\r\n    };\r\n    return Tap;\r\n}());\r\nexport { Tap };\r\n","import { CenterR, P, Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, PointText, Shape } from \"paper\";\r\nimport { setDefaultStyle } from \"../../draw\";\r\nvar Conductimeter = /** @class */ (function () {\r\n    function Conductimeter() {\r\n        this.drivers = [\r\n            {\r\n                type: \"rectangle\",\r\n                minX: -150, maxX: 150,\r\n                minY: 0, maxY: 200,\r\n                toAppearance: function (p) { return ({ probeX: p.x, probeY: p.y }); },\r\n                fromAppearance: function (a) { return P(a.probeX, a.probeY); },\r\n                scale: 1.0,\r\n            }\r\n        ];\r\n    }\r\n    Conductimeter.prototype.render = function (appearance) {\r\n        var probeOffsetX = appearance.probeX;\r\n        var probeOffsetY = appearance.probeY;\r\n        // Create a reader\r\n        var casing = Shape.Rectangle(R(0, 0, 60, 100, Pivot.TOP_CENTER), 4);\r\n        casing.fillColor = \"#dddddd\";\r\n        setDefaultStyle(casing);\r\n        var screen = Shape.Rectangle(R(0, 7, 46, 25, Pivot.TOP_CENTER), 2);\r\n        screen.strokeWidth = 2.0;\r\n        screen.strokeColor = \"#777777\";\r\n        screen.fillColor = \"white\";\r\n        var button = Shape.Circle(P(-10, 80), 7);\r\n        button.fillColor = \"#5c9adb\";\r\n        button.strokeWidth = 2.0;\r\n        button.strokeColor = \"#3c6fa6\";\r\n        var button2 = Shape.Circle(P(10, 80), 7);\r\n        button2.fillColor = \"#5c9adb\";\r\n        button2.strokeWidth = 2.0;\r\n        button2.strokeColor = \"#3c6fa6\";\r\n        var display = new PointText({\r\n            point: P(0, 25),\r\n            content: appearance.reading,\r\n            fillColor: 'black',\r\n            fontFamily: 'sans-serif',\r\n            fontSize: 15,\r\n            justification: \"center\",\r\n        });\r\n        var unitLabel = new PointText({\r\n            point: P(-20, 50),\r\n            content: appearance.units,\r\n            fillColor: \"#888888\",\r\n            fontFamily: 'sans-serif',\r\n            fontSize: 14,\r\n            justification: \"left\",\r\n        });\r\n        var reader = new Group([casing, screen, display, unitLabel, button, button2]);\r\n        // Create the probe\r\n        var probeRod = Shape.Rectangle(CenterR(0, 60, 10, 120));\r\n        probeRod.setGradientFill(\"right\", [[\"#444444\", 0.0], [\"#222222\", 1.0]]);\r\n        var probeTop = Shape.Rectangle(CenterR(0, 15, 13, 30));\r\n        probeTop.fillColor = \"#cccccc\";\r\n        probeTop.strokeColor = \"#aaaaaa\";\r\n        probeTop.strokeWidth = 2.0;\r\n        var probe = new Group([probeRod, probeTop]);\r\n        probe.position = probe.position.add(P(probeOffsetX, probeOffsetY));\r\n        // Create the wire.\r\n        var wire = new Path(Segments([[0, 100], undefined, [0, 50]], [[probeOffsetX, probeOffsetY], [0, -50]]));\r\n        setDefaultStyle(wire);\r\n        var graphic = new Group([reader, probe, wire]);\r\n        var hitShapes = [\r\n            probe.bounds.toShape(),\r\n            reader.bounds.toShape(),\r\n        ];\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShapes, pivot: casing.bounds.center,\r\n            watermark: P(20, -5)\r\n        };\r\n    };\r\n    Conductimeter.convertToLatest = function (old) {\r\n        if (!old.x) {\r\n            old.probeX = old.position == \"right\" ? 150 : -150;\r\n            old.probeY = 100;\r\n        }\r\n        return old;\r\n    };\r\n    Conductimeter.properties = {\r\n        label: \"Conductimeter\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            reading: \"0.0\",\r\n            units: \"S/cm\",\r\n            probeX: 150,\r\n            probeY: 100,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"text\", key: \"reading\", label: \"Reading\",\r\n                numbersOnly: true, maxLength: 6,\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"units\", label: \"Units\",\r\n                options: [\r\n                    { value: \"S/cm\", label: \"S/cm\" },\r\n                    { value: \"S/m\", label: \"S/m\" },\r\n                ],\r\n            }\r\n        ],\r\n    };\r\n    return Conductimeter;\r\n}());\r\nexport { Conductimeter };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { DEFAULT_SWATCHES } from \"components/colorpicker\";\r\nimport { Path } from \"paper\";\r\nvar PaperClip = /** @class */ (function () {\r\n    function PaperClip() {\r\n    }\r\n    PaperClip.prototype.render = function (appearance) {\r\n        var graphic = new Path(Segments([[-20, 49]], [[-20, -68], , [0, -22]], [[19, -68], [0, -22]], [[19, 105], , [0, 30]], [[-40, 105], [0, 30]], [[-40, -105], , [0, -45]], [[38, -105], [0, -45]], [[38, 48]])).withStroke(appearance.scale * 2, appearance.color);\r\n        graphic.strokeCap = \"round\";\r\n        graphic.scale(appearance.scale * 0.125);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.expand(5).toShape()\r\n        };\r\n    };\r\n    PaperClip.properties = {\r\n        label: \"Paper Clip\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            scale: 1.0,\r\n            color: SharedColors.stroke,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Zoom\",\r\n                min: 1, max: 5, step: 0.01, unit: \"%\",\r\n            },\r\n            {\r\n                spec: \"color\", key: \"color\", label: \"Color\", tier: \"boost\",\r\n                demoSwatches: { \"Default\": SharedColors.stroke, \"Metal\": \"#999999\" },\r\n                swatches: __assign({ \"Default\": SharedColors.stroke, \"Metal\": \"#999999\" }, DEFAULT_SWATCHES)\r\n            }\r\n        ],\r\n    };\r\n    return PaperClip;\r\n}());\r\nexport { PaperClip };\r\n","import { setDefaultStyle } from \"apparatus/draw\";\r\nimport { P, R, Segments } from \"apparatus/library/common\";\r\nimport { Path } from \"paper\";\r\nimport { addEdgeLipsReversed, breakPathClosed, mirrorX } from \"../../draw\";\r\nimport { Interpolator } from \"../common\";\r\n/** Interpolator, converts height to corresponding bulb size. */\r\nvar bulbDiameterLerp = new Interpolator([100, 300], [40, 136]);\r\n/** Interpolator, converts height to corresponding neck diameter. */\r\nvar neckSizeLerp = new Interpolator([100, 300], [18, 28]);\r\n/**\r\n * Based on https://scienceequip.com.au/products/distilling-flasks-fused-quartz\r\n */\r\nvar DistillationFlask = /** @class */ (function () {\r\n    function DistillationFlask() {\r\n    }\r\n    DistillationFlask.prototype.render = function (appearance) {\r\n        var height = appearance.height;\r\n        var bulbDiameter = bulbDiameterLerp.interpolate(height);\r\n        var neckWidth = neckSizeLerp.interpolate(height);\r\n        var bulb = new Path.Circle(P(0, -bulbDiameter / 2), bulbDiameter / 2);\r\n        var neck = new Path(Segments([[neckWidth / 2, -height]], [[neckWidth / 2, -20]]));\r\n        mirrorX(neck);\r\n        addEdgeLipsReversed(neck);\r\n        neck.closePath();\r\n        var outletPivot = P(0, -(height + bulbDiameter) / 2 - 10);\r\n        var outletAngle = 17;\r\n        var outletLength = bulbDiameter / 2 + 50;\r\n        var outlet = new Path.Rectangle(R(0, outletPivot.y, outletLength, 12));\r\n        outlet.rotate(outletAngle, outletPivot);\r\n        var shape = bulb.unite(neck).unite(outlet);\r\n        var liquidMask = shape.clone();\r\n        var graphic = breakPathClosed(shape, 4, 8);\r\n        setDefaultStyle(graphic);\r\n        return {\r\n            graphic: graphic,\r\n            liquidMask: liquidMask,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: [\r\n                { type: \"connectable\", at: P(outletLength, outletPivot.y + 6).rotate(outletAngle, outletPivot), facing: 90 + outletAngle }\r\n            ]\r\n        };\r\n    };\r\n    DistillationFlask.properties = {\r\n        label: \"Distillation Flask\",\r\n        canContainLiquids: true,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            height: 180\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Height\",\r\n                min: 100, max: 300\r\n            }\r\n        ],\r\n    };\r\n    return DistillationFlask;\r\n}());\r\nexport { DistillationFlask };\r\n","import { Consts } from \"vars\";\r\n/** Beacon wrapper */\r\nexport var Bcn;\r\n(function (Bcn) {\r\n    function init() {\r\n        (function (e, t, n) { function a() { var e = t.getElementsByTagName(\"script\")[0], n = t.createElement(\"script\"); n.type = \"text/javascript\", n.async = !0, n.src = \"https://beacon-v2.helpscout.net\", e.parentNode.insertBefore(n, e); } if (e.Beacon = n = function (t, n, a) { e.Beacon.readyQueue.push({ method: t, options: n, data: a }); }, n.readyQueue = [], \"complete\" === t.readyState)\r\n            return a(); e.attachEvent ? e.attachEvent(\"onload\", a) : e.addEventListener(\"load\", a, !1); })(window, document, window.Beacon || function () { });\r\n    }\r\n    Bcn.init = init;\r\n    function load() {\r\n        Beacon('init', '2ee18501-cd54-44e1-8cac-b39bdfac6d17');\r\n    }\r\n    Bcn.load = load;\r\n    function article(id, style) {\r\n        Beacon('article', id, { type: style });\r\n    }\r\n    Bcn.article = article;\r\n    function setSessionData(provider, user, tier) {\r\n        // First reset session data.\r\n        unsetSessionData();\r\n        var data = {\r\n            dbId: user.id,\r\n            adminLink: \"https://chemixapp.appspot.com/admin/lookup?emailOrId=\" + user.id,\r\n            tier: tier !== null && tier !== void 0 ? tier : \"basic\",\r\n            oauthProvider: provider,\r\n            avatar: user.avatarUrl,\r\n            version: Consts.version,\r\n        };\r\n        if (user.email)\r\n            data[\"email\"] = user.email;\r\n        if (provider == \"twitter\" && user.handle)\r\n            data[\"twitterHandle\"] = user.handle;\r\n        if (user.name)\r\n            data[\"name\"] = user.name;\r\n        Beacon('session-data', data);\r\n        // Identify.\r\n        if (user.email) {\r\n            Beacon('identify', { email: user.email });\r\n        }\r\n    }\r\n    Bcn.setSessionData = setSessionData;\r\n    function unsetSessionData() {\r\n        Beacon('reset');\r\n        Beacon('logout');\r\n    }\r\n    Bcn.unsetSessionData = unsetSessionData;\r\n    function open() {\r\n        Beacon('open');\r\n    }\r\n    Bcn.open = open;\r\n    function ask() {\r\n        Beacon('navigate', '/ask/');\r\n        Beacon('open');\r\n    }\r\n    Bcn.ask = ask;\r\n    function openSchoolEnquiry(numberOfStudents) {\r\n        Beacon('prefill', {\r\n            subject: 'Chemix: School subscription',\r\n            text: 'I would like to request a quote for a Chemix subscription for my organisation. \\n\\nOrganisation name: \\nNumber of students (estimate): ' + numberOfStudents,\r\n        });\r\n        Beacon('navigate', '/ask/message/');\r\n        Beacon('open');\r\n    }\r\n    Bcn.openSchoolEnquiry = openSchoolEnquiry;\r\n})(Bcn || (Bcn = {}));\r\n/** Article IDs */\r\nexport var Articles;\r\n(function (Articles) {\r\n    Articles.NEW = \"5fb54c0b46e0fb0017fcd333\";\r\n    Articles.TOS = \"5fb565c04cedfd00165b1a28\";\r\n    Articles.ABOUT = \"5fb524eacff47e00160bb1a7\";\r\n    Articles.SCREEN_TOO_SMALL = \"5fb5673acff47e0017d33160\";\r\n    Articles.CHEMTEXT = \"5fb5690a4cedfd00165b1a34\";\r\n    Articles.IMAGE_FORMATS = \"5fb56a42cff47e0017d33173\";\r\n    Articles.IMAGE_QUALITY = \"5fb56e064cedfd001610e2f9\";\r\n    Articles.SUBSCRIPTIONS = \"5fb564154cedfd001610e2b5\";\r\n    Articles.CHRISTMAS_PROMO = \"5fbafd3a46e0fb0017fce7c8\";\r\n    Articles.LICENSE = \"5fb56603cff47e00160bb3fe\";\r\n})(Articles || (Articles = {}));\r\n","import { addMarkers, mirrorX, setDefaultStyle } from \"apparatus/draw\";\r\nimport { interpolate, P, Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\n/**\r\n * Sources:\r\n *  - https://www.amazon.co.uk/StonyLab-Conical-Centrifuge-Polypropylene-Graduated/dp/B07MYY1WKW/ref=asc_df_B07MYY1WKW/?tag=googshopuk-21&linkCode=df0&hvadid=241063450015&hvpos=1o4&hvnetw=g&hvrand=9989796212979711613&hvpone=&hvptwo=&hvqmt=&hvdev=c&hvdvcmdl=&hvlocint=&hvlocphy=9045901&hvtargid=pla-757694563196&psc=1\r\n *  - https://www.amazon.co.uk/Uotyle-Plastic-Centrifuge-Conical-Graduated/dp/B07SQ1WVZ1/ref=asc_df_B07SQ1WVZ1/?tag=googshopuk-21&linkCode=df0&hvadid=375433463406&hvpos=1o9&hvnetw=g&hvrand=9989796212979711613&hvpone=&hvptwo=&hvqmt=&hvdev=c&hvdvcmdl=&hvlocint=&hvlocphy=9045901&hvtargid=pla-846557735754&psc=1&tag=&ref=&adgrpid=82457261171&hvpone=&hvptwo=&hvadid=375433463406&hvpos=1o9&hvnetw=g&hvrand=9989796212979711613&hvqmt=&hvdev=c&hvdvcmdl=&hvlocint=&hvlocphy=9045901&hvtargid=pla-846557735754\r\n */\r\nvar CentrifugeTube = /** @class */ (function () {\r\n    function CentrifugeTube() {\r\n    }\r\n    CentrifugeTube.prototype.render = function (appearance) {\r\n        var width = interpolate(appearance.size, [10, 50], [20, 30]);\r\n        var height = interpolate(appearance.size, [10, 50], [105, 117]);\r\n        var tapering = interpolate(appearance.size, [10, 50], [25, 17]);\r\n        var shape = new Path(Segments([[width / 2, 0]], [[width / 2, height - tapering]], [[3, height]]));\r\n        mirrorX(shape);\r\n        var liquidMask = shape.clone();\r\n        setDefaultStyle(shape);\r\n        var graphic = new Group([shape]);\r\n        addMarkers(graphic, P(width / 2 - 5, height - tapering), 0, P(0, 10));\r\n        if (appearance.cap) {\r\n            var cap = Shape.Rectangle(R(0, -2, width + 4, 15, Pivot.TOP_CENTER));\r\n            var capColor = capColors[appearance.capColor];\r\n            cap.withStroke(3.0, capColor.color().darken(0.1).hex());\r\n            cap.setGradientFill(\"right\", [\r\n                [capColor.color().lighten(0.1).hex(), 0.0],\r\n                [capColor, 1.0]\r\n            ]);\r\n            graphic.addChild(cap);\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            liquidMask: liquidMask,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    CentrifugeTube.properties = {\r\n        label: \"Centrifuge tube\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            cap: true,\r\n            size: 50,\r\n            capColor: \"blue\",\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 10, max: 50\r\n            },\r\n            {\r\n                spec: \"checkbox\", key: \"cap\", label: \"Show cap\"\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"capColor\", label: \"Cap colour\",\r\n                options: [\r\n                    { value: \"blue\", label: \"Blue\" },\r\n                    { value: \"orange\", label: \"Orange\" },\r\n                    { value: \"white\", label: \"White\" },\r\n                ],\r\n                visible: function (a) { return a.cap; },\r\n            }\r\n        ],\r\n    };\r\n    return CentrifugeTube;\r\n}());\r\nexport { CentrifugeTube };\r\nvar capColors = {\r\n    \"orange\": \"#d9901a\",\r\n    \"blue\": \"#3475b8\",\r\n    \"white\": \"#dddddd\"\r\n};\r\n","/** Evaluates whether two rotations are close to each other. */\r\nexport function areRotationsClose(r1, r2, tolerance) {\r\n    var diff = Math.abs(r1 - r2);\r\n    if (diff > 180)\r\n        diff = 360 - diff;\r\n    return diff <= tolerance;\r\n}\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { mirrorY } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Curve, drawCurve } from \"apparatus/library/shapes/curve\";\r\nimport { Group, Path } from \"paper\";\r\nvar RED_COLOR = \"#BD1E0C\";\r\nvar BLACK_COLOR = \"#222222\";\r\nvar Cable = /** @class */ (function () {\r\n    function Cable() {\r\n        this.drivers = Curve.drivers;\r\n        this.shouldUseBoundsCenter = true;\r\n    }\r\n    Cable.prototype.render = function (appearance) {\r\n        var _a = drawCurve(appearance), path = _a.path, xray = _a.xray;\r\n        path.withStroke(\"thick\", appearance.color);\r\n        var endClip = this.createClip(appearance);\r\n        endClip.position = path.segments[0].point;\r\n        endClip.rotation = path.segments[0].handleOut.angle + 180;\r\n        var startClip = this.createClip(appearance);\r\n        var lastSegment = path.segments[path.segments.length - 1];\r\n        startClip.position = lastSegment.point;\r\n        startClip.rotation = lastSegment.handleIn.angle + 180;\r\n        var graphic = new Group([path, endClip, startClip]);\r\n        return {\r\n            graphic: graphic,\r\n            xray: xray,\r\n            hitShape: graphic.bounds.toShape(),\r\n            pivot: P(0, 0),\r\n        };\r\n    };\r\n    Cable.prototype.createClip = function (appearance) {\r\n        var color = appearance.color.color();\r\n        var casing = new Path(Segments([[0, 0]], [[24, 0]], [[32, 8]], [[32, 14]], [[0, 14]])).close()\r\n            .withGradientFill(\"down\", Gradients.box(color));\r\n        var connector = new Path(Segments([[0, -2]], [[7, -2]], [[15, -2], [-5, -2]], [[18, -2], , [1, 2]])).close();\r\n        mirrorY(connector);\r\n        connector.withGradientFill(\"down\", Gradients.cylinder(SharedColors.gold.color()));\r\n        connector.pivot = P(0, 0);\r\n        connector.position = P(32, 11);\r\n        var group = new Group([connector, casing]);\r\n        group.pivot = P(0, 4);\r\n        return group;\r\n    };\r\n    Cable.properties = {\r\n        label: \"Cable\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: __assign(__assign({}, Curve.properties.defaultAppearance), { color: RED_COLOR }),\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"color\", label: \"Colour\",\r\n                options: [\r\n                    { value: RED_COLOR, label: \"Red\" },\r\n                    { value: BLACK_COLOR, label: \"Black\" },\r\n                ],\r\n            }\r\n        ],\r\n    };\r\n    return Cable;\r\n}());\r\nexport { Cable };\r\n","import { strokeWidth } from \"apparatus/draw\";\r\nimport { P, R } from \"apparatus/library/common\";\r\nimport { Path, Shape } from \"paper\";\r\nvar CoverSlip = /** @class */ (function () {\r\n    function CoverSlip() {\r\n    }\r\n    CoverSlip.prototype.render = function (appearance) {\r\n        var width = appearance.width, height = appearance.height;\r\n        if (appearance.side) {\r\n            var graphic = new Path.Line(P(0, 0), P(width, 0));\r\n            graphic.withStroke(strokeWidth(\"thin\"), \"#999999aa\");\r\n            return {\r\n                graphic: graphic,\r\n                hitShape: graphic.bounds.expand(20).toShape(),\r\n            };\r\n        }\r\n        else {\r\n            var graphic = Shape.Rectangle(R(0, 0, width, height));\r\n            graphic.withStroke(strokeWidth(\"thinner\"), \"#999999aa\").withFill(\"#dddddd40\");\r\n            return {\r\n                graphic: graphic,\r\n                hitShape: graphic.bounds.expand(15).toShape()\r\n            };\r\n        }\r\n    };\r\n    CoverSlip.properties = {\r\n        label: \"Cover slip\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            width: 20,\r\n            height: 20,\r\n            side: false,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"width\", label: \"Width\",\r\n                min: 20, max: 50, unit: \"mm\"\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Height\",\r\n                min: 20, max: 50, unit: \"mm\"\r\n            },\r\n            {\r\n                spec: \"checkbox\", key: \"side\", label: \"View from side\"\r\n            }\r\n        ],\r\n    };\r\n    return CoverSlip;\r\n}());\r\nexport { CoverSlip };\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as React from \"react\";\r\nimport { P } from \"../../apparatus/library/common\";\r\n/**\r\n * Component to display current state of rotation while\r\n * an item or collection of items is being rotated.\r\n * To use this component, instantiate it and update by setting state.\r\n */\r\nvar RotationOverlay = /** @class */ (function (_super) {\r\n    __extends(RotationOverlay, _super);\r\n    function RotationOverlay(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.state = { pivot: P(0, 0), angle: 0 };\r\n        return _this;\r\n    }\r\n    RotationOverlay.prototype.render = function () {\r\n        if (!this.state.type)\r\n            return null;\r\n        var _a = this.state, pivot = _a.pivot, rotation = _a.angle, type = _a.type;\r\n        var labelOffsetX = 155 * Math.sin(rotation.toRadians()) - 30;\r\n        var labelOffsetY = -135 * Math.cos(rotation.toRadians()) - 12;\r\n        return React.createElement(React.Fragment, null,\r\n            React.createElement(\"div\", { id: \"rotation-line\", key: \"guideLine\", style: {\r\n                    left: pivot.x,\r\n                    top: pivot.y - 130,\r\n                    transform: \"rotate(\" + rotation + \"deg)\"\r\n                } }),\r\n            type == \"delta\" ?\r\n                React.createElement(\"div\", { id: \"rotation-base\", key: \"base_line\", style: {\r\n                        left: pivot.x,\r\n                        top: pivot.y - 100,\r\n                    } })\r\n                : null,\r\n            React.createElement(\"div\", { id: \"rotation-info\", key: \"rotationInfo\", style: {\r\n                    left: pivot.x + labelOffsetX,\r\n                    top: pivot.y + labelOffsetY,\r\n                } }, this.label()));\r\n    };\r\n    /** Determine the label to display based on given state. */\r\n    RotationOverlay.prototype.label = function () {\r\n        // Round the rotation to 1 decimal place.\r\n        var rotation = Math.round(this.state.angle * 10) / 10;\r\n        var rotationString = rotation.toFixed(1);\r\n        switch (this.state.type) {\r\n            case \"rotation\":\r\n                return rotationString + \"\\u00B0\";\r\n            case \"delta\":\r\n                return \"\\u0394=\" + (rotation >= 0 ? \"+\" : \"\") + rotation + \"\\u00B0\";\r\n            default:\r\n                return \"\"; // Should not happen\r\n        }\r\n    };\r\n    return RotationOverlay;\r\n}(React.Component));\r\nexport { RotationOverlay };\r\n","import { setDefaultStyle } from \"apparatus/draw\";\r\nimport { Path, Rectangle, Shape } from \"paper\";\r\nimport { Segments } from \"./common\";\r\nvar Tank = /** @class */ (function () {\r\n    function Tank() {\r\n    }\r\n    Tank.prototype.render = function (appearance) {\r\n        var width = appearance.width;\r\n        var height = appearance.height;\r\n        var graphic = new Path(Segments([[0, 0]], [[0, height]], [[width, height]], [[width, 0]]));\r\n        setDefaultStyle(graphic);\r\n        var rect = new Rectangle(0, 0, width, height);\r\n        var hitShape = Shape.Rectangle(rect);\r\n        var liquidMask = new Path.Rectangle(rect);\r\n        return {\r\n            graphic: graphic, hitShape: hitShape, liquidMask: liquidMask,\r\n            snapping: graphic.placeable()\r\n        };\r\n    };\r\n    Tank.properties = {\r\n        label: \"Tank\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            width: 400,\r\n            height: 220,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"width\", label: \"Width\",\r\n                min: 150, max: 600\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Height\",\r\n                min: 80, max: 300\r\n            },\r\n        ],\r\n    };\r\n    return Tank;\r\n}());\r\nexport { Tank };\r\n","import { strokeWidth } from \"apparatus/common\";\r\nimport { P } from \"apparatus/library/common\";\r\nimport { SVG } from \"apparatus/svg\";\r\nimport { Shape } from \"paper\";\r\nvar MagneticStirrer = /** @class */ (function () {\r\n    function MagneticStirrer() {\r\n    }\r\n    MagneticStirrer.prototype.render = function (appearance) {\r\n        var graphic = SVG.magneticStirrer();\r\n        graphic.scale(2.0 * appearance.scale, P(0, 0));\r\n        graphic.children[0].children[5].strokeWidth = strokeWidth(\"thin\");\r\n        graphic.children[0].children[6].strokeWidth = strokeWidth(\"thin\");\r\n        var hitShape = Shape.Rectangle(graphic.bounds);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShape,\r\n            snapping: [\r\n                graphic.placeable(),\r\n                graphic.topEdgeAsPlaceableSurface(),\r\n            ]\r\n        };\r\n    };\r\n    MagneticStirrer.properties = {\r\n        label: \"Magnetic Stirrer\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            scale: 1.0\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.75, max: 1.5, step: 0.05, unit: \"%\",\r\n            }\r\n        ],\r\n    };\r\n    return MagneticStirrer;\r\n}());\r\nexport { MagneticStirrer };\r\nvar StirBar = /** @class */ (function () {\r\n    function StirBar() {\r\n    }\r\n    StirBar.prototype.render = function (appearance) {\r\n        var graphic = SVG.stirbar();\r\n        // Scale vertically to lesser extent compared to horizontal.\r\n        graphic.scale(appearance.scale, (appearance.scale - 1.0) * 0.3 + 1.0);\r\n        var hitShape = Shape.Rectangle(graphic.bounds);\r\n        return { graphic: graphic, hitShape: hitShape };\r\n    };\r\n    StirBar.properties = {\r\n        label: \"Magnetic Stir Bar\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            scale: 1.0\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.75, max: 2.0, step: 0.05\r\n            }\r\n        ],\r\n    };\r\n    return StirBar;\r\n}());\r\nexport { StirBar };\r\n","import { P } from \"apparatus/library/common\";\r\nimport { SVG } from \"apparatus/svg\";\r\nimport { Group, PointText } from \"paper\";\r\nvar Timer = /** @class */ (function () {\r\n    function Timer() {\r\n    }\r\n    Timer.prototype.render = function (appearance) {\r\n        var graphic = new Group([\r\n            SVG.timer().withScale(0.08, P(0, 0)),\r\n            new PointText({\r\n                point: P(45, 30),\r\n                content: appearance.label,\r\n                fillColor: 'black',\r\n                fontFamily: 'sans-serif',\r\n                fontSize: 20,\r\n            })\r\n        ]);\r\n        return { graphic: graphic, hitShape: graphic.bounds.toShape() };\r\n    };\r\n    Timer.properties = {\r\n        label: \"Timer / Stopwatch\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            label: \"1:00\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"text\", key: \"label\", label: \"Label\",\r\n            }\r\n        ],\r\n    };\r\n    return Timer;\r\n}());\r\nexport { Timer };\r\n","// Contains formatting functions, useful for formatting values for display.\r\n/** Converts values from ratio to percentage, e.g. 0.1 => \"10%\". */\r\nexport function toPercent(input) {\r\n    return Math.round(input * 100) + \"%\";\r\n}\r\n","import { setDefaultStyleWithStroke } from \"apparatus/draw\";\r\nimport { SVG } from \"apparatus/svg\";\r\nimport { Shape } from \"paper\";\r\nvar ColdFinger = /** @class */ (function () {\r\n    function ColdFinger() {\r\n    }\r\n    ColdFinger.prototype.render = function (appearance) {\r\n        var graphic = SVG.coldFinger();\r\n        graphic.scale(1.8 * appearance.scale);\r\n        setDefaultStyleWithStroke(\"thinner\", graphic);\r\n        var hitShape = Shape.Rectangle(graphic.bounds);\r\n        return { graphic: graphic, hitShape: hitShape };\r\n    };\r\n    ColdFinger.properties = {\r\n        label: \"Cold Finger\",\r\n        canContainLiquids: true,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            scale: 1.0\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.7, max: 1.3, step: 0.05,\r\n            },\r\n        ],\r\n    };\r\n    return ColdFinger;\r\n}());\r\nexport { ColdFinger };\r\n","import { SVG } from \"apparatus/svg\";\r\nvar Glove = /** @class */ (function () {\r\n    function Glove() {\r\n    }\r\n    Glove.prototype.render = function (appearance) {\r\n        var graphic = SVG.glove();\r\n        graphic.scale(0.2 * appearance.scale);\r\n        return { graphic: graphic, hitShape: graphic.bounds.toShape() };\r\n    };\r\n    Glove.properties = {\r\n        label: \"Glove\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            scale: 1.0\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.5, max: 3, step: 0.1\r\n            }\r\n        ],\r\n    };\r\n    return Glove;\r\n}());\r\nexport { Glove };\r\n","import { breakPath, glassFold, mirrorX, setDefaultStyle, setDefaultStyleWithStroke } from \"apparatus/draw\";\r\nimport { P, Segments } from \"apparatus/library/common\";\r\nimport { Path } from \"paper\";\r\nvar SplashHead = /** @class */ (function () {\r\n    function SplashHead() {\r\n    }\r\n    SplashHead.prototype.render = function (appearance) {\r\n        var shape = new Path(Segments([[9, 0]], [[6, 17]], [[8, 17]], [[8, 31], [-1, -4], [7, 3]], [[26, 58], [0, -16], [0, 17]], [[7, 84], [2, -2]], [[7, 97]], [[9, 98]], [[6, 117]]));\r\n        mirrorX(shape);\r\n        var graphic = breakPath(shape, 9);\r\n        setDefaultStyle(graphic);\r\n        var innerSpout = breakPath(new Path(Segments([[4, 34], [0, -20], [0, 13]], [[-16, 54], [15, 0]], [[-16, 47], , [12, 0]], [[-3, 34], [0, 10], [0, -20]])), 2);\r\n        setDefaultStyleWithStroke(\"thin\", innerSpout);\r\n        graphic.addChild(innerSpout);\r\n        graphic.addChild(glassFold(0, 79, { rotation: 180 }));\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: [\r\n                { type: \"connectable\", at: P(0, 0), facing: 0 },\r\n                { type: \"connectable\", at: P(0, 117), facing: 180 },\r\n            ]\r\n        };\r\n    };\r\n    SplashHead.properties = {\r\n        label: \"Splash head\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {},\r\n        appearanceSpecs: [],\r\n    };\r\n    return SplashHead;\r\n}());\r\nexport { SplashHead };\r\n","import { mirrorX, setDefaultStyle } from \"apparatus/draw\";\r\nimport { Group, Path, PointText, Shape } from \"paper\";\r\nimport { SVG } from \"../svg\";\r\nimport { CenterR, P, Pivot, R, Segments, SharedColors, SharedGradients } from \"./common\";\r\nvar baseDiameter = 75;\r\nvar baseHeight = 15;\r\nvar height = 110; // Total height = height + baseHeight\r\nvar barrelDiameter = 12;\r\nvar largerDiameter = 15;\r\nvar BunsenBurner = /** @class */ (function () {\r\n    function BunsenBurner() {\r\n    }\r\n    BunsenBurner.prototype.render = function (appearance) {\r\n        if (appearance.flame == \"simple\") {\r\n            return this.renderSimple(appearance);\r\n        }\r\n        return this.renderDefault(appearance);\r\n    };\r\n    BunsenBurner.prototype.renderDefault = function (appearance) {\r\n        var base = new Path(Segments([[0, height]], [[barrelDiameter / 2, height], undefined, [2.0, 0.0]], [[baseDiameter / 2, height + baseHeight - 3], [-2.0, 0]], [[baseDiameter / 2, height + baseHeight]]));\r\n        mirrorX(base);\r\n        base.position = P(0, height);\r\n        base.closed = true;\r\n        setDefaultStyle(base);\r\n        base.strokeColor = \"#375587\";\r\n        base.fillColor = \"#477dd9\";\r\n        var barrel = this.barrel();\r\n        var collar = this.collar(appearance.collar);\r\n        var tip = Shape.Rectangle(R(0, 0, largerDiameter, 18, Pivot.TOP_CENTER))\r\n            .withStroke(\"thinner\", SharedColors.mediumMetal)\r\n            .withGradientFill(\"right\", SharedGradients.metal);\r\n        var gasInlet = new Path(Segments([[2, 0]], [[2, 10]], [[3, 10]], [[2, 15]], [[3, 15]], [[2, 20]], [[3, 20]], [[1, 25]]));\r\n        mirrorX(gasInlet);\r\n        gasInlet.closePath();\r\n        gasInlet.setGradientFill(\"left\", SharedGradients.metal);\r\n        gasInlet.rotate(-90);\r\n        gasInlet.position = P(15, height - 20);\r\n        gasInlet.withStroke(\"thinner\", SharedColors.mediumMetal);\r\n        var graphic = new Group([gasInlet, barrel, base, collar, tip]);\r\n        var hitShapes = [Shape.Rectangle(graphic.bounds)];\r\n        // Add flame if specified\r\n        var flame = this.flame(appearance);\r\n        if (flame) {\r\n            flame.scale(appearance.scale);\r\n            flame.position.x = 0;\r\n            flame.position.y = 0;\r\n            graphic.addChild(flame);\r\n            hitShapes.push(Shape.Rectangle(flame.bounds));\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShapes,\r\n            pivot: P(0, height / 2),\r\n            snapping: graphic.placeable(),\r\n        };\r\n    };\r\n    BunsenBurner.prototype.renderSimple = function (appearance) {\r\n        var text = new PointText({\r\n            point: P(0, 40),\r\n            content: \"HEAT\",\r\n            fillColor: 'black',\r\n            fontFamily: 'sans-serif',\r\n            fontSize: 40,\r\n            justification: 'center'\r\n        });\r\n        var arrow = new Path(Segments([[0, -60]], [[22, -22]], [[7, -22]], [[7, 0]], [[-7, 0]], [[-7, -22]], [[-22, -22]]));\r\n        arrow.closePath();\r\n        arrow.fillColor = \"#de3a3a\";\r\n        var graphic = new Group([arrow, text]);\r\n        graphic.scale(appearance.scale);\r\n        return { graphic: graphic, hitShape: graphic.bounds.toShape() };\r\n    };\r\n    BunsenBurner.prototype.barrel = function () {\r\n        var barrel = Shape.Rectangle(R(0, 0, barrelDiameter, height, Pivot.TOP_CENTER));\r\n        var vent = Shape.Rectangle(CenterR(0, 70, 6, 10), 2);\r\n        vent.setGradientFill(\"down\", [[\"#222222\", 0.0], [\"#666666\", 1.0]]);\r\n        barrel\r\n            .withStroke(\"thinner\", SharedColors.mediumMetal)\r\n            .setGradientFill(\"right\", SharedGradients.metal);\r\n        var gasJet = Shape.Rectangle(CenterR(0, 73, 2, 4));\r\n        gasJet.fillColor = \"#b5ac57\";\r\n        return new Group([barrel, vent, gasJet]);\r\n    };\r\n    BunsenBurner.prototype.collar = function (valveOpening) {\r\n        var collar = new Path.Rectangle(CenterR(0, 70, largerDiameter, 20));\r\n        var vent = new Path.Rectangle(CenterR(0, 70, largerDiameter - 6, 14), 4);\r\n        vent.position.x += valveOpening * (largerDiameter / 2 + 7);\r\n        var collarWithVent = collar.subtract(vent);\r\n        collarWithVent\r\n            .withStroke(\"thinner\", SharedColors.mediumMetal)\r\n            .setGradientFill(\"right\", SharedGradients.metal);\r\n        return collarWithVent;\r\n    };\r\n    BunsenBurner.prototype.flame = function (appearance) {\r\n        switch (appearance.flame) {\r\n            case \"red\":\r\n                switch (appearance.shape) {\r\n                    case \"straight\":\r\n                        return SVG.redFlame();\r\n                    case \"flat\":\r\n                    default:\r\n                        return SVG.redFlameFlat();\r\n                }\r\n            case \"blue\":\r\n                switch (appearance.shape) {\r\n                    case \"straight\":\r\n                        return SVG.blueFlame();\r\n                    case \"flat\":\r\n                    default:\r\n                        return SVG.blueFlameFlat();\r\n                }\r\n            case \"off\":\r\n            case \"simple\":\r\n                return;\r\n        }\r\n    };\r\n    BunsenBurner.properties = {\r\n        label: \"Bunsen Burner\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            flame: \"red\",\r\n            shape: \"straight\",\r\n            scale: 1.0,\r\n            collar: 0,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"flame\", label: \"Flame heat\",\r\n                options: [\r\n                    { value: \"off\", label: \"Off\" },\r\n                    { value: \"red\", label: \"Red flame (Low heat)\" },\r\n                    { value: \"blue\", label: \"Blue flame (High heat)\" },\r\n                    { value: \"simple\", label: \"Simple\" } // LAUNCH_IN_3.2.0\r\n                ]\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"shape\", label: \"Flame shape\",\r\n                options: [\r\n                    { value: \"straight\", label: \"Straight up\" },\r\n                    { value: \"flat\", label: \"Flattened\" },\r\n                ],\r\n                visible: function (a) { return a.flame != \"simple\"; }\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Flame size\",\r\n                min: 0.5, max: 1.5, step: 0.05\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"collar\", label: \"Adjust collar (vents)\",\r\n                min: -1, max: 1, step: 0.05,\r\n                visible: function (a) { return a.flame != \"simple\"; },\r\n                tier: \"boost\",\r\n            },\r\n        ],\r\n    };\r\n    return BunsenBurner;\r\n}());\r\nexport { BunsenBurner };\r\n","import { P } from \"apparatus/library/common\";\r\nimport \"ext/color\";\r\nimport { Shape } from \"paper\";\r\nvar TLCSpot = /** @class */ (function () {\r\n    function TLCSpot() {\r\n    }\r\n    // static isBoostRequiredForAppearance(a: TLCSpotAppearance) {\r\n    //     return a.type == \"blur\"\r\n    // }\r\n    TLCSpot.prototype.render = function (appearance) {\r\n        var baseColor = appearance.color;\r\n        // Create a circle of diameter <size> * 4, i.e radius of <size> * 2\r\n        var graphic = Shape.Circle(P(0, 0), appearance.size * 2);\r\n        graphic.scale(1.0, appearance.thin);\r\n        if (appearance.type == \"solid\") {\r\n            graphic.fillColor = baseColor;\r\n        }\r\n        else {\r\n            var gradient = [\r\n                [baseColor, 1.0 - appearance.blurAmount],\r\n                [baseColor + \"00\", 1.0]\r\n            ];\r\n            graphic.setRadialGradientFill(gradient);\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.expand(5).toShape(),\r\n            snapping: { type: \"tlc_spot\", at: P(0, 0) }\r\n        };\r\n    };\r\n    TLCSpot.properties = {\r\n        label: \"Chromatography Spot\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            type: \"solid\",\r\n            blurAmount: 0.5,\r\n            color: \"#47aa31\",\r\n            size: 6,\r\n            thin: 1.0,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"color\", key: \"color\", label: \"Colour\",\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 2, max: 10, unit: \"mm\"\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"thin\", label: \"Thin/Thick\",\r\n                min: 0.4, max: 4.0, step: 0.1, unit: \"%\",\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"type\", label: \"Presentation\",\r\n                options: [\r\n                    { value: \"solid\", label: \"Solid\" },\r\n                    { value: \"blur\", label: \"Blurred\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"blurAmount\", label: \"Blur amount\", tier: \"boost\",\r\n                min: 0.0, max: 1.0, step: 0.05, unit: \"%\",\r\n                visible: function (a) { return a.type == \"blur\"; }\r\n            },\r\n        ],\r\n    };\r\n    return TLCSpot;\r\n}());\r\nexport { TLCSpot };\r\n","/**\r\n * Chemix document version.\r\n * 1 - Default version\r\n * 2 - Add support for groups\r\n * 3 - Add support for theme. (Stroke width only.)\r\n */\r\nexport var CURRENT_CHEMIX_DOCUMENT_VERSION = 3;\r\n","import { mirrorX } from \"apparatus/draw\";\r\nimport { CenterR, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nimport { breakPath, setDefaultStyle } from \"../../draw\";\r\nvar WashBottle = /** @class */ (function () {\r\n    function WashBottle() {\r\n    }\r\n    WashBottle.prototype.render = function (appearance) {\r\n        var size = appearance.size;\r\n        var totalHeight = 30 + size;\r\n        var width = Math.min(40, 15 + size / 5);\r\n        var bottle = new Path(Segments([[12, 0]], [[12, 10], undefined, [0, 10]], [[width, 30], [0, -15]], [[width, totalHeight - 5], undefined, [0, 4]], [[width - 5, totalHeight]]));\r\n        mirrorX(bottle);\r\n        var liquidMask = bottle.clone();\r\n        setDefaultStyle(bottle);\r\n        // Draw the tube.\r\n        var tube = new Path(Segments([[4, totalHeight - 20]], [[4, -40], undefined, [0, -15]], [[-15, -55], [10, -8]], [[-70, -10]], [[-70, 0]], [[-15, -45], undefined, [9, -7]], [[-4, -36], [0, -8]], [[-4, totalHeight - 20]]));\r\n        var newTube = breakPath(tube, 4);\r\n        setDefaultStyle(newTube);\r\n        // Draw the cap.\r\n        var cap = CenterR(0, 0, 25, 15).toShape();\r\n        setDefaultStyle(cap);\r\n        cap.fillColor = \"white\";\r\n        var graphic = new Group([bottle, newTube, cap]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            liquidMask: liquidMask,\r\n            snapping: graphic.placeable(),\r\n        };\r\n    };\r\n    WashBottle.properties = {\r\n        label: \"Wash Bottle\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            size: 100\r\n        },\r\n        flippable: true,\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 70, max: 150\r\n            }\r\n        ],\r\n    };\r\n    return WashBottle;\r\n}());\r\nexport { WashBottle };\r\n","import { g } from \"analytics\";\r\nimport { createApparatus } from \"apparatus/library\";\r\nimport { categoryToModuleMap } from \"apparatus/specs\";\r\nimport { AddApparatus, Deselect, Select } from \"command/basic\";\r\nimport { commandProcessor, Sequence } from \"command/command\";\r\nimport * as React from \"react\";\r\nimport store from \"store/store\";\r\nimport { TierContext } from \"tiers/context\";\r\nimport { crumb } from \"utils\";\r\n/** Clickable item that displays a single apparatus item.  */\r\nexport var ApparatusItem = function (props) {\r\n    var tiers = React.useContext(TierContext);\r\n    /** Adds the apparatus. */\r\n    var addApparatus = function () {\r\n        g(\"Add apparatus\" + (props.isSearchMode ? \":search\" : \"\"), props.type);\r\n        crumb(\"ui\", \"Add \" + props.type);\r\n        var apparatusData = createApparatus(props.type, paper.project.view.center);\r\n        var commands = [\r\n            new AddApparatus([apparatusData]),\r\n            new Deselect(store.selectedObjectsID()),\r\n            new Select([apparatusData.id])\r\n        ];\r\n        commandProcessor.execute(new Sequence(commands));\r\n    };\r\n    var spritePositionX, spritePositionY;\r\n    var extraClass = \"\";\r\n    if (props.sprite.length == 3) {\r\n        // New specification for multiple sheets.\r\n        spritePositionX = -props.sprite[1] * 40;\r\n        spritePositionY = -props.sprite[2] * 40;\r\n        extraClass = \"sprite-sheet-\" + props.sprite[0];\r\n    }\r\n    else {\r\n        spritePositionX = -props.sprite[0] * 40;\r\n        spritePositionY = -props.sprite[1] * 40;\r\n    }\r\n    function onClick() {\r\n        // Always add apparatus. If it's tier-locked,\r\n        // this is handled by the editor_canvas via watermarking.\r\n        addApparatus();\r\n    }\r\n    return React.createElement(\"div\", { className: \"apparatus-item\", key: \"item\", onClick: onClick },\r\n        React.createElement(\"img\", { className: \"apparatus-preview \" + extraClass, key: \"preview\", src: \"./images/1.png\", style: {\r\n                backgroundPosition: spritePositionX + \"px \" + spritePositionY + \"px\"\r\n            } }),\r\n        React.createElement(\"span\", { className: \"name\", key: \"text\" },\r\n            React.createElement(\"span\", { className: \"apparatus-name\", key: \"name\" }, props.name),\r\n            tiers.badge(props),\r\n            props.showCategory\r\n                ? React.createElement(\"span\", { className: \"sub d-block\", key: \"sub\" },\r\n                    React.createElement(\"i\", { className: \"fa fa-\" + categoryToModuleMap[props.category].icon }),\r\n                    \"\\u00A0\",\r\n                    categoryToModuleMap[props.category].display,\r\n                    \" > \",\r\n                    props.category.displaySpecial())\r\n                : null));\r\n};\r\nexport var UsageVisualiser = function (props) {\r\n    return React.createElement(\"span\", { style: { height: \"20px\", width: props.widthRatio * 100 + \"%\", background: \"red\", display: \"block\", position: \"absolute\" } });\r\n};\r\n","import { strokeWidth } from \"apparatus/draw\";\r\nimport { P, Segments } from \"apparatus/library/common\";\r\nimport { CompoundPath, Group, Path, Shape } from \"paper\";\r\nvar GREEN = \"#31c458\";\r\nvar YELLOW = \"#e6de49\";\r\nvar Scissors = /** @class */ (function () {\r\n    function Scissors() {\r\n    }\r\n    Scissors.prototype.render = function (appearance) {\r\n        var blade = new Path(Segments([[-74, 10]], [[-65, 17], [-10, 1], [20, -3]], [[5, 7]], [[19, -5]], [[15, -13]]));\r\n        blade.closePath();\r\n        var handleOuter = new Path(Segments([[15, -15]], [[36, -22], [-13, 6], [23, -11]], [[83, -55], [-16, 4], [15, -3]], [[113, -38], [-4, -12], [3, 10]], [[101, -16], [9, -2], [-38, 7]], [[20, -3]]));\r\n        handleOuter.closePath();\r\n        var handleInner = new Path(Segments([[88, -46], [-14, 1], [15, -1]], [[100, -25], [13, -4], [-13, 4]], [[66, -25], [6, 8], [-4, -6]]));\r\n        handleInner.closePath();\r\n        var handle = new CompoundPath({ children: [handleOuter, handleInner] });\r\n        handle.fillRule = \"evenodd\";\r\n        var handleStroke = appearance.handleColor.color().desaturate(0.15).darken(0.2).hex();\r\n        blade.withStroke(strokeWidth(\"thin\"), \"#777777\").withFill(\"#dddddd\");\r\n        handle.withStroke(strokeWidth(\"thin\"), handleStroke).withFill(appearance.handleColor);\r\n        var part1 = new Group([blade, handle]);\r\n        part1.rotate(8 - appearance.opening, P(0, 0));\r\n        var part2 = part1.clone();\r\n        part2.children[0].fillColor = \"#bbbbbb\";\r\n        part2.scale(1.0, -1.0, P(0, 0));\r\n        if (appearance.handleColor === GREEN) {\r\n            part2.children[1].fillColor = YELLOW;\r\n            part2.children[1].strokeColor = YELLOW.color().desaturate(0.15).darken(0.2).hex();\r\n        }\r\n        var graphic = new Group([part2, part1, Shape.Circle(P(0, 0), 2.0).withFill(\"#777777\")]);\r\n        if (appearance.leftie) {\r\n            graphic.scale(1.0, -1.0);\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            pivot: P(0, 0),\r\n        };\r\n    };\r\n    Scissors.properties = {\r\n        label: \"Scissors\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            opening: 20,\r\n            handleColor: \"#c44231\",\r\n            leftie: false,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"opening\", label: \"Opening\",\r\n                min: 0, max: 40, unit: \"\"\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"handleColor\", label: \"Handle colour\",\r\n                options: [\r\n                    { value: \"#c44231\", label: \"Red\" },\r\n                    { value: \"#5395db\", label: \"Blue\" },\r\n                    { value: \"#444444\", label: \"Black\" },\r\n                    { value: GREEN, label: \"Green/Yellow\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"checkbox\", key: \"leftie\", label: \"Left-handed\"\r\n            }\r\n        ],\r\n    };\r\n    return Scissors;\r\n}());\r\nexport { Scissors };\r\n","import { mirrorX } from \"apparatus/draw\";\r\nimport { P, Pivot, Polar, R, RP, S, Segments } from \"apparatus/library/common\";\r\nimport { CompoundPath, Group, Path, Shape } from \"paper\";\r\nvar Solenoid = /** @class */ (function () {\r\n    function Solenoid() {\r\n    }\r\n    Solenoid.prototype.render = function (appearance) {\r\n        var coilBack = new CompoundPath([]).withStroke(\"thick\");\r\n        coilBack.strokeCap = \"round\";\r\n        var coilFront = new CompoundPath([]).withStroke(\"thick\");\r\n        coilFront.strokeCap = \"round\";\r\n        var coilStep = 20;\r\n        var coilHeight = 50;\r\n        var coils = 10;\r\n        var width = coilStep * coils;\r\n        var coilBackStep = P(coilStep / 2, coilHeight);\r\n        var coilBackStepHandle = coilBackStep.add(P(10, 0));\r\n        var coilFrontStep = P(coilStep / 2, -coilHeight);\r\n        var coilFrontStepHandle = coilFrontStep.add(P(-10, 0));\r\n        for (var i = 0; i < coils; i++) {\r\n            coilBack.moveTo(P(i * coilStep, -coilHeight / 2));\r\n            coilBack.cubicCurveBy(P(10, 0), coilBackStepHandle, coilBackStep);\r\n            coilFront.moveTo(P((i + 0.5) * coilStep, coilHeight / 2));\r\n            coilFront.cubicCurveBy(P(-10, 0), coilFrontStepHandle, coilFrontStep);\r\n        }\r\n        var leftFrontWire = new Path(Segments([[-10, 80]], [[0, -coilHeight / 2], [-15, 0]])).withStroke(\"thick\");\r\n        var rightBackWire = new Path(Segments([[0, -coilHeight / 2], , [15, 0]], [[10, 80]])).withStroke(\"thick\");\r\n        rightBackWire.position.x += width;\r\n        var bar = new Path.Rectangle(R(0, 0, width, coilHeight * 0.74, Pivot.CENTER_LEFT))\r\n            .withStroke(\"default\").withFill(\"#d7a558\");\r\n        var magneticLines = new Group();\r\n        if (appearance.fieldLines) {\r\n            var magneticLinesCount = 2;\r\n            for (var i = 0; i < magneticLinesCount; i++) {\r\n                var y = (magneticLinesCount - i - 0.5) * coilHeight / (2 * (magneticLinesCount + 1));\r\n                var line = new Path([\r\n                    S(P(width / 2, y)),\r\n                    S(P(0, y), P(10, 0), P(-20, 0)),\r\n                    S(P(-width * 0.2 * (i + 1), coilHeight * (0.5 + 0.2 * (i + 1))), Polar(coilHeight * 0.3, -20).multiply(i + 1), // down\r\n                    Polar(coilHeight * 0.7, -20 + 180).multiply(i + 1))\r\n                ]);\r\n                mirrorX(line, width / 2);\r\n                var mirrored = line.clone();\r\n                line.scale(1, -1, P(0, 0));\r\n                magneticLines.addChildren([line, mirrored]);\r\n                var middleOfTheLine = line.getPointAt(line.length * 0.5);\r\n                var arrow = new Path([\r\n                    S(middleOfTheLine),\r\n                    S(middleOfTheLine.add(P(-5, 3))),\r\n                    S(middleOfTheLine.add(P(-5, -3))),\r\n                ]).close().withFill(\"#3020ff\");\r\n                var mirroredArrow = arrow.clone();\r\n                arrow.scale(1, -1, P(0, 0));\r\n                magneticLines.addChildren([arrow, mirroredArrow]);\r\n            }\r\n            magneticLines.withStroke(\"thin\", \"#3020ff\");\r\n        }\r\n        var graphic = new Group([coilBack, rightBackWire, magneticLines, bar, coilFront, leftFrontWire]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: Shape.Rectangle(RP(-10, -coilHeight / 2, coils * coilStep + 10, 60)),\r\n            pivot: bar.bounds.center,\r\n        };\r\n    };\r\n    Solenoid.properties = {\r\n        label: \"Solenoid\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            fieldLines: false,\r\n        },\r\n        appearanceSpecs: [\r\n            { spec: \"checkbox\", key: \"fieldLines\", label: \"Show\", subLabel: \"Field lines\" }\r\n        ],\r\n    };\r\n    return Solenoid;\r\n}());\r\nexport { Solenoid };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { Group, Path } from \"paper\";\r\nimport { addMarkers, mirrorX, setDefaultStyle } from \"../draw\";\r\nimport { DEFAULT_LIQUID_DATA, markerSpacing, P, Segments } from \"./common\";\r\nvar GasSyringe = /** @class */ (function () {\r\n    function GasSyringe() {\r\n    }\r\n    GasSyringe.prototype.render = function (appearance) {\r\n        var length = appearance.size;\r\n        var diameter = length / 4 + 4;\r\n        var outletLength = 15;\r\n        var radius = diameter / 2;\r\n        var plungerRadius = radius - 2;\r\n        var outletRadius = 4;\r\n        var body = new Path(Segments(\r\n        // Start from the tip\r\n        [[outletRadius, length + outletLength]], [[outletRadius, length]], [[radius, length - 3], [0, 3]], // Slight rounded corner\r\n        [[radius, 0], undefined, [20, -2]]));\r\n        mirrorX(body);\r\n        var liquidMask = body.clone();\r\n        setDefaultStyle(body);\r\n        // Plunger.\r\n        var plunger = new Path(Segments([[plungerRadius, length - 5], [0, 3]], [[plungerRadius, -2], undefined, [30, -1]]));\r\n        mirrorX(plunger);\r\n        plunger.closePath();\r\n        setDefaultStyle(plunger);\r\n        plunger.fillColor = \"#eeeeee\";\r\n        plunger.position.y -= appearance.plungerSlide * length;\r\n        var graphic = new Group([body, plunger]);\r\n        addMarkers(graphic, P(plungerRadius - 5, length), 0, P(0, markerSpacing));\r\n        return {\r\n            graphic: graphic,\r\n            liquidMask: liquidMask,\r\n            hitShape: [body.bounds.toShape(), plunger.bounds.toShape()],\r\n            pivot: body.bounds.center,\r\n            snapping: {\r\n                type: \"connectable\", at: P(0, length + outletLength), facing: 180,\r\n            }\r\n        };\r\n    };\r\n    GasSyringe.properties = {\r\n        label: \"Gas Syringe\",\r\n        canContainLiquids: true,\r\n        defaultLiquidData: __assign(__assign({}, DEFAULT_LIQUID_DATA), { amountRatio: 0.3 }),\r\n        defaultAppearance: {\r\n            plungerSlide: 0.4,\r\n            size: 120,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"plungerSlide\", label: \"Plunger slide\",\r\n                min: 0.0, max: 0.95, step: 0.01,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 80, max: 200\r\n            }\r\n        ],\r\n    };\r\n    return GasSyringe;\r\n}());\r\nexport { GasSyringe };\r\n","import { R } from \"apparatus/library/common\";\r\nimport { Shape } from \"paper\";\r\nvar Splint = /** @class */ (function () {\r\n    function Splint() {\r\n    }\r\n    Splint.prototype.render = function (appearance) {\r\n        var width = appearance.width;\r\n        var length = appearance.length;\r\n        var graphic = Shape.Rectangle(R(0, 0, width, length), width / 2)\r\n            .withFill(\"#ddc292\")\r\n            .withStroke(\"thinner\", \"#b69660\");\r\n        return { graphic: graphic, hitShape: graphic.bounds.expand(15).toShape() };\r\n    };\r\n    Splint.properties = {\r\n        label: \"Wooden Splint\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            length: 140,\r\n            width: 8\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"length\", label: \"Length\",\r\n                min: 100, max: 180\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"width\", label: \"Width\",\r\n                min: 5, max: 12,\r\n            }\r\n        ],\r\n    };\r\n    return Splint;\r\n}());\r\nexport { Splint };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { P } from \"apparatus/library/common\";\r\nimport { DEMO_COLOUR_SWATCHES, FONT_FAMILY_OPTIONS, TEXT_COLOUR_SWATCHES } from \"apparatus/text/appearance\";\r\nimport { Group, PointText, Shape } from \"paper\";\r\nimport { appStore } from \"store/store\";\r\nimport { ChemMark } from \"text/parse\";\r\nimport { AdvancedText } from \"../../../text/render\";\r\nvar Label = /** @class */ (function () {\r\n    function Label() {\r\n        this.advancedText = new AdvancedText();\r\n        this.advancedText2 = new AdvancedText();\r\n    }\r\n    Label.prototype.render = function (appearance) {\r\n        var fontFamily = appearance.fontFamily, fontSize = appearance.fontSize, textColor = appearance.textColor, text = appearance.text, text2 = appearance.text2, isChemMarkEnabled = appearance.isChemMarkEnabled;\r\n        var textItem1 = this.renderText(this.advancedText, text, fontFamily, fontSize, textColor, P(0, 0), isChemMarkEnabled);\r\n        var graphic = new Group([textItem1]);\r\n        // Add a second, subtitle line. Note the font size is slightly smaller.\r\n        if (appearance.text2.length > 0) {\r\n            var textItem2 = this.renderText(this.advancedText2, text2, fontFamily, fontSize * 0.8, textColor, P(0, fontSize * 2), isChemMarkEnabled);\r\n            graphic.addChild(textItem2);\r\n            // To center, shift each item by half its width. Only if chemMark is not enabled.\r\n            if (!isChemMarkEnabled) {\r\n                textItem1.position.x -= textItem1.bounds.width / 2;\r\n                textItem2.position.x -= textItem2.bounds.width / 2;\r\n            }\r\n        }\r\n        if (appearance.showBorder) {\r\n            var radius = appearance.roundedCorners ? 4.0 : 0.0;\r\n            var sticker = Shape.Rectangle(graphic.bounds.expand(10.0), radius);\r\n            sticker.fillColor = \"#ffffffcc\"; // Transparent white\r\n            sticker.strokeColor = \"#444444\";\r\n            sticker.strokeWidth = 3.0;\r\n            graphic.insertChild(0, sticker);\r\n        }\r\n        return { graphic: graphic, hitShape: graphic.bounds.toShape() };\r\n    };\r\n    Label.prototype.renderText = function (field, text, fontFamily, fontSize, color, position, isChemMarkEnabled) {\r\n        var sharedStyle = {\r\n            fontFamily: fontFamily,\r\n            fontSize: fontSize * 2,\r\n            fillColor: color,\r\n        };\r\n        if (isChemMarkEnabled) {\r\n            // TODO: This is hacky, accessing appstore directly for tier.\r\n            var formattedText = appStore.getState().tier ? ChemMark.parseSmart(text) : ChemMark.parseSmartLimited(text);\r\n            var style = __assign(__assign({}, sharedStyle), { textAlign: \"left\" });\r\n            field.setText(formattedText, style);\r\n            field.setPosition(position.x, position.y);\r\n            return field.container;\r\n        }\r\n        else {\r\n            return new PointText(__assign({ point: position, content: text }, sharedStyle));\r\n        }\r\n    };\r\n    Label.properties = {\r\n        label: \"Label\",\r\n        canContainLiquids: false,\r\n        chemMarkAppearanceKey: \"isChemMarkEnabled\",\r\n        defaultAppearance: {\r\n            text: \"Label\",\r\n            text2: \"\",\r\n            fontSize: 10,\r\n            fontFamily: \"sans-serif\",\r\n            isChemMarkEnabled: false,\r\n            textColor: \"#000000\",\r\n            textAlign: \"left\",\r\n            showBorder: true,\r\n            roundedCorners: false,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"text\", key: \"text\", label: \"Label text\",\r\n                maxLength: 100, enableReplacements: true,\r\n            },\r\n            {\r\n                spec: \"text\", key: \"text2\", label: \"Subtitle text\",\r\n                maxLength: 100, enableReplacements: true, tier: \"boost\",\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"fontSize\", label: \"Text size\",\r\n                min: 4, max: 16, step: 0.5\r\n            },\r\n            {\r\n                spec: \"select\", key: \"fontFamily\", label: \"Font\",\r\n                options: FONT_FAMILY_OPTIONS\r\n            },\r\n            {\r\n                spec: \"color\", key: \"textColor\", label: \"Text colour\",\r\n                swatches: TEXT_COLOUR_SWATCHES,\r\n                tier: \"boost\", demoSwatches: DEMO_COLOUR_SWATCHES,\r\n            },\r\n            {\r\n                spec: \"checkbox-group\", label: \"Border\",\r\n                checkboxes: [\r\n                    { key: \"showBorder\", label: \"Show\", tier: \"boost\" },\r\n                    { key: \"roundedCorners\", label: \"Rounded\", tier: \"boost\", visible: function (a) { return a.showBorder; } },\r\n                ]\r\n            }\r\n        ],\r\n    };\r\n    Label.convertToLatest = convertToLatest;\r\n    return Label;\r\n}());\r\nexport { Label };\r\nfunction convertToLatest(a) {\r\n    return __assign(__assign({}, Label.properties.defaultAppearance), a);\r\n}\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { apparatusCategories } from \"apparatus/specs\";\r\nimport * as React from \"react\";\r\nimport { Component } from \"react\";\r\nimport { pluralize } from \"utils\";\r\nimport { searchApparatus } from \"../../apparatus/search\";\r\nimport apparatusSpecListWithNames from \"../../apparatus/specList\";\r\nimport { ApparatusItem } from \"./apparatus_item\";\r\n/**\r\n * Component that displays a list of apparatus. Clicking on an item adds it.\r\n * This is also used for a filtered apparatus search.\r\n */\r\nvar ApparatusList = /** @class */ (function (_super) {\r\n    __extends(ApparatusList, _super);\r\n    function ApparatusList() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.render = function () { return (React.createElement(\"div\", { className: \"sidebar-list\" },\r\n            React.createElement(\"div\", { className: \"scrollable-container\", \"data-simplebar\": true },\r\n                React.createElement(\"div\", null, _this.isInSearchMode\r\n                    ? React.createElement(SearchResults, { key: \"searchResults\", results: searchApparatus(_this.props.searchTerm), onSwitchModule: _this.props.onSwitchModule })\r\n                    : React.createElement(DefaultList, { key: \"searchResults\", groups: ApparatusList.apparatusByGroups[_this.props.module] }))))); };\r\n        return _this;\r\n    }\r\n    Object.defineProperty(ApparatusList.prototype, \"isInSearchMode\", {\r\n        get: function () {\r\n            return this.props.searchTerm.length > 0;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /** List of all apparatus, split into modules by category. */\r\n    ApparatusList.apparatusByGroups = {\r\n        \"chemistry\": splitApparatusByCategory(apparatusSpecListWithNames, \"chemistry\"),\r\n        \"heating\": splitApparatusByCategory(apparatusSpecListWithNames, \"heating\"),\r\n        \"various\": splitApparatusByCategory(apparatusSpecListWithNames, \"various\"),\r\n        \"shapes\": splitApparatusByCategory(apparatusSpecListWithNames, \"shapes\"),\r\n        \"biology\": splitApparatusByCategory(apparatusSpecListWithNames, \"biology\"),\r\n        \"physics\": splitApparatusByCategory(apparatusSpecListWithNames, \"physics\"),\r\n        \"distillation\": splitApparatusByCategory(apparatusSpecListWithNames, \"distillation\"),\r\n        \"measurement\": splitApparatusByCategory(apparatusSpecListWithNames, \"measurement\"),\r\n    };\r\n    return ApparatusList;\r\n}(Component));\r\nexport { ApparatusList };\r\nvar SearchResults = function (props) { return (React.createElement(React.Fragment, null,\r\n    React.createElement(\"div\", { key: \"searchResultSummary\", className: \"search-results-summary\" }, pluralize(props.results.length, \"result\", true)),\r\n    props.results.map(function (a) {\r\n        return React.createElement(ApparatusItem, __assign({ showCategory: true, isSearchMode: true, key: a.name }, a));\r\n    }),\r\n    props.results.length == 0 ? React.createElement(NoResultsTip, { onSwitchToShapes: function () { return props.onSwitchModule(\"shapes\"); } }) : undefined)); };\r\n/** Remembers the collapse state of groups. True = expanded. */\r\nvar groupCollapseMemo = {};\r\nvar DefaultList = function (props) {\r\n    function onHeaderClick(id, el) {\r\n        var _a, _b;\r\n        var collapsed = el.classList.contains(\"collapsed\");\r\n        groupCollapseMemo[id] = !collapsed;\r\n        // If collapsing and the header is sticky,\r\n        // scroll to the header element to prevent weird artifacts.\r\n        if (collapsed) {\r\n            var scrollable = document.getElementsByClassName(\"scrollable-container\")[0];\r\n            var sb = SimpleBar.instances.get(scrollable);\r\n            var groupOffsetStart = (_b = (_a = el.parentElement) === null || _a === void 0 ? void 0 : _a.offsetTop) !== null && _b !== void 0 ? _b : 0;\r\n            if (sb.getScrollElement().scrollTop > groupOffsetStart) {\r\n                $(sb.getScrollElement()).animate({ scrollTop: groupOffsetStart }, 100);\r\n            }\r\n        }\r\n    }\r\n    return React.createElement(React.Fragment, null, props.groups.map(function (group) {\r\n        var _a;\r\n        var id = \"apparatus-group-\" + group.category.replace(\" \", \"_\");\r\n        var show = (_a = groupCollapseMemo[id]) !== null && _a !== void 0 ? _a : true;\r\n        return [\r\n            React.createElement(\"div\", { className: \"category-group-wrapper\", key: group.category },\r\n                React.createElement(\"h3\", { \"data-toggle\": \"collapse\", \"aria-expanded\": show ? \"true\" : \"false\", \"data-target\": \"#\" + id, onClick: function (e) { return onHeaderClick(id, e.nativeEvent.target); } },\r\n                    React.createElement(\"i\", { className: \"fas fa-caret-right fa-fw\" }),\r\n                    group.category.displaySpecial()),\r\n                React.createElement(\"div\", { className: \"category-group collapse \" + \"show\".if(show), key: \"group_\" + group.category, id: id }, group.apparatus.map(function (a) {\r\n                    return React.createElement(ApparatusItem, __assign({ isSearchMode: false, key: a.name }, a));\r\n                })))\r\n        ];\r\n    }));\r\n};\r\nfunction splitApparatusByCategory(allApparatus, module) {\r\n    return apparatusCategories[module].map(function (category) { return ({\r\n        category: category,\r\n        apparatus: allApparatus.filter(function (spec) { return spec.category == category; })\r\n    }); });\r\n}\r\nvar NoResultsTip = function (props) { return (React.createElement(\"div\", { className: \"text-secondary p-3\" },\r\n    React.createElement(\"i\", { className: \"fad fa-lightbulb-on text-warning mr-2 fa-lg\" }),\r\n    \"Didn't find an item you need? Try using \",\r\n    React.createElement(\"span\", { className: \"href\", onClick: function () { return props.onSwitchToShapes(); } },\r\n        React.createElement(\"b\", null, \"Shapes\")),\r\n    \" to draw it yourself or\",\r\n    React.createElement(\"br\", null),\r\n    React.createElement(\"a\", { href: \"https://chemix.kampsite.co\", target: \"_blank\" },\r\n        React.createElement(\"b\", null, \"send us a suggestion.\")))); };\r\n","import { breakPath, glassFold, setDefaultStyle } from \"apparatus/draw\";\r\nimport { P, Segments } from \"apparatus/library/common\";\r\nimport { Path } from \"paper\";\r\nvar ReceiverAdaptor = /** @class */ (function () {\r\n    function ReceiverAdaptor() {\r\n    }\r\n    ReceiverAdaptor.prototype.render = function (appearance) {\r\n        var path = new Path(Segments([[0, 0]], [[22, 7]], [[24, 6]], [[50, 13], , [20, 7]], [[71, 40], [0, -5]], [[71, 91]], // Bottom. Break after this\r\n        [[62, 100]], [[62, 52], , [0, -11]], [[50, 38], [6, 2]], [[18, 30]], [[16, 28]], [[-6, 23]]));\r\n        var hitShape = path.bounds.toShape();\r\n        var graphic = breakPath(path, 6);\r\n        setDefaultStyle(graphic);\r\n        graphic.addChild(glassFold(20, 18, { size: 12, rotation: -73 }));\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShape,\r\n            watermark: P(0, 10)\r\n        };\r\n    };\r\n    ReceiverAdaptor.properties = {\r\n        label: \"Receiver Adaptor\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {},\r\n        appearanceSpecs: [],\r\n    };\r\n    return ReceiverAdaptor;\r\n}());\r\nexport { ReceiverAdaptor };\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { g } from \"analytics\";\r\nimport clipboard from \"editing/clipboard\";\r\nimport { deleteSelected } from \"editing/deleting\";\r\nimport { redo, undo } from \"editing/undo_redo\";\r\nimport { AccountBar, LoginModal } from \"layout/top_bar/account\";\r\nimport { Logo, SocialWidgets } from \"layout/top_bar/extras\";\r\nimport { MainMenu } from \"layout/top_bar/main_menu\";\r\nimport * as React from \"react\";\r\nimport { Component } from \"react\";\r\nimport { Consts } from \"vars\";\r\nimport { AboutModal } from \"../modals/about\";\r\nimport { Button, ButtonGroup } from \"./button_group\";\r\nimport { Toolbox } from \"./toolbox\";\r\n/**\r\n * Application Top Bar, displays:\r\n *  - for main actions (such as Save Image, Help...),\r\n *  - tool selection (move, pan, label...),\r\n *  - common operations (cut/copy/paste, undo/redo...)\r\n *  - various links (e.g. social links, link to \"What's new\" page)\r\n */\r\nvar TopBar = /** @class */ (function (_super) {\r\n    __extends(TopBar, _super);\r\n    function TopBar() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.aboutDialogRef = React.createRef();\r\n        _this.loginRef = React.createRef();\r\n        _this.openLogin = function (callback) {\r\n            _this.loginRef.current.openWithCallback(callback);\r\n        };\r\n        _this.render = function () { return (React.createElement(React.Fragment, null,\r\n            React.createElement(\"div\", { id: \"topBar\", key: \"topBar\", \"data-simplebar\": true },\r\n                React.createElement(Logo, { key: \"logo\", onClick: function () { g(\"Click logo\"); _this.aboutDialogRef.current.open(); } }),\r\n                React.createElement(MainMenu, { key: \"menubar\", file: _this.props.file, auth: _this.props.auth, openLogin: _this.openLogin, cloudDiagramTitle: _this.props.cloudDiagramTitle }),\r\n                React.createElement(\"div\", { key: \"rhg\", className: \"rightHandGroup\" },\r\n                    React.createElement(SocialWidgets, { key: \"widgets\", visible: _this.props.auth.state != \"logged_in\" })),\r\n                React.createElement(\"div\", { className: \"secondTopBarRow\" },\r\n                    React.createElement(Toolbox, { key: \"toolbox\", tool: _this.props.tool }),\r\n                    React.createElement(ButtonGroup, { key: \"undo_redo\", id: \"history-toolbox\" }, UNDO_REDO_BUTTONS.map(function (b, i) { return React.createElement(Button, __assign({ key: \"b_\" + i }, b)); })),\r\n                    React.createElement(ButtonGroup, { key: \"clipboard\" }, CLIPBOARD_BUTTONS.map(function (b, i) { return React.createElement(Button, __assign({ key: \"b_\" + i }, b)); })),\r\n                    React.createElement(ButtonGroup, { key: \"delete\" },\r\n                        React.createElement(Button, { key: \"delete\", icon: \"r,trash-alt\", hint: \"Delete selected\", shortcuts: [{ key: \"Del\" }, { key: \"\" }], onClick: function () { deleteSelected(\"click\"); } }))),\r\n                React.createElement(AccountBar, { auth: _this.props.auth, openLogin: _this.openLogin })),\r\n            React.createElement(LoginModal, { auth: _this.props.auth, ref: _this.loginRef }),\r\n            React.createElement(AboutModal, { key: \"about\", version: Consts.version, ref: _this.aboutDialogRef }))); };\r\n        return _this;\r\n    }\r\n    return TopBar;\r\n}(Component));\r\nexport { TopBar };\r\nvar UNDO_REDO_BUTTONS = [\r\n    {\r\n        hint: \"Undo\",\r\n        icon: \"undo\",\r\n        shortcuts: [{ ctrl: true, key: \"Z\" }],\r\n        onClick: function () { undo(\"click\"); }\r\n    },\r\n    {\r\n        hint: \"Redo\",\r\n        icon: \"redo\",\r\n        shortcuts: [{ ctrl: true, key: \"Y\" }],\r\n        onClick: function () { redo(\"click\"); }\r\n    },\r\n];\r\nvar CLIPBOARD_BUTTONS = [\r\n    {\r\n        hint: \"Cut\",\r\n        icon: \"cut\",\r\n        shortcuts: [{ ctrl: true, key: \"X\" }],\r\n        onClick: function () { clipboard.cut(\"click\"); }\r\n    },\r\n    {\r\n        hint: \"Copy\",\r\n        icon: \"r,copy\",\r\n        shortcuts: [{ ctrl: true, key: \"C\" }],\r\n        onClick: function () { clipboard.copy(\"click\"); }\r\n    },\r\n    {\r\n        hint: \"Paste\",\r\n        icon: \"r,clipboard\",\r\n        shortcuts: [{ ctrl: true, key: \"V\" }],\r\n        onClick: function () { clipboard.paste(\"click\"); }\r\n    }\r\n];\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { Arrays } from \"ext/array\";\r\nimport { createMoveForwardIndices, createMoveToFrontIndices, createSendBackwardIndices, createSendToBackIndices, reorder } from \"ordering/reorder\";\r\nimport appStore from \"store/store\";\r\nvar ReorderItems = /** @class */ (function () {\r\n    function ReorderItems(from, to) {\r\n        this.from = from;\r\n        this.to = to;\r\n    }\r\n    ReorderItems.create = function (ids, op) {\r\n        var indices = getIndices(ids);\r\n        var destIndices = (function () {\r\n            switch (op) {\r\n                case \"sendBackward\": return createSendBackwardIndices(indices);\r\n                case \"sendToBack\": return createSendToBackIndices(indices);\r\n                case \"bringForward\": return createMoveForwardIndices(indices, appStore.items().length);\r\n                case \"bringToFront\": return createMoveToFrontIndices(indices, appStore.items().length);\r\n            }\r\n        })();\r\n        // If this results in no changes, dont' return a command.\r\n        if (Arrays.shallowStrictEquals(indices, destIndices))\r\n            return;\r\n        return new ReorderItems(indices, destIndices);\r\n    };\r\n    ReorderItems.prototype.execute = function () {\r\n        var _this = this;\r\n        appStore.dispatchFn(\"Reorder\", function (store) {\r\n            return __assign(__assign({}, store), { items: reorder(store.items, _this.from, _this.to) });\r\n        });\r\n    };\r\n    ReorderItems.prototype.undo = function () {\r\n        var _this = this;\r\n        appStore.dispatchFn(\"Reorder\", function (store) {\r\n            return __assign(__assign({}, store), { items: reorder(store.items, _this.to, _this.from) });\r\n        });\r\n    };\r\n    return ReorderItems;\r\n}());\r\nexport { ReorderItems };\r\nvar SendToBack = /** @class */ (function () {\r\n    function SendToBack(index) {\r\n        this.index = index;\r\n    }\r\n    SendToBack.createFor = function (id) {\r\n        // Determine the index of the element.\r\n        var index = getIndex(id, 0);\r\n        if (index == 0)\r\n            return;\r\n        return new SendToBack(index);\r\n    };\r\n    SendToBack.prototype.execute = function () {\r\n        var _this = this;\r\n        appStore.dispatchFn(\"SendToBack\", function (state) {\r\n            var newItems = __spreadArrays(state.items);\r\n            var toMove = newItems.splice(_this.index, 1);\r\n            newItems.unshift(toMove[0]);\r\n            return __assign(__assign({}, state), { items: newItems });\r\n        });\r\n    };\r\n    SendToBack.prototype.undo = function () {\r\n        var _this = this;\r\n        appStore.dispatchFn(\"Undo-SendToBack\", function (state) {\r\n            var newItems = __spreadArrays(state.items);\r\n            // Pop from the front and insert into original index position.\r\n            var toMove = newItems.shift();\r\n            newItems.splice(_this.index, 0, toMove);\r\n            return __assign(__assign({}, state), { items: newItems });\r\n        });\r\n    };\r\n    return SendToBack;\r\n}());\r\nexport { SendToBack };\r\nvar BringToFront = /** @class */ (function () {\r\n    function BringToFront(index) {\r\n        this.index = index;\r\n    }\r\n    BringToFront.createFor = function (id) {\r\n        // Determine the index of the element.\r\n        var highestIndex = appStore.items().length - 1;\r\n        var index = getIndex(id, highestIndex);\r\n        if (index == highestIndex)\r\n            return;\r\n        return new BringToFront(index);\r\n    };\r\n    BringToFront.prototype.execute = function () {\r\n        var _this = this;\r\n        appStore.dispatchFn(\"BringToFront\", function (state) {\r\n            var newItems = __spreadArrays(state.items);\r\n            var toMove = newItems.splice(_this.index, 1);\r\n            newItems.push(toMove[0]);\r\n            return __assign(__assign({}, state), { items: newItems });\r\n        });\r\n    };\r\n    BringToFront.prototype.undo = function () {\r\n        var _this = this;\r\n        appStore.dispatchFn(\"Undo-BrintToFront\", function (state) {\r\n            var newItems = __spreadArrays(state.items);\r\n            // Pop from the front and insert into original index position.\r\n            var toMove = newItems.pop();\r\n            newItems.splice(_this.index, 0, toMove);\r\n            return __assign(__assign({}, state), { items: newItems });\r\n        });\r\n    };\r\n    return BringToFront;\r\n}());\r\nexport { BringToFront };\r\nvar BringForward = /** @class */ (function () {\r\n    function BringForward(index) {\r\n        this.index = index;\r\n    }\r\n    BringForward.createFor = function (id) {\r\n        // Determine the index of the element.\r\n        var highestIndex = appStore.items().length - 1;\r\n        var index = getIndex(id, highestIndex);\r\n        if (index == highestIndex)\r\n            return;\r\n        return new BringForward(index);\r\n    };\r\n    BringForward.prototype.execute = function () {\r\n        var _this = this;\r\n        appStore.dispatchFn(\"BringForward\", function (state) {\r\n            var newItems = __spreadArrays(state.items);\r\n            var toMove = newItems.splice(_this.index, 1);\r\n            newItems.splice(_this.index + 1, 0, toMove[0]);\r\n            return __assign(__assign({}, state), { items: newItems });\r\n        });\r\n    };\r\n    BringForward.prototype.undo = function () {\r\n        var _this = this;\r\n        appStore.dispatchFn(\"Undo-BringForward\", function (state) {\r\n            var newItems = __spreadArrays(state.items);\r\n            // Pop from the front and insert into original index position.\r\n            var toMove = newItems.splice(_this.index + 1, 1);\r\n            newItems.splice(_this.index, 0, toMove[0]);\r\n            return __assign(__assign({}, state), { items: newItems });\r\n        });\r\n    };\r\n    return BringForward;\r\n}());\r\nexport { BringForward };\r\nvar SendBackward = /** @class */ (function () {\r\n    function SendBackward(index) {\r\n        this.index = index;\r\n    }\r\n    SendBackward.createFor = function (id) {\r\n        // Determine the index of the element.\r\n        var index = getIndex(id, 0);\r\n        if (index == 0)\r\n            return;\r\n        return new SendBackward(index);\r\n    };\r\n    SendBackward.prototype.execute = function () {\r\n        var _this = this;\r\n        appStore.dispatchFn(\"SendBackwards\", function (state) {\r\n            var newItems = __spreadArrays(state.items);\r\n            var toMove = newItems.splice(_this.index, 1);\r\n            newItems.splice(_this.index - 1, 0, toMove[0]);\r\n            return __assign(__assign({}, state), { items: newItems });\r\n        });\r\n    };\r\n    SendBackward.prototype.undo = function () {\r\n        var _this = this;\r\n        appStore.dispatchFn(\"Undo-SendBackwards\", function (state) {\r\n            var newItems = __spreadArrays(state.items);\r\n            // Pop from the front and insert into original index position.\r\n            var toMove = newItems.splice(_this.index - 1, 1);\r\n            newItems.splice(_this.index, 0, toMove[0]);\r\n            return __assign(__assign({}, state), { items: newItems });\r\n        });\r\n    };\r\n    return SendBackward;\r\n}());\r\nexport { SendBackward };\r\nfunction getIndex(id, notFound) {\r\n    var items = appStore.items();\r\n    for (var i = 0; i < items.length; i++) {\r\n        var item = items[i];\r\n        if (item.id == id) {\r\n            return i;\r\n        }\r\n    }\r\n    // This should never happen.\r\n    return notFound;\r\n}\r\nfunction getIndices(ids) {\r\n    var items = appStore.items();\r\n    var indices = [];\r\n    for (var i = 0; i < items.length; i++) {\r\n        var item = items[i];\r\n        if (ids.indexOf(item.id) > -1) {\r\n            indices.push(i);\r\n        }\r\n    }\r\n    return indices;\r\n}\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { breakPath, setDefaultStyle } from \"apparatus/draw\";\r\nimport { DEFAULT_LIQUID_DATA, Segments } from \"apparatus/library/common\";\r\nimport { Path } from \"paper\";\r\nimport { mirrorX } from \"../draw\";\r\nvar BuchnerFunnel = /** @class */ (function () {\r\n    function BuchnerFunnel() {\r\n    }\r\n    BuchnerFunnel.prototype.render = function (appearance) {\r\n        var radius = appearance.size;\r\n        var upperHeight = radius * 0.5 + 30;\r\n        var taperHeight = 0.5 * radius;\r\n        var stem = 40;\r\n        var mouthRadius = 6;\r\n        var shape = new Path(Segments([[-radius, -taperHeight - upperHeight]], [[-radius, -taperHeight]], [[0, 0]], [[0, stem]]));\r\n        mirrorX(shape, mouthRadius);\r\n        var hitShape = shape.clone();\r\n        var liquidMask = shape.clone();\r\n        var graphic = breakPath(shape, 4);\r\n        // Add filter layer.\r\n        var filterLayer = new Path(Segments([[-radius, -taperHeight - 2]], [[radius + mouthRadius * 2, -taperHeight - 2]]));\r\n        filterLayer.strokeWidth = 3;\r\n        filterLayer.strokeCap = 'butt';\r\n        filterLayer.dashArray = [3, 6];\r\n        graphic.addChild(filterLayer);\r\n        setDefaultStyle(graphic);\r\n        return { graphic: graphic, hitShape: hitShape, liquidMask: liquidMask };\r\n    };\r\n    BuchnerFunnel.properties = {\r\n        label: \"Buchner Funnel\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            size: 40\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 30, max: 60,\r\n            }\r\n        ],\r\n        defaultLiquidData: __assign(__assign({}, DEFAULT_LIQUID_DATA), { amountRatio: 0.7 })\r\n    };\r\n    return BuchnerFunnel;\r\n}());\r\nexport { BuchnerFunnel };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { apparatusClass } from \"apparatus/library\";\r\nimport Flags from \"flags\";\r\nimport { Consts } from \"vars\";\r\nvar apparatusSpecList = [\r\n    {\r\n        type: \"__live edit__\",\r\n        category: \"Containers\",\r\n        sprite: [\"2\", 1, 0],\r\n        search: [],\r\n        released: Consts.isDev,\r\n    },\r\n    {\r\n        type: \"test tube\",\r\n        category: \"Containers\",\r\n        sprite: [0, 0],\r\n        search: [],\r\n    },\r\n    {\r\n        type: \"test tube with side arm\",\r\n        category: \"Containers\",\r\n        sprite: [1, 9],\r\n        search: [],\r\n    },\r\n    {\r\n        type: \"bung\",\r\n        category: \"Containers\",\r\n        sprite: [9, 0],\r\n        search: [\"test tube\", \"stopper\", \"cork\", \"rubber bung\", \"lid\", \"cover\"]\r\n    },\r\n    {\r\n        type: \"beaker\",\r\n        category: \"Containers\",\r\n        sprite: [0, 2],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"displacement beaker\",\r\n        category: \"Containers\",\r\n        sprite: [0, 3],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"conical flask\",\r\n        category: \"Containers\",\r\n        sprite: [0, 4],\r\n        search: [\"erlenmeyer\", \"erlen meyer\"]\r\n    },\r\n    {\r\n        type: \"conical flask with side arm\",\r\n        category: \"Containers\",\r\n        sprite: [4, 7],\r\n        search: [\"buchner flask\"]\r\n    },\r\n    {\r\n        type: \"boiling flask\",\r\n        category: \"Containers\",\r\n        sprite: [0, 5],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"volumetric flask\",\r\n        category: \"Containers\",\r\n        sprite: [0, 6],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"round bottom flask\",\r\n        category: \"Containers\",\r\n        sprite: [0, 7],\r\n        search: [\"spherical\", \"three neck\"]\r\n    },\r\n    {\r\n        type: \"petri dish\",\r\n        category: \"_Bio_Equipment\",\r\n        sprite: [0, 8],\r\n        search: [\"sample dish\"]\r\n    },\r\n    {\r\n        type: \"choice chamber\",\r\n        category: \"_Bio_Equipment\",\r\n        sprite: [\"2\", 9, 4],\r\n        search: [],\r\n    },\r\n    {\r\n        type: \"watch glass\",\r\n        category: \"Containers\",\r\n        sprite: [2, 9],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"gas jar\",\r\n        category: \"Containers\",\r\n        sprite: [0, 9],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"tank\",\r\n        category: \"Containers\",\r\n        sprite: [0, 10],\r\n        search: [\"container\", \"tub\", \"water tank\", \"sink\", \"water trough\"]\r\n    },\r\n    {\r\n        type: \"boiling tube\",\r\n        category: \"Containers\",\r\n        sprite: [0, 0],\r\n        tier: \"boost\",\r\n        search: [],\r\n    },\r\n    {\r\n        type: \"boiling tube with sidearm\",\r\n        category: \"Containers\",\r\n        sprite: [1, 9],\r\n        search: [],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"thiele tube\",\r\n        category: \"Containers\",\r\n        sprite: [0, 1],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"pear-shaped flask\",\r\n        category: \"Containers\",\r\n        sprite: [\"2\", 0, 2],\r\n        search: [\"pear shaped flask\", \"pear flask\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"schlenk flask\",\r\n        category: \"Containers\",\r\n        sprite: [\"2\", 0, 4],\r\n        search: [],\r\n    },\r\n    {\r\n        type: \"weight boat\",\r\n        category: \"Containers\",\r\n        sprite: [\"2\", 9, 6],\r\n        search: [\"weighing boat\", \"disposable boat\", \"weigh boat\"],\r\n    },\r\n    {\r\n        type: \"calorimetry cup\",\r\n        category: \"Containers\",\r\n        sprite: [6, 6],\r\n        search: [\"plastic cup\", \"foam cup\", \"styrofoam cup\", \"coffee cup\", \"polystyrene cup\"]\r\n    },\r\n    {\r\n        type: \"thermos\",\r\n        category: \"Containers\",\r\n        sprite: [\"2\", 6, 5],\r\n        search: [\"thermos flask\", \"Dewar flask\", \"Dewar bottle\"]\r\n    },\r\n    {\r\n        type: \"cuvette\",\r\n        category: \"Containers\",\r\n        sprite: [6, 7],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"cell flask\",\r\n        category: \"Containers\",\r\n        sprite: [\"2\", 6, 0],\r\n        search: [\"culture flask\"],\r\n        tier: \"boost\"\r\n    },\r\n    {\r\n        type: \"centrifuge tube\",\r\n        category: \"_Bio_Equipment\",\r\n        sprite: [8, 6],\r\n        search: [\"falcon tube\", \"microcentrifuge tube\", \"eppendorf\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"eppendorf tube\",\r\n        category: \"_Bio_Equipment\",\r\n        sprite: [8, 5],\r\n        search: [\"centrifuge tube\", \"microcentrifuge tube\", \"falcon\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"wash bottle\",\r\n        category: \"Containers\",\r\n        sprite: [6, 8],\r\n        search: [\"clean\"],\r\n    },\r\n    {\r\n        type: \"cylinder\",\r\n        category: \"Measurement\",\r\n        sprite: [1, 1],\r\n        search: [\"graduated cylinder\", \"measuring cylinder\", \"mixing cylinder\"]\r\n    },\r\n    {\r\n        type: \"pipette\",\r\n        category: \"Measurement\",\r\n        sprite: [1, 3],\r\n        search: [\"dropper\"]\r\n    },\r\n    {\r\n        type: \"mohr\",\r\n        category: \"Measurement\",\r\n        sprite: [\"2\", 5, 6],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"burette\",\r\n        category: \"Measurement\",\r\n        sprite: [1, 4],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"thermometer\",\r\n        category: \"Measurement\",\r\n        sprite: [1, 0],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"digital thermometer\",\r\n        category: \"Measurement\",\r\n        sprite: [7, 6],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"balance\",\r\n        category: \"Measurement\",\r\n        sprite: [1, 5],\r\n        search: [\"scales\", \"weight\", \"lab scales\", \"mass\"],\r\n    },\r\n    {\r\n        type: \"triple beam balance\",\r\n        category: \"Measurement\",\r\n        sprite: [\"2\", 8, 7],\r\n        search: [\"scales\", \"weight\", \"mass\", \"triple-beam balance\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"beam balance\",\r\n        category: \"Measurement\",\r\n        sprite: [\"2\", 8, 9],\r\n        search: [\"scales\", \"physical balance\", \"weight\", \"mass\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"hydrometer\",\r\n        category: \"Measurement\",\r\n        sprite: [\"2\", 6, 8],\r\n        search: [\"density\"],\r\n    },\r\n    {\r\n        type: \"manometer\",\r\n        category: \"Measurement\",\r\n        sprite: [\"2\", 7, 1],\r\n        search: [\"pressure\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"ruler\",\r\n        category: \"Measurement\",\r\n        sprite: [1, 7],\r\n        search: [\"measure\", \"tape\", \"length\"]\r\n    },\r\n    {\r\n        type: \"tape measure\",\r\n        category: \"Measurement\",\r\n        sprite: [\"2\", 2, 6],\r\n        search: [\"measure\", \"tape\", \"length\"],\r\n    },\r\n    {\r\n        type: \"vernier\",\r\n        category: \"Measurement\",\r\n        sprite: [\"2\", 9, 9],\r\n        search: [\"measure\", \"tape\", \"length\"],\r\n        released: Flags.isPhysicsEnabled,\r\n    },\r\n    {\r\n        type: \"protractor\",\r\n        category: \"Measurement\",\r\n        sprite: [\"2\", 8, 8],\r\n        search: [\"angle\"],\r\n    },\r\n    {\r\n        type: \"ph paper pack\",\r\n        category: \"Measurement\",\r\n        sprite: [\"2\", 7, 8],\r\n        search: [\"ph meter\", \"ph indicator\", \"indicator paper\", \"ph strips\", \"indicator strips\", \"strips\", \"litmus\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"ph paper\",\r\n        category: \"Measurement\",\r\n        sprite: [\"2\", 7, 9],\r\n        search: [\"ph meter\", \"ph indicator\", \"indicator paper\", \"ph strips\", \"indicator strips\", \"strips\", \"litmus\"],\r\n    },\r\n    {\r\n        type: \"ph probe\",\r\n        category: \"Measurement\",\r\n        sprite: [6, 9],\r\n        search: [\"ph meter\"],\r\n    },\r\n    {\r\n        type: \"conductimeter\",\r\n        category: \"Measurement\",\r\n        sprite: [6, 10],\r\n        search: [\"probe\"],\r\n        tier: \"boost\"\r\n    },\r\n    {\r\n        type: \"oxsat probe\",\r\n        category: \"Measurement\",\r\n        sprite: [\"2\", 9, 3],\r\n        search: [\"data probe\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"spectrophotometer\",\r\n        category: \"Measurement\",\r\n        sprite: [\"2\", 8, 4],\r\n        search: [\"colorimeter\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"spectrophotometer-s\",\r\n        category: \"Measurement\",\r\n        sprite: [\"2\", 8, 5],\r\n        search: [\"colorimeter\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"pump\",\r\n        category: \"_Mea_Extraction\",\r\n        sprite: [1, 2],\r\n        search: [\"pipette filler\"]\r\n    },\r\n    {\r\n        type: \"suction pear\",\r\n        category: \"_Mea_Extraction\",\r\n        sprite: [\"2\", 5, 8],\r\n        search: [\"suction ball\", \"pipette filler\", \"pipette aid\", \"peleus ball\"],\r\n    },\r\n    {\r\n        type: \"dropper pipette\",\r\n        category: \"_Mea_Extraction\",\r\n        sprite: [1, 6],\r\n        search: [\"pipette bottle\"],\r\n    },\r\n    {\r\n        type: \"pipette bottle\",\r\n        category: \"_Mea_Extraction\",\r\n        sprite: [7, 5],\r\n        search: [\"dropper pipette\", \"glass bottle\"],\r\n    },\r\n    {\r\n        type: \"plastic pipette\",\r\n        category: \"_Mea_Extraction\",\r\n        sprite: [3, 6],\r\n        search: [\"dropper\", \"disposable\"]\r\n    },\r\n    {\r\n        type: \"micropipette\",\r\n        category: \"_Mea_Extraction\",\r\n        sprite: [\"2\", 2, 10],\r\n        search: [\"automatic pipette\", \"pipette\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"microplate\",\r\n        category: \"_Mea_Extraction\",\r\n        sprite: [\"2\", 5, 7],\r\n        search: [\"96 wells\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"syringe\",\r\n        category: \"_Mea_Extraction\",\r\n        sprite: [\"2\", 2, 7],\r\n        search: [\"syringe\", \"needle\", \"inject\"],\r\n    },\r\n    {\r\n        type: \"gas syringe\",\r\n        category: \"_Mea_Extraction\",\r\n        sprite: [1, 8],\r\n        search: [\"plunger\"]\r\n    },\r\n    {\r\n        type: \"bunsen\",\r\n        category: \"Heating\",\r\n        sprite: [2, 0],\r\n        search: [\"bunsen burner\", \"burner\", \"heat\", \"fire\", \"flame\", \"hot\"]\r\n    },\r\n    {\r\n        type: \"torch burner\",\r\n        category: \"Heating\",\r\n        sprite: [\"2\", 6, 7],\r\n        search: [\"propane torch\", \"burner\", \"heat\", \"fire\", \"flame\", \"hot\"]\r\n    },\r\n    {\r\n        type: \"flame\",\r\n        category: \"Heating\",\r\n        sprite: [7, 10],\r\n        search: [\"fire\", \"flame\"],\r\n    },\r\n    {\r\n        type: \"hot plate\",\r\n        category: \"Heating\",\r\n        sprite: [2, 1],\r\n        search: [\"heat\", \"boil\"]\r\n    },\r\n    {\r\n        type: \"magnetic stirrer-heater\",\r\n        category: \"Heating\",\r\n        sprite: [2, 2],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"spirit lamp\",\r\n        category: \"Heating\",\r\n        sprite: [7, 9],\r\n        search: [\"heat\", \"flame\", \"alcohol lamp\", \"burner\", \"alcohol burner\"],\r\n    },\r\n    {\r\n        type: \"stick lighter\",\r\n        category: \"Heating\",\r\n        sprite: [\"2\", 6, 6],\r\n        search: [\"heat\", \"gas lighter\", \"flame\", \"fire\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"sand bath\",\r\n        category: \"Heating\",\r\n        sprite: [5, 8],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"heating mantle\",\r\n        category: \"Heating\",\r\n        sprite: [8, 2],\r\n        search: [\"isomantle\"],\r\n    },\r\n    {\r\n        type: \"stirring rod\",\r\n        category: \"Heating\",\r\n        sprite: [2, 8],\r\n        search: [\"glass rod\", \"stir rod\", \"stick\"]\r\n    },\r\n    {\r\n        type: \"magnetic stir bar\",\r\n        category: \"Heating\",\r\n        sprite: [2, 3],\r\n        search: [\"stirrer\"]\r\n    },\r\n    {\r\n        type: \"glass wool\",\r\n        category: \"Heating\",\r\n        sprite: [2, 4],\r\n        search: [\"cloud\", \"puff\"]\r\n    },\r\n    {\r\n        type: \"wire gauze\",\r\n        category: \"Heating\",\r\n        sprite: [2, 5],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"clay triangle\",\r\n        category: \"Heating\",\r\n        sprite: [2, 6],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"tongs\",\r\n        category: \"Heating\",\r\n        sprite: [2, 7],\r\n        search: [\"crucible tongs\", \"beaker tongs\"]\r\n    },\r\n    {\r\n        type: \"peg\",\r\n        category: \"Heating\",\r\n        sprite: [8, 3],\r\n        search: [\"test tube holder\"],\r\n    },\r\n    {\r\n        type: \"test tube holder\",\r\n        category: \"Heating\",\r\n        sprite: [8, 4],\r\n        search: [\"metal test tube holder\", \"metallic test tube holder\"],\r\n    },\r\n    {\r\n        type: \"filter funnel\",\r\n        category: \"Filtering\",\r\n        sprite: [3, 0],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"thistle tube\",\r\n        category: \"Filtering\",\r\n        sprite: [3, 1],\r\n        search: [\"thistle tube\"],\r\n    },\r\n    {\r\n        type: \"buchner\",\r\n        category: \"Filtering\",\r\n        sprite: [3, 2],\r\n        search: [],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"separatory funnel\",\r\n        category: \"Filtering\",\r\n        sprite: [3, 3],\r\n        search: [\"separation funnel\", \"separating funnel\", \"sep funnel\", \"seperat\"]\r\n    },\r\n    {\r\n        type: \"filter paper\",\r\n        category: \"Filtering\",\r\n        sprite: [3, 4],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"fluted filter paper\",\r\n        category: \"Filtering\",\r\n        sprite: [9, 10],\r\n        search: [\"folded filter paper\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"evaporating dish\",\r\n        category: \"Filtering\",\r\n        sprite: [3, 5],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"allihn\",\r\n        category: \"Condensers\",\r\n        sprite: [4, 2],\r\n        search: [\"condenser\"]\r\n    },\r\n    {\r\n        type: \"fractionating column\",\r\n        category: \"Condensers\",\r\n        sprite: [4, 0],\r\n        search: [\"distillation\", \"condenser\"]\r\n    },\r\n    {\r\n        type: \"graham\",\r\n        category: \"Condensers\",\r\n        sprite: [4, 3],\r\n        search: [\"condenser\"]\r\n    },\r\n    {\r\n        type: \"liebig condenser\",\r\n        category: \"Condensers\",\r\n        sprite: [4, 1],\r\n        search: [\"condenser\"]\r\n    },\r\n    {\r\n        type: \"vigreux\",\r\n        category: \"Condensers\",\r\n        sprite: [\"2\", 5, 3],\r\n        search: [\"vigreux condenser\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"waterless condenser\",\r\n        category: \"Condensers\",\r\n        sprite: [7, 7],\r\n        search: [\"air condenser\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"cold finger\",\r\n        category: \"Distillation\",\r\n        sprite: [4, 6],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"distillation head\",\r\n        category: \"Distillation\",\r\n        sprite: [8, 9],\r\n        search: [],\r\n    },\r\n    {\r\n        type: \"splash head\",\r\n        category: \"Distillation\",\r\n        sprite: [\"2\", 2, 5],\r\n        tier: \"boost\",\r\n        search: [],\r\n    },\r\n    {\r\n        type: \"soxhlet extractor\",\r\n        category: \"Distillation\",\r\n        sprite: [\"2\", 0, 7],\r\n        search: [],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"receiver adaptor\",\r\n        category: \"Distillation\",\r\n        sprite: [\"2\", 0, 3],\r\n        search: [\"receiver adapter\", \"distillation\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"cowtype\",\r\n        category: \"Distillation\",\r\n        sprite: [\"2\", 5, 5],\r\n        search: [],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"dean-stark trap\",\r\n        category: \"Distillation\",\r\n        sprite: [\"2\", 0, 5],\r\n        search: [],\r\n    },\r\n    {\r\n        type: \"distillation flask\",\r\n        category: \"Distillation\",\r\n        sprite: [\"2\", 0, 1],\r\n        search: [],\r\n    },\r\n    {\r\n        type: \"oil bubbler\",\r\n        category: \"Distillation\",\r\n        sprite: [\"2\", 5, 4],\r\n        search: [],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"capillary tube\",\r\n        category: \"Transportation\",\r\n        sprite: [2, 10],\r\n        search: [\"tube\", \"tlc\", \"tlc spotter\"]\r\n    },\r\n    {\r\n        type: \"tube\",\r\n        category: \"Transportation\",\r\n        sprite: [5, 0],\r\n        search: [\"transport\", \"delivery\"]\r\n    },\r\n    {\r\n        type: \"tube bend\",\r\n        category: \"Transportation\",\r\n        sprite: [5, 1],\r\n        search: [\"transport\", \"delivery\"]\r\n    },\r\n    {\r\n        type: \"s-bent tube\",\r\n        category: \"Transportation\",\r\n        sprite: [5, 4],\r\n        search: [\"S bend\", \"u-bend\", \"s-tube\", \"s tube\", \"delivery\", \"transport\", \"tube\"]\r\n    },\r\n    {\r\n        type: \"u-bent tube\",\r\n        category: \"Transportation\",\r\n        sprite: [5, 6],\r\n        search: [\"tube\", \"u-bend\", \"u tube\", \"u bend\", \"u-tube\", \"delivery\", \"transport\", \"utube\"]\r\n    },\r\n    {\r\n        type: \"tube adapter\",\r\n        category: \"Transportation\",\r\n        sprite: [5, 7],\r\n        search: [\"diameter\", \"change diameter\", \"tube diameter\", \"transport\", \"connect\", \"delivery\"]\r\n    },\r\n    {\r\n        type: \"3-way crossing\",\r\n        category: \"Transportation\",\r\n        sprite: [5, 2],\r\n        search: [\"t tube\", \"three way crossing\", \"threeway crossing\", \"3 way crossing\", \"delivery\", \"transport\",]\r\n    },\r\n    {\r\n        type: \"4-way crossing\",\r\n        category: \"Transportation\",\r\n        sprite: [5, 3],\r\n        search: [\"cross tube\", \"x tube\", \"four way crossing\", \"fourway crossing\", \"delivery\", \"transport\",],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"gas wash bottle\",\r\n        category: \"Transportation\",\r\n        sprite: [5, 5],\r\n        search: [\"drechsel bottle\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"dropping funnel\",\r\n        category: \"Transportation\",\r\n        sprite: [9, 8],\r\n        search: [\"addition funnel\", \"dropping funnel\", \"drop funnel\",]\r\n    },\r\n    {\r\n        type: \"osmosis tube\",\r\n        category: \"Transportation\",\r\n        sprite: [\"2\", 7, 0],\r\n        search: [\"u tube\", \"utube\", \"u-tube\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"dialysis tube\",\r\n        category: \"Transportation\",\r\n        sprite: [\"2\", 6, 10],\r\n        search: [\"visking tube\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"test tube rack\",\r\n        category: \"Metallic\",\r\n        sprite: [6, 0],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"retort stand\",\r\n        category: \"Metallic\",\r\n        sprite: [6, 1],\r\n        search: [\"retort\", \"stand\", \"clamp\", \"ring\"]\r\n    },\r\n    {\r\n        type: \"clamp\",\r\n        category: \"Metallic\",\r\n        sprite: [6, 2],\r\n        search: [\"retort\", \"stand\"]\r\n    },\r\n    {\r\n        type: \"clamp front\",\r\n        category: \"Metallic\",\r\n        sprite: [\"2\", 7, 6],\r\n        search: [\"retort\", \"stand\", \"front-facing clamp\", \"front facing clamp\", \"frontfacing clamp\"],\r\n    },\r\n    {\r\n        type: \"retort ring\",\r\n        category: \"Metallic\",\r\n        sprite: [6, 5],\r\n        search: [\"retort stand\", \"stand\", \"clamp\", \"ring clamp\", \"iron ring\"]\r\n    },\r\n    {\r\n        type: \"burette holder\",\r\n        category: \"Metallic\",\r\n        sprite: [7, 8],\r\n        search: [\"burette clamp\", \"retort\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"burette clamp\",\r\n        category: \"Metallic\",\r\n        sprite: [\"2\", 6, 1],\r\n        search: [\"holder\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"spatula\",\r\n        category: \"Metallic\",\r\n        sprite: [6, 3],\r\n        search: [\"spoon\"]\r\n    },\r\n    {\r\n        type: \"tripod\",\r\n        category: \"Metallic\",\r\n        sprite: [6, 4],\r\n        search: [\"stand\", \"shelf\"]\r\n    },\r\n    {\r\n        type: \"nichrome loop\",\r\n        category: \"Metallic\",\r\n        sprite: [\"2\", 2, 0],\r\n        search: [\"inoculating loop\", \"inoculation loop\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"combustion spoon\",\r\n        category: \"Metallic\",\r\n        sprite: [\"2\", 8, 10],\r\n        search: [\"deflagration spoon\", \"deflagrating spoon\", \"spoon\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"steel wool\",\r\n        category: \"Metallic\",\r\n        sprite: [\"2\", 5, 9],\r\n        search: [\"iron wool\"],\r\n    },\r\n    {\r\n        type: \"hoffman clamp\",\r\n        category: \"Metallic\",\r\n        sprite: [\"2\", 5, 10],\r\n        search: [],\r\n    },\r\n    {\r\n        type: \"mortar\",\r\n        category: \"Ceramic\",\r\n        sprite: [7, 0],\r\n        search: [\"pestle\"]\r\n    },\r\n    {\r\n        type: \"pestle\",\r\n        category: \"Ceramic\",\r\n        sprite: [7, 1],\r\n        search: [\"mortar\"]\r\n    },\r\n    {\r\n        type: \"beehive stand\",\r\n        category: \"Ceramic\",\r\n        sprite: [7, 2],\r\n        search: [\"beehive shelf\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"spotting tile\",\r\n        category: \"Ceramic\",\r\n        sprite: [1, 10],\r\n        search: [\"dimple tile\", \"sampling tile\"]\r\n    },\r\n    {\r\n        type: \"bench mat\",\r\n        category: \"Ceramic\",\r\n        sprite: [3, 7],\r\n        search: [\"ceramic tile\", \"white tile\"]\r\n    },\r\n    {\r\n        type: \"crucible\",\r\n        category: \"Ceramic\",\r\n        sprite: [7, 3],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"crucible cover\",\r\n        category: \"Ceramic\",\r\n        sprite: [7, 4],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"battery\",\r\n        category: \"Electrical\",\r\n        sprite: [\"2\", 6, 2],\r\n        search: [\"power\"],\r\n    },\r\n    {\r\n        type: \"croc clips\",\r\n        category: \"Electrical\",\r\n        sprite: [\"2\", 0, 6],\r\n        search: [\"alligator clip\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"fume hood\",\r\n        category: \"Devices\",\r\n        sprite: [\"2\", 8, 0],\r\n        search: [\"fume cupboard\", \"fume closet\", \"extractor\"],\r\n    },\r\n    {\r\n        type: \"rotavap\",\r\n        category: \"Devices\",\r\n        sprite: [\"2\", 0, 9],\r\n        search: [\"rotovap\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"centrifuge\",\r\n        category: \"Devices\",\r\n        sprite: [\"2\", 9, 7],\r\n        search: [\"\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"sonicator\",\r\n        category: \"Devices\",\r\n        sprite: [\"2\", 7, 5],\r\n        search: [\"rotovap\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"lab jack\",\r\n        category: \"Devices\",\r\n        sprite: [8, 7],\r\n        search: [\"laboratory jack\", \"lab scissor jack\", \"laboratory scissor jack\", \"scissor lift jack\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"drop counter\",\r\n        category: \"Devices\",\r\n        sprite: [\"2\", 7, 10],\r\n        search: [],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"hofmann\",\r\n        category: \"Devices\",\r\n        sprite: [\"2\", 2, 2],\r\n        search: [\"Hoffman\", \"Hofmann Apparatus\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"schlenk lines\",\r\n        category: \"Devices\",\r\n        sprite: [\"2\", 0, 10],\r\n        search: [\"vacuum gas manifold\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"tlc plate\",\r\n        category: \"Chromatography\",\r\n        sprite: [\"2\", 2, 3],\r\n        search: [],\r\n    },\r\n    {\r\n        type: \"tlc spot\",\r\n        category: \"Chromatography\",\r\n        sprite: [\"2\", 2, 4],\r\n        search: [\"dot\"],\r\n    },\r\n    {\r\n        type: \"tlc chamber\",\r\n        category: \"Chromatography\",\r\n        sprite: [\"2\", 9, 8],\r\n        search: [\"tlc\"],\r\n    },\r\n    {\r\n        type: \"desiccator\",\r\n        category: \"Storage\",\r\n        sprite: [8, 1],\r\n        search: [\"dessicator\", \"dessiccator\"],\r\n    },\r\n    {\r\n        type: \"reagent bottle\",\r\n        category: \"Storage\",\r\n        sprite: [8, 0],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"gas cylinder\",\r\n        category: \"Storage\",\r\n        sprite: [8, 8],\r\n        search: [\"oxygen\", \"argon\", \"canister\"],\r\n    },\r\n    {\r\n        type: \"plastic reagent bottle\",\r\n        category: \"Storage\",\r\n        sprite: [\"2\", 0, 8],\r\n        search: [\"reagent container\"],\r\n        tier: \"boost\",\r\n    },\r\n    /** Substances */\r\n    {\r\n        type: \"bubbles\",\r\n        category: \"Substances\",\r\n        sprite: [4, 8],\r\n        search: [\"boil\", \"circle\", \"particles\", \"fizz\", \"effervescence\", \"foam\", \"froth\"]\r\n    },\r\n    {\r\n        type: \"crystals\",\r\n        category: \"Substances\",\r\n        sprite: [4, 9],\r\n        search: [\"solid\"],\r\n    },\r\n    {\r\n        type: \"beads\",\r\n        category: \"Substances\",\r\n        sprite: [\"2\", 5, 0],\r\n        search: [\"pearls\", \"algae beads\", \"yeast beads\", \"pellets\", \"samples\"],\r\n    },\r\n    {\r\n        type: \"drop\",\r\n        category: \"Substances\",\r\n        sprite: [9, 4],\r\n        search: [\"liquid\", \"fluid\", \"water\"]\r\n    },\r\n    {\r\n        type: \"ice cube\",\r\n        category: \"Substances\",\r\n        sprite: [4, 10],\r\n        search: [\"solid\", \"square\"],\r\n    },\r\n    {\r\n        type: \"metal strip\",\r\n        category: \"Substances\",\r\n        sprite: [5, 9],\r\n        search: [\"rectangle\", \"paper\", \"electrode\", \"magnesium\", \"ribbon\"],\r\n    },\r\n    {\r\n        type: \"nail\",\r\n        category: \"Substances\",\r\n        sprite: [9, 1],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"powder\",\r\n        category: \"Substances\",\r\n        sprite: [5, 10],\r\n        search: [\"solid\", \"lumps\", \"piles\", \"particle\", \"dose\", \"dust\", \"chips\", \"food\", \"samples\", \"salt\"],\r\n    },\r\n    {\r\n        type: \"smoke\",\r\n        category: \"Substances\",\r\n        sprite: [\"2\", 9, 2],\r\n        search: [\"fume\", \"vapour\", \"gas\", \"exhaust\", \"steam\", \"trails\"],\r\n    },\r\n    {\r\n        type: \"faucet\",\r\n        category: \"Substances\",\r\n        sprite: [\"2\", 7, 2],\r\n        search: [\"water\", \"tap\", \"flow\"],\r\n    },\r\n    /** Accessories */\r\n    {\r\n        type: \"table\",\r\n        category: \"Accessories\",\r\n        sprite: [9, 2],\r\n        search: [\"desk\", \"ground\", \"line\", \"base\", \"surface\", \"box\", \"rectangle\", \"flat surface\", \"workbench\"]\r\n    },\r\n    {\r\n        type: \"glass stopper\",\r\n        category: \"Accessories\",\r\n        sprite: [\"2\", 0, 0],\r\n        search: [\"ground joint glass stopper\", \"glass joint stopper\"],\r\n    },\r\n    {\r\n        type: \"lamp\",\r\n        category: \"Accessories\",\r\n        sprite: [9, 5],\r\n        search: [\"light\", \"illumination\", \"bright\", \"ray\", \"bulb\", \"lamp\"]\r\n    },\r\n    {\r\n        type: \"desk lamp\",\r\n        category: \"Accessories\",\r\n        sprite: [\"2\", 4, 9],\r\n        search: [\"light\", \"illumination\", \"bright\", \"ray\", \"bulb\"],\r\n    },\r\n    {\r\n        type: \"wooden splint\",\r\n        category: \"Accessories\",\r\n        sprite: [3, 8],\r\n        search: [\"stick\", \"stir\", \"match\"]\r\n    },\r\n    {\r\n        type: \"pencil\",\r\n        category: \"Accessories\",\r\n        sprite: [\"2\", 8, 3],\r\n        search: [\"write\"],\r\n    },\r\n    {\r\n        type: \"felt tip pen\",\r\n        category: \"Accessories\",\r\n        sprite: [\"2\", 8, 2],\r\n        search: [\"marker\", \"sharpie\", \"write\"],\r\n    },\r\n    {\r\n        type: \"balloon\",\r\n        category: \"Accessories\",\r\n        sprite: [\"2\", 6, 9],\r\n        search: [\"baloon\"]\r\n    },\r\n    {\r\n        type: \"adhesive tape\",\r\n        category: \"Accessories\",\r\n        sprite: [\"2\", 7, 4],\r\n        search: [\"sticky tape\", \"tape\", \"sellotape\", \"duct tape\"],\r\n    },\r\n    {\r\n        type: \"timer\",\r\n        category: \"Accessories\",\r\n        sprite: [9, 6],\r\n        search: [\"stopwatch\", \"clock\", \"time\"]\r\n    },\r\n    {\r\n        type: \"glove\",\r\n        category: \"Accessories\",\r\n        sprite: [3, 9],\r\n        search: [\"disposable glove\", \"safety\"]\r\n    },\r\n    {\r\n        type: \"goggles\",\r\n        category: \"Accessories\",\r\n        sprite: [3, 10],\r\n        search: [\"glasses\", \"eye protection\", \"safety\"]\r\n    },\r\n    {\r\n        type: \"bottle\",\r\n        category: \"Accessories\",\r\n        sprite: [\"2\", 7, 7],\r\n        search: [\"water bottle\", \"cola\", \"coke\", \"soda\"],\r\n    },\r\n    {\r\n        type: \"candle\",\r\n        category: \"Accessories\",\r\n        sprite: [\"2\", 8, 6],\r\n        search: [\"wax\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"plastic joint clip\",\r\n        category: \"Accessories\",\r\n        sprite: [9, 9],\r\n        search: [\"glass joint clip\", \"keck clip\"],\r\n    },\r\n    {\r\n        type: \"cork ring\",\r\n        category: \"Accessories\",\r\n        sprite: [\"2\", 2, 1],\r\n        search: [\"cork stand\", \"round bottom flask\", \"round-bottom flask\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"scissors\",\r\n        category: \"Accessories\",\r\n        sprite: [\"2\", 2, 8],\r\n        search: [\"cut\"],\r\n    },\r\n    {\r\n        type: \"paperclip\",\r\n        category: \"Accessories\",\r\n        sprite: [\"2\", 9, 5],\r\n        search: [],\r\n    },\r\n    {\r\n        type: \"tap\",\r\n        category: \"Accessories\",\r\n        sprite: [\"2\", 2, 9],\r\n        search: [\"stopcock\", \"stop cock\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"camera\",\r\n        category: \"Accessories\",\r\n        sprite: [\"2\", 6, 3],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"videocamera\",\r\n        category: \"Accessories\",\r\n        sprite: [\"2\", 6, 4],\r\n        search: []\r\n    },\r\n    {\r\n        type: \"label\",\r\n        category: \"Labelling\",\r\n        sprite: [9, 7],\r\n        search: [\"text\", \"sticker\"]\r\n    },\r\n    {\r\n        type: \"eye\",\r\n        category: \"Labelling\",\r\n        sprite: [9, 3],\r\n        search: [\"eye\", \"pointer\", \"focus\", \"attention\", \"highlight\"]\r\n    },\r\n    {\r\n        type: \"ghs hazard\",\r\n        category: \"Labelling\",\r\n        sprite: [8, 10],\r\n        search: [\"signs\", \"symbols\", \"warning\", \"flammable\", \"danger\"],\r\n    },\r\n    {\r\n        type: \"rectangle\",\r\n        category: \"Basic shapes\",\r\n        sprite: [\"2\", 1, 0],\r\n        search: [\"square\"],\r\n    },\r\n    {\r\n        type: \"ellipse\",\r\n        category: \"Basic shapes\",\r\n        sprite: [\"2\", 1, 1],\r\n        search: [\"circle\", \"ring\"],\r\n    },\r\n    {\r\n        type: \"line\",\r\n        category: \"Basic shapes\",\r\n        sprite: [\"2\", 1, 7],\r\n        search: [\"wire\"],\r\n    },\r\n    {\r\n        type: \"curve\",\r\n        category: \"Basic shapes\",\r\n        sprite: [\"2\", 1, 6],\r\n        search: [\"wire\", \"wires\", \"line\", \"hose\", \"pipe\", \"tube\", \"delivery\"],\r\n    },\r\n    {\r\n        type: \"triangle\",\r\n        category: \"Basic shapes\",\r\n        sprite: [\"2\", 8, 1],\r\n        search: [\"ramp\"],\r\n    },\r\n    {\r\n        type: \"arrow\",\r\n        category: \"Arrows\",\r\n        sprite: [\"2\", 1, 4],\r\n        search: [],\r\n    },\r\n    {\r\n        type: \"curved arrow\",\r\n        category: \"Arrows\",\r\n        sprite: [\"2\", 9, 0],\r\n        search: [\"arrow\", \"curve\"],\r\n    },\r\n    {\r\n        type: \"stir arrow\",\r\n        category: \"Arrows\",\r\n        sprite: [\"2\", 9, 1],\r\n        search: [\"shake arrow\", \"swirl\", \"spin\", \"stirring\", \"shaking\", \"swirling\", \"spinning\"],\r\n    },\r\n    {\r\n        type: \"cross\",\r\n        category: \"Basic shapes\",\r\n        sprite: [\"2\", 1, 2],\r\n        search: [\"plus\"],\r\n    },\r\n    {\r\n        type: \"star\",\r\n        category: \"Basic shapes\",\r\n        sprite: [\"2\", 1, 8],\r\n        search: [],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"tick\",\r\n        category: \"Basic shapes\",\r\n        sprite: [\"2\", 1, 3],\r\n        search: [],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"cuboid\",\r\n        category: \"3D\",\r\n        sprite: [\"2\", 1, 9],\r\n        search: [\"cube\", \"rectangle\", \"box\"],\r\n    },\r\n    {\r\n        type: \"3dcylinder\",\r\n        category: \"3D\",\r\n        sprite: [\"2\", 1, 5],\r\n        search: [\"cylinder\", \"rod\", \"electrode\"],\r\n    },\r\n    {\r\n        type: \"sphere\",\r\n        category: \"3D\",\r\n        sprite: [\"2\", 1, 10],\r\n        search: [\"atom\", \"ball\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"leaf\",\r\n        category: \"Organic\",\r\n        sprite: [\"2\", 3, 0],\r\n        search: [\"leaves\", \"green\"],\r\n    },\r\n    {\r\n        type: \"plant shoot\",\r\n        category: \"Organic\",\r\n        sprite: [\"2\", 3, 9],\r\n        search: [],\r\n    },\r\n    {\r\n        type: \"root\",\r\n        category: \"Organic\",\r\n        sprite: [\"2\", 5, 1],\r\n        search: [],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"shoot\",\r\n        category: \"Organic\",\r\n        sprite: [\"2\", 4, 1],\r\n        search: [\"plant\", \"straight shoot\"],\r\n    },\r\n    {\r\n        type: \"pond weed\",\r\n        category: \"Organic\",\r\n        sprite: [\"2\", 4, 0],\r\n        search: [\"leaves\", \"green\", \"plant\", \"waterweed\", \"elodea\"],\r\n    },\r\n    {\r\n        type: \"potato\",\r\n        category: \"Organic\",\r\n        sprite: [\"2\", 3, 1],\r\n        search: [\"chip\"],\r\n    },\r\n    {\r\n        type: \"agar\",\r\n        category: \"Organic\",\r\n        sprite: [\"2\", 3, 6],\r\n        search: [\"jelly\", \"gel\", \"cube\"],\r\n    },\r\n    {\r\n        type: \"bug\",\r\n        category: \"Organic\",\r\n        sprite: [\"2\", 5, 2],\r\n        search: [\"insect\", \"spider\"],\r\n    },\r\n    {\r\n        type: \"seed\",\r\n        category: \"Organic\",\r\n        sprite: [\"2\", 3, 2],\r\n        search: [],\r\n    },\r\n    {\r\n        type: \"bacteria\",\r\n        category: \"Organic\",\r\n        sprite: [\"2\", 4, 4],\r\n        search: [\"culture\", \"petri dish\", \"sample dish\"],\r\n    },\r\n    {\r\n        type: \"streaked bacteria\",\r\n        category: \"Organic\",\r\n        sprite: [\"2\", 7, 3],\r\n        search: [\"culture\", \"petri dish\", \"sample dish\"],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"microscope\",\r\n        category: \"_Bio_Equipment\",\r\n        sprite: [\"2\", 3, 4],\r\n        search: [],\r\n    },\r\n    {\r\n        type: \"microscope slide\",\r\n        category: \"_Bio_Equipment\",\r\n        sprite: [\"2\", 3, 7],\r\n        search: [],\r\n    },\r\n    {\r\n        type: \"cover slip\",\r\n        category: \"_Bio_Equipment\",\r\n        sprite: [\"2\", 3, 8],\r\n        search: [\"microscope\", \"slide\"],\r\n    },\r\n    {\r\n        type: \"potometer\",\r\n        category: \"_Bio_Equipment\",\r\n        sprite: [\"2\", 4, 3],\r\n        search: [],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"petri top\",\r\n        category: \"_Bio_Equipment\",\r\n        sprite: [\"2\", 3, 3],\r\n        search: [\"petri dish\", \"sample dish\"],\r\n    },\r\n    {\r\n        type: \"tweezers\",\r\n        category: \"_Bio_Equipment\",\r\n        sprite: [\"2\", 4, 2],\r\n        search: [\"forceps\"],\r\n    },\r\n    {\r\n        type: \"scalpel\",\r\n        category: \"_Bio_Equipment\",\r\n        sprite: [\"2\", 4, 6],\r\n        search: [],\r\n        tier: \"boost\",\r\n    },\r\n    {\r\n        type: \"quadrat\",\r\n        category: \"_Bio_Equipment\",\r\n        sprite: [\"2\", 4, 7],\r\n        search: [\"grid\"],\r\n    },\r\n    {\r\n        type: \"water bath\",\r\n        category: \"_Bio_Equipment\",\r\n        sprite: [\"2\", 4, 10],\r\n        search: [],\r\n    },\r\n    {\r\n        type: \"pot\",\r\n        category: \"_Bio_Other\",\r\n        sprite: [\"2\", 3, 10],\r\n        search: [],\r\n    },\r\n    {\r\n        type: \"dirt\",\r\n        category: \"_Bio_Other\",\r\n        sprite: [\"2\", 4, 5],\r\n        search: [\"earth\", \"ground\", \"soil\"],\r\n    },\r\n    {\r\n        type: \"cotton wool\",\r\n        category: \"_Bio_Other\",\r\n        sprite: [\"2\", 3, 5],\r\n        search: [],\r\n    },\r\n    {\r\n        type: \"sun\",\r\n        category: \"_Bio_Other\",\r\n        sprite: [\"2\", 4, 8],\r\n        search: [\"light\", \"rays\"],\r\n    },\r\n    {\r\n        type: \"magnet\",\r\n        category: \"Electrical\",\r\n        sprite: [\"3\", 0, 0],\r\n        search: [],\r\n        released: Flags.isPhysicsEnabled,\r\n    },\r\n    {\r\n        type: \"powerpack\",\r\n        category: \"Electrical\",\r\n        sprite: [\"3\", 0, 1],\r\n        search: [],\r\n        released: Flags.isPhysicsEnabled,\r\n    },\r\n    {\r\n        type: \"digital ammeter\",\r\n        category: \"Electrical\",\r\n        sprite: [\"3\", 1, 3],\r\n        search: [],\r\n        released: Flags.isPhysicsEnabled,\r\n    },\r\n    {\r\n        type: \"digital voltmeter\",\r\n        category: \"Electrical\",\r\n        sprite: [\"3\", 1, 2],\r\n        search: [],\r\n        released: Flags.isPhysicsEnabled,\r\n    },\r\n    {\r\n        type: \"cable\",\r\n        category: \"Electrical\",\r\n        sprite: [\"3\", 0, 4],\r\n        search: [\"wire\", \"banana clips\"],\r\n        released: Flags.isPhysicsEnabled,\r\n    },\r\n    {\r\n        type: \"light gate\",\r\n        category: \"Optics\",\r\n        sprite: [\"3\", 1, 4],\r\n        search: [],\r\n        released: Flags.isPhysicsEnabled,\r\n    },\r\n    {\r\n        type: \"solenoid\",\r\n        category: \"Electrical\",\r\n        sprite: [\"3\", 1, 5],\r\n        search: [],\r\n        released: Flags.isPhysicsEnabled,\r\n    },\r\n    {\r\n        type: \"ammeter-s\",\r\n        category: \"Electrical\",\r\n        sprite: [\"3\", 0, 2],\r\n        search: [],\r\n        released: Flags.isPhysicsEnabled,\r\n    },\r\n    {\r\n        type: \"voltmeter-s\",\r\n        category: \"Electrical\",\r\n        sprite: [\"3\", 0, 3],\r\n        search: [],\r\n        released: Flags.isPhysicsEnabled,\r\n    },\r\n    {\r\n        type: \"trolley\",\r\n        category: \"Dynamics\",\r\n        sprite: [\"3\", 1, 0],\r\n        search: [],\r\n        released: Flags.isPhysicsEnabled,\r\n    },\r\n    {\r\n        type: \"ramp\",\r\n        category: \"Dynamics\",\r\n        sprite: [\"3\", 1, 1],\r\n        search: [],\r\n        released: Flags.isPhysicsEnabled,\r\n    },\r\n    {\r\n        type: \"pulley\",\r\n        category: \"Dynamics\",\r\n        sprite: [\"3\", 0, 5],\r\n        search: [],\r\n        released: Flags.isPhysicsEnabled,\r\n    },\r\n    {\r\n        type: \"raybox\",\r\n        category: \"Optics\",\r\n        sprite: [\"3\", 0, 6],\r\n        search: [\"laser box\", \"ray box\"],\r\n        released: Flags.isPhysicsEnabled,\r\n    },\r\n    {\r\n        type: \"glass block\",\r\n        category: \"Optics\",\r\n        sprite: [\"3\", 0, 7],\r\n        search: [\"refraction\", \"ray\", \"laser\"],\r\n        released: Flags.isPhysicsEnabled,\r\n    },\r\n    {\r\n        type: \"spring\",\r\n        category: \"Dynamics\",\r\n        sprite: [\"3\", 0, 8],\r\n        search: [],\r\n        released: Flags.isPhysicsEnabled,\r\n    },\r\n    {\r\n        type: \"slotted weight\",\r\n        category: \"Dynamics\",\r\n        sprite: [\"3\", 0, 9],\r\n        search: [\"mass\"],\r\n        released: Flags.isPhysicsEnabled,\r\n    },\r\n    {\r\n        type: \"mirror\",\r\n        category: \"Optics\",\r\n        sprite: [\"3\", 0, 10],\r\n        search: [],\r\n        released: Flags.isPhysicsEnabled,\r\n    },\r\n];\r\n// Adds names to the above list.\r\nvar apparatusSpecListWithNames = apparatusSpecList\r\n    // Filter out apparatus that is not yet released.\r\n    .filter(function (spec) { var _a; return ((_a = spec.released) !== null && _a !== void 0 ? _a : true); })\r\n    .map(function (spec) {\r\n    var name = apparatusClass(spec.type).properties.label;\r\n    return __assign(__assign({}, spec), { name: name, lowerCaseName: name.toLowerCase() });\r\n});\r\nvar releasedItems = apparatusSpecList.filter(function (spec) { var _a; return ((_a = spec.released) !== null && _a !== void 0 ? _a : true); });\r\nvar releasedAndFreeItems = releasedItems.filter(function (spec) { return spec.tier === undefined; });\r\nexport var itemsThatRequireBoost = apparatusSpecList.filter(function (spec) { return spec.tier == \"boost\"; }).map(function (spec) { return spec.type; });\r\n/** Count the number of items that are released. */\r\nexport var releasedItemsCount = releasedItems.length;\r\n/** Count the number of items that are in free tier and publicly available. */\r\nexport var releasedAndFreeItemsCount = releasedAndFreeItems.length;\r\nexport default apparatusSpecListWithNames;\r\n","// Component for checkbox\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport * as React from \"react\";\r\nimport { TierContext } from \"tiers/context\";\r\nexport var Checkbox = function (props) {\r\n    var _a;\r\n    return (React.createElement(\"input\", { type: \"checkbox\", className: \"custom-control-input\", ref: function (el) { return el && (el.indeterminate = (props.value === undefined)); }, id: props.id, checked: (_a = props.value) !== null && _a !== void 0 ? _a : false, disabled: props.disabled, onChange: function (e) { return props.onCheckedChange(e.target.checked); } }));\r\n};\r\nexport var LabelledCheckbox = function (props) {\r\n    var tiers = React.useContext(TierContext);\r\n    var disableCheckbox = !tiers.allow(props) && props.allowWhenLocked !== true;\r\n    var className = \"custom-control \" + (props.useSwitch ? \"custom-switch\" : \"custom-checkbox\");\r\n    var onClick = disableCheckbox ? function () { return tiers.popup(\"PP:\" + props.id); } : undefined;\r\n    return React.createElement(\"div\", { className: className, onClick: onClick },\r\n        React.createElement(Checkbox, __assign({}, props, { id: props.id, key: props.id, disabled: disableCheckbox })),\r\n        React.createElement(\"label\", { key: \"label\", className: \"custom-control-label\", htmlFor: props.id },\r\n            props.label,\r\n            tiers.badge(props) /* Display badge if locked. */));\r\n};\r\nexport var LabelledCheckboxGroup = function (props) { return (React.createElement(\"div\", null, props.checkboxes.map(function (c) { return React.createElement(LabelledCheckbox, __assign({}, c, { key: c.id })); }))); };\r\n","import { Gradients } from \"apparatus/gradients\";\r\nimport { P, Pivot, R, SharedColors } from \"apparatus/library/common\";\r\nimport { createJack } from \"apparatus/library/electrical/powerpack\";\r\nimport { Group, Path, PointText, Shape } from \"paper\";\r\nvar DigitalVoltmeter = /** @class */ (function () {\r\n    function DigitalVoltmeter() {\r\n    }\r\n    DigitalVoltmeter.prototype.render = function (appearance) {\r\n        return renderMeter(appearance, \"V\");\r\n    };\r\n    DigitalVoltmeter.properties = {\r\n        label: \"Digital Voltmeter\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            reading: \"12.00\",\r\n        },\r\n        appearanceSpecs: [],\r\n    };\r\n    return DigitalVoltmeter;\r\n}());\r\nexport { DigitalVoltmeter };\r\nvar DigitalAmmemter = /** @class */ (function () {\r\n    function DigitalAmmemter() {\r\n    }\r\n    DigitalAmmemter.prototype.render = function (appearance) {\r\n        return renderMeter(appearance, \"A\");\r\n    };\r\n    DigitalAmmemter.properties = {\r\n        label: \"Digital Ammeter\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            reading: \"12.00\",\r\n        },\r\n        appearanceSpecs: [],\r\n    };\r\n    return DigitalAmmemter;\r\n}());\r\nexport { DigitalAmmemter };\r\nfunction renderMeter(appearance, unit) {\r\n    var casing = new Path.Rectangle(R(0, 0, 90, 62, Pivot.TOP_CENTER), 3.0)\r\n        .withStroke(\"default\")\r\n        .withGradientFill(\"down\", Gradients.box(SharedColors.deviceGrey.color(), { shift: 0.15 }));\r\n    var dcJack1 = createJack(\"#f61f2f\").withPosition(P(-30, 46));\r\n    var dcJack2 = createJack(\"#414141\").withPosition(P(30, 46));\r\n    var screen = Shape.Rectangle(R(0, 8, 70, 25, Pivot.TOP_CENTER), 2)\r\n        .withStroke(2.0, \"white\")\r\n        .withFill(SharedColors.lcdScreen);\r\n    var backgroundText = new PointText({\r\n        point: P(0, 59),\r\n        content: unit,\r\n        fillColor: '#d1d5d9',\r\n        fontFamily: 'sans-serif',\r\n        fontSize: 78,\r\n        justification: \"center\",\r\n    });\r\n    var text = new PointText({\r\n        point: P(30, 27),\r\n        content: appearance.reading,\r\n        fillColor: 'black',\r\n        fontFamily: 'sans-serif',\r\n        fontSize: 15,\r\n        justification: \"right\",\r\n    });\r\n    var unitText = new PointText({\r\n        point: P(-30, 27),\r\n        content: unit,\r\n        fillColor: \"#61893f\",\r\n        fontFamily: 'sans-serif',\r\n        fontWeight: 'bold',\r\n        fontSize: 15,\r\n        justification: \"left\",\r\n    });\r\n    var graphic = new Group([casing, backgroundText, dcJack1, dcJack2, screen, text, unitText]);\r\n    return {\r\n        graphic: graphic,\r\n        hitShape: graphic.bounds.toShape()\r\n    };\r\n}\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nexport var FONT_FAMILY_OPTIONS = [\r\n    { value: \"sans-serif\", label: \"Default\" },\r\n    { value: \"Arial\", label: \"Arial\" },\r\n    { value: \"Calibri\", label: \"Calibri\" },\r\n    { value: \"Comic Sans MS\", label: \"Comic Sans\" },\r\n    { value: \"Courier New\", label: \"Courier New\" },\r\n    { value: \"Georgia\", label: \"Georgia\" },\r\n    { value: \"Rubik\", label: \"Rubik\" },\r\n    { value: \"Times New Roman\", label: \"Times New Roman\" },\r\n    { value: \"Verdana\", label: \"Verdana\" },\r\n];\r\nexport var TEXT_COLOUR_SWATCHES = {\r\n    \"Black\": \"#000000\",\r\n    \"Red\": \"#FF3B2D\",\r\n    \"Blue\": \"#4353EB\",\r\n    \"Green\": \"#43882E\",\r\n};\r\nexport var DEMO_COLOUR_SWATCHES = __assign({}, TEXT_COLOUR_SWATCHES);\r\n","import { P } from \"apparatus/library/common\";\r\nvar Random = /** @class */ (function () {\r\n    function Random(seed) {\r\n        if (seed === void 0) { seed = 1238167; }\r\n        this.generator = sfc32(seed, 871238, 61237, 301189);\r\n    }\r\n    // Returns a random vector sampled uniformly from a square, from (-x, -x) to (x, x)\r\n    Random.prototype.randomUnitVector = function (x) {\r\n        if (x === void 0) { x = 1.0; }\r\n        return P(this.randomUnitValue(x), this.randomUnitValue(x));\r\n    };\r\n    // Returns random value from -x to x\r\n    Random.prototype.randomUnitValue = function (x) {\r\n        if (x === void 0) { x = 1.0; }\r\n        return (this.generator() - 0.5) * 2 * x;\r\n    };\r\n    Random.prototype.randomBetween = function (min, max) {\r\n        return min + (max - min) * this.generator();\r\n    };\r\n    Random.prototype.randomInBounds = function (r) {\r\n        var x = this.randomBetween(r.left, r.right);\r\n        var y = this.randomBetween(r.top, r.bottom);\r\n        return P(x, y);\r\n    };\r\n    return Random;\r\n}());\r\nexport { Random };\r\nfunction sfc32(a, b, c, d) {\r\n    return function () {\r\n        a >>>= 0;\r\n        b >>>= 0;\r\n        c >>>= 0;\r\n        d >>>= 0;\r\n        var t = (a + b) | 0;\r\n        a = b ^ b >>> 9;\r\n        b = c + (c << 3) | 0;\r\n        c = (c << 21 | c >>> 11);\r\n        d = d + 1 | 0;\r\n        t = t + d | 0;\r\n        c = c + t | 0;\r\n        return (t >>> 0) / 4294967296;\r\n    };\r\n}\r\n","import { addMarkers2, breakPath, mirrorX, setDefaultStyle } from \"apparatus/draw\";\r\nimport { P, Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, PointText, Shape } from \"paper\";\r\nvar allSizes = [\"0.5\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"15\", \"20\", \"25\", \"30\", \"40\", \"50\", \"100\"];\r\nvar BLACK = \"#000000\";\r\nvar BLUE = \"#0423af\";\r\nvar ORANGE = \"#db720f\";\r\nvar RED = \"#aa1d1d\";\r\nvar WHITE = \"#eeeeee\";\r\nvar GREEN = \"#20b12f\";\r\nvar YELLOW = \"#eadb10\";\r\nvar LABEL_COLOR = \"#33333366\";\r\n/**\r\n * Original:\r\n *  - https://www.fishersci.com/shop/products/pyrex-reusable-class-a-volumetric-pipets-capacity-25ml-tolerance-0-03ml-color-code-blue/136511n\r\n *\r\n * Colour coding:\r\n *  - https://www.coleparmer.co.uk/p/blaubrand-bulb-pipettes/81461\r\n *  - https://1.bp.blogspot.com/-LUBA0vZZrxM/XBFI3Ogcv9I/AAAAAAAALUQ/eUV-Z2dC0DwjXWIfmB8zmRnt78P-Y0LFACLcBGAs/s1600/IMG_20181207_175733.jpg\r\n *\r\n * Example: https://www.sks-science.com/lab-supply-p-9503.html\r\n */\r\nvar Pipette = /** @class */ (function () {\r\n    function Pipette() {\r\n    }\r\n    Pipette.isBoostRequiredForAppearance = function (appearance) {\r\n        return appearance.showLabel;\r\n    };\r\n    Pipette.prototype.render = function (appearance) {\r\n        var radius = 5;\r\n        var _a = this.params(appearance.size), length = _a[0], bulbRadius = _a[1], bulbLength = _a[2], colorCode = _a[3], doubleCode = _a[4];\r\n        var bulbCenterRelative = 0.45;\r\n        var bulbStart = bulbCenterRelative * length - bulbLength / 2;\r\n        var bulbEnd = bulbStart + bulbLength;\r\n        var radiusDiff = bulbRadius - radius;\r\n        var oneSide = new Path(Segments([[radius, 0]], [[radius, bulbStart]], [[bulbRadius, bulbStart + bulbRadius], [0, -radiusDiff]], [[bulbRadius, bulbEnd - bulbRadius], , [0, radiusDiff]], [[radius, bulbEnd]], [[radius, length]]));\r\n        var shape = oneSide.clone();\r\n        mirrorX(shape);\r\n        var liquidMask = shape.clone();\r\n        shape.remove();\r\n        var otherSide = oneSide.clone();\r\n        otherSide.scale(-1, 1, P(0, 0));\r\n        var graphic = new Group([oneSide, otherSide]);\r\n        // Extend the lip on one side.\r\n        oneSide.lastSegment.point.y += 5;\r\n        setDefaultStyle(oneSide, otherSide);\r\n        // Add marker.\r\n        graphic.insertChild(0, new Path.Line(P(-radius, bulbStart - 20), P(radius, bulbStart - 20))\r\n            .withStroke(\"thinner\", LABEL_COLOR));\r\n        // Add volume label.\r\n        if (appearance.showLabel) {\r\n            var fontSize = bulbRadius * 0.9;\r\n            var label = new PointText({\r\n                point: P(0, bulbCenterRelative * length + fontSize / 2),\r\n                content: appearance.size,\r\n                fillColor: LABEL_COLOR,\r\n                fontFamily: 'sans-serif',\r\n                fontWeight: 'bold',\r\n                fontSize: fontSize,\r\n                justification: \"center\",\r\n            });\r\n            graphic.addChild(label);\r\n        }\r\n        // Add color code.\r\n        if (!doubleCode) {\r\n            graphic.insertChild(0, Shape.Rectangle(R(0, 15, radius * 2, 12, Pivot.TOP_CENTER)).withFill(colorCode));\r\n        }\r\n        else {\r\n            graphic.insertChildren(0, [\r\n                Shape.Rectangle(R(0, 15, radius * 2, 5, Pivot.TOP_CENTER)).withFill(colorCode),\r\n                Shape.Rectangle(R(0, 15 + 7, radius * 2, 5, Pivot.TOP_CENTER)).withFill(colorCode),\r\n            ]);\r\n        }\r\n        // Scale everything.\r\n        var center = graphic.bounds.center;\r\n        graphic.scale(appearance.scale, center);\r\n        liquidMask.scale(appearance.scale, center);\r\n        var hitShape = graphic.bounds.expand(5).toShape();\r\n        return { graphic: graphic, hitShape: hitShape, liquidMask: liquidMask, watermark: P(5, bulbEnd) };\r\n    };\r\n    Pipette.prototype.params = function (size) {\r\n        switch (size) {\r\n            case \"0.5\":\r\n                return [300, 7, 40, BLACK, true];\r\n            case \"1\":\r\n                return [300, 7, 40, BLUE, false];\r\n            case \"2\":\r\n                return [330, 8, 40, ORANGE, false];\r\n            case \"3\":\r\n                return [330, 9, 42, BLACK, false];\r\n            case \"4\":\r\n                return [400, 9, 42, RED, true];\r\n            case \"5\":\r\n                return [400, 10, 45, WHITE, false];\r\n            case \"6\":\r\n                return [400, 11, 45, ORANGE, true];\r\n            case \"7\":\r\n                return [400, 12, 50, GREEN, true];\r\n            case \"8\":\r\n                return [440, 13, 50, BLUE, false];\r\n            case \"9\":\r\n                return [440, 14, 50, BLACK, false];\r\n            case \"10\":\r\n                return [440, 15, 55, RED, false];\r\n            case \"15\":\r\n                return [510, 16, 55, GREEN, false];\r\n            case \"20\":\r\n                return [510, 16, 60, YELLOW, false];\r\n            case \"25\":\r\n                return [520, 17, 60, BLUE, false];\r\n            case \"30\":\r\n                return [520, 18, 65, BLACK, false];\r\n            case \"40\":\r\n                return [540, 18, 70, WHITE, false];\r\n            case \"50\":\r\n                return [540, 19, 75, RED, false];\r\n            case \"100\":\r\n                return [585, 20, 80, YELLOW, false];\r\n        }\r\n    };\r\n    Pipette.properties = {\r\n        label: \"Pipette\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            size: \"10\",\r\n            scale: 0.73,\r\n            showLabel: false,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.6, max: 1.0, step: 0.01, unit: \"%\"\r\n            },\r\n            {\r\n                spec: \"select\", key: \"size\", label: \"Max volume\",\r\n                options: allSizes.map(function (s) { return ({ label: s + \" mL\", value: s }); })\r\n            },\r\n            { spec: \"checkbox\", key: \"showLabel\", label: \"Show label\", tier: \"boost\", allowWhenLocked: true },\r\n        ],\r\n    };\r\n    return Pipette;\r\n}());\r\nexport { Pipette };\r\nvar PlasticPipette = /** @class */ (function () {\r\n    function PlasticPipette() {\r\n    }\r\n    PlasticPipette.prototype.render = function (appearance) {\r\n        var length = appearance.length;\r\n        var lip = 30;\r\n        var bulb = 40;\r\n        var bodyWidth = 8;\r\n        var bulbWidth = 15;\r\n        var graphic = new Path(Segments([[2, length]], [[bodyWidth / 2, length - lip]], [[bodyWidth / 2, bulb]], [[bulbWidth / 2, bulb - 10]], [[bulbWidth / 2, 0], undefined, [0, -10]]));\r\n        mirrorX(graphic);\r\n        var liquidMask = graphic.clone();\r\n        setDefaultStyle(graphic);\r\n        return { graphic: graphic, hitShape: graphic.strokeBounds.toShape(), liquidMask: liquidMask };\r\n    };\r\n    PlasticPipette.properties = {\r\n        label: \"Plastic Pipette\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            length: 155,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"length\", label: \"Length\",\r\n                min: 100, max: 180\r\n            }\r\n        ],\r\n    };\r\n    return PlasticPipette;\r\n}());\r\nexport { PlasticPipette };\r\nvar MohrPipette = /** @class */ (function () {\r\n    function MohrPipette() {\r\n    }\r\n    MohrPipette.prototype.render = function (appearance) {\r\n        var length = appearance.length;\r\n        var shape = new Path(Segments([[4, 0]], [[4, 40]], [[8, 47], [0, -4]], [[8, length - 40], , [0, 5]], [[4, length]]));\r\n        mirrorX(shape);\r\n        var liquidMask = shape.clone();\r\n        var graphic = breakPath(shape, 5);\r\n        setDefaultStyle(graphic);\r\n        addMarkers2(graphic, { start: P(6, length - 50), step: P(0, -4), count: (length - 150) / 4 + 1, majorEvery: 5 });\r\n        return { graphic: graphic, hitShape: graphic.strokeBounds.toShape(), liquidMask: liquidMask };\r\n    };\r\n    MohrPipette.properties = {\r\n        label: \"Mohr Pipette\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            length: 350\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"length\", label: \"Size\",\r\n                min: 250, max: 350\r\n            }\r\n        ],\r\n    };\r\n    return MohrPipette;\r\n}());\r\nexport { MohrPipette };\r\n","import { strokeWidth } from \"apparatus/common\";\r\nimport { mirrorX } from \"apparatus/draw\";\r\nimport { Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nvar ThermosFlask = /** @class */ (function () {\r\n    function ThermosFlask() {\r\n    }\r\n    ThermosFlask.prototype.render = function (appearance) {\r\n        var wallThickness = 8;\r\n        var neckSize = appearance.neckSize;\r\n        var radius = appearance.width / 2;\r\n        var height = appearance.height;\r\n        var outline = new Path(Segments([[neckSize, 0]], [[neckSize, 10], , [0, 15]], [[radius, 40], [0, -15]], [[radius, height - 20], , [0, 10]], [[radius - 20, height], [10, 0]]));\r\n        mirrorX(outline);\r\n        // Create the liquid mask first. The mask is closed but the\r\n        // graphics is not.\r\n        var liquidMask = outline.clone();\r\n        liquidMask.closePath();\r\n        // Reuse the outline as the thicker outline, forming the walls.\r\n        outline.strokeCap = \"round\";\r\n        var innerWall = outline.clone();\r\n        outline.withStroke(strokeWidth(\"default\") * 2 + wallThickness, SharedColors.stroke);\r\n        innerWall.withStroke(wallThickness, \"white\");\r\n        var graphic = new Group([outline, innerWall]);\r\n        return {\r\n            graphic: graphic,\r\n            liquidMask: liquidMask,\r\n            hitShape: outline.strokeBounds.toShape(),\r\n            snapping: outline.placeable()\r\n        };\r\n    };\r\n    ThermosFlask.properties = {\r\n        label: \"Vacuum Flask\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            neckSize: 18,\r\n            height: 240,\r\n            width: 80,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"width\", label: \"Diameter\",\r\n                min: 60, max: 90,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Height\",\r\n                min: 160, max: 250,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"neckSize\", label: \"Neck Size\",\r\n                min: 12, max: 20, step: 0.5\r\n            }\r\n        ],\r\n    };\r\n    return ThermosFlask;\r\n}());\r\nexport { ThermosFlask };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { breakPath, setDefaultStyle } from \"apparatus/draw\";\r\nimport { P, Segments, SharedGradients } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\n/** Filter paper stroke color */\r\nvar strokeColor = \"#cccccc\";\r\n/** Used by \"folded\" and \"folded-simple\". Lower results in narrower paper. */\r\nvar FOLD_DRAW_RATIO = 0.8;\r\nvar FilterFunnel = /** @class */ (function () {\r\n    function FilterFunnel() {\r\n    }\r\n    FilterFunnel.prototype.render = function (appearance) {\r\n        var ratio = 0.8;\r\n        var height = appearance.funnelSize, stem = appearance.stemLength, stemD = appearance.stemDiameter;\r\n        var shape = new Path(Segments([[-height * ratio, -height]], [[0, 0]], [[0, stem]], [[stemD, stem + 5]], [[stemD, 0]], [[stemD + height * ratio, -height]]));\r\n        var hitShape = shape.clone();\r\n        var liquidMask = shape.clone();\r\n        var graphic = breakPath(shape, 3);\r\n        setDefaultStyle(graphic);\r\n        return { graphic: graphic, hitShape: hitShape, liquidMask: liquidMask };\r\n    };\r\n    FilterFunnel.properties = {\r\n        label: \"Filter Funnel\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            funnelSize: 55,\r\n            stemLength: 45,\r\n            stemDiameter: 10,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"funnelSize\", label: \"Funnel size\",\r\n                min: 30, max: 90,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"stemLength\", label: \"Stem length\",\r\n                min: 30, max: 80,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"stemDiameter\", label: \"Stem diameter\",\r\n                min: 7, max: 35, unit: \"mm\"\r\n            },\r\n        ],\r\n    };\r\n    return FilterFunnel;\r\n}());\r\nexport { FilterFunnel };\r\nvar FilterPaper = /** @class */ (function () {\r\n    function FilterPaper() {\r\n    }\r\n    FilterPaper.prototype.render = function (appearance) {\r\n        var graphic = createGraphic(appearance);\r\n        graphic.scale(appearance.diameter / 90);\r\n        var hitShape = Shape.Rectangle(graphic.bounds);\r\n        return { graphic: graphic, hitShape: hitShape };\r\n    };\r\n    FilterPaper.properties = {\r\n        label: \"Filter paper\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            style: \"folded\",\r\n            folding: \"simple\",\r\n            diameter: 90.0,\r\n            residue: false,\r\n            residueColor: \"#9c735d\",\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"style\", label: \"View and style\",\r\n                options: [\r\n                    { value: \"top\", label: \"Top view\" },\r\n                    { value: \"folded\", label: \"Folded, side view\" },\r\n                    { value: \"folded-simple\", label: \"Simple, side view\" },\r\n                ]\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"diameter\", label: \"Diameter\",\r\n                min: 60, max: 150,\r\n            },\r\n            {\r\n                spec: \"checkbox\", key: \"residue\", label: \"Residue\",\r\n            },\r\n            {\r\n                visible: function (a) { return a.residue; },\r\n                spec: \"color\", key: \"residueColor\", label: \"Residue color\",\r\n            },\r\n        ],\r\n    };\r\n    return FilterPaper;\r\n}());\r\nexport { FilterPaper };\r\nvar FlutedFilterPaper = /** @class */ (function () {\r\n    function FlutedFilterPaper() {\r\n    }\r\n    FlutedFilterPaper.prototype.render = function (appearance) {\r\n        var graphic = createGraphic(appearance);\r\n        graphic.scale(appearance.diameter / 90);\r\n        var hitShape = Shape.Rectangle(graphic.bounds);\r\n        return { graphic: graphic, hitShape: hitShape };\r\n    };\r\n    FlutedFilterPaper.properties = {\r\n        label: \"Fluted Filter paper\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: __assign(__assign({}, FilterPaper.properties.defaultAppearance), { folding: \"fluted\" }),\r\n        appearanceSpecs: FilterPaper.properties.appearanceSpecs\r\n    };\r\n    return FlutedFilterPaper;\r\n}());\r\nexport { FlutedFilterPaper };\r\nfunction createGraphic(appearance) {\r\n    switch (appearance.style) {\r\n        case \"top\":\r\n            return function () {\r\n                var graphic = new Group();\r\n                var filterPaper = Shape.Circle(P(0, 0), 45)\r\n                    .withStroke(\"thinner\", strokeColor);\r\n                filterPaper.setRadialGradientFill(SharedGradients.filterPaper);\r\n                graphic.addChild(filterPaper);\r\n                if (appearance.folding == \"fluted\") {\r\n                    var valleyFold = createValleyFold([[0, 0]], [[5, 45]], [[-5, 45]]);\r\n                    graphic.addChild(valleyFold);\r\n                    var mountainFold = createMountainFold(\"aa\", [[0, 0]], [[5, 45]], [[-5, 45]]);\r\n                    mountainFold.rotate(15, P(0, 0));\r\n                    graphic.addChild(mountainFold);\r\n                    for (var i = 1; i < 12; i++) {\r\n                        valleyFold.clone();\r\n                        valleyFold.rotate(30, P(0, 0));\r\n                        mountainFold.clone();\r\n                        mountainFold.rotate(30, P(0, 0));\r\n                        graphic.addChild(valleyFold);\r\n                        graphic.addChild(mountainFold);\r\n                    }\r\n                }\r\n                if (!appearance.residue) {\r\n                    return graphic;\r\n                }\r\n                // Add residue.\r\n                var residue = new Path(Segments([[10, 10], [-5, -5], [6, 6]], [[-10, 10], [-5, 3], [-3, -8]], [[-10, -10], [7, 9], [-4, -11]], [[10, -10], [4, 4], [15, -5]]));\r\n                residue.closePath();\r\n                residue.fillColor = appearance.residueColor + \"aa\";\r\n                graphic.addChild(residue);\r\n                return graphic;\r\n            }();\r\n        case \"folded\":\r\n            var graphic_1 = new Group();\r\n            return function () {\r\n                var filterPaper = new Path(Segments([[0, 45]], [[45 * FOLD_DRAW_RATIO, 0], undefined, [3, -5]], [[-45 * FOLD_DRAW_RATIO, 0], [-3, -5]]));\r\n                filterPaper.close()\r\n                    .withStroke(\"thinner\", strokeColor)\r\n                    .setGradientFill(\"right-down\", SharedGradients.filterPaper);\r\n                var topLine = new Path(Segments([[45 * FOLD_DRAW_RATIO, 0], undefined, [0, 5]], [[-45 * FOLD_DRAW_RATIO, 0], [0, 5]]));\r\n                topLine.strokeColor = strokeColor;\r\n                // Add shading for the inside.\r\n                var insideShading = new Path(Segments([[-36, 0], [0, -5], [0, 5]], [[36, 0], [0, 5], [0, -5]]));\r\n                insideShading.closePath();\r\n                insideShading.fillColor = \"#00001028\";\r\n                graphic_1.addChildren([filterPaper, insideShading, topLine]);\r\n                if (appearance.folding == \"fluted\") {\r\n                    var valley = createValleyFold([[0, 45]], [[-5, -5]], [[5, -5]]);\r\n                    graphic_1.addChild(valley);\r\n                    var mountain1 = createMountainFold(\"30\", [[0, 45]], [[-5, -4]], [[5, -5]]);\r\n                    mountain1.rotate(8, P(0, 45));\r\n                    graphic_1.addChild(mountain1);\r\n                    var valley1 = valley.clone();\r\n                    valley1.rotate(17, P(0, 45));\r\n                    valley1.scale(1.0, 1.03, P(0, 45));\r\n                    var valley2 = valley.clone();\r\n                    valley2.rotate(34, P(0, 45));\r\n                    valley2.scale(1.0, 1.19, P(0, 45));\r\n                    var valley_1 = valley1.clone();\r\n                    valley1.scale(-1.0, 1.0, P(0, 45));\r\n                    var valley_2 = valley2.clone();\r\n                    valley2.scale(-1.0, 1.0, P(0, 45));\r\n                    var mountain2 = mountain1.clone();\r\n                    mountain1.rotate(17, P(0, 45));\r\n                    mountain1.scale(1.0, 1.06, P(0, 45));\r\n                    var mountain_1 = mountain1.clone();\r\n                    mountain_1.scale(-1.0, 1.0, P(0, 45));\r\n                    var mountain_2 = mountain2.clone();\r\n                    mountain_2.scale(-1.0, 1.0, P(0, 45));\r\n                    graphic_1.addChildren([valley1, valley2, valley_1, valley_2, mountain1, mountain2, mountain_1, mountain_2]);\r\n                }\r\n                else {\r\n                    var foldedPart = new Path(Segments([[-45 * FOLD_DRAW_RATIO, 0], undefined, [3, 5]], [[-20 * FOLD_DRAW_RATIO, 8]], [[0, 45]]));\r\n                    foldedPart.strokeColor = strokeColor;\r\n                    graphic_1.addChild(foldedPart);\r\n                }\r\n                if (!appearance.residue) {\r\n                    return graphic_1;\r\n                }\r\n                var residue = new Path(Segments([[0, 45]], [[16, 25], undefined, [-8, -8]], [[-16, 25], [8, 8]]));\r\n                residue.closePath();\r\n                residue.fillColor = appearance.residueColor + \"60\";\r\n                graphic_1.addChild(residue);\r\n                return graphic_1;\r\n            }();\r\n        case \"folded-simple\":\r\n            return foldedSimple(appearance);\r\n    }\r\n}\r\nfunction foldedSimple(appearance) {\r\n    var graphic = new Group();\r\n    var shape = new Path(Segments([[-45 * FOLD_DRAW_RATIO, 0]], [[0, 45]], [[45 * FOLD_DRAW_RATIO, 0]]));\r\n    setDefaultStyle(shape);\r\n    graphic.addChild(shape);\r\n    if (appearance.residue) {\r\n        var residue = new Path(Segments([[0, 45]], [[16, 25], undefined, [-8, -8]], [[-16, 25], [8, 8]]));\r\n        residue.closePath();\r\n        residue.fillColor = appearance.residueColor + \"60\";\r\n        graphic.addChild(residue);\r\n    }\r\n    return graphic;\r\n}\r\nfunction createValleyFold() {\r\n    var segments = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        segments[_i] = arguments[_i];\r\n    }\r\n    var valleyFold = new Path(Segments.apply(void 0, segments));\r\n    valleyFold.setGradientFill(\"right\", [[\"#00000000\", 0.0], [\"#00000015\", 0.5], [\"#00000000\", 1.0]]);\r\n    return valleyFold;\r\n}\r\nfunction createMountainFold(opacity) {\r\n    var segments = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        segments[_i - 1] = arguments[_i];\r\n    }\r\n    var mountainFold = new Path(Segments.apply(void 0, segments));\r\n    mountainFold.setGradientFill(\"right\", [[\"#ffffff00\", 0.0], [\"#ffffff\" + opacity, 0.5], [\"#ffffff00\", 1.0]]);\r\n    return mountainFold;\r\n}\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { ControlledMenu, MenuDivider, MenuItem, SubMenu } from \"@szhsin/react-menu\";\r\nimport { g } from \"analytics\";\r\nimport { commandProcessor } from \"command/command\";\r\nimport clipboard from \"editing/clipboard\";\r\nimport { deleteSelected } from \"editing/deleting\";\r\nimport { ReorderItems } from \"ordering/actions\";\r\nimport React from \"react\";\r\nvar EditorContextMenu = /** @class */ (function (_super) {\r\n    __extends(EditorContextMenu, _super);\r\n    function EditorContextMenu() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.reorderAction = function (action) {\r\n            var command = ReorderItems.create(_this.extractSelectedIds(), action);\r\n            if (command) {\r\n                g(\"LayerOrdering\", action.capitalise() + \"-ContextMenu\");\r\n                commandProcessor.execute(command);\r\n            }\r\n        };\r\n        return _this;\r\n    }\r\n    EditorContextMenu.prototype.render = function () {\r\n        var _this = this;\r\n        var itemsSelected = !this.props.selected.isEmpty;\r\n        return React.createElement(ControlledMenu, { key: \"ContextMenu\", anchorPoint: this.props.contextMenu ? this.props.contextMenu.position : { x: 0, y: 0 }, isOpen: this.props.contextMenu !== undefined, onClose: function () { return _this.props.onClose(); } },\r\n            React.createElement(MenuItem, { key: \"Cut\", onClick: function () { return clipboard.cut(\"contextmenu\"); }, disabled: !itemsSelected },\r\n                React.createElement(\"i\", { className: \"fas fa-cut\" }),\r\n                \"Cut\"),\r\n            React.createElement(MenuItem, { key: \"Copy\", onClick: function () { return clipboard.copy(\"contextmenu\"); }, disabled: !itemsSelected },\r\n                React.createElement(\"i\", { className: \"far fa-copy\" }),\r\n                \"Copy\"),\r\n            React.createElement(MenuItem, { key: \"Paste\", onClick: function () { return clipboard.paste(\"contextmenu\"); } },\r\n                React.createElement(\"i\", { className: \"far fa-clipboard\" }),\r\n                \"Paste\"),\r\n            React.createElement(MenuDivider, null),\r\n            this.groupUngroupSection(),\r\n            React.createElement(MenuDivider, null),\r\n            React.createElement(SubMenu, { label: \"Order\", disabled: !itemsSelected, offsetX: -4 },\r\n                React.createElement(MenuItem, { onClick: function () { return _this.reorderAction(\"bringToFront\"); } },\r\n                    React.createElement(\"i\", { className: \"fad fa-bring-front\" }),\r\n                    \"Bring to front\"),\r\n                React.createElement(MenuItem, { onClick: function () { return _this.reorderAction(\"bringForward\"); } },\r\n                    React.createElement(\"i\", { className: \"fad fa-bring-forward\" }),\r\n                    \"Bring forward\"),\r\n                React.createElement(MenuItem, { onClick: function () { return _this.reorderAction(\"sendBackward\"); } },\r\n                    React.createElement(\"i\", { className: \"fad fa-send-backward\" }),\r\n                    \"Send backward\"),\r\n                React.createElement(MenuItem, { onClick: function () { return _this.reorderAction(\"sendToBack\"); } },\r\n                    React.createElement(\"i\", { className: \"fad fa-send-back\" }),\r\n                    \"Send to back\")),\r\n            React.createElement(MenuDivider, null),\r\n            React.createElement(MenuItem, { key: \"Delete\", onClick: function () { return deleteSelected(\"contextmenu\"); }, disabled: !itemsSelected },\r\n                React.createElement(\"i\", { className: \"far fa-trash-alt\" }),\r\n                \"Delete\"));\r\n    };\r\n    EditorContextMenu.prototype.groupUngroupSection = function () {\r\n        var _this = this;\r\n        var children = [];\r\n        if (this.props.selected.shouldAllowUngrouping) {\r\n            children.push(React.createElement(MenuItem, { key: \"Ungroup\", onClick: function () {\r\n                    var command = _this.props.selected.createUngroupObjectsCommand();\r\n                    if (command) {\r\n                        g(\"Grouping\", \"Ungroup-ContextMenu\");\r\n                        commandProcessor.execute(command);\r\n                    }\r\n                } },\r\n                React.createElement(\"i\", { className: \"far fa-object-ungroup\" }),\r\n                \"Ungroup\"));\r\n        }\r\n        if (this.props.selected.shouldAllowRegrouping) {\r\n            children.push(React.createElement(MenuItem, { key: \"Regroup\", onClick: function () {\r\n                    var command = _this.props.selected.createRegroupObjectsCommand();\r\n                    if (command) {\r\n                        g(\"Grouping\", \"Regroup-ContextMenu\");\r\n                        commandProcessor.execute(command);\r\n                    }\r\n                } },\r\n                React.createElement(\"i\", { className: \"fad fa-object-group\" }),\r\n                \"Regroup\"));\r\n        }\r\n        if (children.length == 0 || this.props.selected.shouldAllowGrouping) {\r\n            // Ensure there is at least one button: Group.\r\n            children.unshift(React.createElement(MenuItem, { key: \"Group\", disabled: !this.props.selected.shouldAllowGrouping, onClick: function () {\r\n                    var command = _this.props.selected.createGroupObjectsCommand();\r\n                    if (command) {\r\n                        g(\"Grouping\", \"Group-ContextMenu\");\r\n                        commandProcessor.execute(command);\r\n                    }\r\n                } },\r\n                React.createElement(\"i\", { className: \"far fa-object-group\" }),\r\n                \"Group\"));\r\n        }\r\n        return children;\r\n    };\r\n    EditorContextMenu.prototype.extractSelectedIds = function () {\r\n        return this.props.selected.items.map(function (a) { return a.id; });\r\n    };\r\n    return EditorContextMenu;\r\n}(React.Component));\r\nexport { EditorContextMenu };\r\n","import { createOutlinedGroup, mirrorX } from \"apparatus/draw\";\r\nimport { P, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { SVG } from \"apparatus/svg\";\r\nimport { Color, Gradient, Path } from \"paper\";\r\nvar CANDLE_GRADIENT = [\r\n    [\"#deca8b\", 0],\r\n    [\"#feeab8\", 0.31],\r\n    [\"#fcedc9\", 0.45],\r\n    [\"#deca8b\", 1.0],\r\n];\r\nvar STROKE = \"#c3b68e\";\r\nvar Candle = /** @class */ (function () {\r\n    function Candle() {\r\n    }\r\n    Candle.prototype.render = function (appearance) {\r\n        var width = appearance.diameter, height = appearance.height;\r\n        var base = new Path(Segments([[width / 2, 0], [12, -3]], [[width / 2, height - 5], , [7, -2]], [[width / 2 + 5, height]]));\r\n        mirrorX(base);\r\n        base.close().withGradientFill(\"right\", CANDLE_GRADIENT);\r\n        // Create some melted drops.\r\n        var drop = new Path(Segments([[0, 0]], [[5, 10], [0, -5], [0, 5]])).close();\r\n        mirrorX(drop);\r\n        drop.position = P(width / 2, 8);\r\n        drop.fillColor = new Color(new Gradient([[\"#fcedc9\", 0.4], [\"#ddbe61\", 1.0]], true), drop.bounds.center, drop.bounds.bottomRight, drop.bounds.topLeft);\r\n        var drop2 = drop.clone();\r\n        drop2.position = P(-width / 2, height / 2);\r\n        var drop3 = drop.clone();\r\n        drop3.position = P(width / 2 - 3, Math.min(height * 0.7, height - 10));\r\n        var graphic = createOutlinedGroup(\"thin\", STROKE, base, drop, drop2, drop3);\r\n        // Add wick.\r\n        graphic.insertChild(0, new Path(Segments([[0, 0], , [5, -5]], [[0, -12], [0, 5]])).withStroke(\"thick\", SharedColors.stroke));\r\n        // Add flame.\r\n        if (appearance.flame) {\r\n            graphic.addChild(SVG.redFlame().withPosition(P(0, -12)).withScale(0.75 * appearance.flameSize));\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            pivot: base.bounds.center,\r\n            snapping: base.placeable(),\r\n        };\r\n    };\r\n    Candle.properties = {\r\n        label: \"Candle\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            diameter: 30,\r\n            height: 100,\r\n            flame: true,\r\n            flameSize: 1.0,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"diameter\", label: \"Diameter\",\r\n                min: 20, max: 40, unit: \"mm\",\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Height\",\r\n                min: 20, max: 150, unit: \"mm\"\r\n            },\r\n            { spec: \"checkbox\", key: \"flame\", label: \"Show flame\" },\r\n            {\r\n                spec: \"slider\", key: \"flameSize\", label: \"Flame size\",\r\n                min: 0.5, max: 1.3, step: 0.1, unit: \"%\",\r\n                visible: function (a) { return a.flame; }\r\n            }\r\n        ],\r\n    };\r\n    return Candle;\r\n}());\r\nexport { Candle };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { addEdgeLips, mirrorX, setDefaultStyle, smoothCornersIndividual } from \"apparatus/draw\";\r\nimport { DEFAULT_LIQUID_DATA, P, Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nvar TLCChamber = /** @class */ (function () {\r\n    function TLCChamber() {\r\n    }\r\n    TLCChamber.prototype.render = function (appearance) {\r\n        var size = appearance.size;\r\n        var path = new Path(Segments([[-size * 0.4, 0]], [[-size * 0.4, size]], [[size * 0.4, size]], [[size * 0.4, 0]]));\r\n        setDefaultStyle(path);\r\n        smoothCornersIndividual(path, { 1: 5, 2: 5 });\r\n        addEdgeLips(path);\r\n        var liquidMask = path.clone();\r\n        var graphic = new Group([path]);\r\n        if (appearance.lid == \"flat\") {\r\n            graphic.addChild(new Path.Line(P(-size * 0.5, 0), P(size * 0.5, 0)).withStroke(\"thick\"));\r\n        }\r\n        else if (appearance.lid == \"handle\") {\r\n            var lid = new Path(Segments([[-path.strokeBounds.topLeft.x - 1, 10]], [[-path.strokeBounds.topLeft.x - 1, 0]])).withStroke(\"default\");\r\n            mirrorX(lid);\r\n            var handle = new Path.Rectangle(R(0, 0, 18, 9, Pivot.BOTTOM_CENTER)).withStroke(\"default\");\r\n            smoothCornersIndividual(handle, { 1: 2, 2: 2 });\r\n            graphic.addChildren([handle, lid]);\r\n        }\r\n        if (appearance.view == \"zoom\") {\r\n            var pivot = path.bounds.center;\r\n            graphic.scale(4.0, pivot);\r\n            liquidMask.scale(4.0, pivot);\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            liquidMask: liquidMask,\r\n            pivot: path.bounds.center,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: path.placeable(),\r\n        };\r\n    };\r\n    TLCChamber.properties = {\r\n        label: \"Chromatography Chamber\",\r\n        canContainLiquids: true,\r\n        defaultLiquidData: __assign(__assign({}, DEFAULT_LIQUID_DATA), { amountRatio: 0.1 }),\r\n        defaultAppearance: {\r\n            view: \"zoom\",\r\n            size: 100,\r\n            lid: \"flat\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"view\", label: \"View size\",\r\n                options: [\r\n                    { value: \"real\", label: \"Real size\" },\r\n                    { value: \"zoom\", label: \"Zoomed\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 80, max: 150, unit: \"mm\",\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"lid\", label: \"Lid\",\r\n                options: [\r\n                    { value: \"none\", label: \"None\" },\r\n                    { value: \"flat\", label: \"Flat\" },\r\n                    { value: \"handle\", label: \"With handle\" },\r\n                ],\r\n            }\r\n        ],\r\n    };\r\n    return TLCChamber;\r\n}());\r\nexport { TLCChamber };\r\n","import { mirrorX, setDefaultStyle } from \"apparatus/draw\";\r\nimport { Group, Path, Rectangle, Shape } from \"paper\";\r\nimport { P, Segments } from \"./common\";\r\nvar PetriDish = /** @class */ (function () {\r\n    function PetriDish() {\r\n    }\r\n    PetriDish.prototype.render = function (appearance) {\r\n        var diameter = appearance.size;\r\n        var height = 10 + appearance.size / 20;\r\n        var path = new Path();\r\n        path.addSegments(Segments([[0, 0]], [[0, height]]));\r\n        mirrorX(path, diameter / 2);\r\n        var graphic = new Group([path]);\r\n        setDefaultStyle(graphic);\r\n        graphic.strokeCap = \"butt\";\r\n        var hitShape = Shape.Rectangle(new Rectangle(0, 0, diameter, height));\r\n        var liquidMask = new Path.Rectangle(new Rectangle(0, 0, diameter, height));\r\n        return { graphic: graphic, hitShape: hitShape, liquidMask: liquidMask, snapping: { type: \"placeable\", at: P(diameter / 2, height) } };\r\n    };\r\n    PetriDish.properties = {\r\n        label: \"Petri dish\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            // Standard petri dish is 100mm.\r\n            size: 100\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\",\r\n                key: \"size\",\r\n                label: \"Diameter\",\r\n                min: 50,\r\n                max: 150,\r\n            },\r\n        ],\r\n    };\r\n    return PetriDish;\r\n}());\r\nexport { PetriDish };\r\n","import { P, Pivot, R, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar WHITE = \"#e0e0e0\";\r\nvar GRAY = \"#999999\";\r\nvar GRAY_BLUE = \"#bbbbb9\";\r\nvar BLACK = \"#444444\";\r\nvar DARK_BLUE = \"#325b99\";\r\nvar LIGHT_BLUE = \"#477bc9\";\r\nvar LIGHT_GREEN = \"#289937\";\r\nvar DARK_GREEN = \"#206b2a\";\r\nvar MAROON = \"#752334\";\r\nvar YELLOW = \"#ebde4d\";\r\nvar RED = \"#d43737\";\r\nvar BROWN = \"#8c5f4a\";\r\n/**\r\n * Gas Cylinder.\r\n *\r\n * Color coding according to \"EN 1089 Part 3\"\r\n */\r\nvar GasCylinder = /** @class */ (function () {\r\n    function GasCylinder() {\r\n    }\r\n    GasCylinder.prototype.render = function (appearance) {\r\n        var height = appearance.height;\r\n        // A gas cylinder consists of\r\n        // 1) the container, coloured in two parts: shoulder and body.\r\n        // 2) the outlet\r\n        var shoulder = new Path(Segments([[0, 20]], [[0, 0], , [0, -90]], [[140, 0], [0, -90]], [[140, 20]]));\r\n        var body = new Path(Segments([[0, 20]], [[0, height]], [[140, height]], [[140, 20]]));\r\n        var outlet = Shape.Rectangle(R(70, -120, 35, 80, Pivot.TOP_CENTER), 17.5);\r\n        setMetallicGradient(outlet, SharedColors.lightMetal);\r\n        // Add highlights to create a more realistic look.\r\n        var highlight = new Path(Segments([[70, -68]], [[45, 20], [0, -100]], [[45, height]], [[20, height]], [[20, 20], , [0, -100]]));\r\n        highlight.closePath();\r\n        highlight.fillColor = \"#ffffff50\";\r\n        var topHighlight = shoulder.clone();\r\n        topHighlight.setGradientFill(\"down\", [[\"#ffffff80\", 0.0], [\"#ffffff00\", 0.5]]);\r\n        // Set up the colors of the container based on type of gas.\r\n        var color = shoulderColor(appearance.gas);\r\n        setMetallicGradient(shoulder, color);\r\n        if (appearance.bodyColor == \"medical\") {\r\n            setMetallicGradient(body, WHITE);\r\n        }\r\n        else if (appearance.bodyColor == \"industrial\") {\r\n            setMetallicGradient(body, GRAY_BLUE);\r\n        }\r\n        else {\r\n            // Copy shoulder colour.\r\n            setMetallicGradient(body, color);\r\n        }\r\n        // Put everything together.\r\n        var graphic = new Group([outlet, body, shoulder, highlight, topHighlight]);\r\n        // The container can be large. Allow it to be scaleable.\r\n        graphic.scale(appearance.scale);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: [\r\n                graphic.placeable(),\r\n                { type: \"connectable\", at: outlet.bounds.topCenter.add(P(0, 8)), facing: 0 },\r\n            ]\r\n        };\r\n    };\r\n    GasCylinder.properties = {\r\n        label: \"Gas cylinder\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            scale: 0.5,\r\n            height: 600,\r\n            gas: \"argon\",\r\n            bodyColor: \"industrial\",\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.5, max: 1.0, step: 0.01,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Height\",\r\n                min: 400, max: 600\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"bodyColor\", label: \"Body colour\",\r\n                options: [\r\n                    { value: \"industrial\", label: \"Industrial Gas\" },\r\n                    { value: \"medical\", label: \"Medical Gas\" },\r\n                    { value: \"copy-shoulder\", label: \"Same as shoulder\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"select\", key: \"gas\", label: \"Gas type (colour)\",\r\n                options: [\r\n                    { value: \"toxic\", label: \"Toxic / Corrosive\", tier: \"boost\" },\r\n                    { value: \"flammable\", label: \"Flammable\", tier: \"boost\" },\r\n                    { value: \"oxidising\", label: \"Oxidising\", tier: \"boost\" },\r\n                    { value: \"inert\", label: \"Inert\", tier: \"boost\" },\r\n                    { value: \"acetylene\", label: \"Acetylene\" },\r\n                    { value: \"argon\", label: \"Argon\" },\r\n                    { value: \"co2\", label: \"Carbon dioxide\" },\r\n                    { value: \"helium\", label: \"Helium\" },\r\n                    { value: \"nitrogen\", label: \"Nitrogen\" },\r\n                    { value: \"nitrous oxide\", label: \"Nitrous Oxide\" },\r\n                    { value: \"oxygen\", label: \"Oxygen\" },\r\n                ],\r\n            },\r\n        ],\r\n    };\r\n    return GasCylinder;\r\n}());\r\nexport { GasCylinder };\r\nfunction setMetallicGradient(item, color) {\r\n    var darkerColor = color.color().darken(0.18).hex();\r\n    item.setGradientFill(\"right\", [\r\n        [darkerColor, 0.0],\r\n        [color, 0.3],\r\n        [color, 0.7],\r\n        [darkerColor, 1.0]\r\n    ]);\r\n}\r\nvar shoulderColor = function (gas) {\r\n    switch (gas) {\r\n        case \"toxic\": return YELLOW;\r\n        case \"flammable\": return RED;\r\n        case \"oxidising\": return LIGHT_BLUE;\r\n        case \"inert\": return LIGHT_GREEN;\r\n        case \"argon\": return DARK_GREEN;\r\n        case \"helium\": return BROWN;\r\n        case \"co2\": return GRAY;\r\n        case \"nitrogen\": return BLACK;\r\n        case \"oxygen\": return WHITE;\r\n        case \"acetylene\": return MAROON;\r\n        case \"nitrous oxide\": return DARK_BLUE;\r\n    }\r\n};\r\n","import { CompoundPath, Group, Path, Rectangle, Shape } from \"paper\";\r\nimport { addMarkers, setDefaultStyle } from \"../draw\";\r\nimport { lerp, markerSpacing, P } from \"./common\";\r\nvar Thermometer = /** @class */ (function () {\r\n    function Thermometer() {\r\n    }\r\n    Thermometer.isBoostRequiredForAppearance = function (a) {\r\n        return a.size == \"medium\" || a.size == \"tiny\";\r\n    };\r\n    Thermometer.prototype.measurements = function (size) {\r\n        switch (size) {\r\n            case \"tiny\":\r\n                return { stemWidth: 6, bulbRadius: 6, mercuryBulbGap: 2.0, mercuryStemGap: 0.0, markerSize: 4, };\r\n            case \"small\":\r\n                return { stemWidth: 8, bulbRadius: 6, mercuryBulbGap: 2.0, mercuryStemGap: 0.0, markerSize: 6 };\r\n            case \"medium\":\r\n                return { stemWidth: 11, bulbRadius: 9, mercuryBulbGap: 3.5, mercuryStemGap: 1.0 };\r\n            case \"large\":\r\n                return { stemWidth: 15, bulbRadius: 12, mercuryBulbGap: 5.0, mercuryStemGap: 2.0 };\r\n        }\r\n    };\r\n    Thermometer.prototype.render = function (appearance) {\r\n        var stemHeight = appearance.length;\r\n        var _a = this.measurements(appearance.size), stemWidth = _a.stemWidth, bulbRadius = _a.bulbRadius, mercuryBulbGap = _a.mercuryBulbGap, mercuryStemGap = _a.mercuryStemGap, markerSize = _a.markerSize;\r\n        var glassColor = \"#ffffffb0\";\r\n        var mercuryColor = \"#f43d50\";\r\n        var mercuryAmountRatio = appearance.mercuryAmountRatio;\r\n        // Draw glassware.\r\n        var stem = new Path.Rectangle(new Rectangle(-stemWidth / 2, 0, stemWidth, stemHeight), stemWidth / 2);\r\n        var bulb = new Path.Circle(P(0, stemHeight), bulbRadius);\r\n        var body = new CompoundPath(stem).unite(bulb);\r\n        setDefaultStyle(body);\r\n        body.fillColor = glassColor;\r\n        // Draw mercury.\r\n        var mercuryBulb = new Path.Circle(P(0, stemHeight), bulbRadius - mercuryBulbGap);\r\n        mercuryBulb.fillColor = mercuryColor;\r\n        var mercuryStem = new Path.Line(P(0, lerp(stemHeight, stemWidth / 2, mercuryAmountRatio)), P(0, stemHeight));\r\n        mercuryStem.strokeColor = mercuryColor;\r\n        mercuryStem.strokeWidth = stemWidth / 2.0 - mercuryStemGap;\r\n        mercuryStem.strokeCap = \"round\";\r\n        // Assemble.\r\n        var graphic = new Group([body]);\r\n        addMarkers(graphic, P(stemWidth / 2, stemHeight), stemWidth / 2, P(0, markerSpacing), markerSize);\r\n        graphic.addChildren([mercuryStem, mercuryBulb]);\r\n        // Set up hit shape.\r\n        var hitShape = Shape.Rectangle(new Rectangle(-bulbRadius, 0, bulbRadius * 2, stemHeight + bulbRadius));\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShape,\r\n        };\r\n    };\r\n    Thermometer.properties = {\r\n        label: \"Thermometer\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            length: 180,\r\n            size: \"large\",\r\n            mercuryAmountRatio: 0.3,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\",\r\n                key: \"length\",\r\n                label: \"Length\",\r\n                min: 100,\r\n                max: 320,\r\n            },\r\n            {\r\n                spec: \"slider\",\r\n                key: \"mercuryAmountRatio\",\r\n                label: \"Temperature\",\r\n                min: 0.0,\r\n                max: 1.0,\r\n                step: 0.05,\r\n            },\r\n            {\r\n                spec: \"radio\",\r\n                key: \"size\",\r\n                label: \"Overall size\",\r\n                options: [\r\n                    { value: \"large\", label: \"Large\" },\r\n                    { value: \"medium\", label: \"Medium\", tier: \"boost\" },\r\n                    { value: \"small\", label: \"Small\" },\r\n                    { value: \"tiny\", label: \"Tiny\", tier: \"boost\" }\r\n                ],\r\n                allowSelectingTierLockedOptions: true,\r\n            },\r\n        ]\r\n    };\r\n    return Thermometer;\r\n}());\r\nexport { Thermometer };\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { P } from \"apparatus/library/common\";\r\nimport { UpdateAppearance } from \"command/basic\";\r\nimport { commandProcessor, Sequence } from \"command/command\";\r\nimport { Move } from \"editing/move\";\r\nimport { clog } from \"log\";\r\nimport { Key, Tool } from \"paper\";\r\nimport appStore from \"store/store\";\r\nvar PathEditTool = /** @class */ (function (_super) {\r\n    __extends(PathEditTool, _super);\r\n    function PathEditTool(app) {\r\n        var _this = _super.call(this) || this;\r\n        _this.app = app;\r\n        _this.onMouseDown = function (event) {\r\n            var TOLERANCE = 10 / paper.project.view.scaling.x;\r\n            // Get first selected item.\r\n            var selectedFirstItem = appStore.selectedItems()[0];\r\n            if (!selectedFirstItem || selectedFirstItem.type !== \"__live edit__\")\r\n                return;\r\n            var component = _this.app.getApparatusComponent(selectedFirstItem.id);\r\n            if (!component)\r\n                return;\r\n            if (Key.modifiers.alt && Key.modifiers.shift && Key.modifiers.control) {\r\n                var path = getPath(component);\r\n                var delta_1 = event.downPoint.subtract(P(component.props.x, component.props.y));\r\n                path.segments.forEach(function (s) { s.point = s.point.subtract(delta_1); });\r\n                _this.editedLiveEditComponent = component;\r\n                _this.op = { type: \"set-center\", delta: delta_1 };\r\n            }\r\n            else if (Key.modifiers.shift && Key.modifiers.control) {\r\n                // Align centers.\r\n                var destination_1 = P(component.props.x, component.props.y);\r\n                commandProcessor.execute(new Sequence(appStore.selectedItems().map(function (i) { return new Move([i.id], destination_1.subtract(P(i.x, i.y))); })));\r\n            }\r\n            else if (Key.modifiers.alt) {\r\n                var hitResult = component.item.hitTest(event.downPoint, { segments: true, tolerance: TOLERANCE });\r\n                if (hitResult) {\r\n                    _this.editedLiveEditComponent = component;\r\n                    if (hitResult.segment.handleIn.length == 0 && hitResult.segment.handleOut.length == 0) {\r\n                        // Straight point. Switch to having both handles\r\n                        hitResult.segment.handleIn = P(20, 0);\r\n                        hitResult.segment.handleOut = P(-20, 0);\r\n                    }\r\n                    else if (hitResult.segment.handleIn.length == 0) {\r\n                        // Only has handleOut. Switch to handleIn.\r\n                        hitResult.segment.handleIn = hitResult.segment.handleOut.multiply(-1);\r\n                        hitResult.segment.handleOut = P(0, 0);\r\n                    }\r\n                    else if (hitResult.segment.handleOut.length == 0) {\r\n                        // Only has handleIn set. Switch to none.\r\n                        hitResult.segment.handleOut = P(0, 0);\r\n                        hitResult.segment.handleIn = P(0, 0);\r\n                    }\r\n                    else {\r\n                        // Has both handles, switch to handleOut only.\r\n                        hitResult.segment.handleIn = P(0, 0);\r\n                    }\r\n                }\r\n            }\r\n            else if (Key.modifiers.shift) {\r\n                // Add a point to path.\r\n                var hitResult = component.item.hitTest(event.downPoint, { stroke: true, tolerance: TOLERANCE });\r\n                clog(hitResult);\r\n                if (hitResult && hitResult.location) {\r\n                    var path = getPath(component);\r\n                    path.insert(hitResult.location.index + 1, event.point.subtract(P(component.props.x, component.props.y)));\r\n                    _this.editedLiveEditComponent = component;\r\n                }\r\n            }\r\n            else if (Key.modifiers.control) {\r\n                // Remove a point.\r\n                var hitResult = component.item.hitTest(event.downPoint, { segments: true, tolerance: TOLERANCE });\r\n                if (hitResult) {\r\n                    var path = getPath(component);\r\n                    path.removeSegment(hitResult.segment.index);\r\n                    _this.editedLiveEditComponent = component;\r\n                }\r\n            }\r\n            else {\r\n                var hitResult = component.item.hitTest(event.downPoint, {\r\n                    segments: true,\r\n                    handles: true,\r\n                    tolerance: TOLERANCE,\r\n                });\r\n                if (hitResult) {\r\n                    if (hitResult.type === \"segment\") {\r\n                        _this.op = {\r\n                            type: \"move-segment\",\r\n                            segment: hitResult.segment\r\n                        };\r\n                        _this.editedLiveEditComponent = component;\r\n                    }\r\n                    else if (hitResult.type === \"handle-in\") {\r\n                        _this.op = {\r\n                            type: \"move-handle-in\",\r\n                            segment: hitResult.segment\r\n                        };\r\n                        _this.editedLiveEditComponent = component;\r\n                    }\r\n                    else if (hitResult.type === \"handle-out\") {\r\n                        _this.op = {\r\n                            type: \"move-handle-out\",\r\n                            segment: hitResult.segment\r\n                        };\r\n                        _this.editedLiveEditComponent = component;\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        _this.onMouseDrag = function (event) {\r\n            if (!_this.editedLiveEditComponent)\r\n                return;\r\n            if (!_this.op)\r\n                return;\r\n            switch (_this.op.type) {\r\n                case \"move-segment\":\r\n                    _this.op.segment.point = _this.op.segment.point.add(event.delta);\r\n                    break;\r\n                case \"move-handle-in\":\r\n                    _this.op.segment.handleIn = _this.op.segment.handleIn.add(event.delta);\r\n                    if (Key.modifiers.shift) {\r\n                        _this.op.segment.handleOut.angle = _this.op.segment.handleIn.angle + 180;\r\n                    }\r\n                    break;\r\n                case \"move-handle-out\":\r\n                    _this.op.segment.handleOut = _this.op.segment.handleOut.add(event.delta);\r\n                    if (Key.modifiers.shift) {\r\n                        _this.op.segment.handleIn.angle = _this.op.segment.handleOut.angle + 180;\r\n                    }\r\n                    break;\r\n            }\r\n        };\r\n        _this.onMouseUp = function (event) {\r\n            var _a;\r\n            if (!_this.editedLiveEditComponent)\r\n                return;\r\n            commandProcessor.startRecording();\r\n            // Extract Path object.\r\n            var path = getPath(_this.editedLiveEditComponent);\r\n            var mirrored = _this.editedLiveEditComponent.props.appearance[\"mirrored\"];\r\n            var pathData = convertToData(path, mirrored ? path.segments.length / 2 : path.segments.length);\r\n            commandProcessor.execute(new UpdateAppearance(_this.editedLiveEditComponent.id, \"segments\", pathData, _this.editedLiveEditComponent.props.appearance[\"segments\"]));\r\n            if (((_a = _this.op) === null || _a === void 0 ? void 0 : _a.type) == \"set-center\") {\r\n                commandProcessor.execute(new Move([_this.editedLiveEditComponent.id], _this.op.delta));\r\n            }\r\n            commandProcessor.finishRecording();\r\n            _this.editedLiveEditComponent = undefined;\r\n            _this.op = undefined;\r\n        };\r\n        return _this;\r\n    }\r\n    return PathEditTool;\r\n}(Tool));\r\nexport { PathEditTool };\r\nfunction getPath(liveEditComponent) {\r\n    return liveEditComponent.item.children[0].children[0];\r\n}\r\nfunction convertToData(path, limit) {\r\n    var converted = [];\r\n    var count = 0;\r\n    for (var _i = 0, _a = path.segments; _i < _a.length; _i++) {\r\n        var segment = _a[_i];\r\n        if (count >= limit)\r\n            break;\r\n        var point = [segment.point.x, segment.point.y];\r\n        var handleOut = segment.handleOut.x == 0 && segment.handleOut.y == 0 ? undefined : [segment.handleOut.x, segment.handleOut.y];\r\n        var handleIn = segment.handleIn.x == 0 && segment.handleIn.y == 0 ? undefined : [segment.handleIn.x, segment.handleIn.y];\r\n        if (handleOut) {\r\n            converted.push(\"[\" + toString(point) + \",\" + (handleIn ? toString(handleIn) : '') + \",\" + toString(handleOut) + \"]\");\r\n        }\r\n        else if (handleIn) {\r\n            converted.push(\"[\" + toString(point) + \",\" + toString(handleIn) + \"]\");\r\n        }\r\n        else {\r\n            converted.push(\"[\" + toString(point) + \"]\");\r\n        }\r\n        count++;\r\n    }\r\n    return converted.join(\",\\n\");\r\n}\r\n/** Rounds and converts a PointAsArray into string. */\r\nfunction toString(point) {\r\n    return \"[\" + point[0].round() + \", \" + point[1].round() + \"]\";\r\n}\r\n","import { SVG } from \"apparatus/svg\";\r\nvar TestTubeHolder = /** @class */ (function () {\r\n    function TestTubeHolder() {\r\n    }\r\n    TestTubeHolder.prototype.render = function (appearance) {\r\n        var graphic = SVG.testTubeHolder();\r\n        graphic.scale(appearance.scale, 1.0);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    TestTubeHolder.properties = {\r\n        label: \"Test Tube Holder (Metal)\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            scale: 1\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.8, max: 1.25, step: 0.01, unit: \"%\"\r\n            }\r\n        ],\r\n    };\r\n    return TestTubeHolder;\r\n}());\r\nexport { TestTubeHolder };\r\n","import { Group, Path, Shape } from \"paper\";\r\nimport { setDefaultStyle } from \"../draw\";\r\nimport { R, Segments } from \"./common\";\r\nvar StirringRod = /** @class */ (function () {\r\n    function StirringRod() {\r\n    }\r\n    StirringRod.prototype.render = function (appearance) {\r\n        var width = 8;\r\n        var height = appearance.height;\r\n        var bulbWidth = 15;\r\n        var bulbHeight = 25;\r\n        var rod = new Path.Rectangle(R(-width / 2.0, 0, width, height), width / 2);\r\n        var finalRod;\r\n        if (appearance.style == \"bulb\") {\r\n            var bulb = new Path.Rectangle(R(-bulbWidth / 2, height - bulbHeight, bulbWidth, bulbHeight), bulbWidth / 2);\r\n            finalRod = bulb.unite(rod);\r\n        }\r\n        else {\r\n            finalRod = rod;\r\n        }\r\n        setDefaultStyle(finalRod);\r\n        finalRod.fillColor = \"#ffffffaa\";\r\n        var graphic = new Group();\r\n        graphic.addChild(finalRod);\r\n        if (appearance.showArrow) {\r\n            graphic.insertChild(0, new Path(Segments([[-20, -2]], [[-15, 0], undefined, [-50, 20]], [[15, 0], [50, 20]], [[20, -2]])).withStroke(3.0, \"#777777\").withPosition({ y: 20 }));\r\n        }\r\n        var hitShape = Shape.Rectangle(R(-bulbWidth / 2.0, 0, bulbWidth, height));\r\n        return { graphic: graphic, hitShape: hitShape };\r\n    };\r\n    StirringRod.properties = {\r\n        label: \"Stirring rod\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            style: \"bulb\",\r\n            height: 220,\r\n            showArrow: false,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"style\", label: \"Style\",\r\n                options: [\r\n                    { value: \"bulb\", label: \"Normal\" },\r\n                    { value: \"simple\", label: \"Simple\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Length\",\r\n                min: 100, max: 300\r\n            },\r\n            {\r\n                spec: \"checkbox\", key: \"showArrow\", label: \"Stirring arrow\", subLabel: \"Show\",\r\n            }\r\n        ],\r\n    };\r\n    return StirringRod;\r\n}());\r\nexport { StirringRod };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { Path, Rectangle, Shape } from \"paper\";\r\nimport { addEdgeLips, breakPath, mirrorX, setDefaultStyle } from \"../draw\";\r\nimport { P, Segments } from \"./common\";\r\nvar TestTube = /** @class */ (function () {\r\n    function TestTube() {\r\n        this.drivers = [\r\n            {\r\n                type: \"rectangle\",\r\n                minX: 8, maxX: 30,\r\n                minY: 75, maxY: 200,\r\n                fromAppearance: function (a) { return P(a.width, a.height); },\r\n                toAppearance: function (p) { return ({ width: p.x, height: p.y }); },\r\n                scale: 2.0,\r\n            }\r\n        ];\r\n    }\r\n    TestTube.prototype.render = function (appearance) {\r\n        var width = appearance.width;\r\n        var height = appearance.height;\r\n        var graphic = new Path();\r\n        graphic.addSegments(Segments([[0, 0]], [[0, height - width / 2], undefined, [0, width / 1.55]]));\r\n        mirrorX(graphic, width / 2);\r\n        addEdgeLips(graphic, 2.0);\r\n        var liquidMask = graphic.clone();\r\n        setDefaultStyle(graphic);\r\n        var hitShape = Shape.Rectangle(new Rectangle(0, 0, width, height));\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShape,\r\n            liquidMask: liquidMask,\r\n            snapping: { type: \"neck\", top: P(width / 2, 0), diameter: width, facing: 0 }\r\n        };\r\n    };\r\n    TestTube.properties = {\r\n        label: \"Test tube\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            // Size of a regular test tube = 16, according to\r\n            // https://www.homesciencetools.com/product/glass-test-tubes/\r\n            // However we use 24 so it's more visible.\r\n            width: 24,\r\n            height: 150,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\",\r\n                key: \"width\",\r\n                label: \"Width\",\r\n                min: 8,\r\n                max: 30,\r\n            },\r\n            {\r\n                spec: \"slider\",\r\n                key: \"height\",\r\n                label: \"Height\",\r\n                min: 75,\r\n                max: 200,\r\n            },\r\n        ]\r\n    };\r\n    return TestTube;\r\n}());\r\nexport { TestTube };\r\nvar TestTubeWithSideArm = /** @class */ (function () {\r\n    function TestTubeWithSideArm() {\r\n    }\r\n    TestTubeWithSideArm.prototype.render = function (appearance) {\r\n        var width = appearance.width;\r\n        var height = appearance.height;\r\n        var offset = 30;\r\n        var holeRadius = appearance.holeDiameter / 2;\r\n        var sideArmLength = 15;\r\n        var tube = new Path();\r\n        tube.addSegments(Segments([[0, 0]], [[0, height - width / 2], undefined, [0, width / 1.55]]));\r\n        mirrorX(tube, width / 2);\r\n        tube.insertSegments(3, Segments([[width, offset + holeRadius]], [[width + sideArmLength, offset + holeRadius]], [[width + sideArmLength, offset - holeRadius]], [[width, offset - holeRadius]]));\r\n        addEdgeLips(tube, 2.0);\r\n        var liquidMask = tube.clone();\r\n        var graphics = breakPath(tube, 6);\r\n        setDefaultStyle(graphics);\r\n        var hitShape = Shape.Rectangle(new Rectangle(0, 0, width + sideArmLength, height));\r\n        return {\r\n            graphic: graphics,\r\n            hitShape: hitShape,\r\n            liquidMask: liquidMask,\r\n            snapping: [\r\n                { type: \"connectable\", at: P(width + sideArmLength, offset), facing: 90, },\r\n                { type: \"neck\", top: P(width / 2, 0), diameter: width, facing: 0 }\r\n            ]\r\n        };\r\n    };\r\n    TestTubeWithSideArm.properties = {\r\n        label: \"Test tube with side arm\",\r\n        canContainLiquids: true,\r\n        flippable: true,\r\n        defaultAppearance: __assign(__assign({}, TestTube.properties.defaultAppearance), { holeDiameter: 10 }),\r\n        appearanceSpecs: __spreadArrays(TestTube.properties.appearanceSpecs, [\r\n            {\r\n                spec: \"slider\", key: \"holeDiameter\", label: \"Hole diameter\",\r\n                min: 8, max: 20,\r\n            }\r\n        ]),\r\n    };\r\n    return TestTubeWithSideArm;\r\n}());\r\nexport { TestTubeWithSideArm };\r\n","import { mirrorX } from \"apparatus/draw\";\r\nimport { SVG } from \"apparatus/svg\";\r\nimport { Group, Path } from \"paper\";\r\nimport { setDefaultStyle } from \"../../draw\";\r\nimport { CenterR, Segments } from \"../common\";\r\nvar SpiritLamp = /** @class */ (function () {\r\n    function SpiritLamp() {\r\n    }\r\n    SpiritLamp.prototype.render = function (appearance) {\r\n        var bottle = new Path(Segments([[10, 0]], [[10, 10], undefined, [30, 20]], [[20, 70], [35, -15]], [[25, 78], [5, -5]]));\r\n        var wick = new Path(Segments([[0, -12]], [[0, 20], undefined, [0, 30]], [[-13, 66], [70, 0]]));\r\n        mirrorX(bottle);\r\n        var liquidMask = bottle.clone();\r\n        setDefaultStyle(bottle);\r\n        wick.strokeWidth = 5.0;\r\n        wick.strokeColor = \"#cccc3f\"; // Yellowish.\r\n        var cap = CenterR(0, 3, 24, 10).toShape();\r\n        setDefaultStyle(cap);\r\n        cap.fillColor = \"#eeeeee\"; // Light grey.\r\n        var graphic = new Group([bottle, wick, cap]);\r\n        if (appearance.flame == \"red\") {\r\n            var flame = SVG.redFlame();\r\n            flame.scale(appearance.flameScale);\r\n            graphic.addChild(flame);\r\n            flame.position.x = 0;\r\n            flame.position.y = -10;\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            liquidMask: liquidMask,\r\n            hitShape: graphic.bounds.toShape(),\r\n            pivot: bottle.bounds.center,\r\n            snapping: graphic.placeable(),\r\n        };\r\n    };\r\n    SpiritLamp.properties = {\r\n        label: \"Spirit Lamp\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            flame: \"red\",\r\n            flameScale: 1.0\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"flame\", label: \"Flame\",\r\n                options: [\r\n                    { value: \"off\", label: \"Off\" },\r\n                    { value: \"red\", label: \"Red flame\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"flameScale\", label: \"Flame size\",\r\n                min: 0.5, max: 1.5, step: 0.05, tier: \"boost\",\r\n            }\r\n        ],\r\n    };\r\n    return SpiritLamp;\r\n}());\r\nexport { SpiritLamp };\r\n","import { strokeWidth } from \"apparatus/draw\";\r\nimport { P, R } from \"apparatus/library/common\";\r\nimport { Path, Shape } from \"paper\";\r\nvar MicroscopeSlide = /** @class */ (function () {\r\n    function MicroscopeSlide() {\r\n    }\r\n    MicroscopeSlide.prototype.render = function (appearance) {\r\n        var width = appearance.width, height = appearance.height;\r\n        if (appearance.side) {\r\n            var graphic = new Path.Line(P(0, 0), P(width, 0));\r\n            graphic.withStroke(strokeWidth(\"thin\"), \"#999999aa\");\r\n            return {\r\n                graphic: graphic,\r\n                hitShape: graphic.bounds.expand(20).toShape(),\r\n                snapping: [\r\n                    graphic.placeable(),\r\n                ]\r\n            };\r\n        }\r\n        else {\r\n            var graphic = Shape.Rectangle(R(0, 0, width, height));\r\n            graphic.withStroke(strokeWidth(\"thin\"), \"#999999aa\").withFill(\"#dddddd40\");\r\n            return {\r\n                graphic: graphic,\r\n                hitShape: graphic.bounds.toShape()\r\n            };\r\n        }\r\n    };\r\n    MicroscopeSlide.properties = {\r\n        label: \"Microscope slide\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            width: 75,\r\n            height: 25,\r\n            side: false\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"width\", label: \"Width\",\r\n                min: 50, max: 150, unit: \"mm\"\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Height\",\r\n                min: 20, max: 50, unit: \"mm\"\r\n            },\r\n            {\r\n                spec: \"checkbox\", key: \"side\", label: \"View from side\"\r\n            }\r\n        ],\r\n    };\r\n    return MicroscopeSlide;\r\n}());\r\nexport { MicroscopeSlide };\r\n","import { mirrorX, simpleGradient } from \"apparatus/draw\";\r\nimport * as p from \"paper\";\r\nimport { smoothCorner } from \"../draw\";\r\nimport { P, Pivot, R, Segments, SharedColors, SharedGradients } from \"./common\";\r\nvar Balance = /** @class */ (function () {\r\n    function Balance() {\r\n    }\r\n    Balance.prototype.render = function (appearance) {\r\n        switch (appearance.design) {\r\n            case \"cream\": return design1(appearance.display);\r\n            case \"modern\": return designModern(appearance.display, appearance.windshield);\r\n        }\r\n    };\r\n    Balance.properties = {\r\n        label: \"Balance\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            design: \"modern\",\r\n            display: \"0.00 g\",\r\n            windshield: \"none\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"design\", label: \"Design\",\r\n                options: [\r\n                    { value: \"cream\", label: \"Generic Cream\" },\r\n                    { value: \"modern\", label: \"Modern White\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"text\", key: \"display\", label: \"Display\"\r\n            },\r\n            {\r\n                visible: function (a) { return a.design == \"modern\"; },\r\n                spec: \"radio\", key: \"windshield\", label: \"Windshield\",\r\n                options: [\r\n                    { value: \"none\", label: \"No windshield\" },\r\n                    { value: \"enabled\", label: \"With windshield\" },\r\n                ],\r\n            }\r\n        ],\r\n    };\r\n    return Balance;\r\n}());\r\nexport { Balance };\r\n/** Older design, creamy looking */\r\nfunction designModern(display, windshield) {\r\n    var width = 200;\r\n    var bodyColor = \"#dbd7d9\";\r\n    var plate = p.Shape.Rectangle(R(25, 0, width - 50, 10)); // The weighing plate.\r\n    var leg = p.Shape.Rectangle(R(10, 45, 30, 5));\r\n    var body = new p.Path(Segments([[80, 10], , [0, 3]], [[100, 19], [0, -5]], [[100, 45]]));\r\n    mirrorX(body);\r\n    smoothCorner(body.segments[3]);\r\n    smoothCorner(body.segments[2]);\r\n    body.closePath();\r\n    body.position.x += 100;\r\n    plate.setGradientFill(\"right\", SharedGradients.metal);\r\n    plate.withStroke(\"thinner\", \"#888888\");\r\n    body.setGradientFill(\"down\", simpleGradient(bodyColor));\r\n    body.withStroke(\"thinner\", bodyColor.color().darken(0.1).hex());\r\n    leg.fillColor = SharedColors.mediumMetal;\r\n    var leg2 = leg.clone();\r\n    leg2.position.x += width - 50;\r\n    // Add buttons with labels.\r\n    var button1 = p.Shape.Rectangle(R(15, 25, 16, 10, Pivot.CENTER_LEFT), 2.0);\r\n    button1.fillColor = \"#f5ba49\";\r\n    button1.strokeColor = \"#6e6b3d\";\r\n    button1.strokeWidth = 0.0;\r\n    var button1Text = new p.PointText(P(22, 38));\r\n    button1Text.content = \"O/I\";\r\n    button1Text.fontSize = \"7\";\r\n    button1Text.justification = \"center\";\r\n    button1Text.fontWeight = \"bold\";\r\n    button1Text.fillColor = \"#888888\";\r\n    var button2 = p.Shape.Rectangle(R(35, 25, 16, 10, Pivot.CENTER_LEFT), 2.0);\r\n    button2.fillColor = \"#f5ba49\";\r\n    button2.strokeColor = \"#6e6b3d\";\r\n    button2.strokeWidth = 0.0;\r\n    var button2Text = new p.PointText(P(42, 38));\r\n    button2Text.content = \"TARE\";\r\n    button2Text.fontSize = \"7\";\r\n    button2Text.fontWeight = \"bold\";\r\n    button2Text.justification = \"center\";\r\n    button2Text.fillColor = \"#888888\";\r\n    // Screen display.\r\n    var displayScreen = p.Shape.Rectangle(R(180, 18, 120, 20, Pivot.TOP_RIGHT), 3.0);\r\n    displayScreen.fillColor = \"#87cee7\";\r\n    displayScreen.strokeColor = \"#53a2be\";\r\n    displayScreen.strokeWidth = 1.0;\r\n    var displayText = new p.PointText(P(175, 33));\r\n    displayText.content = display;\r\n    displayText.style = {\r\n        fontFamily: \"monospace\",\r\n        fontSize: \"16\",\r\n        justification: \"right\"\r\n    };\r\n    displayText.fillColor = \"#2d758f\";\r\n    var graphic = new p.Group([leg, leg2, plate, body, displayScreen, displayText, button1, button2, button1Text, button2Text]);\r\n    // Windshield.\r\n    if (windshield == \"enabled\") {\r\n        var windshieldHeight = 170;\r\n        var leftWall = p.Shape.Rectangle(R(10, 30, 10, windshieldHeight, Pivot.BOTTOM_LEFT), 2.0);\r\n        var rightWall = p.Shape.Rectangle(R(width - 10, 30, 10, windshieldHeight, Pivot.BOTTOM_RIGHT), 2.0);\r\n        var topWall = p.Shape.Rectangle(R(width / 2, -windshieldHeight + 30, width - 20, 10, Pivot.TOP_CENTER), 2.0);\r\n        var wallGradient = [[\"#dddddd\", 0.0], [\"#cccccc\", 1.0]];\r\n        leftWall.setGradientFill(\"right\", wallGradient);\r\n        rightWall.setGradientFill(\"right\", wallGradient);\r\n        topWall.setGradientFill(\"down\", wallGradient);\r\n        var glass = p.Shape.Rectangle(R(width / 2, 30, width - 25, windshieldHeight - 5, Pivot.BOTTOM_CENTER));\r\n        glass.setGradientFill(\"right-down\", SharedGradients.glass);\r\n        graphic.insertChildren(0, [glass, leftWall, rightWall, topWall]);\r\n    }\r\n    return {\r\n        graphic: graphic,\r\n        hitShape: graphic.bounds.toShape(),\r\n        snapping: [\r\n            graphic.placeable(),\r\n            plate.topEdgeAsPlaceableSurface(),\r\n        ],\r\n        pivot: body.bounds.center,\r\n    };\r\n}\r\nfunction design1(display) {\r\n    var width = 200;\r\n    var bodyColor = \"#c4b18c\";\r\n    var plate = p.Shape.Rectangle(R(0, 0, width, 10));\r\n    var body = p.Shape.Rectangle(R(0, 10, width, 30));\r\n    var leg = p.Shape.Rectangle(R(0, 40, 30, 5));\r\n    plate.setGradientFill(\"down\", SharedGradients.metal);\r\n    plate.withStroke(\"thinner\", \"#888888\");\r\n    body.setGradientFill(\"down\", simpleGradient(bodyColor));\r\n    body.withStroke(\"thinner\", bodyColor);\r\n    leg.fillColor = SharedColors.darkMetal;\r\n    var leg2 = leg.clone();\r\n    leg2.position.x += width - 30;\r\n    var displayText = new p.PointText(P(width - 10, 30));\r\n    displayText.content = display;\r\n    displayText.style = {\r\n        fontFamily: \"monospace\",\r\n        fontSize: \"16\",\r\n        justification: \"right\"\r\n    };\r\n    var graphic = new p.Group([body, plate, leg, leg2, displayText]);\r\n    return {\r\n        graphic: graphic,\r\n        hitShape: graphic.bounds.toShape(),\r\n        snapping: [\r\n            graphic.placeable(),\r\n            graphic.topEdgeAsPlaceableSurface(),\r\n        ]\r\n    };\r\n}\r\n","import { P, R } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nimport { addEdgeLips, breakPath, glassFold, mirrorX, setDefaultStyle, smoothCorner } from \"../draw\";\r\nimport { Segments } from \"./common\";\r\nvar FOURTH_NECK_ROTATION = 10;\r\nvar RoundBottomFlask = /** @class */ (function () {\r\n    function RoundBottomFlask() {\r\n    }\r\n    RoundBottomFlask.prototype.render = function (appearance) {\r\n        var neckWidth = 12 + appearance.size / 12;\r\n        var neckTaper = 2;\r\n        var neckHeight = 20 + appearance.size / 15;\r\n        var radius = appearance.size / 2;\r\n        var glassFoldSize = neckWidth * 0.48;\r\n        var cornerSmoothing = radius / 8;\r\n        // Round bottom flask is drawn using path union. First draw\r\n        // the bottom part, then the neck and then assemble.\r\n        var bulb = new Path.Circle(P(0, radius), radius);\r\n        var neck = new Path(Segments([[-neckWidth / 2, -neckHeight]], [[-neckWidth / 2 + neckTaper, 20]] // Use a higher number to make sure it attaches to the bottom.\r\n        ));\r\n        mirrorX(neck);\r\n        addEdgeLips(neck);\r\n        // Snap point, which is placed at the top of the neck, slightly inside.\r\n        var connectableSnapPoint = P(0, -neckHeight + 10);\r\n        // Snap point for bung, placed at the height of the neck.\r\n        var neckSnapPoint = P(0, -neckHeight);\r\n        var snapPoints = [\r\n            { type: \"placeable\", at: bulb.strokeBounds.bottomCenter },\r\n        ];\r\n        var combinedShape;\r\n        var neckPivot = P(0, radius * 2);\r\n        if (appearance.necks == \"one\") {\r\n            combinedShape = neck.unite(bulb);\r\n            snapPoints.push({ type: \"connectable\", at: connectableSnapPoint, facing: 0 });\r\n            snapPoints.push({ type: \"neck\", top: neckSnapPoint, diameter: neckWidth, facing: 0 });\r\n            combinedShape.closed = false;\r\n        }\r\n        else if (appearance.necks == \"three\" || appearance.necks == \"four\") {\r\n            var neckLeft = neck.clone();\r\n            var neckRight = neck.clone();\r\n            neckLeft.rotate(-20, neckPivot);\r\n            neckRight.rotate(20, neckPivot);\r\n            if (appearance.necks == \"four\") {\r\n                neck.rotate(-3, neckPivot);\r\n                snapPoints.push({ type: \"connectable\", at: connectableSnapPoint.rotate(-3, neckPivot), facing: -3 });\r\n                snapPoints.push({ type: \"neck\", top: neckSnapPoint.rotate(-3, neckPivot), diameter: neckWidth, facing: -3 });\r\n                snapPoints.push({ type: \"connectable\", at: connectableSnapPoint.rotate(FOURTH_NECK_ROTATION, neckPivot), facing: FOURTH_NECK_ROTATION });\r\n                snapPoints.push({ type: \"neck\", top: neckSnapPoint.rotate(FOURTH_NECK_ROTATION, neckPivot), diameter: neckWidth, facing: FOURTH_NECK_ROTATION });\r\n            }\r\n            else {\r\n                snapPoints.push({ type: \"connectable\", at: connectableSnapPoint, facing: 0 });\r\n                snapPoints.push({ type: \"neck\", top: neckSnapPoint, diameter: neckWidth, facing: 0 });\r\n            }\r\n            combinedShape = neck.unite(bulb).unite(neckLeft).unite(neckRight);\r\n            smoothCorner(combinedShape.segments[12], cornerSmoothing);\r\n            smoothCorner(combinedShape.segments[8], cornerSmoothing);\r\n            snapPoints.push({ type: \"connectable\", at: connectableSnapPoint.rotate(-20, neckPivot), facing: -20 });\r\n            snapPoints.push({ type: \"neck\", top: neckSnapPoint.rotate(-20, neckPivot), diameter: neckWidth, facing: -20 });\r\n            snapPoints.push({ type: \"connectable\", at: connectableSnapPoint.rotate(20, neckPivot), facing: 20 });\r\n            snapPoints.push({ type: \"neck\", top: neckSnapPoint.rotate(20, neckPivot), diameter: neckWidth, facing: 20 });\r\n        }\r\n        else { // Two-neck cases.\r\n            var secondNeck = neck.clone();\r\n            var angle = 20;\r\n            secondNeck.rotate(angle, neckPivot);\r\n            combinedShape = neck.unite(bulb).unite(secondNeck);\r\n            snapPoints.push({ type: \"connectable\", at: connectableSnapPoint, facing: 0 });\r\n            snapPoints.push({ type: \"neck\", top: neckSnapPoint, diameter: neckWidth, facing: 0 });\r\n            snapPoints.push({ type: \"connectable\", at: connectableSnapPoint.rotate(angle, neckPivot), facing: angle });\r\n            snapPoints.push({ type: \"neck\", top: neckSnapPoint.rotate(angle, neckPivot), diameter: neckWidth, facing: angle });\r\n            smoothCorner(combinedShape.segments[8], cornerSmoothing);\r\n        }\r\n        // Liquid mask.\r\n        var liquidMask = combinedShape.clone();\r\n        // For 3-neck, decompose the shape into separate paths.\r\n        var graphic;\r\n        if (appearance.necks == \"one\") {\r\n            setDefaultStyle(combinedShape);\r\n            graphic = new Group([\r\n                combinedShape,\r\n                glassFold(0, 5, { size: glassFoldSize })\r\n            ]);\r\n        }\r\n        else if (appearance.necks == \"three\") {\r\n            graphic = breakPath(combinedShape, 6, 17);\r\n            setDefaultStyle(graphic);\r\n            graphic.addChildren([\r\n                glassFold(0, 5, { size: glassFoldSize }),\r\n                glassFold(radius * 0.61, radius * 0.3, { rotation: 35, size: glassFoldSize }),\r\n                glassFold(-radius * 0.61, radius * 0.3, { rotation: -35, size: glassFoldSize })\r\n            ]);\r\n        }\r\n        else if (appearance.necks == \"four\") {\r\n            // Break at the same points as three but create a fourth neck\r\n            // that is just overlayed on top of everything.\r\n            var fourthNeck = neck.clone();\r\n            // +3 is required because of earlier -3 on the neck.\r\n            fourthNeck.rotate(FOURTH_NECK_ROTATION + 3, neckPivot);\r\n            var fourthNeckGlass = fourthNeck.clone();\r\n            fourthNeckGlass.strokeWidth = 0.0;\r\n            fourthNeckGlass.fillColor = \"#ffffffaa\";\r\n            graphic = new Group([\r\n                breakPath(combinedShape, 6, 17),\r\n                fourthNeckGlass,\r\n                glassFold(radius * -0.1, 6, { size: glassFoldSize }),\r\n                glassFold(radius * 0.61, radius * 0.3, { rotation: 35, size: glassFoldSize }),\r\n                glassFold(-radius * 0.61, radius * 0.3, { rotation: -35, size: glassFoldSize }),\r\n                breakPath(fourthNeckGlass, 3),\r\n                glassFold(radius * 0.36 - 6, 27, { rotation: 13, size: glassFoldSize }),\r\n            ]);\r\n            setDefaultStyle(graphic.children[0], graphic.children[5]);\r\n        }\r\n        else {\r\n            // Two-neck case. (R)\r\n            graphic = breakPath(combinedShape, 6);\r\n            setDefaultStyle(graphic);\r\n            graphic.addChildren([\r\n                glassFold(0, 5, { size: glassFoldSize }),\r\n                glassFold(radius * 0.61, radius * 0.3, { rotation: 35, size: glassFoldSize }),\r\n            ]);\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            pivot: P(0, radius),\r\n            liquidMask: liquidMask,\r\n            snapping: snapPoints\r\n        };\r\n    };\r\n    RoundBottomFlask.properties = {\r\n        label: \"Round bottom flask\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            size: 115,\r\n            necks: \"three\"\r\n        },\r\n        flippable: true,\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 80, max: 200,\r\n            },\r\n            {\r\n                spec: \"toggle-buttons\",\r\n                size: \"text\",\r\n                key: \"necks\",\r\n                label: \"Necks\",\r\n                options: [\r\n                    { value: \"one\", label: \"1\", icon: \"\" },\r\n                    { value: \"two-r\", label: \"2\", icon: \"\" },\r\n                    { value: \"three\", label: \"3\", icon: \"\" },\r\n                    { value: \"four\", label: \"4\", icon: \"\" },\r\n                ]\r\n            },\r\n        ],\r\n    };\r\n    return RoundBottomFlask;\r\n}());\r\nexport { RoundBottomFlask };\r\n// Sizes: https://www.ebay.co.uk/itm/222654821188?var=&ul_noapp=true\r\nvar BoilingFlask = /** @class */ (function () {\r\n    function BoilingFlask() {\r\n    }\r\n    BoilingFlask.prototype.render = function (appearance) {\r\n        var neckWidth = 10 + appearance.size / 10;\r\n        var neckHeight = 20 + appearance.size / 3;\r\n        var radius = appearance.size / 2;\r\n        var bulb = new Path.Circle(P(0, radius), radius);\r\n        var neck = new Path(Segments([[-neckWidth / 2, -neckHeight]], [[-neckWidth / 2, 30]] // Use a higher number to make sure it attaches to the bottom.\r\n        ));\r\n        mirrorX(neck);\r\n        addEdgeLips(neck);\r\n        var combinedShape = neck.unite(bulb);\r\n        // If the bottom is flat, create one by subtracting a rectangle.\r\n        if (appearance.bottom == \"flat\" || appearance.bottom == \"very flat\") {\r\n            var flatness = appearance.bottom == \"flat\" ? 0.07 : 0.2;\r\n            var flatBottomNegative = new Path.Rectangle(R(-radius, (2.0 - flatness) * radius, radius * 2, radius));\r\n            combinedShape = combinedShape.subtract(flatBottomNegative);\r\n        }\r\n        var liquidMask = combinedShape.clone();\r\n        var hitShape = combinedShape.clone();\r\n        setDefaultStyle(combinedShape);\r\n        combinedShape.closed = false;\r\n        var graphic = new Group([combinedShape]);\r\n        graphic.addChild(glassFold(0, 5, { size: neckWidth * 0.7 }));\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShape,\r\n            liquidMask: liquidMask,\r\n            snapping: [\r\n                { type: \"placeable\", at: combinedShape.bounds.bottomCenter },\r\n                { type: \"neck\", top: P(0, -neckHeight), diameter: neckWidth, facing: 0 },\r\n            ]\r\n        };\r\n    };\r\n    BoilingFlask.properties = {\r\n        label: \"Boiling Flask\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            size: 120,\r\n            bottom: \"flat\",\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 45, max: 180,\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"bottom\", label: \"Base\",\r\n                options: [\r\n                    { value: \"round\", label: \"Round\" },\r\n                    { value: \"flat\", label: \"Rather Flat\" },\r\n                    { value: \"very flat\", label: \"Very flat\" }\r\n                ],\r\n            }\r\n        ],\r\n    };\r\n    return BoilingFlask;\r\n}());\r\nexport { BoilingFlask };\r\n","import { setDefaultStyle, strokeWidth } from \"apparatus/draw\";\r\nimport { P, Pivot, R, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path, Segment, Shape } from \"paper\";\r\nimport { mirrorX } from \"../../draw\";\r\nvar DialysisTube = /** @class */ (function () {\r\n    function DialysisTube() {\r\n    }\r\n    DialysisTube.isBoostRequiredForAppearance = function (appearance) {\r\n        return appearance.shape == \"bulge\";\r\n    };\r\n    DialysisTube.prototype.render = function (appearance) {\r\n        var length = appearance.length, width = appearance.diameter, shapeOption = appearance.shape;\r\n        var shape = new Path(Segments([[0, -8], , [3, -5]], [[5, -6], [3, -5], [4, -1]], [[6, 0], [5, -1], [-2, 6]], shapeOption == \"uniform\" ? [[width / 2, 21], [0, -16]] : [[width / 2, length / 2], [0, -length / 3]]));\r\n        // Create bottom part.\r\n        var bottomSegments = shape.segments.map(function (s) { return new Segment(P(s.point.x, -s.point.y + length), s.handleOut.multiply([1, -1]), s.handleIn.multiply([1, -1])); });\r\n        bottomSegments.reverse();\r\n        shape.addSegments(bottomSegments);\r\n        mirrorX(shape);\r\n        shape.close();\r\n        setDefaultStyle(shape);\r\n        var graphic = new Group([\r\n            shape,\r\n            Shape.Rectangle(R(0, 0, 14, 4, Pivot.TOP_CENTER), 2).withStroke(strokeWidth(\"thinner\"), SharedColors.stroke),\r\n            Shape.Rectangle(R(0, length, 14, 4, Pivot.BOTTOM_CENTER), 2).withStroke(strokeWidth(\"thinner\"), SharedColors.stroke),\r\n        ]);\r\n        var liquidMask = new Path(shape.segments.slice(2, 6).map(function (s) { return s.clone(); }));\r\n        liquidMask.segments[0].point.y += 3;\r\n        liquidMask.segments[3].point.y -= 3;\r\n        mirrorX(liquidMask);\r\n        liquidMask.close();\r\n        return {\r\n            graphic: graphic,\r\n            liquidMask: liquidMask,\r\n            hitShape: shape.bounds.toShape()\r\n        };\r\n    };\r\n    DialysisTube.properties = {\r\n        label: \"Dialysis Tube\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            diameter: 26,\r\n            length: 80,\r\n            shape: \"uniform\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"diameter\", label: \"Diameter\",\r\n                min: 15, max: 35, unit: \"mm\"\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"length\", label: \"Length\",\r\n                min: 50, max: 150, unit: \"mm\"\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"shape\", label: \"Shape\",\r\n                options: [\r\n                    { value: \"uniform\", label: \"Uniform\" },\r\n                    { value: \"bulge\", label: \"Bulge\", tier: \"boost\" },\r\n                ],\r\n                allowSelectingTierLockedOptions: true\r\n            }\r\n        ],\r\n    };\r\n    return DialysisTube;\r\n}());\r\nexport { DialysisTube };\r\n","import { releasedAndFreeItemsCount, releasedItemsCount } from \"apparatus/specList\";\r\nimport Flags from \"flags\";\r\nimport * as React from \"react\";\r\nimport { Articles } from \"support/beacon\";\r\nimport { BeaconLink, Tick } from \"tiers/promo_ui\";\r\nimport { BOOST_TOTAL_DIAGRAMS, ITEM_CUSTOMISATIONS, MAX_BOOST_DIAGRAM_LAYERS } from \"./promo\";\r\nvar extraCustomisationsText = \"More crystal shapes, specialised glassware, more colour options, sizes, views...\";\r\nexport var ComparisonTable = function (props) {\r\n    var maxBoostDiagramLayersAsIcons = [];\r\n    for (var i = 0; i < MAX_BOOST_DIAGRAM_LAYERS; i++) {\r\n        maxBoostDiagramLayersAsIcons.push(React.createElement(InlineIcon, { icon: \"fa-tint\", key: i }));\r\n    }\r\n    return React.createElement(\"table\", { className: \"table-responsive-md\" },\r\n        React.createElement(\"tbody\", null,\r\n            React.createElement(\"tr\", null,\r\n                React.createElement(\"th\", { style: { minWidth: 260 }, colSpan: 2 },\r\n                    React.createElement(\"h6\", { className: \"text-left m-0\" }, \"Compare features\")),\r\n                React.createElement(\"th\", { style: { minWidth: 110 } },\r\n                    React.createElement(\"div\", null,\r\n                        React.createElement(\"i\", { className: \"fa fa-vial mr-2\" }),\r\n                        \"Start\")),\r\n                React.createElement(\"th\", { style: { minWidth: 110 } },\r\n                    React.createElement(\"div\", null,\r\n                        React.createElement(\"i\", { className: \"fa fa-bolt mr-2\" }),\r\n                        \"Boost\")),\r\n                React.createElement(\"th\", { style: { minWidth: 110 } },\r\n                    React.createElement(\"div\", null,\r\n                        React.createElement(\"i\", { className: \"fa fa-university mr-2\" }),\r\n                        \"Schools\"))),\r\n            React.createElement(\"tr\", null,\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Icon, { icon: \"fa-flask\" })),\r\n                React.createElement(\"td\", null, \"Available apparatus\"),\r\n                React.createElement(\"td\", null, releasedAndFreeItemsCount),\r\n                React.createElement(\"td\", null,\r\n                    releasedItemsCount,\r\n                    \" \"),\r\n                React.createElement(\"td\", null,\r\n                    releasedItemsCount,\r\n                    \" \")),\r\n            React.createElement(\"tr\", null,\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Icon, { icon: \"fa-th\" })),\r\n                React.createElement(\"td\", null,\r\n                    \"Downloaded image quality\",\r\n                    React.createElement(BeaconLink, { hint: \"Click to learn more about Standard vs High Quality\", article: Articles.IMAGE_QUALITY })),\r\n                React.createElement(\"td\", null,\r\n                    \"0.5 MP \",\r\n                    React.createElement(Icon, { icon: \"fa-square\" })),\r\n                React.createElement(\"td\", null,\r\n                    \"4.0 MP \",\r\n                    React.createElement(Icon, { icon: \"fa-th\" })),\r\n                React.createElement(\"td\", null,\r\n                    \"4.0 MP \",\r\n                    React.createElement(Icon, { icon: \"fa-th\" }))),\r\n            React.createElement(\"tr\", null,\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Icon, { icon: \"fa-image\" })),\r\n                React.createElement(\"td\", null,\r\n                    \"Maximum image size\",\r\n                    React.createElement(BeaconLink, { hint: \"Click to learn more about Standard vs High Quality\", article: Articles.IMAGE_QUALITY })),\r\n                React.createElement(\"td\", null, \"800x600\"),\r\n                React.createElement(\"td\", null, \"2400x1600\"),\r\n                React.createElement(\"td\", null, \"2400x1600\")),\r\n            React.createElement(\"tr\", null,\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Icon, { icon: \"fa-download\" })),\r\n                React.createElement(\"td\", null, \"Image export and downloads\"),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(InfinityIcon, null)),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(InfinityIcon, null)),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(InfinityIcon, null))),\r\n            React.createElement(\"tr\", null,\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Icon, { icon: \"fa-cloud\" })),\r\n                React.createElement(\"td\", null, \"Diagrams stored in the Cloud\"),\r\n                React.createElement(\"td\", null, \"3\"),\r\n                React.createElement(\"td\", null, BOOST_TOTAL_DIAGRAMS),\r\n                React.createElement(\"td\", null, props.maxDiagrams)),\r\n            React.createElement(\"tr\", null,\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Icon, { icon: \"fa-graduation-cap\" })),\r\n                React.createElement(\"td\", null,\r\n                    \"Permission for educational use\",\r\n                    React.createElement(BeaconLink, { hint: \"You can use Chemix diagrams in your teaching materials and student handouts distributed in a limited setting, such as a class.<br/>Click to learn more\", article: Articles.LICENSE })),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Tick, null)),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Tick, null)),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Tick, null))),\r\n            React.createElement(\"tr\", null,\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Icon, { icon: \"fa-file-certificate\" })),\r\n                React.createElement(\"td\", null,\r\n                    \"Permission for publishing and commercial use\",\r\n                    React.createElement(BeaconLink, { hint: \"Allows mass and commerical distribution of material containing diagrams made with Chemix.<br/>Click to learn more\", article: Articles.LICENSE })),\r\n                React.createElement(\"td\", null),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Tick, null)),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Tick, null))),\r\n            React.createElement(\"tr\", { className: \"start-section\" },\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Icon, { icon: \"fa-sliders-h\" })),\r\n                React.createElement(\"td\", null,\r\n                    \"Extra item customisations\",\r\n                    React.createElement(\"div\", { className: \"text-muted\" }, extraCustomisationsText)),\r\n                React.createElement(\"td\", null, \"0\"),\r\n                React.createElement(\"td\", null, ITEM_CUSTOMISATIONS),\r\n                React.createElement(\"td\", null, ITEM_CUSTOMISATIONS)),\r\n            React.createElement(\"tr\", null,\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Icon, { icon: \"fa-paint-roller\" })),\r\n                React.createElement(\"td\", null, \"Text colour and additional styling\"),\r\n                React.createElement(\"td\", null),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Tick, null)),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Tick, null))),\r\n            React.createElement(\"tr\", null,\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Icon, { icon: \"fa-subscript\" })),\r\n                React.createElement(\"td\", null,\r\n                    \"Easily write formulas, units and symbols using\\u00A0\",\r\n                    React.createElement(\"b\", null, \"ChemText\"),\r\n                    React.createElement(BeaconLink, { hint: \"When writing text, automatically convert H2SO4 to H\\u2082SO\\u2084. <br/>Click to learn more\", article: Articles.CHEMTEXT }),\r\n                    React.createElement(\"div\", { className: \"text-muted\" }, \"Convert H2SO4 to H\\u2082SO\\u2084, cm3 to cm\\u00B3...\")),\r\n                React.createElement(\"td\", null),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Tick, null)),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Tick, null))),\r\n            React.createElement(\"tr\", null,\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Icon, { icon: \"fa-fill-drip\" })),\r\n                React.createElement(\"td\", null, \"Liquid layers in a container\"),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(InlineIcon, { icon: \"fa-tint\", key: \"1\" }),\r\n                    React.createElement(InlineIcon, { icon: \"fa-tint\", key: \"2\" })),\r\n                React.createElement(\"td\", null, maxBoostDiagramLayersAsIcons),\r\n                React.createElement(\"td\", null, maxBoostDiagramLayersAsIcons)),\r\n            Flags.isNewTemplatesEnabled\r\n                ? React.createElement(\"tr\", null,\r\n                    React.createElement(\"td\", null,\r\n                        React.createElement(Icon, { icon: \"fa-sparkles\" })),\r\n                    React.createElement(\"td\", null, \"More diagram templates to choose from\"),\r\n                    React.createElement(\"td\", null),\r\n                    React.createElement(\"td\", null,\r\n                        React.createElement(Tick, null)),\r\n                    React.createElement(\"td\", null,\r\n                        React.createElement(Tick, null)))\r\n                : undefined,\r\n            React.createElement(\"tr\", null,\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Icon, { icon: \"fa-file-download\" })),\r\n                React.createElement(\"td\", null, \"Download as JPG\"),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Tick, null)),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Tick, null)),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Tick, null))),\r\n            React.createElement(\"tr\", null,\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Icon, { icon: \"fa-file-download\" })),\r\n                React.createElement(\"td\", null, \"Download as PNG\"),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Tick, null)),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Tick, null)),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Tick, null))),\r\n            React.createElement(\"tr\", null,\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Icon, { icon: \"fa-file-download\" })),\r\n                React.createElement(\"td\", null, \"Download as SVG\"),\r\n                React.createElement(\"td\", null),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Tick, null)),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Tick, null))),\r\n            React.createElement(\"tr\", null,\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Icon, { icon: \"fa-file-image\" })),\r\n                React.createElement(\"td\", null, \"Transparent PNG\"),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Tick, null)),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Tick, null)),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Tick, null))),\r\n            React.createElement(\"tr\", null,\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Icon, { icon: \"fa-ban\" })),\r\n                React.createElement(\"td\", null, \"No social widgets\"),\r\n                React.createElement(\"td\", null),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Tick, null)),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Tick, null))),\r\n            React.createElement(\"tr\", { className: \"start-section\" },\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Icon, { icon: \"fa-users\" })),\r\n                React.createElement(\"td\", null, \"Number of user accounts\"),\r\n                React.createElement(\"td\", null, \"1\"),\r\n                React.createElement(\"td\", null, \"1\"),\r\n                React.createElement(\"td\", null, props.students)),\r\n            React.createElement(\"tr\", null,\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Icon, { icon: \"fa-at\" })),\r\n                React.createElement(\"td\", null, \"Sign in with school email\"),\r\n                React.createElement(\"td\", null),\r\n                React.createElement(\"td\", null),\r\n                React.createElement(\"td\", null,\r\n                    React.createElement(Tick, null)))));\r\n};\r\nvar Icon = function (props) {\r\n    return React.createElement(\"i\", { className: \"fa-fw fad \" + props.icon });\r\n};\r\nvar InlineIcon = function (props) {\r\n    return React.createElement(\"i\", { className: \"fa fa-sm mr-1 \" + props.icon });\r\n};\r\nvar InfinityIcon = function () { return React.createElement(\"i\", { className: \"fas fa-infinity\" }); };\r\n","// Driver is a feature that allows on-screen elements to drive\r\n// changes to appearance. A simple example is a draggable circle\r\n// that can be dragged to change the width and height of a rectangle.\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { g } from \"analytics\";\r\nimport { clamp, P } from \"apparatus/library/common\";\r\nimport { UpdateAppearance } from \"command/basic\";\r\nimport { Sequence } from \"command/command\";\r\nimport { createInteractionHandleFor } from \"editing/handle\";\r\nimport { Adjustable } from \"editing/interaction\";\r\nimport { Key } from \"paper\";\r\nexport var INFINITE_BOUNDS = { minX: -10000, maxX: 10000, minY: -10000, maxY: 10000 };\r\nfunction restrainRectangleDriver(position, driver) {\r\n    var x = Math.round(clamp(position.x, driver.minX, driver.maxX));\r\n    var y = Math.round(clamp(position.y, driver.minY, driver.maxY));\r\n    return P(x, y);\r\n}\r\n/** Computes the delta in the component's coordinate system, from a screen-space delta. */\r\nfunction adjustDriverDelta(rawDelta, driver, component) {\r\n    var rotation = -component.currentRotation;\r\n    var flipped = component.props.flipped;\r\n    return rawDelta.rotate(rotation).multiply([flipped ? -1.0 : 1.0, 1.0]).multiply(driver.scale);\r\n}\r\n/** Applies the constraint, if present. */\r\nfunction maybeApplyConstraint(position, driver, component) {\r\n    if (!driver.constraints)\r\n        return position;\r\n    var maybeNewAppearance = driver.constraints(__assign(__assign({}, component.props.appearance), driver.toAppearance(position, component.props.appearance)), Key.modifiers);\r\n    if (!maybeNewAppearance)\r\n        return position;\r\n    return driver.fromAppearance(maybeNewAppearance);\r\n}\r\nexport function createRectangleDriver(driver, component) {\r\n    var currentPosition = driver.fromAppearance(component.props.appearance);\r\n    var handle;\r\n    handle = createInteractionHandleFor(Adjustable({\r\n        setDelta: function (delta) {\r\n            // Compute new position and then apply the appearance changes.\r\n            delta = adjustDriverDelta(delta, driver, component);\r\n            var restrainedPosition = restrainRectangleDriver(currentPosition.add(delta), driver);\r\n            var finalPosition = maybeApplyConstraint(restrainedPosition, driver, component);\r\n            handle.position = finalPosition;\r\n            component.updateMultipleAppearanceAttributes(driver.toAppearance(finalPosition, component.props.appearance));\r\n        },\r\n        onEnd: function (delta) {\r\n            g(\"UpdateAppearance\", component.apparatusType + \"::{driver}\");\r\n            delta = adjustDriverDelta(delta, driver, component);\r\n            var restrainedPosition = restrainRectangleDriver(currentPosition.add(delta), driver);\r\n            var finalPosition = maybeApplyConstraint(restrainedPosition, driver, component);\r\n            var newAppearance = driver.toAppearance(finalPosition, component.props.appearance);\r\n            var commands = [];\r\n            for (var key in newAppearance) {\r\n                commands.push(new UpdateAppearance(component.id, key, newAppearance[key], component.props.appearance[key]));\r\n            }\r\n            return new Sequence(commands);\r\n        },\r\n    }));\r\n    return {\r\n        handle: handle,\r\n        onPropsChanged: function (newAppearance) {\r\n            currentPosition = driver.fromAppearance(newAppearance);\r\n            handle.position = currentPosition;\r\n        },\r\n        onStateChanged: function (newAppearance) {\r\n            handle.position = driver.fromAppearance(newAppearance);\r\n        }\r\n    };\r\n}\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport * as Sentry from \"@sentry/react\";\r\nimport { g } from \"analytics\";\r\nimport { commandProcessor } from \"command/command\";\r\nimport { ChemixDocuments } from \"file/loading\";\r\nimport { eraseItems, replace } from \"store/actions\";\r\nimport { ID } from \"store/id\";\r\nimport { callApi } from \"../api/api\";\r\nimport { setCloudDiagram, setThemeStrokeThickness } from \"../store/actions\";\r\nimport { appStore } from \"../store/store\";\r\nexport function openDiagram(rawDiagram, isTemplate) {\r\n    g(\"Cloud\", \"Open\");\r\n    // TODO: Check if user is ok to open this file.\r\n    commandProcessor.clear();\r\n    appStore.dispatch(eraseItems());\r\n    // This sucks because we have to first erase the items,\r\n    // then use a setTimeout so that React can update the props\r\n    // and states. This should flush out the objectRefs in\r\n    // editor canvas. Without this, if an item is of the same\r\n    // ID but different type, the ref might be erased, e.g.\r\n    // if \"test tube\" has ID 1 and is replaced by \"beaker\" with\r\n    // same ID, a different ApparatusComponent is created but\r\n    // the ref is the same since it's based on ID only. This may\r\n    // result in the ref being erased when the old component is removed.\r\n    Sentry.withScope(function (scope) {\r\n        if (!isTemplate) {\r\n            scope.setExtra(\"diagram.id\", rawDiagram.id);\r\n            scope.setExtra(\"diagram.data\", rawDiagram.rawData);\r\n        }\r\n        var diagram = __assign(__assign({}, rawDiagram), { data: ChemixDocuments.parseJson(rawDiagram.rawData) });\r\n        // Reset IDs based on the doc.\r\n        ID.resetFor(diagram.data);\r\n        // Update the stroke thickness ahead of time.\r\n        appStore.dispatch(setThemeStrokeThickness(diagram.data.theme.strokeThickness));\r\n        setTimeout(function () { return appStore.dispatch(replace(diagram, isTemplate)); }, 0);\r\n    });\r\n}\r\nexport var CloudFiles;\r\n(function (CloudFiles) {\r\n    /**\r\n     * Saves the current diagram to cloud. Thumbnail must be passed as base64 encoded image.\r\n     * @param forceNew Whether a new diagram should be created regardless if the\r\n     * current diagram is already linked to a cloud diagram.\r\n     */\r\n    function save(loggedIn, thumbnail, forceNew, callbacks) {\r\n        var _a, _b;\r\n        if (forceNew === void 0) { forceNew = false; }\r\n        g(\"Cloud\", \"Save\");\r\n        var data = JSON.stringify(ChemixDocuments.getCurrentDocument());\r\n        // Check if this is a new diagram.\r\n        var currentDiagramId = (_a = appStore.getState().currentCloudDiagram) === null || _a === void 0 ? void 0 : _a.id;\r\n        var requestMethod;\r\n        var requestPayload;\r\n        var title;\r\n        if (currentDiagramId === undefined || forceNew) {\r\n            // Create new diagram.\r\n            var inputTitle = prompt(\"Enter a file name for your diagram\", \"Untitled\");\r\n            if (inputTitle === null)\r\n                return;\r\n            title = inputTitle || \"Untitled\",\r\n                requestMethod = \"POST\";\r\n            requestPayload = {\r\n                diagramSerialized: data,\r\n                thumbnailBase64: thumbnail,\r\n                title: title,\r\n            };\r\n        }\r\n        else {\r\n            // Save existing diagram.\r\n            title = ((_b = appStore.getState().currentCloudDiagram) === null || _b === void 0 ? void 0 : _b.title) || \"\";\r\n            requestMethod = \"PATCH\";\r\n            requestPayload = {\r\n                id: currentDiagramId,\r\n                diagramSerialized: data,\r\n                thumbnailBase64: thumbnail,\r\n            };\r\n        }\r\n        toastr.info(\"Saving diagram...\", title, { timeOut: 1000 });\r\n        callApi(\"diagram\", requestMethod, loggedIn, requestPayload, {\r\n            success: function (response) {\r\n                appStore.dispatch(setCloudDiagram(response));\r\n                toastr.success(\"Successfully saved diagram to Cloud.\", response.title);\r\n            },\r\n            special: function (error) {\r\n                if (error.error_type == \"diagram_exceeded\") {\r\n                    g(\"ErrorPopups\", \"StorageExceeded\");\r\n                    toastr.error(\"You have \" + error.current + \" diagrams stored. \" +\r\n                        \"To save this diagram, consider\" +\r\n                        \"<ul>\" +\r\n                        \"<li><b>upgrading</b> your plan or</li>\" +\r\n                        \"<li><b>delete</b> some previously stored diagrams first.</li>\" +\r\n                        \"</ul>\", \"You can currently only store \" + error.limit + \" diagrams\", { timeOut: 20000, extendedTimeOut: 20000 });\r\n                    // Trigger callback with delay to allow for toastr animation.\r\n                    setTimeout(callbacks.onDiagramsLimitExceeded, 1000);\r\n                    return true;\r\n                }\r\n                return false;\r\n            }\r\n        });\r\n    }\r\n    CloudFiles.save = save;\r\n    function rename(loggedIn, diagram, title, callback) {\r\n        callApi(\"diagram\", \"PATCH\", loggedIn, {\r\n            id: diagram.id,\r\n            title: title,\r\n        }, {\r\n            success: function (response) {\r\n                var _a;\r\n                // Update the current document if the renamed file matches the currently opened file.\r\n                if (((_a = appStore.getState().currentCloudDiagram) === null || _a === void 0 ? void 0 : _a.id) == diagram.id) {\r\n                    appStore.dispatch(setCloudDiagram({ id: diagram.id, title: title }));\r\n                }\r\n                toastr.success(\"Successfully renamed diagram.\", title);\r\n                callback();\r\n            },\r\n            generic: function () {\r\n                toastr.error(\"Error renaming diagram.\");\r\n            }\r\n        });\r\n    }\r\n    CloudFiles.rename = rename;\r\n    function remove(auth, diagram, callback) {\r\n        callApi(\"diagrams\", \"DELETE\", auth, { id: diagram.id }, {\r\n            success: function () {\r\n                var _a;\r\n                toastr.success(\"Diagram successfully deleted!\");\r\n                // If the current diagram has been deleted, reset the diagram ID.\r\n                if (((_a = appStore.getState().currentCloudDiagram) === null || _a === void 0 ? void 0 : _a.id) == diagram.id) {\r\n                    appStore.dispatch(setCloudDiagram(undefined));\r\n                }\r\n                callback();\r\n            },\r\n            generic: function () {\r\n                toastr.error(\"Could not delete file!\");\r\n            }\r\n        });\r\n    }\r\n    CloudFiles.remove = remove;\r\n})(CloudFiles || (CloudFiles = {}));\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { setDefaultStyle } from \"apparatus/draw\";\r\nimport { P, R, S, Segments } from \"apparatus/library/common\";\r\nimport { CompoundPath, Group, Path, Shape } from \"paper\";\r\nimport { breakPath } from \"../draw\";\r\nvar MIN_DIAMETER = 8;\r\nvar MAX_DIAMETER = 40;\r\nexport var TUBE_DIAMETER_SPEC = {\r\n    spec: \"slider\", key: \"diameter\", label: \"Diameter\",\r\n    min: MIN_DIAMETER, max: MAX_DIAMETER\r\n};\r\nvar bendSpecs = {\r\n    min: -135, max: 135, step: 5,\r\n    pipsStep: 9, unit: \"\"\r\n};\r\nvar lengthSpecs = {\r\n    label: \"Length\", min: 0, max: 250\r\n};\r\nvar defaultDiameter = 15;\r\nvar TubeBend = /** @class */ (function () {\r\n    function TubeBend() {\r\n    }\r\n    TubeBend.prototype.render = function (appearance) {\r\n        var diameter = appearance.diameter;\r\n        var semilength = 25;\r\n        var onesidelength = appearance.length;\r\n        var angle = appearance.angle;\r\n        var _a = tubeBend(diameter, angle, semilength, onesidelength), topWall = _a.topWall, bottomWall = _a.bottomWall, snapping = _a.snapping;\r\n        var graphic = new Group([topWall, bottomWall]);\r\n        setDefaultStyle(graphic);\r\n        var hitShape = new Path(__spreadArrays(topWall.segments, bottomWall.segments));\r\n        // let pivot = angle != 0 ? P(semilength, 0).add([rotationPivotDistance * Math.tan(angle.toRadians() / 2), 0]) : P(semilength + tubeBendLength / 2, 0)\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShape,\r\n            snapping: [\r\n                { type: \"connectable\", at: P(0, 0), facing: -90 },\r\n                snapping,\r\n            ]\r\n        };\r\n    };\r\n    TubeBend.properties = {\r\n        label: \"Tube bend\",\r\n        kind: \"tube\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            angle: -75,\r\n            diameter: defaultDiameter,\r\n            length: 25\r\n        },\r\n        appearanceSpecs: [\r\n            __assign({ spec: \"slider\", key: \"angle\", label: \"Bend Angle\" }, bendSpecs),\r\n            TUBE_DIAMETER_SPEC,\r\n            __assign({ spec: \"slider\", key: \"length\" }, lengthSpecs),\r\n        ],\r\n    };\r\n    return TubeBend;\r\n}());\r\nexport { TubeBend };\r\nvar Tube = /** @class */ (function () {\r\n    function Tube() {\r\n        this.drivers = [\r\n            {\r\n                type: \"rectangle\",\r\n                minX: 30, maxX: 600,\r\n                minY: 20, maxY: 20,\r\n                fromAppearance: function (a) { return P(a.length, 20); },\r\n                toAppearance: function (p) { return ({ length: p.x }); },\r\n                scale: 2.0,\r\n            }\r\n        ];\r\n    }\r\n    Tube.prototype.render = function (appearance) {\r\n        var radius = appearance.diameter / 2;\r\n        var length = appearance.length;\r\n        var topWall = new Path(Segments([[0, -radius]], [[length, -radius]]));\r\n        var bottomWall = new Path(Segments([[0, radius]], [[length, radius]]));\r\n        var graphic = new Group([topWall, bottomWall]);\r\n        setDefaultStyle(graphic);\r\n        var hitShape = Shape.Rectangle(R(0, -radius, length, radius * 2));\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShape,\r\n            snapping: [{\r\n                    type: \"connectable\", at: P(0, 0), facing: -90,\r\n                }, {\r\n                    type: \"connectable\", at: P(length, 0), facing: 90,\r\n                }]\r\n        };\r\n    };\r\n    Tube.properties = {\r\n        label: \"Straight tube\",\r\n        kind: \"tube\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            length: 100,\r\n            diameter: defaultDiameter,\r\n        },\r\n        appearanceSpecs: [\r\n            TUBE_DIAMETER_SPEC,\r\n            {\r\n                spec: \"slider\", key: \"length\", label: \"Length\",\r\n                min: 30, max: 600\r\n            },\r\n        ],\r\n    };\r\n    return Tube;\r\n}());\r\nexport { Tube };\r\nvar FourWayCrossing = /** @class */ (function () {\r\n    function FourWayCrossing() {\r\n    }\r\n    FourWayCrossing.prototype.render = function (appearance) {\r\n        var diameter = appearance.diameter;\r\n        var radius = diameter / 2;\r\n        var outer = radius + 20;\r\n        var path = new CompoundPath({});\r\n        path.moveTo(P(radius, -outer));\r\n        path.lineTo(P(radius, -radius));\r\n        path.lineTo(P(outer, -radius));\r\n        path.moveBy(P(0, diameter));\r\n        path.lineTo(P(radius, radius));\r\n        path.lineTo(P(radius, outer));\r\n        path.moveBy(P(-diameter, 0));\r\n        path.lineTo(P(-radius, radius));\r\n        path.lineTo(P(-outer, radius));\r\n        path.moveBy(P(0, -diameter));\r\n        path.lineTo(P(-radius, -radius));\r\n        path.lineTo(P(-radius, -outer));\r\n        setDefaultStyle(path);\r\n        return {\r\n            graphic: path, hitShape: path.bounds.toShape(),\r\n            snapping: [\r\n                { type: \"connectable\", at: P(0, outer), facing: 180 },\r\n                { type: \"connectable\", at: P(outer, 0), facing: 90 },\r\n                { type: \"connectable\", at: P(0, -outer), facing: 0 },\r\n                { type: \"connectable\", at: P(-outer, 0), facing: -90 },\r\n            ]\r\n        };\r\n    };\r\n    FourWayCrossing.properties = {\r\n        label: \"4-Way Crossing\",\r\n        kind: \"tube\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            diameter: defaultDiameter\r\n        },\r\n        appearanceSpecs: [\r\n            TUBE_DIAMETER_SPEC\r\n        ],\r\n    };\r\n    return FourWayCrossing;\r\n}());\r\nexport { FourWayCrossing };\r\nvar ThreeWayCrossing = /** @class */ (function () {\r\n    function ThreeWayCrossing() {\r\n    }\r\n    ThreeWayCrossing.prototype.render = function (appearance) {\r\n        var diameter = appearance.diameter;\r\n        var radius = diameter / 2;\r\n        var outer = radius + 20;\r\n        var path = new CompoundPath({});\r\n        path.moveTo(P(radius, -outer));\r\n        path.lineTo(P(radius, -radius));\r\n        path.lineTo(P(outer, -radius));\r\n        path.moveBy(P(0, diameter));\r\n        path.lineTo(P(radius, radius));\r\n        path.lineTo(P(radius, outer));\r\n        path.moveBy(P(-diameter, 0));\r\n        path.lineTo(P(-radius, -outer));\r\n        setDefaultStyle(path);\r\n        return {\r\n            graphic: path, hitShape: path.bounds.toShape(),\r\n            snapping: [\r\n                { type: \"connectable\", at: P(0, outer), facing: 180 },\r\n                { type: \"connectable\", at: P(0, -outer), facing: 0 },\r\n                { type: \"connectable\", at: P(outer, 0), facing: 90 },\r\n            ]\r\n        };\r\n    };\r\n    ThreeWayCrossing.properties = {\r\n        label: \"3-Way Crossing\",\r\n        kind: \"tube\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            diameter: defaultDiameter\r\n        },\r\n        appearanceSpecs: [\r\n            TUBE_DIAMETER_SPEC\r\n        ],\r\n    };\r\n    return ThreeWayCrossing;\r\n}());\r\nexport { ThreeWayCrossing };\r\nvar UTube = /** @class */ (function () {\r\n    function UTube() {\r\n        this.drivers = [\r\n            {\r\n                type: \"rectangle\",\r\n                minX: 0, maxX: 0,\r\n                minY: 30, maxY: 150,\r\n                fromAppearance: function (a) { return P(0, a.size); },\r\n                toAppearance: function (p) { return ({ size: p.y }); },\r\n                scale: 2.0,\r\n            }\r\n        ];\r\n    }\r\n    UTube.prototype.render = function (appearance) {\r\n        var bendRadius = appearance.size;\r\n        var diameter = appearance.diameter;\r\n        var outerRadius = bendRadius + diameter;\r\n        var path = new Path(Segments([[-bendRadius, -50]], [[-bendRadius, 0], undefined, [0, bendRadius * 1.4]], [[bendRadius, 0], [0, bendRadius * 1.4]], [[bendRadius, -50]], [[outerRadius, -50]], [[outerRadius, 0], undefined, [0, outerRadius * 1.4]], [[-outerRadius, 0], [0, outerRadius * 1.4]], [[-outerRadius, -50]]));\r\n        var graphic = breakPath(path, 4);\r\n        setDefaultStyle(graphic);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: path,\r\n            snapping: [\r\n                { type: \"connectable\", at: P(-bendRadius - diameter / 2, -50), facing: 0 },\r\n                { type: \"connectable\", at: P(bendRadius + diameter / 2, -50), facing: 0 },\r\n            ]\r\n        };\r\n    };\r\n    UTube.properties = {\r\n        label: \"U-Bent Tube\",\r\n        kind: \"tube\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            diameter: defaultDiameter,\r\n            size: 60\r\n        },\r\n        appearanceSpecs: [\r\n            TUBE_DIAMETER_SPEC,\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 30, max: 150,\r\n            },\r\n        ],\r\n    };\r\n    return UTube;\r\n}());\r\nexport { UTube };\r\nvar STube = /** @class */ (function () {\r\n    function STube() {\r\n    }\r\n    STube.prototype.render = function (appearance) {\r\n        var diameter = appearance.diameter;\r\n        var leftAngle = appearance.angle1;\r\n        var rightAngle = appearance.angle2;\r\n        var semilength = 15;\r\n        // Length of the section connecting the two end in the middle.\r\n        var middleLength = appearance.length;\r\n        var rightEnd = tubeBend(diameter, rightAngle, semilength, semilength);\r\n        var leftEnd = tubeBend(diameter, leftAngle, semilength, semilength);\r\n        // reflect the left end.\r\n        leftEnd.topWall.scale(-1, P(0, 0));\r\n        leftEnd.bottomWall.scale(-1, P(0, 0));\r\n        // Shift the segments of the right end.\r\n        rightEnd.topWall.segments.forEach(function (s) { return s.point.x += middleLength; });\r\n        rightEnd.bottomWall.segments.forEach(function (s) { return s.point.x += middleLength; });\r\n        // Assembe the top walls and bottom walls separately.\r\n        var graphic = new Group([\r\n            new Path(__spreadArrays(leftEnd.bottomWall.segments, rightEnd.topWall.segments)),\r\n            new Path(__spreadArrays(rightEnd.bottomWall.segments, leftEnd.topWall.segments))\r\n        ]);\r\n        setDefaultStyle(graphic);\r\n        // Join everything together to create the hit shape.\r\n        var hitShape = new Path(__spreadArrays(leftEnd.bottomWall.segments, rightEnd.topWall.segments, rightEnd.bottomWall.segments, leftEnd.topWall.segments));\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShape,\r\n            snapping: [\r\n                __assign(__assign({}, rightEnd.snapping), { at: rightEnd.snapping.at.add([middleLength, 0]) }),\r\n                __assign(__assign({}, leftEnd.snapping), { at: leftEnd.snapping.at.multiply(-1), facing: leftEnd.snapping.facing + 180 })\r\n            ]\r\n        };\r\n    };\r\n    STube.properties = {\r\n        label: \"S-Bent Tube\",\r\n        kind: \"tube\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            diameter: defaultDiameter,\r\n            angle1: 90,\r\n            angle2: 90,\r\n            length: 80\r\n        },\r\n        appearanceSpecs: [\r\n            TUBE_DIAMETER_SPEC,\r\n            __assign({ spec: \"slider\", key: \"angle1\", label: \"First angle\" }, bendSpecs),\r\n            __assign({ spec: \"slider\", key: \"angle2\", label: \"Second angle\" }, bendSpecs),\r\n            {\r\n                spec: \"slider\", key: \"length\", label: \"Length\",\r\n                min: 0, max: 120\r\n            }\r\n        ],\r\n    };\r\n    return STube;\r\n}());\r\nexport { STube };\r\nvar AdapterTube = /** @class */ (function () {\r\n    function AdapterTube() {\r\n    }\r\n    AdapterTube.prototype.render = function (appearance) {\r\n        var radius1 = appearance.diameter1 / 2;\r\n        var radius2 = appearance.diameter2 / 2;\r\n        var hitShape = new Path(Segments(\r\n        // Top\r\n        [[-30, -radius1]], [[-15, -radius1], undefined, [5, 0]], [[15, -radius2], [-5, 0]], [[30, -radius2]], \r\n        // Bottom\r\n        [[30, radius2]], [[15, radius2], undefined, [-5, 0]], [[-15, radius1], [5, 0]], [[-30, radius1]]));\r\n        var graphic = breakPath(hitShape, 4);\r\n        setDefaultStyle(graphic);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShape,\r\n            snapping: [\r\n                { type: \"connectable\", at: P(-30, 0), facing: -90 },\r\n                { type: \"connectable\", at: P(30, 0), facing: 90 },\r\n            ]\r\n        };\r\n    };\r\n    AdapterTube.properties = {\r\n        label: \"Adapter Tube\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            diameter1: 8,\r\n            diameter2: defaultDiameter,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", min: MIN_DIAMETER, max: MAX_DIAMETER,\r\n                key: \"diameter1\", label: \"First diameter\",\r\n            },\r\n            {\r\n                spec: \"slider\", min: MIN_DIAMETER, max: MAX_DIAMETER,\r\n                key: \"diameter2\", label: \"Second diameter\",\r\n            }\r\n        ],\r\n    };\r\n    return AdapterTube;\r\n}());\r\nexport { AdapterTube };\r\n/**\r\n * Helper method to draw a tube bend.\r\n *\r\n *               r     D   D2\r\n *                   /   /\r\n *           e     C   C2\r\n *   A ------- B /   /    e = semi length\r\n *   o            p /     r = rotary pivot\r\n *   A2 ------ B2 -/      o = origin, p = pivot\r\n * Parameters:\r\n *  - diameter: The thickness of the tube\r\n *  - angle: The angle the tube should bend\r\n *  - semilength: length from A -> B and C -> D\r\n * Returns:\r\n *  - topWall: (A,B,C,D)\r\n *  - bottomWall: (D2,C2,B2,A2)\r\n *  - snapPoint: The snappoint for the D-end. A-end is simply P(0, 0)\r\n */\r\nfunction tubeBend(diameter, angle, semilength, onesidelength) {\r\n    var radius = diameter / 2;\r\n    // Length dedicated to drawing the bend.\r\n    var tubeBendLength = diameter * 3;\r\n    // Set up the pivot around which the tube bends\r\n    var rotationPivotDistance = angle != 0 ? tubeBendLength / angle.toRadians() : 100;\r\n    var r = P(semilength, rotationPivotDistance);\r\n    // Unit direction vector that determines where to draw\r\n    // point D from C and also the (inverse) handleIn for C.\r\n    var directionC = P(1, 0).rotate(angle);\r\n    // Same, but for point B, from A to B\r\n    var directionB = P(1, 0);\r\n    // Set up the points that define the bend. Watch out for angle = 0\r\n    var a = P(0, -radius);\r\n    var b = P(semilength, -radius);\r\n    var c = angle != 0 ? b.rotate(angle, r) : b.add([tubeBendLength, 0]);\r\n    var d = c.add(directionC.multiply(onesidelength));\r\n    var a2 = P(0, radius);\r\n    var b2 = P(semilength, radius);\r\n    var c2 = angle != 0 ? b2.rotate(angle, r) : b2.add([tubeBendLength, 0]);\r\n    var d2 = c2.add(directionC.multiply(onesidelength));\r\n    // Factor by which to scale handle points in the bend.\r\n    var handlesFactor = tubeBendLength * 0.4;\r\n    var outerFactor = handlesFactor * (1 + radius / rotationPivotDistance);\r\n    var innerFactor = handlesFactor * (1 - radius / rotationPivotDistance);\r\n    var topHandlesFactor = outerFactor;\r\n    var bottomHandleFactor = innerFactor;\r\n    var topWall = new Path([\r\n        S(a),\r\n        S(b, undefined, directionB.multiply(topHandlesFactor)),\r\n        S(c, directionC.multiply(-topHandlesFactor)),\r\n        S(d)\r\n    ]);\r\n    // Constructed in reverse.\r\n    var bottomWall = new Path([\r\n        S(d2),\r\n        S(c2, undefined, directionC.multiply(-bottomHandleFactor)),\r\n        S(b2, directionB.multiply(bottomHandleFactor)),\r\n        S(a2),\r\n    ]);\r\n    return {\r\n        topWall: topWall,\r\n        bottomWall: bottomWall,\r\n        snapping: {\r\n            type: \"connectable\",\r\n            at: angle != 0\r\n                ? P(semilength, 0).rotate(angle, r).add(directionC.multiply(onesidelength))\r\n                : P(d.x, 0),\r\n            facing: 90 + angle\r\n        }\r\n    };\r\n}\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { P, R } from \"apparatus/library/common\";\r\nimport { RotationHandler } from \"editing/rotation/rotation_handler\";\r\nimport * as React from \"react\";\r\nimport { ctrlKey } from \"view/keyboard_shortucts\";\r\n/**\r\n * Component to display a rectangle around the current selection\r\n * plus an icon that can be clicked on to perform rotation.\r\n * To use this component, instantiate it and update by setting state.\r\n */\r\nvar SelectionOverlay = /** @class */ (function (_super) {\r\n    __extends(SelectionOverlay, _super);\r\n    function SelectionOverlay(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        /** Ref to the rotation handle. */\r\n        _this.rotatioHandleRef = React.createRef();\r\n        /** Helper for handling updating items when the rotation handler is used */\r\n        _this.rotationHandler = new RotationHandler();\r\n        _this.state = { isVisible: false, center: P(0, 0), bounds: R(0, 0, 0, 0) };\r\n        return _this;\r\n    }\r\n    SelectionOverlay.prototype.componentDidMount = function () {\r\n        this.setUpRotationHandler();\r\n    };\r\n    SelectionOverlay.prototype.render = function () {\r\n        var _a = this.state, isVisible = _a.isVisible, center = _a.center, bounds = _a.bounds;\r\n        var hideDueToInteraction = this.props.hideDueToInteraction;\r\n        return React.createElement(\"div\", { id: \"selection-center\", key: \"selectionCenter\", style: {\r\n                visibility: isVisible && !hideDueToInteraction ? \"visible\" : \"hidden\",\r\n                left: center.x,\r\n                top: center.y\r\n            } },\r\n            React.createElement(\"div\", { id: \"selection-box\", key: \"box\", style: {\r\n                    left: bounds.x - center.x - 5,\r\n                    top: bounds.y - center.y - 5,\r\n                    width: bounds.width + 10,\r\n                    height: bounds.height + 10,\r\n                } }),\r\n            React.createElement(\"div\", { id: \"rotation-handle\", key: \"handle_image\", title: rotationTitle, ref: this.rotatioHandleRef, style: {\r\n                    top: bounds.y - center.y - 60\r\n                } },\r\n                React.createElement(\"i\", { className: \"fas fa-sync-alt\" })));\r\n    };\r\n    /** Sets up the rotation handle to be draggable, using jQuery. */\r\n    SelectionOverlay.prototype.setUpRotationHandler = function () {\r\n        var handle = $(this.rotatioHandleRef.current);\r\n        var self = this;\r\n        handle.draggable({\r\n            revert: true,\r\n            revertDuration: 0,\r\n            cursorAt: { top: 14, left: 0 },\r\n            start: function (e, ui) {\r\n                var rotationType = self.rotationHandler.onStart();\r\n                self.props.onStartRotation(rotationType);\r\n            },\r\n            drag: function (e, ui) {\r\n                var pos = $(this).position();\r\n                // How many snap points?\r\n                var snaps = 72;\r\n                if (e.ctrlKey) {\r\n                    snaps = 360;\r\n                }\r\n                else if (e.shiftKey) {\r\n                    snaps = 16;\r\n                }\r\n                else if (e.altKey) {\r\n                    snaps = 0;\r\n                }\r\n                var angle = self.rotationHandler.onRotate(pos.left, pos.top, snaps);\r\n                self.props.onUpdateRotation(angle);\r\n            },\r\n            stop: function (e, ui) {\r\n                self.rotationHandler.onEnd();\r\n                self.props.onEndRotation();\r\n            }\r\n        }).on('click', function () {\r\n            toastr.info(\"To rotate, start dragging this handle.\");\r\n        });\r\n    };\r\n    return SelectionOverlay;\r\n}(React.Component));\r\nexport { SelectionOverlay };\r\nvar rotationTitle = \"Drag to rotate<div class=\\\"shortcut\\\">\" +\r\n    \"By default, rotates in 5\\u00B0 steps.<br/>\" +\r\n    (\"Hold <span class=\\\"keyboardKey\\\">\" + ctrlKey() + \"</span> for 1\\u00B0 steps<br/>\") +\r\n    \"Hold <span class=\\\"keyboardKey\\\">Shift</span> for 22.5\\u00B0 steps<br/>\" +\r\n    \"Hold <span class=\\\"keyboardKey\\\">Alt</span> for free rotation</div\";\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { P, Pivot, R } from \"apparatus/library/common\";\r\nimport { BasicShapes } from \"apparatus/library/shapes/common\";\r\nimport { Shape } from \"paper\";\r\nvar Rectangle = /** @class */ (function () {\r\n    function Rectangle() {\r\n        this.drivers = [\r\n            {\r\n                type: \"rectangle\",\r\n                minX: 8, maxX: 250,\r\n                minY: 8, maxY: 250,\r\n                toAppearance: function (p) { return ({\r\n                    width: p.x * 2,\r\n                    height: p.y * 2\r\n                }); },\r\n                fromAppearance: function (a) { return P(a.width / 2, a.height / 2); },\r\n                scale: 1.0,\r\n                constraints: function (a, modifiers) {\r\n                    if (modifiers.shift) {\r\n                        // Force square.\r\n                        var size = Math.max(a.width, a.height);\r\n                        return { width: size, height: size };\r\n                    }\r\n                    return;\r\n                }\r\n            }\r\n        ];\r\n    }\r\n    Rectangle.prototype.render = function (appearance) {\r\n        var cornerRadius = 0;\r\n        if (appearance.roundedCorner) {\r\n            cornerRadius = Math.min(Math.min(appearance.width / 2, appearance.height / 2), appearance.cornerRadius);\r\n        }\r\n        var graphic = Shape.Rectangle(R(0, 0, appearance.width, appearance.height, Pivot.CENTER), cornerRadius);\r\n        BasicShapes.applyStyle(graphic, appearance);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: BasicShapes.bounds(graphic)\r\n        };\r\n    };\r\n    Rectangle.properties = {\r\n        label: \"Rectangle\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: __assign({ width: 200, height: 100, roundedCorner: false, cornerRadius: 10 }, BasicShapes.defaultAppearance),\r\n        appearanceSpecs: __spreadArrays(BasicShapes.specs, [\r\n            BasicShapes.header,\r\n            {\r\n                spec: \"checkbox\", key: \"roundedCorner\", label: \"Rounded corners\",\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"cornerRadius\", label: \"Rounded corner size\",\r\n                min: 1, max: 30,\r\n                visible: function (a) { return a.roundedCorner; }\r\n            }\r\n        ]),\r\n    };\r\n    return Rectangle;\r\n}());\r\nexport { Rectangle };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { P, Pivot, R } from \"apparatus/library/common\";\r\nimport { BasicShapes } from \"apparatus/library/shapes/common\";\r\nimport { Shape } from \"paper\";\r\nvar Ellipse = /** @class */ (function () {\r\n    function Ellipse() {\r\n        this.drivers = [\r\n            {\r\n                type: \"rectangle\",\r\n                minX: 8, maxX: 300,\r\n                minY: 8, maxY: 300,\r\n                fromAppearance: function (a) { return P(a.width / 2, a.height / 2); },\r\n                toAppearance: function (p) { return ({ width: p.x * 2, height: p.y * 2 }); },\r\n                scale: 1.0,\r\n                constraints: function (a, modifiers) {\r\n                    if (modifiers.shift) {\r\n                        // Force square.\r\n                        var size = Math.max(a.width, a.height);\r\n                        return { width: size, height: size };\r\n                    }\r\n                    return;\r\n                }\r\n            }\r\n        ];\r\n    }\r\n    Ellipse.prototype.render = function (appearance) {\r\n        var width = appearance.width;\r\n        var height = appearance.height;\r\n        if (appearance.forceCircle) {\r\n            var max = Math.max(width, height);\r\n            width = max;\r\n            height = max;\r\n        }\r\n        var graphic = Shape.Ellipse(R(0, 0, width, height, Pivot.CENTER));\r\n        BasicShapes.applyStyle(graphic, appearance);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: BasicShapes.bounds(graphic)\r\n        };\r\n    };\r\n    Ellipse.properties = {\r\n        label: \"Ellipse\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: __assign({ width: 120, height: 80, forceCircle: false }, BasicShapes.defaultAppearance),\r\n        appearanceSpecs: __spreadArrays(BasicShapes.specs, [\r\n            BasicShapes.header,\r\n            {\r\n                spec: \"checkbox\", key: \"forceCircle\", label: \"Force circle shape\",\r\n            }\r\n        ]),\r\n    };\r\n    return Ellipse;\r\n}());\r\nexport { Ellipse };\r\n","import { apparatusClass } from \"apparatus/library\";\r\nimport { itemsThatRequireBoost } from \"apparatus/specList\";\r\n/**\r\n * This should probably be moved inside the context.\r\n */\r\nexport function isItemUnlocked(item, currentTier) {\r\n    if (currentTier) {\r\n        return true;\r\n    }\r\n    // If here, then user does not have a plan.\r\n    if (itemsThatRequireBoost.indexOf(item.type) !== -1) {\r\n        return false;\r\n    }\r\n    var klass = apparatusClass(item.type);\r\n    if (klass.isBoostRequiredForAppearance && klass.isBoostRequiredForAppearance(item.appearance)) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n","import { P } from \"apparatus/library/common\";\r\nimport { SVG } from \"apparatus/svg\";\r\nimport { Group } from \"paper\";\r\nimport { Random } from \"random/random\";\r\nvar FLAME_COLOR_SWATCHES = {\r\n    \"Green\": \"#5FAA5C\",\r\n    \"Blue\": \"#5C6FAA\",\r\n    \"Yellow\": \"#E9DC8C\",\r\n};\r\nvar Flame = /** @class */ (function () {\r\n    function Flame() {\r\n    }\r\n    Flame.prototype.render = function (appearance) {\r\n        var flame = SVG.redFlame();\r\n        if (appearance.colorMode == \"custom\") {\r\n            var baseColor = appearance.color.color();\r\n            // Outer flame shape.\r\n            var highlightColor = baseColor.ladd(30);\r\n            flame.children[0].children[0].setGradientFill(\"down\", [\r\n                [highlightColor.hex(), 0.0],\r\n                [baseColor.hex(), 1.0]\r\n            ]);\r\n            // Inner flame shape.\r\n            flame.children[0].children[1].setGradientFill(\"down\", [\r\n                [highlightColor.ladd(50).hex(), 0.0],\r\n                [highlightColor.ladd(20).hex(), 1.0]\r\n            ]);\r\n            flame.opacity = 0.9;\r\n        }\r\n        var graphic = new Group();\r\n        graphic.addChild(flame);\r\n        var r = new Random();\r\n        var position = flame.position;\r\n        for (var i = 1; i < appearance.peaks; i++) {\r\n            var newFlame = flame.clone();\r\n            position = position.add(P(appearance.spacing, 0)).add(r.randomUnitVector(5.0));\r\n            newFlame.position = position;\r\n            graphic.addChild(newFlame);\r\n        }\r\n        graphic.scale(appearance.scale);\r\n        return { graphic: graphic, hitShape: graphic.bounds.toShape() };\r\n    };\r\n    Flame.properties = {\r\n        label: \"Flame\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            peaks: 1,\r\n            scale: 1.0,\r\n            spacing: 12,\r\n            colorMode: \"default\",\r\n            color: FLAME_COLOR_SWATCHES[\"Green\"]\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.5, max: 2.0, step: 0.05, unit: \"%\",\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"peaks\", label: \"Number of peaks\",\r\n                min: 1, max: 7, step: 1,\r\n                tier: \"boost\"\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"colorMode\", label: \"Flame colour\",\r\n                options: [\r\n                    { value: \"default\", label: \"Default red\" },\r\n                    { value: \"custom\", label: \"Custom\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"color\", key: \"color\", label: \"Custom colour\",\r\n                visible: function (a) { return a.colorMode === \"custom\"; },\r\n                swatches: FLAME_COLOR_SWATCHES, demoSwatches: FLAME_COLOR_SWATCHES,\r\n                tier: \"boost\",\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"spacing\", label: \"Spacing between peaks\",\r\n                min: 12, max: 20, tier: \"boost\",\r\n                visible: function (a) { return a.peaks > 1; }\r\n            }\r\n        ],\r\n    };\r\n    return Flame;\r\n}());\r\nexport { Flame };\r\n","import { mirrorX, setDefaultStyleWithStroke } from \"apparatus/draw\";\r\nimport { R, Segments, SharedColors, SharedGradients } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar Nail = /** @class */ (function () {\r\n    function Nail() {\r\n    }\r\n    Nail.prototype.render = function (appearance) {\r\n        var length = appearance.length;\r\n        var thickness = appearance.thickness;\r\n        var nail = new Path(Segments([[thickness * 2 + 3, 0]], [[thickness, 3]], [[thickness, length - 10]], [[0, length]]));\r\n        mirrorX(nail);\r\n        nail.closePath();\r\n        setDefaultStyleWithStroke(\"thinner\", nail);\r\n        nail.fillColor = (function () {\r\n            switch (appearance.color) {\r\n                case \"light\":\r\n                    return SharedColors.lightMetal;\r\n                case \"dark\":\r\n                    return SharedColors.mediumMetal;\r\n                case \"rusty\":\r\n                    return \"#bc7832\";\r\n            }\r\n        })();\r\n        var graphic = new Group([nail]);\r\n        if (appearance.additional == \"metal strip\") {\r\n            var stripThickness = thickness * 2 + 4;\r\n            var metalStrip = Shape.Rectangle(R(-stripThickness / 2, length / 2 - 25, stripThickness, 40))\r\n                .withGradientFill(\"right\", SharedGradients.metal)\r\n                .withStroke(\"thinner\", SharedColors.mediumMetal);\r\n            graphic.addChild(metalStrip);\r\n        }\r\n        return { graphic: graphic, hitShape: graphic.bounds.expand(10).toShape() };\r\n    };\r\n    Nail.properties = {\r\n        label: \"Nail\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            length: 75,\r\n            thickness: 2,\r\n            color: \"light\",\r\n            additional: \"none\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"length\", label: \"Length\",\r\n                min: 60, max: 120\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"thickness\", label: \"Thickness\",\r\n                min: 2, max: 4, step: 0.1\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"color\", label: \"Colour\",\r\n                options: [\r\n                    { value: \"light\", label: \"Light metal\" },\r\n                    { value: \"dark\", label: \"Dark metal\" },\r\n                    { value: \"rusty\", label: \"Rusty\" }\r\n                ]\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"additional\", label: \"Additions\",\r\n                options: [\r\n                    { value: \"none\", label: \"Nothing\" },\r\n                    { value: \"metal strip\", label: \"Metal strip\" },\r\n                ]\r\n            }\r\n        ],\r\n    };\r\n    return Nail;\r\n}());\r\nexport { Nail };\r\n","import { mirrorX } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, Pivot, R, Segments, SharedGradients } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar HANDLE_COLOUR = \"#132c64\".color();\r\n/**\r\n * See https://solutions.pipette.com/micropipette/\r\n * https://5.imimg.com/data5/IG/DV/EH/SELLER-10358897/laboratory-ware-500x500.png\r\n */\r\nvar Micropipette = /** @class */ (function () {\r\n    function Micropipette() {\r\n    }\r\n    Micropipette.prototype.render = function (appearance) {\r\n        var handle = new Path(Segments([[-28, -79]], [[15, -71]], [[15, -63]], [[26, -61], [-5, -1], [3, 1]], [[30, -50], [0, -4], [-1, 21]], [[25, 33]], [[-11, 33]], [[-12, -59], [1, 19], [-1, -12]], [[-28, -72]])).close()\r\n            .subtract(new Path.Rectangle(R(0, -65, 15, 25, Pivot.TOP_CENTER), 4.0))\r\n            .withStroke(\"thin\", \"#151d2b\")\r\n            .withGradientFill(\"right\", Gradients.cylinder(HANDLE_COLOUR));\r\n        var dial1 = Shape.Rectangle(R(0, -65, 15, 15, Pivot.TOP_CENTER))\r\n            .withGradientFill(\"right\", Gradients.cylinder(\"#333333\".color()));\r\n        var dial2 = Shape.Rectangle(R(0, -60, 8, 20, Pivot.TOP_CENTER))\r\n            .withGradientFill(\"right\", Gradients.cylinder(\"#333333\".color()));\r\n        var dial3 = Shape.Rectangle(R(0, 33, 22, 16, Pivot.TOP_CENTER), 2.0)\r\n            .withStroke(\"thin\", \"#142852\")\r\n            .withGradientFill(\"right\", Gradients.cylinder(HANDLE_COLOUR));\r\n        var ejectorTip = new Path(Segments([[20, -76], , [16, -1]], [[26, -72], [8, -1]], [[25, -52]], [[19, -52]])).close()\r\n            .withGradientFill(\"left\", Gradients.simple(\"#cccccc\".color()));\r\n        var shaft = new Path(Segments([[25, 31], , [-1, 21]], [[10, 68], [6, -11], [-5, 9]], [[3, 157]], [[0, 184]], [[-3, 184]], [[-5, 157]], [[-6, 85], [0, 16], [0, -15]], [[-8, 48], [-1, 18], [-1, -8]], [[-9, 31]])).close().withStroke(\"thinner\", \"#bbbbbb\")\r\n            .withGradientFill(\"right\", Gradients.reflected([\"#cfd4dc\", 0.1], [\"#e4e5e9\", 0.3]));\r\n        var plungerButton = new Path(Segments([[14, -107]], [[14, -102]], [[5, -93], [2, -7], [-5, 0]]));\r\n        mirrorX(plungerButton);\r\n        plungerButton\r\n            .close()\r\n            .withGradientFill(\"down\", [[\"#d2d2d2\", 0.32], [\"#bbbbbb\", 0.33], [\"#d2d2d2\", 0.8]]);\r\n        var plungerRod = Shape.Rectangle(R(0, -95, 6, 50, Pivot.TOP_CENTER))\r\n            .withGradientFill(\"left\", SharedGradients.cylinderMetal);\r\n        var plunger = new Group([plungerRod, plungerButton]);\r\n        var graphic = new Group([plunger, ejectorTip, dial2, dial1, shaft, dial3, handle]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            pivot: P(0, 0)\r\n        };\r\n    };\r\n    Micropipette.properties = {\r\n        label: \"Micropipette\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {},\r\n        appearanceSpecs: [],\r\n    };\r\n    return Micropipette;\r\n}());\r\nexport { Micropipette };\r\n","import { breakPathClosed, glassFold, mirrorX, setDefaultStyle } from \"apparatus/draw\";\r\nimport { P, Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { Path } from \"paper\";\r\nvar CowType = /** @class */ (function () {\r\n    function CowType() {\r\n    }\r\n    CowType.prototype.render = function (appearance) {\r\n        var angle = 35;\r\n        var bulb = new Path.Circle(P(0, 10), 40);\r\n        var inlet = new Path(Segments([[11, -60]], [[9, 0]]));\r\n        mirrorX(inlet);\r\n        var outlet = new Path(Segments([[13, 0]], [[7, 80]]));\r\n        mirrorX(outlet);\r\n        var hoseOutlet = new Path.Rectangle(R(0, 0, 6, 60, Pivot.TOP_CENTER));\r\n        hoseOutlet.rotate(-75, P(0, 10));\r\n        var outletL = outlet.clone();\r\n        outletL.rotate(angle, P(0, 0));\r\n        var outletR = outlet.clone();\r\n        outletR.rotate(-angle, P(0, 0));\r\n        var path = bulb.unite(outlet).unite(outletL).unite(outletR).unite(inlet).unite(hoseOutlet);\r\n        var graphic = breakPathClosed(path, 3, 8, 12, 16, 20);\r\n        setDefaultStyle(graphic);\r\n        graphic.addChild(glassFold(0, -24));\r\n        graphic.addChild(glassFold(0, 44, { rotation: 180 }));\r\n        graphic.addChild(glassFold(24, 35, { rotation: 180 - angle }));\r\n        graphic.addChild(glassFold(-24, 35, { rotation: 180 + angle }));\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: [\r\n                { type: \"connectable\", at: P(0, -60), facing: 0 },\r\n                { type: \"connectable\", at: P(0, 80), facing: 180 },\r\n                { type: \"connectable\", at: P(0, 80).rotate(-angle), facing: 180 - angle },\r\n                { type: \"connectable\", at: P(0, 80).rotate(angle), facing: 180 + angle },\r\n            ]\r\n        };\r\n    };\r\n    CowType.properties = {\r\n        label: \"Cow-type Distillation Receiver\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {},\r\n        appearanceSpecs: [],\r\n    };\r\n    return CowType;\r\n}());\r\nexport { CowType };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { mirrorX, setDefaultStyle } from \"apparatus/draw\";\r\nimport { DEFAULT_LIQUID_DATA, P, Segments } from \"apparatus/library/common\";\r\nimport { Path } from \"paper\";\r\nvar WatchGlass = /** @class */ (function () {\r\n    function WatchGlass() {\r\n    }\r\n    WatchGlass.prototype.render = function (appearance) {\r\n        var radius = appearance.diameter / 2;\r\n        var height = radius / 5;\r\n        var graphic = new Path(Segments([[radius, -height]], [[0, 0], [radius / 1.5, 0]]));\r\n        mirrorX(graphic);\r\n        var liquidMask = graphic.clone();\r\n        setDefaultStyle(graphic);\r\n        return {\r\n            graphic: graphic,\r\n            liquidMask: liquidMask,\r\n            hitShape: graphic.strokeBounds.expand(10).toShape(),\r\n            snapping: {\r\n                type: \"placeable\",\r\n                at: P(0, 2)\r\n            }\r\n        };\r\n    };\r\n    WatchGlass.properties = {\r\n        label: \"Watch glass\",\r\n        canContainLiquids: true,\r\n        defaultLiquidData: __assign(__assign({}, DEFAULT_LIQUID_DATA), { amountRatio: 0.0 }),\r\n        defaultAppearance: {\r\n            diameter: 75,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"diameter\", label: \"Diameter\",\r\n                min: 60, max: 100\r\n            }\r\n        ],\r\n    };\r\n    return WatchGlass;\r\n}());\r\nexport { WatchGlass };\r\n","import { mirrorX, setDefaultStyle } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, Segments } from \"apparatus/library/common\";\r\nimport { Color as PColor, Gradient, Group, Path } from \"paper\";\r\nvar SuctionPear = /** @class */ (function () {\r\n    function SuctionPear() {\r\n    }\r\n    SuctionPear.prototype.render = function (appearance) {\r\n        var fillColor = appearance.color.color();\r\n        var strokeColor = fillColor.ladd(-35);\r\n        var graphic = (function () {\r\n            switch (appearance.type) {\r\n                case \"simple\": return simple;\r\n                case \"3-way\": return threeWay;\r\n            }\r\n        })()(fillColor, strokeColor);\r\n        graphic.scale(appearance.scale);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    SuctionPear.properties = {\r\n        label: \"Suction Pear\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            type: \"simple\",\r\n            color: \"#2243a7\",\r\n            scale: 1.0\r\n        },\r\n        flippable: true,\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.6, max: 1.25, step: 0.01, unit: \"%\"\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"type\", label: \"Type\",\r\n                options: [\r\n                    { value: \"simple\", label: \"Basic\" },\r\n                    { value: \"3-way\", label: \"Three-way\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"color\", label: \"Colour\",\r\n                options: [\r\n                    { value: \"#2243a7\", label: \"Blue\" },\r\n                    { value: \"#9f2529\", label: \"Red\" },\r\n                ],\r\n            },\r\n        ],\r\n    };\r\n    return SuctionPear;\r\n}());\r\nexport { SuctionPear };\r\nfunction simple(fillColor, strokeColor) {\r\n    var graphic = new Path(Segments([[0, 0], [-20, 0], [20, 0]], [[37, 35], [0, -21], [0, 20]], [[20, 67], [5, -7], [-9, 12]], [[11, 112], [1, -22]]));\r\n    mirrorX(graphic);\r\n    graphic.closePath();\r\n    setDefaultStyle(graphic);\r\n    graphic.fillColor = new PColor(new Gradient(Gradients.simple(fillColor, -25), true), P(0, 35), P(0, 0), P(-20, 18));\r\n    graphic.withStroke(\"default\", strokeColor.hex());\r\n    return graphic;\r\n}\r\n// https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcQf3rceGIKp0oaNoFTW-jup1lzBkXEDoozGfA&usqp=CAU\r\nfunction threeWay(fillColor, strokeColor) {\r\n    var main = new Path(Segments([[8, -29], [0, -2]], [[8, -1], , [20, 4]], [[41, 36], [0, -17], [0, 20]], [[16, 75], [11, -5], [0, 12]], [[16, 96]], [[8, 98]], [[8, 155], , [0, 2]]));\r\n    mirrorX(main);\r\n    main.close();\r\n    var side = new Path(Segments([[11, -64]], [[10, -58], [-1, -3], [11, 5]], [[7, -34], [10, -3]], [[7, -7], , [0, 6]]));\r\n    mirrorX(side);\r\n    side.close();\r\n    side.pivot = P(0, 0);\r\n    side.withGradientFill(\"right\", Gradients.cylinder(fillColor, -8));\r\n    side.rotate(-90);\r\n    side.position = P(0, 130);\r\n    var outline = main.unite(side);\r\n    outline.withStroke(\"default\", strokeColor.hex());\r\n    outline.fillColor = null;\r\n    main.fillColor = new PColor(new Gradient(Gradients.simple(fillColor, -25), true), P(0, 35), P(0, 0), P(-20, 18));\r\n    return new Group([main, side, outline]);\r\n}\r\n","import { mirrorX, setDefaultStyleWithStroke } from \"apparatus/draw\";\r\nimport { R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar Dropper = /** @class */ (function () {\r\n    function Dropper() {\r\n    }\r\n    Dropper.prototype.render = function (appearance) {\r\n        var height = appearance.size;\r\n        var width = 8 + height / 15;\r\n        var handle = this.handle();\r\n        setDefaultStyleWithStroke(\"thin\", handle);\r\n        handle.fillColor = \"#555555\";\r\n        handle.closePath();\r\n        var body = this.body(width, height);\r\n        // Center the pipette body.\r\n        body.position.x += handle.bounds.center.x - body.bounds.center.x;\r\n        var liquidMask = body.clone();\r\n        setDefaultStyleWithStroke(\"thin\", body);\r\n        var graphic = new Group([body, handle]);\r\n        var hitShape = Shape.Rectangle(R(0, -handle.bounds.height, handle.bounds.width, graphic.bounds.height));\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShape,\r\n            liquidMask: liquidMask,\r\n            snapping: graphic.placeable(),\r\n        };\r\n    };\r\n    Dropper.prototype.body = function (width, height) {\r\n        var mouthSize = 5;\r\n        var path = new Path(Segments([[width / 2 - mouthSize / 2, height + 12]], [[width / 2 - mouthSize / 2, height + 7]], [[0, height], [0, 7]], [[0, 0]]));\r\n        mirrorX(path, width / 2);\r\n        return path;\r\n    };\r\n    Dropper.prototype.handle = function () {\r\n        var height = 30;\r\n        var width = 20;\r\n        var path = new Path(Segments([[0, 0]], [[0, -5], undefined, [10, -5]], [[width / 2, -height], [-12, 0]]));\r\n        mirrorX(path, width / 2);\r\n        return path;\r\n    };\r\n    Dropper.properties = {\r\n        label: \"Dropper Pipette\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            size: 60\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 30, max: 80\r\n            }\r\n        ],\r\n    };\r\n    return Dropper;\r\n}());\r\nexport { Dropper };\r\n","import { P, Segments } from \"apparatus/library/common\";\r\nimport { Path } from \"paper\";\r\nimport { breakPath, mirrorX, setDefaultStyle } from \"../../draw\";\r\nvar WaterlessCondenser = /** @class */ (function () {\r\n    function WaterlessCondenser() {\r\n    }\r\n    WaterlessCondenser.prototype.render = function (appearance) {\r\n        var outline = new Path(Segments([[7.5, 0]], [[7.5, 30], undefined, [10, 5]], [[16, 50]]));\r\n        for (var i = 0; i < appearance.height; i++) {\r\n            outline.cubicCurveBy(P(8, 0), P(8, 13), P(0, 13));\r\n            outline.cubicCurveBy(P(-3, 0), P(-3, 10), P(0, 10));\r\n        }\r\n        // Remove last segment\r\n        outline.lastSegment.remove();\r\n        var lastY = outline.lastSegment.point.y;\r\n        outline.lastSegment.handleOut = P(0, 7);\r\n        outline.lineTo(P(7.5, lastY + 15));\r\n        outline.lineBy(P(0, 20));\r\n        var maxY = outline.lastSegment.point.y;\r\n        mirrorX(outline);\r\n        var liquidMask = outline.clone();\r\n        var graphic = breakPath(outline, outline.segments.length / 2);\r\n        setDefaultStyle(graphic);\r\n        return {\r\n            graphic: graphic,\r\n            liquidMask: liquidMask,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: [\r\n                { type: \"connectable\", at: P(0, 0), facing: 0 },\r\n                { type: \"connectable\", at: P(0, maxY), facing: 180 },\r\n            ]\r\n        };\r\n    };\r\n    WaterlessCondenser.properties = {\r\n        label: \"Waterless condenser\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            height: 10\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Height\",\r\n                min: 6, max: 12\r\n            }\r\n        ],\r\n    };\r\n    return WaterlessCondenser;\r\n}());\r\nexport { WaterlessCondenser };\r\n","import { breakPath, breakPathClosed, glassFold, setDefaultStyle } from \"apparatus/draw\";\r\nimport { Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { Path } from \"paper\";\r\nvar SoxhletExtractor = /** @class */ (function () {\r\n    function SoxhletExtractor() {\r\n    }\r\n    SoxhletExtractor.prototype.render = function (appearance) {\r\n        var topInlet = new Path(Segments([[-11, -30]], [[11, -30]], [[9, 20]], [[-9, 20]]));\r\n        topInlet.closePath();\r\n        var body = new Path.Rectangle(R(0, -10, 40, 151, Pivot.TOP_CENTER), 15);\r\n        var outerArm = outerArmPath();\r\n        outerArm.closePath();\r\n        var innerArmHalf = armFirstHalfPath();\r\n        innerArmHalf.closePath();\r\n        var joined = body.unite(outerArm).unite(topInlet).unite(innerArmHalf);\r\n        var graphic = breakPathClosed(joined, 5, 14, 28);\r\n        setDefaultStyle(graphic);\r\n        // Insert, at bottom, the rest of the arm. Since the arm\r\n        // overlaps itself, add a small white shape in between.\r\n        var whiteOverlapSheet = armFirstHalfPath();\r\n        whiteOverlapSheet.closePath();\r\n        whiteOverlapSheet.fillColor = \"#ffffff80\";\r\n        graphic.insertChild(0, whiteOverlapSheet);\r\n        var secondArmHalf = breakPath(armSecondHalfPath(), 6);\r\n        setDefaultStyle(secondArmHalf);\r\n        graphic.insertChild(0, secondArmHalf);\r\n        // Add wrinkles.\r\n        graphic.addChild(glassFold(0, -8));\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    SoxhletExtractor.properties = {\r\n        label: \"Soxhlet Extractor\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {},\r\n        appearanceSpecs: [],\r\n    };\r\n    return SoxhletExtractor;\r\n}());\r\nexport { SoxhletExtractor };\r\nfunction outerArmPath() {\r\n    return new Path(Segments([[0, 0], , [10, -10]], [[40, 5], , [7, 0]], [[50, 15]], [[50, 180], , [0, 20]], [[12, 205]], [[12, 215], , [2, 0]], [[8, 240]], // Bottom.\r\n    [[-8, 240]], [[-12, 215], [-2, 0]], [[-12, 140], , [5, 3]], [[12, 140], [-5, 3]], [[15, 158], [0, -4], [0, 4]], [[12, 190], [0, -20], [0, 10]], [[42, 180], [0, 10]], [[42, 20]], [[35, 12], [7, 0]], [[0, 12]]));\r\n}\r\n// function fullArm(): Path {\r\n//     return new Path(Segments(\r\n//         [[15,125]],\r\n//         [[25,136],[-5,5],[5,-5]],\r\n//         [[20, 120],[0,5]],\r\n//         [[20, 55],,[0, -13]],\r\n//         [[36, 55],[0, -13]],\r\n//         [[36, 150],,[0,20]],\r\n//         [[4, 180],[0, -20]],\r\n//         [[4, 230]],\r\n//         [[-4,230]],\r\n//         [[-4,175],,[0, -20]],\r\n//         [[28, 145],[0, 20]],\r\n//         [[28, 55]],\r\n//         [[28, 116],,[0, 10]],\r\n//         [[30,142],[12, -12],[-12,12]],\r\n//         [[6, 130]]\r\n//     ))\r\n// }\r\nfunction armFirstHalfPath() {\r\n    return new Path(Segments([[15, 125]], [[25, 136], [-5, 5], [5, -5]], [[20.1, 120], [0, 5]], [[28, 116], , [0, 10]], [[30, 142], [12, -12], [-12, 12]], [[6, 130]]));\r\n}\r\nfunction armSecondHalfPath() {\r\n    return new Path(Segments([[20, 120], [0, 5]], [[20, 55], , [0, -13]], [[36, 55], [0, -13]], [[36, 150], , [0, 20]], [[4, 180], [0, -20]], [[4, 230]], [[-4, 230]], [[-4, 175], , [0, -20]], [[28, 145], [0, 20]], [[28, 55]], [[28, 116], , [0, 10]]));\r\n}\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { focusMainApp, Keys } from \"keyboard\";\r\nimport * as React from \"react\";\r\nexport var SEARCH_BOX_ID = \"search-box-input\";\r\nvar SearchBox = /** @class */ (function (_super) {\r\n    __extends(SearchBox, _super);\r\n    function SearchBox() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.inputRef = React.createRef();\r\n        _this.state = { value: \"\", focused: false };\r\n        _this.onChange = function (e) {\r\n            var value = e.target.value;\r\n            _this.setState({ value: value });\r\n            if (_this.props.throttleMs) {\r\n                // Reset throttle timer.\r\n                if (_this.interval)\r\n                    clearTimeout(_this.interval);\r\n                _this.interval = setTimeout(function () {\r\n                    _this.props.onChange(value);\r\n                }, _this.props.throttleMs);\r\n            }\r\n            else {\r\n                _this.props.onChange(value);\r\n            }\r\n        };\r\n        _this.isActive = function () { return _this.state.value.length > 0; };\r\n        _this.render = function () {\r\n            var _a;\r\n            return React.createElement(\"div\", { className: \"search-box-container \" + \"active\".if(_this.isActive()) + \" \" + \"focused\".if(_this.state.focused) + \" \" + ((_a = _this.props.className) !== null && _a !== void 0 ? _a : \"\"), key: \"box\" },\r\n                React.createElement(\"i\", { className: \"fa \" + (_this.isActive() ? \"fa-backspace\" : \"fa-search\"), key: \"icon\", onClick: function (_) {\r\n                        if (_this.isActive()) {\r\n                            // Erase field.\r\n                            _this.setState({ value: \"\" });\r\n                            _this.props.onChange(\"\");\r\n                        }\r\n                        _this.inputRef.current.focus();\r\n                    } }),\r\n                React.createElement(\"input\", { key: \"input\", id: SEARCH_BOX_ID, ref: _this.inputRef, value: _this.state.value, title: _this.props.tooltip, onFocus: function (_) { return _this.setState({ focused: true }); }, onChange: _this.onChange, onBlur: function (e) { var _a; _this.setState({ focused: false }); (_a = _this.props.onBlur) === null || _a === void 0 ? void 0 : _a.call(null, e.target.value); }, onKeyUp: function (e) { if (e.keyCode == Keys.ESCAPE)\r\n                        focusMainApp(); }, placeholder: _this.props.placeholder }));\r\n        };\r\n        return _this;\r\n    }\r\n    SearchBox.getDerivedStateFromProps = function (nextProps, state) {\r\n        if (!state.focused) {\r\n            return __assign(__assign({}, state), { value: nextProps.value });\r\n        }\r\n        return state;\r\n    };\r\n    return SearchBox;\r\n}(React.Component));\r\nexport { SearchBox };\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { createApparatus } from \"apparatus/library\";\r\nimport { AddApparatus, Deselect, Select } from \"command/basic\";\r\nimport { commandProcessor, Sequence } from \"command/command\";\r\nimport { Path, Tool } from \"paper\";\r\nimport store from \"store/store\";\r\nvar FreehandTool = /** @class */ (function (_super) {\r\n    __extends(FreehandTool, _super);\r\n    function FreehandTool(app) {\r\n        var _this = _super.call(this) || this;\r\n        _this.app = app;\r\n        _this.onMouseDown = function () {\r\n            var _a;\r\n            _this.app.setIsInteracting(true);\r\n            (_a = _this.path) === null || _a === void 0 ? void 0 : _a.remove();\r\n            _this.path = new Path();\r\n            _this.path.selected = true;\r\n        };\r\n        _this.onMouseDrag = function (event) {\r\n            if (!_this.path)\r\n                return;\r\n            _this.path.add(event.point);\r\n        };\r\n        _this.onMouseUp = function () {\r\n            _this.app.setIsInteracting(false);\r\n            var path = _this.path;\r\n            if (!path)\r\n                return;\r\n            // Clean up the path first.\r\n            path.simplify();\r\n            path.smooth();\r\n            // Convert path points to segments as array.\r\n            var points = [];\r\n            for (var _i = 0, _a = path.segments; _i < _a.length; _i++) {\r\n                var segment = _a[_i];\r\n                var point = [segment.point.x, segment.point.y];\r\n                var handleOut = segment.handleOut.x == 0 && segment.handleOut.y == 0 ? undefined : [segment.handleOut.x, segment.handleOut.y];\r\n                var handleIn = segment.handleIn.x == 0 && segment.handleIn.y == 0 ? undefined : [segment.handleIn.x, segment.handleIn.y];\r\n                if (handleOut) {\r\n                    points.push([point, handleIn, handleOut]);\r\n                }\r\n                else if (handleIn) {\r\n                    points.push([point, handleIn]);\r\n                }\r\n                else {\r\n                    points.push([point]);\r\n                }\r\n            }\r\n            // Find the center of the path.\r\n            var center = path.bounds.center;\r\n            // Apparatus data.\r\n            var apparatusData = createApparatus(\"__freehand\", center);\r\n            apparatusData.appearance[\"points\"] = points;\r\n            commandProcessor.execute(new Sequence([\r\n                new AddApparatus([apparatusData]),\r\n                new Deselect(store.selectedObjectsID()),\r\n                new Select([apparatusData.id])\r\n            ]));\r\n            // Remove path.\r\n            path.remove();\r\n            _this.path = undefined;\r\n        };\r\n        return _this;\r\n    }\r\n    return FreehandTool;\r\n}(Tool));\r\nexport { FreehandTool };\r\n","import { ID } from \"store/id\";\r\nimport store from \"store/store\";\r\n/** Returns the ID of the root group for given item. */\r\nexport function getRootGroup(groupOrId) {\r\n    var group;\r\n    if (isID(groupOrId)) {\r\n        group = store.groups().filter(ID.matching(groupOrId))[0];\r\n        if (!group) {\r\n            console.error(\"Group could not be found!\");\r\n        }\r\n    }\r\n    else {\r\n        group = groupOrId;\r\n    }\r\n    // Iterate up the chain, to the root group.\r\n    while (group.parentGroup) {\r\n        group = store.groups().filter(ID.matching(group.parentGroup))[0];\r\n    }\r\n    return group;\r\n}\r\nfunction isID(arg) {\r\n    return typeof arg.id === \"number\";\r\n}\r\n/**\r\n * Returns IDs of all descendants of a given group, except for\r\n * other groups, which are unpacked.\r\n */\r\nexport function getDescendantIDs(group) {\r\n    var ids = [];\r\n    for (var _i = 0, _a = group.items; _i < _a.length; _i++) {\r\n        var id = _a[_i];\r\n        if (id.type === \"group\") {\r\n            var childGroup = store.groups().filter(ID.matching(id))[0];\r\n            ids.push.apply(ids, getDescendantIDs(childGroup));\r\n        }\r\n        else {\r\n            ids.push(id);\r\n        }\r\n    }\r\n    return ids;\r\n}\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { g } from \"analytics\";\r\nimport { UpdateAppearance, UpdateItemsAppearance } from \"command/basic\";\r\nimport { commandProcessor } from \"command/command\";\r\nimport { convertDemoSwatchesToRadioOptions } from \"panel/shared\";\r\nimport * as React from \"react\";\r\nimport { ChemMark } from \"text/parse\";\r\nimport { crumb } from \"utils\";\r\n/** Sentinel \"indeterminate\" value used for a group of radio buttons. A random string unlikely to be used as an actual value. */\r\nexport var SENTINEL_INDETERMINATE_RADIO = \"@_x/.!\";\r\n/** Text to display as placeholder for text inputs with indeterminate values. */\r\nexport var SENTINEL_TEXT_PLACEHOLDER = \"Multiple values\";\r\nfunction createUpdateCommand(items, key, newValue) {\r\n    if (items.length > 1) {\r\n        var values = items.map(function (i) { return ({ id: i.id, value: newValue, previousValue: i.appearance[key] }); });\r\n        return new UpdateItemsAppearance(key, values);\r\n    }\r\n    else {\r\n        var item = items[0];\r\n        return new UpdateAppearance(item.id, key, newValue, item.appearance[key]);\r\n    }\r\n}\r\nfunction getConsistentValue(items, key) {\r\n    var value = items[0].appearance[key];\r\n    if (items.length == 1)\r\n        return value;\r\n    for (var _i = 0, items_1 = items; _i < items_1.length; _i++) {\r\n        var item = items_1[_i];\r\n        if (item.appearance[key] !== value)\r\n            return;\r\n    }\r\n    return value;\r\n}\r\nexport function convertAppearanceSpecs(specs, item, items, app, tiers) {\r\n    return specs.filter(function (spec) { return (spec.visible || (function (a) { return true; }))(item.appearance); }) // Filter out specs set to invisible, if visibility fn is defined.\r\n        .map(function (spec) {\r\n        var _a, _b;\r\n        switch (spec.spec) {\r\n            case \"slider\":\r\n                // Create a slider.\r\n                // Sliders are not reusable and so need a unique key.\r\n                return __assign(__assign({}, spec), { spec: \"slider\", key: item.type + \".\" + spec.key, initialValue: item.appearance[spec.key], onStart: function () { app.setIsInteracting(true); }, onChange: function (value) {\r\n                        var _a;\r\n                        for (var _i = 0, items_2 = items; _i < items_2.length; _i++) {\r\n                            var item_1 = items_2[_i];\r\n                            (_a = app.getApparatusComponent(item_1.id)) === null || _a === void 0 ? void 0 : _a.updateAppearanceAttributes(spec.key, value);\r\n                        }\r\n                    }, onEnd: function (_, final) {\r\n                        app.setIsInteracting(false);\r\n                        g(\"UpdateAppearance\", item.type + \"::\" + spec.key);\r\n                        crumb(\"ui.props\", item.type + \": \" + spec.key + \" -> \" + final);\r\n                        commandProcessor.execute(createUpdateCommand(items, spec.key, final));\r\n                    } });\r\n            case \"radio\": {\r\n                // Create a group of radio buttons.\r\n                var currentValue_1 = (_a = getConsistentValue(items, spec.key)) !== null && _a !== void 0 ? _a : SENTINEL_INDETERMINATE_RADIO;\r\n                return __assign(__assign({}, spec), { id: spec.key, value: currentValue_1, onChange: function (_, final) {\r\n                        g(\"UpdateAppearance\", item.type + \"::\" + spec.key);\r\n                        crumb(\"ui.props\", item.type + \": \" + spec.key + \" -> \" + final);\r\n                        commandProcessor.execute(createUpdateCommand(items, spec.key, final));\r\n                    } });\r\n            }\r\n            case \"select\":\r\n                // Create a group of radio buttons.\r\n                return __assign(__assign({}, spec), { id: spec.key, value: item.appearance[spec.key], onSelectChange: function (_, final) {\r\n                        crumb(\"ui.props\", item.type + \": \" + spec.key + \" -> \" + final);\r\n                        commandProcessor.execute(createUpdateCommand(items, spec.key, final));\r\n                    } });\r\n            case \"toggle-buttons\": {\r\n                // Identify the highlight index.\r\n                var currentValue_2 = getConsistentValue(items, spec.key);\r\n                var highlightIndex = -1;\r\n                if (currentValue_2 !== undefined) {\r\n                    for (var i = 0; i < spec.options.length; i++) {\r\n                        if (spec.options[i].value == currentValue_2) {\r\n                            highlightIndex = i;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                return {\r\n                    spec: \"toggle-horizontal-buttons\",\r\n                    id: spec.key,\r\n                    key: item.id.id + \"_\" + spec.key,\r\n                    label: spec.label,\r\n                    highlightIndex: highlightIndex,\r\n                    size: spec.size,\r\n                    buttons: spec.options.map(function (o) { return ({\r\n                        icon: o.icon,\r\n                        buttonLabel: o.label,\r\n                        onClick: function () {\r\n                            crumb(\"ui.props\", item.type + \": \" + spec.key + \" -> \" + o.value);\r\n                            commandProcessor.execute(createUpdateCommand(items, spec.key, o.value));\r\n                        }\r\n                    }); })\r\n                };\r\n            }\r\n            case \"text\": {\r\n                var currentValue_3 = getConsistentValue(items, spec.key);\r\n                return __assign(__assign({}, spec), { key: item.id.id + \"_\" + spec.key + \"_\" + currentValue_3, spec: \"text\", id: spec.key, text: currentValue_3 !== null && currentValue_3 !== void 0 ? currentValue_3 : \"\", placeholder: SENTINEL_TEXT_PLACEHOLDER.if(currentValue_3 === undefined), onFocus: function () { app.setIsInteracting(true); }, onChange: function (value) {\r\n                        var _a;\r\n                        for (var _i = 0, items_3 = items; _i < items_3.length; _i++) {\r\n                            var item_2 = items_3[_i];\r\n                            (_a = app.getApparatusComponent(item_2.id)) === null || _a === void 0 ? void 0 : _a.updateAppearanceAttributes(spec.key, value);\r\n                        }\r\n                    }, onEnd: function (previous, final) {\r\n                        app.setIsInteracting(false);\r\n                        if (previous == final)\r\n                            return;\r\n                        g(\"UpdateAppearance\", item.type + \"::\" + spec.key);\r\n                        crumb(\"ui.props\", item.type + \": \" + spec.key + \" -> \" + final);\r\n                        commandProcessor.execute(createUpdateCommand(items, spec.key, final));\r\n                    } });\r\n            }\r\n            case \"textarea\":\r\n                var currentValue = getConsistentValue(items, spec.key);\r\n                return __assign(__assign({}, spec), { key: item.id.id + \"_\" + spec.key + \"_\" + currentValue, spec: \"textarea\", id: spec.key, text: currentValue !== null && currentValue !== void 0 ? currentValue : \"\", placeholder: SENTINEL_TEXT_PLACEHOLDER.if(currentValue === undefined), onFocus: function () { app.setIsInteracting(true); }, onChange: function (value) {\r\n                        var _a;\r\n                        for (var _i = 0, items_4 = items; _i < items_4.length; _i++) {\r\n                            var item_3 = items_4[_i];\r\n                            (_a = app.getApparatusComponent(item_3.id)) === null || _a === void 0 ? void 0 : _a.updateAppearanceAttributes(spec.key, value);\r\n                        }\r\n                    }, onEnd: function (previous, final) {\r\n                        app.setIsInteracting(false);\r\n                        if (previous == final)\r\n                            return;\r\n                        g(\"UpdateAppearance\", item.type + \"::\" + spec.key);\r\n                        crumb(\"ui.props\", item.type + \": \" + spec.key + \" -> \" + final);\r\n                        commandProcessor.execute(createUpdateCommand(items, spec.key, final));\r\n                    } });\r\n            case \"color\":\r\n                var startColor_1 = item.appearance[spec.key];\r\n                // Depending on whether this is supported or not on the\r\n                // current plan, return either a full color picker\r\n                // or a limited radio list from demo swatches.\r\n                if (!tiers.allow(spec) && spec.demoSwatches) {\r\n                    // Return a limited set of choices as radios.\r\n                    return {\r\n                        spec: \"radio\",\r\n                        id: spec.key,\r\n                        key: spec.key,\r\n                        label: spec.label,\r\n                        visible: spec.visible,\r\n                        options: convertDemoSwatchesToRadioOptions(spec.demoSwatches),\r\n                        value: startColor_1,\r\n                        onChange: function (_, final) {\r\n                            crumb(\"ui.props\", item.type + \": \" + spec.key + \" -> \" + final);\r\n                            commandProcessor.execute(createUpdateCommand(items, spec.key, final));\r\n                        }\r\n                    };\r\n                }\r\n                // Return a normal color picker.\r\n                return __assign(__assign({}, spec), { id: spec.key, \r\n                    // Colorpicker needs a unique key per instance.\r\n                    key: spec.key + \"_\" + item.id.id, value: startColor_1, onColorChange: function (value) {\r\n                        var _a;\r\n                        for (var _i = 0, items_5 = items; _i < items_5.length; _i++) {\r\n                            var item_4 = items_5[_i];\r\n                            // TODO: Fix this bug where component may be null\r\n                            (_a = app.getApparatusComponent(item_4.id)) === null || _a === void 0 ? void 0 : _a.updateAppearanceAttributes(spec.key, value);\r\n                        }\r\n                    }, onColorEnd: function (final) {\r\n                        if (final == startColor_1)\r\n                            return;\r\n                        g(\"UpdateAppearance\", item.type + \"::\" + spec.key);\r\n                        crumb(\"ui.props\", item.type + \": \" + spec.key + \" -> \" + final);\r\n                        commandProcessor.execute(createUpdateCommand(items, spec.key, final));\r\n                    }, opacity: spec.opacity\r\n                        ? opacitySettingsForColorpicker(items, app, spec.opacity)\r\n                        : undefined });\r\n            case \"checkbox\":\r\n                /** Convert to a checkbox-group with 1 check box. */\r\n                var cg = {\r\n                    spec: \"checkbox-group\",\r\n                    label: spec.label,\r\n                    key: spec.key,\r\n                    checkboxes: [\r\n                        __assign(__assign({}, spec), { id: spec.key, label: (_b = spec.subLabel) !== null && _b !== void 0 ? _b : \"\", value: getConsistentValue(items, spec.key), onCheckedChange: function (newValue) {\r\n                                g(\"UpdateAppearance\", item.type + \"::\" + spec.key);\r\n                                crumb(\"ui.props\", item.type + \": \" + spec.key + \" -> \" + newValue);\r\n                                commandProcessor.execute(createUpdateCommand(items, spec.key, newValue));\r\n                            } }),\r\n                    ]\r\n                };\r\n                return cg;\r\n            case \"checkbox-group\":\r\n                return __assign(__assign({}, spec), { key: spec.label, checkboxes: spec.checkboxes\r\n                        .filter(function (cSpec) { var _a; return ((_a = cSpec.visible) !== null && _a !== void 0 ? _a : (function (a) { return true; }))(item.appearance); })\r\n                        .map(function (cSpec) { return (__assign(__assign({}, cSpec), { id: cSpec.key, value: getConsistentValue(items, cSpec.key), onCheckedChange: function (newValue) {\r\n                            g(\"UpdateAppearance\", item.type + \"::\" + cSpec.key);\r\n                            crumb(\"ui.props\", item.type + \": \" + cSpec.key + \" -> \" + newValue);\r\n                            commandProcessor.execute(createUpdateCommand(items, cSpec.key, newValue));\r\n                        } })); }) });\r\n            case \"header\":\r\n                return __assign({ key: \"__fakeKey\", label: \"\" }, spec);\r\n            case \"array\":\r\n                return {\r\n                    spec: \"text\",\r\n                    id: spec.key,\r\n                    key: spec.key,\r\n                    label: \"Hello\",\r\n                    text: \"NOT WORKING\",\r\n                    onChange: function (value) {\r\n                    },\r\n                    onEnd: function (previous, final) {\r\n                    }\r\n                };\r\n        }\r\n    });\r\n}\r\nfunction opacitySettingsForColorpicker(items, app, spec) {\r\n    return {\r\n        value: items[0].appearance[spec.key],\r\n        range: spec.range,\r\n        onChange: function (value) {\r\n            var _a;\r\n            for (var _i = 0, items_6 = items; _i < items_6.length; _i++) {\r\n                var item = items_6[_i];\r\n                (_a = app.getApparatusComponent(item.id)) === null || _a === void 0 ? void 0 : _a.updateAppearanceAttributes(spec.key, value);\r\n            }\r\n        },\r\n        onEnd: function (_, final) {\r\n            g(\"UpdateAppearance\", items[0].type + \"::\" + spec.key);\r\n            commandProcessor.execute(createUpdateCommand(items, spec.key, final));\r\n        }\r\n    };\r\n}\r\nexport function chemMarkPropsSection(items, key) {\r\n    return {\r\n        header: \"ChemText\",\r\n        icon: \"subscript\",\r\n        elements: [\r\n            {\r\n                spec: \"checkbox-group\",\r\n                key: \"is_chem_mark_enabled\",\r\n                label: ChemMark.uiDescription,\r\n                wideLabel: true,\r\n                checkboxes: [{\r\n                        label: \"\",\r\n                        useSwitch: true,\r\n                        id: \"is_chem_mark_enabled\",\r\n                        value: items[0].appearance[key],\r\n                        tier: \"boost\",\r\n                        allowWhenLocked: true,\r\n                        onCheckedChange: function (value) {\r\n                            g(\"UpdateAppearance\", items[0].type + \"::ChemMark\");\r\n                            commandProcessor.execute(createUpdateCommand(items, key, value));\r\n                        }\r\n                    }],\r\n            },\r\n            React.createElement(ChemMark.Hint, { key: \"chemmark_hint\", showUpgradeHint: items[0].appearance[key] })\r\n        ]\r\n    };\r\n}\r\n","import { LIQUID_OPACITY_RANGE, P, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { DEFAULT_SWATCHES } from \"components/colorpicker\";\r\nimport { Group, Path } from \"paper\";\r\nvar Drop = /** @class */ (function () {\r\n    function Drop() {\r\n    }\r\n    Drop.prototype.render = function (appearance) {\r\n        var shape = appearance.shape;\r\n        var dropShape = (function () {\r\n            switch (shape) {\r\n                case \"drop\":\r\n                    var plumpness = appearance.plumpness;\r\n                    var path = new Path(Segments([[0, 0], [-plumpness, 4], [plumpness, 4]], [[0, 10], [plumpness, 0], [-plumpness, 0]]));\r\n                    path.closePath();\r\n                    return path;\r\n                case \"round\":\r\n                    return new Path.Circle(P(0, 0), 5);\r\n            }\r\n        })();\r\n        dropShape.scale(appearance.size);\r\n        dropShape.fillColor = appearance.color.color().alpha(appearance.opacity).toString();\r\n        dropShape.withStroke(\"thinner\", appearance.color);\r\n        var graphic;\r\n        if (appearance.count > 1) {\r\n            graphic = new Group([dropShape]);\r\n            dropShape.position.y = 0;\r\n            for (var i = 1; i < appearance.count; i++) {\r\n                var drop = dropShape.clone();\r\n                drop.position.y = i * (10 + appearance.dropSpacing) * appearance.size;\r\n                graphic.addChild(drop);\r\n            }\r\n        }\r\n        else {\r\n            graphic = dropShape;\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.expand(20).toShape(),\r\n            snapping: appearance.shape == \"round\"\r\n                ? { type: \"spotting_tile_placeable\", at: P(0, 0) }\r\n                : undefined\r\n        };\r\n    };\r\n    Drop.properties = {\r\n        label: \"Drop\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            color: SharedColors.defaultLiquid,\r\n            opacity: SharedColors.defaultLiquidAlpha,\r\n            size: 2,\r\n            shape: \"drop\",\r\n            plumpness: 5.0,\r\n            count: 1,\r\n            dropSpacing: 5,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 1.5, max: 4, step: 0.1\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"shape\", label: \"Shape\",\r\n                options: [\r\n                    { value: \"drop\", label: \"Drop\" },\r\n                    { value: \"round\", label: \"Round\" },\r\n                ]\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"count\", label: \"Number of drops\",\r\n                min: 1, max: 5, tier: \"boost\",\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"dropSpacing\", label: \"Drop spacing\",\r\n                min: 1, max: 15,\r\n                visible: function (a) { return a.count > 1; },\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"plumpness\", label: \"Plumpness\",\r\n                min: 3.0, max: 6.0, step: 0.1,\r\n                visible: function (a) { return a.shape == \"drop\"; }\r\n            },\r\n            {\r\n                spec: \"color\", key: \"color\", label: \"Liquid colour\",\r\n                swatches: DEFAULT_SWATCHES,\r\n                opacity: { key: \"opacity\", range: LIQUID_OPACITY_RANGE }\r\n            }\r\n        ],\r\n    };\r\n    return Drop;\r\n}());\r\nexport { Drop };\r\n","/**\r\n * Everything that has to do with saving and loading a ChemixDocument.\r\n */\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { apparatusClass } from \"apparatus/library\";\r\nimport { DEFAULT_LIQUID_DATA } from \"apparatus/library/common\";\r\nimport { Arrow } from \"arrows/type\";\r\nimport { CURRENT_CHEMIX_DOCUMENT_VERSION } from \"file/type\";\r\nimport { ID } from \"store/id\";\r\nimport { appStore, DEFAULT_THEME } from \"store/store\";\r\nexport function convertItem(item) {\r\n    var klass = apparatusClass(item.type);\r\n    if (klass.convertToLatest) {\r\n        item.appearance = klass.convertToLatest(item.appearance);\r\n    }\r\n    else {\r\n        item.appearance = __assign(__assign({}, klass.properties.defaultAppearance), item.appearance);\r\n    }\r\n    if (item.liquid) {\r\n        item.liquid = __assign(__assign({}, DEFAULT_LIQUID_DATA), item.liquid);\r\n    }\r\n    return item;\r\n}\r\nexport function convertArrow(arrow) {\r\n    // Fix bugs:\r\n    //  1) Iterate over arrows to check start and end are {x,y}\r\n    //     instead of the serialised Point object.\r\n    return __assign(__assign(__assign({}, Arrow.defaultArrow), arrow), { start: ensurePosition(arrow.start), end: ensurePosition(arrow.end) });\r\n}\r\nexport var ChemixDocuments;\r\n(function (ChemixDocuments) {\r\n    /**\r\n     * Converts stored (in JSON) document to ChemixDocument, matching\r\n     * latest specs.\r\n     */\r\n    function parseJson(data) {\r\n        var doc = JSON.parse(data);\r\n        doc.arrows = doc.arrows.map(convertArrow);\r\n        doc.items = doc.items.map(convertItem);\r\n        // Run migrations.\r\n        if (!doc.version || doc.version == 1) {\r\n            doc = migrateFrom1To2(doc);\r\n        }\r\n        if (doc.version == 2) {\r\n            doc = migrateFrom2To3(doc);\r\n        }\r\n        // Make sure same IDs use the same reference.\r\n        graftIds(doc);\r\n        doc.version = CURRENT_CHEMIX_DOCUMENT_VERSION;\r\n        return doc;\r\n    }\r\n    ChemixDocuments.parseJson = parseJson;\r\n    /**\r\n     * Extract current saveable state as JSON. Note this does not\r\n     * return deep copies so conversion to JSON immediately is advised.\r\n     */\r\n    function getCurrentDocument() {\r\n        var currentState = appStore.getState();\r\n        return {\r\n            version: CURRENT_CHEMIX_DOCUMENT_VERSION,\r\n            zoom: currentState.zoom,\r\n            items: currentState.items,\r\n            arrows: currentState.arrows,\r\n            groups: currentState.groups,\r\n            theme: currentState.theme,\r\n        };\r\n    }\r\n    ChemixDocuments.getCurrentDocument = getCurrentDocument;\r\n    /** Returns a blank document, based on the current settings. */\r\n    function getBlankDocument() {\r\n        return __assign(__assign({}, getCurrentDocument()), { items: [], arrows: [], groups: [] });\r\n    }\r\n    ChemixDocuments.getBlankDocument = getBlankDocument;\r\n})(ChemixDocuments || (ChemixDocuments = {}));\r\nfunction migrateFrom1To2(doc) {\r\n    doc.version = 2;\r\n    doc.groups = [];\r\n    return doc;\r\n}\r\nfunction migrateFrom2To3(doc) {\r\n    doc.version = 3;\r\n    doc.theme = __assign({}, DEFAULT_THEME);\r\n    return doc;\r\n}\r\n/** Converts definitely to plain Position */\r\nfunction ensurePosition(position) {\r\n    return Array.isArray(position) && position[0] === \"Point\" ? { x: position[1], y: position[2] } : position;\r\n}\r\n/**\r\n * IDs rely on object equality. Loading from JSON creates new instances of IDs,\r\n * so object equality would be broken. Re-graft referenced IDs to same instance\r\n * as the owned ID.\r\n */\r\nfunction graftIds(doc) {\r\n    // Collect all owned IDs.\r\n    var ownedIds = {\r\n        \"arrow\": {},\r\n        \"apparatus\": {},\r\n        \"group\": {}\r\n    };\r\n    doc.items.forEach(function (i) { return ownedIds[\"apparatus\"][i.id.id] = i.id; });\r\n    doc.arrows.forEach(function (i) { return ownedIds[\"arrow\"][i.id.id] = i.id; });\r\n    doc.groups.forEach(function (i) { return ownedIds[\"group\"][i.id.id] = i.id; });\r\n    // Now regraft each reference ID to the owned instance.\r\n    doc.items.forEach(function (i) {\r\n        if (i.parentGroup) {\r\n            i.parentGroup = ownedIds.group[i.parentGroup.id];\r\n        }\r\n    });\r\n    doc.arrows.forEach(function (a) {\r\n        if (a.parentGroup) {\r\n            a.parentGroup = ownedIds.group[a.parentGroup.id];\r\n        }\r\n    });\r\n    doc.groups.forEach(function (g) {\r\n        if (g.parentGroup) {\r\n            g.parentGroup = ownedIds.group[g.parentGroup.id];\r\n        }\r\n        g.items =\r\n            g.items\r\n                // Filter out null and undefined values.\r\n                .filter(function (i) { return i != null; })\r\n                .map(function (i) { return ownedIds[i.type][i.id]; })\r\n                // Filter afterwards too, some groups may be broken\r\n                // and contain invalid children.\r\n                .filter(function (i) { return i != null; });\r\n    });\r\n    // SINGLE CHILD COLLAPSE:\r\n    // If the group only has 1 child, collapse it: if the group has a child, reparent\r\n    // it to its parents.\r\n    doc.groups.filter(function (g) { return g.items.length == 1; }).forEach(function (g) {\r\n        var childId = g.items[0];\r\n        var newParentId = g.parentGroup;\r\n        // Assign child to parent.\r\n        if (newParentId) {\r\n            var parentGroup = doc.groups.filter(ID.matching(newParentId))[0];\r\n            parentGroup.items = parentGroup.items.map(function (id) { return id == g.id ? childId : id; });\r\n        }\r\n        // Assign parent to child.\r\n        var child = getChildIn(doc, childId);\r\n        child.parentGroup = newParentId;\r\n    });\r\n    // Don't keep empty groups or groups with 1 child.\r\n    doc.groups = doc.groups.filter(function (g) { return g.items.length > 1; });\r\n}\r\nfunction getChildIn(doc, childId) {\r\n    switch (childId.type) {\r\n        case \"apparatus\":\r\n            return doc.items.filter(ID.matching(childId))[0];\r\n        case \"arrow\":\r\n            return doc.arrows.filter(ID.matching(childId))[0];\r\n        case \"group\":\r\n            return doc.groups.filter(ID.matching(childId))[0];\r\n    }\r\n}\r\n","import { strokeWidth } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, Segments } from \"apparatus/library/common\";\r\nimport { hsl } from \"color\";\r\nimport \"ext/color\";\r\nimport { Group, Path } from \"paper\";\r\nexport var DEFAULT_COLOR = hsl(124, 57, 40).hex();\r\nvar Leaf = /** @class */ (function () {\r\n    function Leaf() {\r\n    }\r\n    Leaf.prototype.render = function (appearance) {\r\n        var graphic = Leaf.createLeaf(appearance.color, appearance.length);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    Leaf.createLeaf = function (baseColor, length) {\r\n        var outlineColor = baseColor.color().ladd(-20).hex();\r\n        var leaf = new Path(Segments([[0, 0], [20, -20], [20, 30]], [[60, 0], , [-30, -20]]));\r\n        leaf.closePath();\r\n        leaf.withStroke(strokeWidth(\"default\"), outlineColor);\r\n        leaf.setGradientFill(\"down\", Gradients.simple(baseColor.color()));\r\n        var stem = new Path(Segments([[-15, -15]], [[0, 0], [-5, -2], [15, 6]], [[length, 0]]));\r\n        stem.withStroke(strokeWidth(\"default\"), outlineColor);\r\n        leaf.scale(length / 60, P(0, 0));\r\n        return new Group([leaf, stem]);\r\n    };\r\n    Leaf.properties = {\r\n        label: \"Leaf\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            color: DEFAULT_COLOR,\r\n            length: 60,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"color\", key: \"color\", label: \"Colour\",\r\n                swatches: {\r\n                    \"Green\": DEFAULT_COLOR,\r\n                    \"Yellow\": \"#f3f338\",\r\n                },\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"length\", label: \"Length\",\r\n                min: 40, max: 120, unit: \"mm\",\r\n            }\r\n        ],\r\n    };\r\n    return Leaf;\r\n}());\r\nexport { Leaf };\r\n","import { LazyRaster } from \"apparatus/draw\";\r\nimport { Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar Smoke = /** @class */ (function () {\r\n    function Smoke() {\r\n        this.smokeLazyRaster = new LazyRaster(\"./images/smoke.png\");\r\n        this.vapourLazyRaster = new LazyRaster(\"./images/vapour.png\");\r\n    }\r\n    Smoke.prototype.render = function (appearance) {\r\n        switch (appearance.style) {\r\n            case \"trails\": return this.renderTrails(appearance);\r\n            case \"smoke-real\": return this.renderSmokeReal(appearance);\r\n            case \"vapour-real\": return this.renderVapourReal(appearance);\r\n        }\r\n    };\r\n    Smoke.prototype.renderTrails = function (appearance) {\r\n        var baseColor = (appearance.color === \"default\" ? \"#444444\" : appearance.customColor).color();\r\n        var darkerColor = baseColor.ladd(-7);\r\n        var trail1 = new Path(Segments([[1, 3], [14, -37], [26, -19]], [[-8, -124], [-2, 47], [-11, 44]])).withGradientFill(\"up\", [[baseColor.alpha(0.2 * appearance.alpha).string(), 0.3], [baseColor.alpha(0).string(), 1.0]]).close();\r\n        var trail2 = new Path(Segments([[1, 2], [-15, -36], [-7, -32]], [[-1, -157], [51, 47], [44, 61]])).withGradientFill(\"up\", [[darkerColor.alpha(0.2 * appearance.alpha).string(), 0.3], [darkerColor.alpha(0).string(), 1.0]]).close();\r\n        var trail3 = new Path(Segments([[3, 4], [31, -38], [37, -26]], [[9, -97], [-6, 27], [-16, 25]])).withGradientFill(\"up\", [[baseColor.alpha(0.3 * appearance.alpha).string(), 0.3], [baseColor.alpha(0).string(), 1.0]]).close();\r\n        var graphic = new Group([trail1, trail2, trail3]);\r\n        graphic.scale(appearance.size * 0.5 + 0.5, appearance.size);\r\n        graphic.opacity = appearance.alpha;\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    Smoke.prototype.renderSmokeReal = function (appearance) {\r\n        var prescale = 0.7;\r\n        // Size of the image must be known ahead of time to set the hit shape.\r\n        var graphic = new Group([]);\r\n        this.smokeLazyRaster.clone(function (raster) {\r\n            raster.scale(prescale * appearance.size);\r\n            raster.opacity = appearance.alpha;\r\n            graphic.addChild(raster);\r\n            if (appearance.color === \"custom\") {\r\n                var filter = Shape.Rectangle(R(0, 0, 95, 250, Pivot.CENTER));\r\n                filter.scale(prescale * appearance.size);\r\n                filter.fillColor = appearance.customColor;\r\n                filter.blendMode = \"source-atop\";\r\n                graphic.addChild(filter);\r\n                var rasterised = graphic.rasterize();\r\n                graphic.removeChildren();\r\n                graphic.addChild(rasterised);\r\n            }\r\n        });\r\n        var hitShape = Shape.Rectangle(R(0, 0, 95, 250, Pivot.CENTER));\r\n        hitShape.scale(prescale * appearance.size);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShape,\r\n        };\r\n    };\r\n    Smoke.prototype.renderVapourReal = function (appearance) {\r\n        var prescale = 0.7;\r\n        // Size of the image must be known ahead of time to set the hit shape.\r\n        var graphic = new Group([]);\r\n        this.vapourLazyRaster.clone(function (raster) {\r\n            raster.scale(prescale * appearance.size);\r\n            raster.opacity = appearance.alpha;\r\n            graphic.addChild(raster);\r\n            if (appearance.color === \"custom\") {\r\n                var filter = Shape.Rectangle(R(0, 0, 95, 250, Pivot.CENTER));\r\n                filter.scale(prescale * appearance.size);\r\n                filter.fillColor = appearance.customColor;\r\n                filter.blendMode = \"source-atop\";\r\n                graphic.addChild(filter);\r\n                var rasterised = graphic.rasterize();\r\n                graphic.removeChildren();\r\n                graphic.addChild(rasterised);\r\n            }\r\n        });\r\n        var hitShape = Shape.Rectangle(R(0, 0, 95, 250, Pivot.CENTER));\r\n        hitShape.scale(prescale * appearance.size);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShape,\r\n        };\r\n    };\r\n    Smoke.properties = {\r\n        label: \"Smoke\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            size: 1.0,\r\n            style: \"trails\",\r\n            alpha: 1.0,\r\n            color: \"default\",\r\n            customColor: \"#e13232\",\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"style\", label: \"Style\",\r\n                options: [\r\n                    { value: \"trails\", label: \"Trails\" },\r\n                    { value: \"smoke-real\", label: \"Smoke\" },\r\n                    { value: \"vapour-real\", label: \"Vapour\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 0.5, max: 1.5, step: 0.01, unit: \"%\",\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"alpha\", label: \"Opacity\",\r\n                min: 0.25, max: 1.0, step: 0.01, unit: \"%\"\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"color\", label: \"Color\",\r\n                options: [\r\n                    { value: \"default\", label: \"Default\" },\r\n                    { value: \"custom\", label: \"Custom\", tier: \"boost\" },\r\n                ],\r\n            },\r\n            { spec: \"color\", key: \"customColor\", label: \"\", visible: function (a) { return a.color === \"custom\"; } }\r\n        ],\r\n    };\r\n    return Smoke;\r\n}());\r\nexport { Smoke };\r\nexport var smokeTwirl = [\r\n    [[0, 0], [-25, -5], [32, -5]],\r\n    [[51, 17], [114, -7], [-9, 4]],\r\n    [[8, 27], [-1, -8], [2, 8]],\r\n    [[48, 31], [-6, -4], [10, 7]],\r\n    [[17, 41], [1, -4], [-5, 10]],\r\n    [[42, 57], [9, -15], [-15, 25]],\r\n    [[32, 137]]\r\n];\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { P } from \"apparatus/library/common\";\r\nimport { BasicShapes } from \"apparatus/library/shapes/common\";\r\nimport { CompoundPath } from \"paper\";\r\nvar Star = /** @class */ (function () {\r\n    function Star() {\r\n        this.drivers = [\r\n            {\r\n                type: \"rectangle\",\r\n                minX: 0, maxX: 0,\r\n                minY: -150, maxY: -8,\r\n                toAppearance: function (p) { return ({\r\n                    radius: -p.y,\r\n                }); },\r\n                fromAppearance: function (a) { return P(0, -a.radius); },\r\n                scale: 1.0,\r\n            }\r\n        ];\r\n    }\r\n    Star.prototype.render = function (appearance) {\r\n        var points = appearance.points;\r\n        var radius = appearance.radius;\r\n        var strideAngle = 360 / points;\r\n        var thickness = appearance.thickness;\r\n        var origin = P(0, 0);\r\n        var outerPoint = P(0, -radius);\r\n        var innerPoint = P(0, -radius * thickness).rotate(strideAngle / 2, origin);\r\n        var graphic = new CompoundPath({});\r\n        graphic.moveTo(outerPoint);\r\n        graphic.lineTo(innerPoint);\r\n        for (var i = 0; i < points - 1; i++) {\r\n            outerPoint = outerPoint.rotate(strideAngle, origin);\r\n            innerPoint = innerPoint.rotate(strideAngle, origin);\r\n            graphic.lineTo(outerPoint);\r\n            graphic.lineTo(innerPoint);\r\n        }\r\n        graphic.closePath();\r\n        BasicShapes.applyStyle(graphic, appearance);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: BasicShapes.bounds(graphic),\r\n            watermark: outerPoint,\r\n        };\r\n    };\r\n    Star.properties = {\r\n        label: \"Star\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: __assign({ radius: 50, thickness: 0.55, points: 5 }, BasicShapes.defaultAppearance),\r\n        appearanceSpecs: __spreadArrays(BasicShapes.specs, [\r\n            BasicShapes.header,\r\n            {\r\n                spec: \"slider\", key: \"points\", label: \"Points\",\r\n                min: 4, max: 8, step: 1,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"radius\", label: \"Radius\",\r\n                min: 8, max: 150\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"thickness\", label: \"Thickness\",\r\n                min: 0.2, max: 0.8, step: 0.05,\r\n            },\r\n        ]),\r\n    };\r\n    return Star;\r\n}());\r\nexport { Star };\r\n","// Basic set of commands.\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { addItems, addItemsAtIndices, addToGroup, removeFromGroup, removeItems, updateAppearance, updateAppearanceProperties, updateItemsAppearance, updateItemsAppearanceProperties } from \"store/actions\";\r\nimport appStore, { GroupsOperationData } from \"store/store\";\r\n/** Changes the selection state of several items. */\r\nvar DeselectAndSelect = /** @class */ (function () {\r\n    function DeselectAndSelect(ids) {\r\n        var _a, _b;\r\n        this.selectIds = (_a = ids.select) !== null && _a !== void 0 ? _a : [];\r\n        this.deselectIds = (_b = ids.deselect) !== null && _b !== void 0 ? _b : [];\r\n    }\r\n    DeselectAndSelect.prototype.execute = function () {\r\n        appStore.dispatchFn(\"SelectDeselect\", DeselectAndSelect.mutator(this.selectIds, this.deselectIds));\r\n    };\r\n    DeselectAndSelect.prototype.undo = function () {\r\n        // Swap select and deselect around.\r\n        appStore.dispatchFn(\"SelectDeselect\", DeselectAndSelect.mutator(this.deselectIds, this.selectIds));\r\n    };\r\n    DeselectAndSelect.mutator = function (select, deselect) {\r\n        return function (state) {\r\n            var newState = __assign({}, state);\r\n            newState.items = state.items.map(function (a) {\r\n                if (select.indexOf(a.id) > -1) {\r\n                    return __assign(__assign({}, a), { selected: true });\r\n                }\r\n                else if (deselect.indexOf(a.id) > -1) {\r\n                    return __assign(__assign({}, a), { selected: false });\r\n                }\r\n                return a;\r\n            });\r\n            newState.arrows = state.arrows.map(function (a) {\r\n                if (select.indexOf(a.id) > -1) {\r\n                    return __assign(__assign({}, a), { selected: true });\r\n                }\r\n                else if (deselect.indexOf(a.id) > -1) {\r\n                    return __assign(__assign({}, a), { selected: false });\r\n                }\r\n                return a;\r\n            });\r\n            return newState;\r\n        };\r\n    };\r\n    return DeselectAndSelect;\r\n}());\r\nexport { DeselectAndSelect };\r\n// Changes the selection state of apparatus to selected.\r\n// Currently assumes apparatus ID.\r\nvar Select = /** @class */ (function (_super) {\r\n    __extends(Select, _super);\r\n    function Select(ids) {\r\n        return _super.call(this, { select: ids }) || this;\r\n    }\r\n    return Select;\r\n}(DeselectAndSelect));\r\nexport { Select };\r\nvar Deselect = /** @class */ (function (_super) {\r\n    __extends(Deselect, _super);\r\n    function Deselect(ids) {\r\n        return _super.call(this, { deselect: ids }) || this;\r\n    }\r\n    return Deselect;\r\n}(DeselectAndSelect));\r\nexport { Deselect };\r\nvar Flip = /** @class */ (function () {\r\n    function Flip(apparatus, opts) {\r\n        this.apparatus = apparatus;\r\n        this.oldRotation = apparatus.rotation;\r\n        if (opts) {\r\n            this.newRotation = opts.vertical ? 180 - this.oldRotation : -this.oldRotation;\r\n        }\r\n        else {\r\n            this.newRotation = this.oldRotation;\r\n        }\r\n    }\r\n    Flip.prototype.execute = function () {\r\n        var _this = this;\r\n        appStore.dispatchFn(\"Flip\", function (store) { return (__assign(__assign({}, store), { items: store.items.map(function (i) { return i.id == _this.apparatus.id ? __assign(__assign({}, i), { flipped: !_this.apparatus.flipped, rotation: _this.newRotation }) : i; }) })); });\r\n    };\r\n    Flip.prototype.undo = function () {\r\n        var _this = this;\r\n        appStore.dispatchFn(\"Undo-Flip\", function (store) { return (__assign(__assign({}, store), { items: store.items.map(function (i) { return i.id == _this.apparatus.id ? __assign(__assign({}, i), { flipped: _this.apparatus.flipped, rotation: _this.oldRotation }) : i; }) })); });\r\n    };\r\n    return Flip;\r\n}());\r\nexport { Flip };\r\nvar AddApparatus = /** @class */ (function () {\r\n    function AddApparatus(apparatuses) {\r\n        this.apparatuses = apparatuses;\r\n        this.groupInformation = new GroupsOperationData();\r\n        for (var _i = 0, apparatuses_1 = apparatuses; _i < apparatuses_1.length; _i++) {\r\n            var apparatus = apparatuses_1[_i];\r\n            if (apparatus.parentGroup) {\r\n                this.groupInformation.add(apparatus.parentGroup, apparatus.id);\r\n            }\r\n        }\r\n    }\r\n    AddApparatus.prototype.execute = function () {\r\n        if (this.groupInformation.hasData()) {\r\n            appStore.dispatch(addToGroup(this.groupInformation));\r\n        }\r\n        appStore.dispatch(addItems(this.apparatuses));\r\n    };\r\n    AddApparatus.prototype.undo = function () {\r\n        appStore.dispatch(removeItems(this.apparatuses.map(function (a) { return a.id; })));\r\n        if (this.groupInformation.hasData()) {\r\n            appStore.dispatch(removeFromGroup(this.groupInformation));\r\n        }\r\n    };\r\n    return AddApparatus;\r\n}());\r\nexport { AddApparatus };\r\nvar DeleteApparatus = /** @class */ (function () {\r\n    function DeleteApparatus(apparatuses) {\r\n        this.apparatuses = apparatuses;\r\n        this.groupInformation = new GroupsOperationData();\r\n        this.itemsWithIndex = [];\r\n        for (var _i = 0, apparatuses_2 = apparatuses; _i < apparatuses_2.length; _i++) {\r\n            var apparatus = apparatuses_2[_i];\r\n            if (apparatus.parentGroup) {\r\n                this.groupInformation.remove(apparatus.parentGroup, apparatus.id);\r\n            }\r\n            this.itemsWithIndex.push({ item: apparatus, index: appStore.items().indexOf(apparatus) });\r\n        }\r\n    }\r\n    DeleteApparatus.prototype.execute = function () {\r\n        appStore.dispatch(removeItems(this.apparatuses.map(function (a) { return a.id; })));\r\n        if (this.groupInformation.hasData()) {\r\n            appStore.dispatch(removeFromGroup(this.groupInformation));\r\n        }\r\n    };\r\n    DeleteApparatus.prototype.undo = function () {\r\n        // Add the group first. If the item is added first, it will\r\n        // contain group information referring to a group that does\r\n        // not yet exist.\r\n        if (this.groupInformation.hasData()) {\r\n            appStore.dispatch(addToGroup(this.groupInformation));\r\n        }\r\n        appStore.dispatch(addItemsAtIndices(this.itemsWithIndex));\r\n    };\r\n    return DeleteApparatus;\r\n}());\r\nexport { DeleteApparatus };\r\nvar UpdateAppearance = /** @class */ (function () {\r\n    function UpdateAppearance(id, key, value, previousValue) {\r\n        this.id = id;\r\n        this.key = key;\r\n        this.value = value;\r\n        this.previousValue = previousValue;\r\n    }\r\n    UpdateAppearance.prototype.execute = function () {\r\n        appStore.dispatch(updateAppearance(this.id, this.key, this.value));\r\n    };\r\n    UpdateAppearance.prototype.undo = function () {\r\n        appStore.dispatch(updateAppearance(this.id, this.key, this.previousValue));\r\n    };\r\n    return UpdateAppearance;\r\n}());\r\nexport { UpdateAppearance };\r\nvar UpdateItemsAppearance = /** @class */ (function () {\r\n    function UpdateItemsAppearance(key, values) {\r\n        this.key = key;\r\n        this.values = values;\r\n        this.previousValues = values.map(function (v) { return ({ id: v.id, value: v.previousValue }); });\r\n    }\r\n    UpdateItemsAppearance.prototype.execute = function () {\r\n        appStore.dispatch(updateItemsAppearance(this.key, this.values));\r\n    };\r\n    UpdateItemsAppearance.prototype.undo = function () {\r\n        appStore.dispatch(updateItemsAppearance(this.key, this.previousValues));\r\n    };\r\n    return UpdateItemsAppearance;\r\n}());\r\nexport { UpdateItemsAppearance };\r\n/**\r\n * Update multiple appearance properties on one or multiple items of the same type.\r\n * Note that this command only makes shallow copies!\r\n */\r\nvar UpdateAppearanceProperties = /** @class */ (function () {\r\n    function UpdateAppearanceProperties(id_or_ids, newAppearance, previousAppearance) {\r\n        this.id_or_ids = id_or_ids;\r\n        this.newAppearance = __assign({}, newAppearance);\r\n        this.prevAppearance = __assign({}, previousAppearance);\r\n    }\r\n    UpdateAppearanceProperties.prototype.execute = function () {\r\n        if (Array.isArray(this.id_or_ids)) {\r\n            appStore.dispatch(updateItemsAppearanceProperties(this.id_or_ids, this.newAppearance));\r\n        }\r\n        else {\r\n            appStore.dispatch(updateAppearanceProperties(this.id_or_ids, this.newAppearance));\r\n        }\r\n    };\r\n    UpdateAppearanceProperties.prototype.undo = function () {\r\n        if (Array.isArray(this.id_or_ids)) {\r\n            appStore.dispatch(updateItemsAppearanceProperties(this.id_or_ids, this.newAppearance));\r\n        }\r\n        else {\r\n            appStore.dispatch(updateAppearanceProperties(this.id_or_ids, this.prevAppearance));\r\n        }\r\n    };\r\n    return UpdateAppearanceProperties;\r\n}());\r\nexport { UpdateAppearanceProperties };\r\nvar UpdateLiquidAmount = /** @class */ (function () {\r\n    function UpdateLiquidAmount(values) {\r\n        this.valuesMap = {};\r\n        this.previousValuesMap = {};\r\n        for (var _i = 0, values_1 = values; _i < values_1.length; _i++) {\r\n            var value = values_1[_i];\r\n            this.valuesMap[value.id.id] = value.value;\r\n            this.previousValuesMap[value.id.id] = value.previousValue;\r\n        }\r\n    }\r\n    UpdateLiquidAmount.prototype.execute = function () {\r\n        appStore.dispatchFn(\"UpdateLiquid\", this.mutator(this.valuesMap));\r\n    };\r\n    UpdateLiquidAmount.prototype.undo = function () {\r\n        appStore.dispatchFn(\"UpdateLiquid\", this.mutator(this.previousValuesMap));\r\n    };\r\n    UpdateLiquidAmount.prototype.mutator = function (mutations) {\r\n        return (function (store) {\r\n            var newStore = __assign({}, store);\r\n            newStore.items = store.items.map(function (i) { return mutations[i.id.id] !== undefined && i.liquid\r\n                ? __assign(__assign({}, i), { liquid: __assign(__assign({}, i.liquid), { amountRatio: mutations[i.id.id] }) }) : i; });\r\n            return newStore;\r\n        });\r\n    };\r\n    return UpdateLiquidAmount;\r\n}());\r\nexport { UpdateLiquidAmount };\r\nvar UpdateLiquidColor = /** @class */ (function () {\r\n    function UpdateLiquidColor(values) {\r\n        this.valuesMap = {};\r\n        this.previousValuesMap = {};\r\n        for (var _i = 0, values_2 = values; _i < values_2.length; _i++) {\r\n            var value = values_2[_i];\r\n            this.valuesMap[value.id.id] = value.value;\r\n            this.previousValuesMap[value.id.id] = value.previousValue;\r\n        }\r\n    }\r\n    UpdateLiquidColor.prototype.execute = function () {\r\n        appStore.dispatchFn(\"UpdateLiquidColor\", this.mutator(this.valuesMap));\r\n    };\r\n    UpdateLiquidColor.prototype.undo = function () {\r\n        appStore.dispatchFn(\"UpdateLiquidColor\", this.mutator(this.previousValuesMap));\r\n    };\r\n    UpdateLiquidColor.prototype.mutator = function (mutations) {\r\n        return (function (store) {\r\n            var newStore = __assign({}, store);\r\n            newStore.items = store.items.map(function (i) { return mutations[i.id.id] !== undefined && i.liquid\r\n                ? __assign(__assign({}, i), { liquid: __assign(__assign({}, i.liquid), { color: mutations[i.id.id] }) }) : i; });\r\n            return newStore;\r\n        });\r\n    };\r\n    return UpdateLiquidColor;\r\n}());\r\nexport { UpdateLiquidColor };\r\nvar UpdateLiquidAlpha = /** @class */ (function () {\r\n    function UpdateLiquidAlpha(values) {\r\n        this.valuesMap = {};\r\n        this.previousValuesMap = {};\r\n        for (var _i = 0, values_3 = values; _i < values_3.length; _i++) {\r\n            var value = values_3[_i];\r\n            this.valuesMap[value.id.id] = value.value;\r\n            this.previousValuesMap[value.id.id] = value.previousValue;\r\n        }\r\n    }\r\n    UpdateLiquidAlpha.prototype.execute = function () {\r\n        appStore.dispatchFn(\"UpdateLiquidAlpha\", this.mutator(this.valuesMap));\r\n    };\r\n    UpdateLiquidAlpha.prototype.undo = function () {\r\n        appStore.dispatchFn(\"UpdateLiquidAlpha\", this.mutator(this.previousValuesMap));\r\n    };\r\n    UpdateLiquidAlpha.prototype.mutator = function (mutations) {\r\n        return (function (store) {\r\n            var newStore = __assign({}, store);\r\n            newStore.items = store.items.map(function (i) { return mutations[i.id.id] !== undefined && i.liquid\r\n                ? __assign(__assign({}, i), { liquid: __assign(__assign({}, i.liquid), { alpha: mutations[i.id.id] }) }) : i; });\r\n            return newStore;\r\n        });\r\n    };\r\n    return UpdateLiquidAlpha;\r\n}());\r\nexport { UpdateLiquidAlpha };\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { g } from \"analytics\";\r\nimport { P } from \"apparatus/library/common\";\r\nimport { AddArrow } from \"arrows/command\";\r\nimport { Arrow } from \"arrows/type\";\r\nimport { Deselect, Select } from \"command/basic\";\r\nimport { commandProcessor, Sequence } from \"command/command\";\r\nimport { Key, Tool } from \"paper\";\r\nimport { ID } from \"store/id\";\r\nimport store from \"store/store\";\r\nimport { crumb } from \"utils\";\r\n/** Minimum length of the arrow before the arrow is shown. */\r\nvar MIN_DELTA_LENGTH_SHOW_ARROW = 20.0;\r\n/** Arrow offset, from start to end, when no arow is shown.*/\r\nvar NO_ARROW_END_OFFSET = P(0, 15);\r\nvar ArrowTool = /** @class */ (function (_super) {\r\n    __extends(ArrowTool, _super);\r\n    function ArrowTool(layers, app) {\r\n        var _this = _super.call(this) || this;\r\n        /** Template arrow data to use when creating new diagrams. */\r\n        _this.templateArrow = Arrow.defaultArrow;\r\n        _this.onMouseDown = function (event) {\r\n        };\r\n        _this.onMouseDrag = function (event) {\r\n            _this.appInterface.setArrow(_this.createArrow(event, ID.TEMP_ARROW));\r\n        };\r\n        _this.onMouseUp = function (event) {\r\n            crumb(\"ui\", \"Add arrow\");\r\n            g(\"Add arrow\");\r\n            var id = ID.mint(\"arrow\");\r\n            var newArrowCommand = new AddArrow([_this.createArrow(event, id)]);\r\n            commandProcessor.execute(new Sequence([\r\n                newArrowCommand,\r\n                new Deselect(store.selectedObjectsID()),\r\n                new Select([id]),\r\n            ]));\r\n            // Clean up temporary arrow.\r\n            _this.appInterface.setArrow();\r\n        };\r\n        _this.appInterface = app;\r\n        return _this;\r\n    }\r\n    ArrowTool.prototype.createArrow = function (event, id) {\r\n        var deltaVector = event.point.subtract(event.downPoint);\r\n        // Checks if arrow is too short.\r\n        var showArrow = deltaVector.length > MIN_DELTA_LENGTH_SHOW_ARROW;\r\n        // Calculates angle of arrow.\r\n        var angle = deltaVector.angle; //Calculates angle of arrow\r\n        if (Key.modifiers.shift) {\r\n            // Snaps arrow to multiples of 45 degrees.\r\n            var roundedAngle = ((angle / 45).round()) * 45;\r\n            deltaVector.angle = roundedAngle;\r\n            event.point = event.downPoint.add(deltaVector);\r\n        }\r\n        return __assign(__assign({}, this.templateArrow), { id: id, start: event.downPoint, end: showArrow ? event.point : event.downPoint.add(NO_ARROW_END_OFFSET), showArrow: showArrow, selected: false });\r\n    };\r\n    ArrowTool.prototype.updateTemplateArrow = function (data) {\r\n        this.templateArrow = __assign(__assign({}, this.templateArrow), data);\r\n    };\r\n    return ArrowTool;\r\n}(Tool));\r\nexport default ArrowTool;\r\n","var __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n/**\r\n * Returns a shallow copy of the input, with applied reorderings.\r\n * Both \"from\" and \"to\" arguments MUST be in increasing order.\r\n */\r\nexport function reorder(input, from, to) {\r\n    var copy = __spreadArrays(input);\r\n    var toMove = [];\r\n    for (var i = 0; i < from.length; i++) {\r\n        toMove[i] = copy.splice(from[i] - i, 1)[0];\r\n    }\r\n    for (var i = 0; i < from.length; i++) {\r\n        copy.splice(to[i], 0, toMove[i]);\r\n    }\r\n    return copy;\r\n}\r\nexport function createSendToBackIndices(indices) {\r\n    var c = [];\r\n    for (var i = 0; i < indices.length; i++) {\r\n        c[i] = i;\r\n    }\r\n    return c;\r\n}\r\nexport function createMoveToFrontIndices(indices, length) {\r\n    var c = [];\r\n    for (var i = 0; i < indices.length; i++) {\r\n        c[i] = length - indices.length + i;\r\n    }\r\n    return c;\r\n}\r\nexport function createMoveForwardIndices(indices, length) {\r\n    var max = indices[indices.length - 1];\r\n    return createMoveToFrontIndices(indices, Math.min(max + 2, length));\r\n}\r\nexport function createSendBackwardIndices(indices) {\r\n    var min = Math.max(0, indices[0] - 1);\r\n    var c = [];\r\n    for (var i = 0; i < indices.length; i++) {\r\n        c[i] = min + i;\r\n    }\r\n    return c;\r\n}\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { INFINITE_BOUNDS } from \"apparatus/driver\";\r\nimport { P, Segments } from \"apparatus/library/common\";\r\nimport { BasicShapes } from \"apparatus/library/shapes/common\";\r\nimport { Path, Point } from \"paper\";\r\nvar Line = /** @class */ (function () {\r\n    function Line() {\r\n        this.shouldUseBoundsCenter = true;\r\n        this.drivers = [\r\n            __assign(__assign({ type: \"rectangle\" }, INFINITE_BOUNDS), { toAppearance: function (p) { return ({ end1x: p.x, end1y: p.y }); }, fromAppearance: function (a) { return P(a.end1x, a.end1y); }, scale: 1.0, constraints: function (a, modifiers) {\r\n                    if (modifiers.shift) {\r\n                        var delta = new Point(a.end1x, a.end1y).subtract([a.end2x, a.end2y]);\r\n                        var axis = delta.clone();\r\n                        axis.angle = Math.round(delta.angle / 45) * 45;\r\n                        var modifiedDelta = delta.project(axis);\r\n                        return {\r\n                            end1x: a.end2x + modifiedDelta.x,\r\n                            end1y: a.end2y + modifiedDelta.y\r\n                        };\r\n                    }\r\n                    return;\r\n                } }),\r\n            __assign(__assign({ type: \"rectangle\" }, INFINITE_BOUNDS), { toAppearance: function (p) { return ({ end2x: p.x, end2y: p.y }); }, fromAppearance: function (a) { return P(a.end2x, a.end2y); }, scale: 1.0, constraints: function (a, modifiers) {\r\n                    if (modifiers.shift) {\r\n                        var delta = new Point(a.end2x, a.end2y).subtract([a.end1x, a.end1y]);\r\n                        var axis = delta.clone();\r\n                        axis.angle = Math.round(delta.angle / 45) * 45;\r\n                        var modifiedDelta = delta.project(axis);\r\n                        return {\r\n                            end2x: a.end1x + modifiedDelta.x,\r\n                            end2y: a.end1y + modifiedDelta.y\r\n                        };\r\n                    }\r\n                    return;\r\n                } }),\r\n        ];\r\n    }\r\n    Line.prototype.render = function (a) {\r\n        var graphic = new Path(Segments([[a.end1x, a.end1y]], [[a.end2x, a.end2y]]));\r\n        BasicShapes.StrokeOnly.apply(graphic, a);\r\n        if (a.dashed) {\r\n            graphic.dashArray = [10, 8];\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: BasicShapes.bounds(graphic),\r\n            pivot: P(0, 0)\r\n        };\r\n    };\r\n    Line.properties = {\r\n        label: \"Line\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: __assign({ end1x: -100, end1y: 100, end2x: 100, end2y: -100, dashed: false }, BasicShapes.StrokeOnly.defaultAppearance),\r\n        appearanceSpecs: __spreadArrays(BasicShapes.StrokeOnly.specs, [\r\n            BasicShapes.header,\r\n            { spec: \"checkbox\", key: \"dashed\", label: \"Dashed\" },\r\n        ]),\r\n    };\r\n    return Line;\r\n}());\r\nexport { Line };\r\n","import { setDefaultStyle } from \"apparatus/draw\";\r\nimport { P } from \"apparatus/library/common\";\r\nimport { CompoundPath } from \"paper\";\r\nvar Beehive = /** @class */ (function () {\r\n    function Beehive() {\r\n    }\r\n    Beehive.prototype.render = function (appearance) {\r\n        var height = appearance.height;\r\n        var graphic = new CompoundPath({});\r\n        graphic.moveTo(P(0, height));\r\n        graphic.lineBy(P(3, -height / 3));\r\n        graphic.moveBy(P(3, -height / 3));\r\n        graphic.lineBy(P(3, -height / 3));\r\n        graphic.lineBy(P(25, 0));\r\n        graphic.moveBy(P(25, 0));\r\n        graphic.lineBy(P(25, 0));\r\n        graphic.lineBy(P(9, height));\r\n        setDefaultStyle(graphic);\r\n        var hitShape = graphic.bounds.toShape();\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShape,\r\n            snapping: [\r\n                graphic.placeable(),\r\n                graphic.topEdgeAsPlaceableSurface(),\r\n            ],\r\n            watermark: P(85, 0)\r\n        };\r\n    };\r\n    Beehive.properties = {\r\n        label: \"Beehive stand\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            height: 40\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Height\",\r\n                min: 30, max: 50\r\n            }\r\n        ],\r\n    };\r\n    return Beehive;\r\n}());\r\nexport { Beehive };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { setDefaultStyle } from \"apparatus/draw\";\r\nimport { P, Segments } from \"apparatus/library/common\";\r\nimport { CommonCondenser, condenserCaseShape } from \"apparatus/library/condensers\";\r\nimport { Group, Path } from \"paper\";\r\nvar LiebigCondenser = /** @class */ (function () {\r\n    function LiebigCondenser() {\r\n    }\r\n    LiebigCondenser.isBoostRequiredForAppearance = function (appearance) {\r\n        return CommonCondenser.isBoostRequiredForAppearance(appearance);\r\n    };\r\n    LiebigCondenser.prototype.render = function (appearance) {\r\n        var ports = appearance.ports, height = appearance.height;\r\n        var _a = condenserCaseShape(height, 15, ports), casing = _a.group, snapping = _a.snap;\r\n        var insideTube1 = new Path(Segments([[-7.5, 0]], [[-7.5, 10]], [[-5, 25]], [[-5, height - 25]], [[-7.5, height - 10]], [[-7.5, height]]));\r\n        var insideTube2 = insideTube1.clone();\r\n        insideTube2.scale(-1.0, 1.0, P(0, 0));\r\n        var graphic = new Group([casing, insideTube1, insideTube2]);\r\n        setDefaultStyle(graphic);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: snapping,\r\n            pivot: P(0, height / 2)\r\n        };\r\n    };\r\n    LiebigCondenser.properties = {\r\n        label: \"Liebig Condenser\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: __assign({}, CommonCondenser.defaultAppearance),\r\n        appearanceSpecs: __spreadArrays(CommonCondenser.appearanceSpecs),\r\n    };\r\n    return LiebigCondenser;\r\n}());\r\nexport { LiebigCondenser };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { setDefaultStyle } from \"apparatus/draw\";\r\nimport { P, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nimport { CommonCondenser, condenserCaseShape } from \"../condensers\";\r\nvar GrahamCondenser2 = /** @class */ (function () {\r\n    function GrahamCondenser2() {\r\n    }\r\n    GrahamCondenser2.isBoostRequiredForAppearance = function (appearance) {\r\n        return CommonCondenser.isBoostRequiredForAppearance(appearance);\r\n    };\r\n    GrahamCondenser2.prototype.render = function (appearance) {\r\n        var ports = appearance.ports, height = appearance.height;\r\n        var _a = condenserCaseShape(height, 15, ports), casing = _a.group, snapping = _a.snap;\r\n        var insideTube1 = new Path(Segments([[7.5, 0]], [[7.5, 10]], [[5, 25]]));\r\n        var insideTube2 = new Path(Segments([[-7.5, 0]], [[-7.5, 10]], [[-5, 25]]));\r\n        var twists = Math.floor((height - 70) / 10);\r\n        for (var i = 0; i < twists; i++) {\r\n            insideTube1.addSegments(Segments([[3, 10 * i + 38],\r\n                i == 0 ? [0, 0] : [10, -5],\r\n                i == twists - 1 ? [0, 0] : [10, 5]]));\r\n            insideTube2.addSegments(Segments([[-3, 10 * i + 43],\r\n                i == 0 ? [0, 0] : [-10, -5],\r\n                i == twists - 1 ? [0, 0] : [-10, 5]]));\r\n        }\r\n        insideTube1.addSegments(Segments([[5, height - 25]], [[7.5, height - 10]], [[7.5, height]]));\r\n        insideTube2.addSegments(Segments([[-5, height - 25]], [[-7.5, height - 10]], [[-7.5, height]]));\r\n        var graphic = new Group([casing, insideTube1, insideTube2]);\r\n        setDefaultStyle(graphic);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: snapping,\r\n            pivot: P(0, height / 2)\r\n        };\r\n    };\r\n    GrahamCondenser2.properties = {\r\n        label: \"Graham Condenser\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: __assign({}, CommonCondenser.defaultAppearance),\r\n        appearanceSpecs: __spreadArrays(CommonCondenser.appearanceSpecs),\r\n    };\r\n    return GrahamCondenser2;\r\n}());\r\nexport { GrahamCondenser2 };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { glassFold, setDefaultStyle } from \"apparatus/draw\";\r\nimport { DEFAULT_LIQUID_DATA, P, Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nimport { addMarkers, breakPathClosed } from \"../../draw\";\r\nimport { createTap, Tap } from \"../common/tap\";\r\n/**\r\n * See https://en.wikipedia.org/wiki/Dropping_funnel\r\n * TODO: Add markers\r\n */\r\nvar DroppingFunnel = /** @class */ (function () {\r\n    function DroppingFunnel() {\r\n    }\r\n    DroppingFunnel.isBoostRequiredForAppearance = function (a) {\r\n        return a.type == \"pressure-equalising\";\r\n    };\r\n    DroppingFunnel.prototype.render = function (appearance) {\r\n        var topInlet = new Path(Segments([[-11, -20]], [[11, -20]], [[9, 10]], [[-9, 10]]));\r\n        topInlet.closePath();\r\n        var body = new Path.Rectangle(R(0, 0, 50, 130, Pivot.TOP_CENTER), 25);\r\n        var spout = new Path.Rectangle(R(0, 125, 10, 100, Pivot.TOP_CENTER));\r\n        // Create parts for the liquid mask.\r\n        var liquidMask;\r\n        if (Tap.isClosed(appearance.tapOpening)) {\r\n            // Tap is closed. Create a very thin shape for the spout.\r\n            liquidMask = body.unite(new Path.Rectangle(R(0, 125, 0.001, 100, Pivot.TOP_CENTER)));\r\n        }\r\n        else {\r\n            liquidMask = body.unite(spout);\r\n        }\r\n        // Outline shape.\r\n        var shape;\r\n        if (appearance.type == \"simple\") {\r\n            var combinedShape = body.unite(topInlet);\r\n            shape = breakPathClosed(combinedShape, 4);\r\n        }\r\n        else { // With pressure-equalising arm.\r\n            var arm = pressureEqualisingArm();\r\n            var combinedShape = body.unite(topInlet).unite(arm);\r\n            shape = breakPathClosed(combinedShape, 4, 12);\r\n        }\r\n        setDefaultStyle(shape);\r\n        // \"spout\" is only used to create the liquid mask.\r\n        // Visible spout is drawn separately, using 2 lines.\r\n        var spoutLeftWall = new Path(Segments([[-5, 135]], [[-5, 225]]));\r\n        var spoutRightWall = new Path(Segments([[5, 135]], [[5, 225]]));\r\n        setDefaultStyle(spoutLeftWall, spoutRightWall);\r\n        // Create stop cock.\r\n        var stopCock = createTap(appearance.tapOpening);\r\n        stopCock.position.y += 135;\r\n        var graphic = new Group([shape, spoutLeftWall, spoutRightWall, stopCock]);\r\n        addMarkers(graphic, P(20, 120), 10, P(0, 10));\r\n        graphic.addChild(glassFold(0, 4));\r\n        return {\r\n            graphic: graphic,\r\n            liquidMask: liquidMask,\r\n            hitShape: graphic.bounds.toShape(),\r\n        };\r\n    };\r\n    DroppingFunnel.properties = {\r\n        label: \"Dropping Funnel\",\r\n        canContainLiquids: true,\r\n        flippable: true,\r\n        defaultLiquidData: __assign(__assign({}, DEFAULT_LIQUID_DATA), { amountRatio: 0.65 }),\r\n        defaultAppearance: __assign({ type: \"simple\" }, Tap.defaultAppearance),\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"type\", label: \"Type\",\r\n                options: [\r\n                    { value: \"simple\", label: \"Simple\" },\r\n                    { value: \"pressure-equalising\", label: \"Pressure-equalising\", tier: \"boost\" },\r\n                ],\r\n                allowSelectingTierLockedOptions: true,\r\n            },\r\n            Tap.appearanceSpec,\r\n        ],\r\n    };\r\n    return DroppingFunnel;\r\n}());\r\nexport { DroppingFunnel };\r\nfunction pressureEqualisingArm() {\r\n    return new Path(Segments([[0, 5]], [[35, 5], , [7, 0]], [[45, 15]], [[45, 140], , [0, 20]], [[15, 185]], [[11, 220]], [[-11, 220]], [[-14, 180], , [-5, -18]], [[17, 174], [1, -8]], [[37, 143], [0, 10]], [[37, 20]], [[30, 12], [7, 0]], [[0, 12]]));\r\n}\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { addToGroup, removeFromGroup } from \"store/actions\";\r\nimport { ID } from \"store/id\";\r\nimport { default as store, GroupsOperationData } from \"store/store\";\r\nvar AddArrow = /** @class */ (function () {\r\n    function AddArrow(arrows) {\r\n        this.arrows = arrows;\r\n        this.groupInformation = new GroupsOperationData();\r\n        for (var _i = 0, arrows_1 = arrows; _i < arrows_1.length; _i++) {\r\n            var arrow = arrows_1[_i];\r\n            if (arrow.parentGroup) {\r\n                this.groupInformation.add(arrow.parentGroup, arrow.id);\r\n            }\r\n        }\r\n    }\r\n    AddArrow.prototype.execute = function () {\r\n        if (this.groupInformation.hasData()) {\r\n            store.dispatch(addToGroup(this.groupInformation));\r\n        }\r\n        store.dispatchFn(\"AddArrow\", addMutator(this.arrows));\r\n    };\r\n    AddArrow.prototype.undo = function () {\r\n        store.dispatchFn(\"RemoveArrow\", removeMutator(this.arrows.map(function (a) { return a.id; })));\r\n        if (this.groupInformation.hasData()) {\r\n            store.dispatch(removeFromGroup(this.groupInformation));\r\n        }\r\n    };\r\n    return AddArrow;\r\n}());\r\nexport { AddArrow };\r\nvar DeleteArrows = /** @class */ (function () {\r\n    function DeleteArrows(arrowData) {\r\n        this.arrowData = arrowData;\r\n        this.groupInformation = new GroupsOperationData();\r\n        for (var _i = 0, arrowData_1 = arrowData; _i < arrowData_1.length; _i++) {\r\n            var arrow = arrowData_1[_i];\r\n            if (arrow.parentGroup) {\r\n                this.groupInformation.add(arrow.parentGroup, arrow.id);\r\n            }\r\n        }\r\n    }\r\n    DeleteArrows.prototype.execute = function () {\r\n        store.dispatchFn(\"DeleteArrow\", removeMutator(this.arrowData.map(function (a) { return a.id; })));\r\n        if (this.groupInformation.hasData()) {\r\n            store.dispatch(removeFromGroup(this.groupInformation));\r\n        }\r\n    };\r\n    DeleteArrows.prototype.undo = function () {\r\n        // Add group information first\r\n        if (this.groupInformation.hasData()) {\r\n            store.dispatch(addToGroup(this.groupInformation));\r\n        }\r\n        store.dispatchFn(\"Undo-DeleteArrow\", addMutator(this.arrowData));\r\n    };\r\n    return DeleteArrows;\r\n}());\r\nexport { DeleteArrows };\r\n/** Generic method to update Arrow Data. Should replace all the UpdateArrowX commands. */\r\nvar UpdateArrowProperties = /** @class */ (function () {\r\n    function UpdateArrowProperties(values) {\r\n        this.valuesMap = {};\r\n        this.previousValuesMap = {};\r\n        for (var _i = 0, values_1 = values; _i < values_1.length; _i++) {\r\n            var value = values_1[_i];\r\n            this.valuesMap[value.id.id] = value.value;\r\n            this.previousValuesMap[value.id.id] = value.previousValue;\r\n        }\r\n    }\r\n    UpdateArrowProperties.prototype.execute = function () {\r\n        var _this = this;\r\n        store.dispatchFn(\"UpdateArrowProperties\", function (store) { return mutateArrowWithPartial(store, _this.valuesMap); });\r\n    };\r\n    UpdateArrowProperties.prototype.undo = function () {\r\n        var _this = this;\r\n        store.dispatchFn(\"UpdateArrowProperties\", function (store) { return mutateArrowWithPartial(store, _this.previousValuesMap); });\r\n    };\r\n    return UpdateArrowProperties;\r\n}());\r\nexport { UpdateArrowProperties };\r\n// Mutator methods that modify the store.\r\nfunction addMutator(data) {\r\n    return function (state) {\r\n        var _a;\r\n        var newState = __assign({}, state);\r\n        (_a = newState.arrows).push.apply(_a, data);\r\n        return newState;\r\n    };\r\n}\r\nfunction removeMutator(ids) {\r\n    return function (state) {\r\n        var newState = __assign({}, state);\r\n        newState.arrows = state.arrows.filter(ID.notMatching(ids));\r\n        return newState;\r\n    };\r\n}\r\nvar mutateArrowWithPartial = function (store, mutations) { return (__assign(__assign({}, store), { arrows: store.arrows.map(function (a) { return mutations[a.id.id] !== undefined ? __assign(__assign({}, a), mutations[a.id.id]) : a; }) })); };\r\nexport var addArrowMutator = addMutator;\r\n","import { mirrorX, setDefaultStyle } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { Pivot, R, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar Bottle = /** @class */ (function () {\r\n    function Bottle() {\r\n    }\r\n    Bottle.prototype.render = function (appearance) {\r\n        var scaleFactor = appearance.height / 210;\r\n        var shape = new Path(Segments([[9, 2]], [[9, 15], , [0, 7]], [[22, 32], [-7, -9], [8, 11]], [[30, 65], , [-2, 0]], [[30, 71], [-2, 0]], [[30, 106], , [-2, 0]], [[30, 112], [-2, 0]], [[30, 200], , [-4, 14]], [[9, 207], [4, 4], [-4, 5]]));\r\n        mirrorX(shape);\r\n        shape.scale(scaleFactor);\r\n        var liquidMask = shape.clone();\r\n        setDefaultStyle(shape);\r\n        var undercap = Shape.Rectangle(R(0, 10, 24, 3, Pivot.CENTER), 2.0)\r\n            .withFill(\"#ffffff80\")\r\n            .withStroke(\"thinner\", SharedColors.stroke);\r\n        var capStuff = new Group([undercap]);\r\n        if (appearance.cap) {\r\n            var capColor = \"#44a8d4\".color();\r\n            var cap = Shape.Rectangle(R(0, 0, 24, 12, Pivot.CENTER), 2.0)\r\n                .withGradientFill(\"right\", Gradients.cylinder(capColor))\r\n                .withStroke(\"default\", capColor.ladd(-10).hex());\r\n            capStuff.addChild(cap);\r\n        }\r\n        capStuff.scale(scaleFactor, shape.bounds.center);\r\n        var graphic = new Group([shape, capStuff]);\r\n        return {\r\n            graphic: graphic,\r\n            liquidMask: liquidMask,\r\n            hitShape: graphic.bounds.toShape(),\r\n            pivot: shape.bounds.center,\r\n            snapping: shape.placeable(),\r\n        };\r\n    };\r\n    Bottle.properties = {\r\n        label: \"Plastic Bottle\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            height: 210,\r\n            cap: true,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Size\",\r\n                min: 200, max: 330\r\n            },\r\n            { spec: \"checkbox\", key: \"cap\", label: \"Show cap\" },\r\n        ],\r\n    };\r\n    return Bottle;\r\n}());\r\nexport { Bottle };\r\n","import \"ext/js\";\r\nimport { PropertyPanelHint } from \"text/ui\";\r\nvar SUBSTITUTIONS = [\r\n    [\" >\", \" \"],\r\n    [\" ->\", \" \"],\r\n    [\" <-\", \" \"],\r\n    [\" degC\", \" C\"],\r\n    [\" degF\", \" F\"],\r\n];\r\n/**\r\n * ChemMark is a codename for a technology for writing text\r\n * containing chemical formulas and other scientific\r\n */\r\nexport var ChemMark;\r\n(function (ChemMark) {\r\n    /** Description to use in the UI on toggles */\r\n    ChemMark.uiDescription = \"Smart detection of units and chemical formulas\";\r\n    /** Limit on the number of characters where ChemMark will be applied. */\r\n    ChemMark.FREE_TIER_CHAR_LIMIT = 7;\r\n    ChemMark.Hint = PropertyPanelHint;\r\n    /** Parse the text without ChemMark features. */\r\n    function parseBasic(input) {\r\n        var formattedText = { segments: [] };\r\n        // Break it down by newlines.\r\n        var lines = input.split(\"\\n\");\r\n        // Insert newline between every line.\r\n        for (var _i = 0, lines_1 = lines; _i < lines_1.length; _i++) {\r\n            var line = lines_1[_i];\r\n            formattedText.segments.push({ type: \"normal\", text: line });\r\n            formattedText.segments.push({ type: \"newline\" });\r\n        }\r\n        // Drop the last newline.\r\n        formattedText.segments.pop();\r\n        return formattedText;\r\n    }\r\n    ChemMark.parseBasic = parseBasic;\r\n    function parseSmartLimited(input) {\r\n        var text = parseSmart(input);\r\n        if (input.length > ChemMark.FREE_TIER_CHAR_LIMIT) {\r\n            // Add warning emojis at start and end.\r\n            text.segments.unshift({\r\n                type: \"normal\",\r\n                text: \"\"\r\n            });\r\n            text.segments.push({\r\n                type: \"normal\",\r\n                text: \"\"\r\n            });\r\n        }\r\n        return text;\r\n    }\r\n    ChemMark.parseSmartLimited = parseSmartLimited;\r\n    function parseSmart(input) {\r\n        var parseState = \"normal\";\r\n        var segments = [];\r\n        var currentSegment = \"\";\r\n        function maybeCloseCurrentSegment() {\r\n            if (currentSegment != \"\") {\r\n                switch (parseState) {\r\n                    case \"normal\":\r\n                        segments.push({ type: \"normal\", text: currentSegment });\r\n                        break;\r\n                    case \"number\":\r\n                        segments.push({ type: \"subscript\", text: currentSegment });\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n        for (var _i = 0, input_1 = input; _i < input_1.length; _i++) {\r\n            var char = input_1[_i];\r\n            if (char == \"\\n\") {\r\n                // Close current segment (if any), insert a newline and reset for new parsing.\r\n                maybeCloseCurrentSegment();\r\n                segments.push({ type: \"newline\" });\r\n                currentSegment = \"\";\r\n                parseState = \"normal\";\r\n                continue;\r\n            }\r\n            switch (parseState) {\r\n                case \"normal\":\r\n                    if ((char == '2' || char == '3') && endsInUnit(currentSegment)) {\r\n                        // This is a unit.\r\n                        segments.push({ type: \"normal\", text: currentSegment });\r\n                        segments.push({ type: \"superscript\", text: char });\r\n                        parseState = \"normal\";\r\n                        currentSegment = '';\r\n                    }\r\n                    else if (isNumeric(char) && isInsideFormula(currentSegment)) {\r\n                        // Switch to subscript.\r\n                        segments.push({ type: \"normal\", text: currentSegment });\r\n                        parseState = \"number\";\r\n                        currentSegment = char;\r\n                    }\r\n                    else if (isPlusMinus(char) && isInsideFormula(currentSegment)) {\r\n                        segments.push({ type: \"normal\", text: currentSegment });\r\n                        segments.push({ type: \"superscript\", text: char });\r\n                        currentSegment = \"\";\r\n                    }\r\n                    else if (isPlusMinus(char) && currentSegment == \"\" && isLastSegmentSuperscriptCharge(segments, char)) {\r\n                        // ++ -> 2+\r\n                        segments[segments.length - 1].text = \"2\" + char;\r\n                    }\r\n                    else if (currentSegment.length >= 2\r\n                        && (char === \"C\" || char === \"F\")\r\n                        && (currentSegment.last(1) === \"o\")\r\n                        && isNumeric(currentSegment[currentSegment.length - 2])) {\r\n                        // Temperatures. (oF and oC)\r\n                        currentSegment = currentSegment.replaceLast(1, \"\") + char;\r\n                    }\r\n                    else {\r\n                        currentSegment += char;\r\n                        currentSegment = checkSubstitutions(currentSegment);\r\n                    }\r\n                    break;\r\n                case \"number\":\r\n                    if (isNumeric(char)) {\r\n                        currentSegment += char;\r\n                    }\r\n                    else if (isPlusMinus(char)) {\r\n                        // This is an ion.\r\n                        // We only support single-digit charges, hence if the current\r\n                        // segment is longer than 1, it also contains an atom count.\r\n                        if (currentSegment.length > 1) {\r\n                            // Charge and atom number.\r\n                            segments.push({\r\n                                type: \"subsuperscript\",\r\n                                sub: currentSegment.first(currentSegment.length - 1),\r\n                                super: currentSegment.last(1) + char,\r\n                            });\r\n                            parseState = \"normal\";\r\n                            currentSegment = '';\r\n                        }\r\n                        else if (isChargeNumberHeuristic(currentSegment, segments[segments.length - 1])) {\r\n                            // This is tricky! It could be a charge, or an atom\r\n                            // number and numberless charge. Apply a heuristic.\r\n                            // Just charge.\r\n                            segments.push({ type: \"superscript\", text: currentSegment + char });\r\n                            parseState = \"normal\";\r\n                            currentSegment = '';\r\n                        }\r\n                        else {\r\n                            // Charge and atom number.\r\n                            segments.push({\r\n                                type: \"subsuperscript\",\r\n                                sub: currentSegment,\r\n                                super: char,\r\n                            });\r\n                            parseState = \"normal\";\r\n                            currentSegment = '';\r\n                        }\r\n                    }\r\n                    else {\r\n                        // Close number and start normal.\r\n                        segments.push({ type: \"subscript\", text: currentSegment });\r\n                        parseState = \"normal\";\r\n                        if (char == \".\") {\r\n                            // Hydration interpunct. We are relying here on the fact that\r\n                            // most hydrates have the first bit ending in a number, e.g. CuSO4, Ba(OH)2\r\n                            currentSegment = \"  \";\r\n                        }\r\n                        else {\r\n                            // Normal character.\r\n                            currentSegment = char;\r\n                        }\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n        // Add last segment.\r\n        maybeCloseCurrentSegment();\r\n        return {\r\n            segments: segments\r\n        };\r\n    }\r\n    ChemMark.parseSmart = parseSmart;\r\n})(ChemMark || (ChemMark = {}));\r\nfunction checkSubstitutions(input) {\r\n    for (var _i = 0, SUBSTITUTIONS_1 = SUBSTITUTIONS; _i < SUBSTITUTIONS_1.length; _i++) {\r\n        var _a = SUBSTITUTIONS_1[_i], sequence = _a[0], substitution = _a[1];\r\n        if (input.last(sequence.length) === sequence) {\r\n            return input.replaceLast(sequence.length, substitution);\r\n        }\r\n    }\r\n    return input;\r\n}\r\nfunction isNumeric(char) {\r\n    return (char >= '0' && char <= '9');\r\n}\r\nfunction isPlusMinus(char) {\r\n    return (char == '+' || char == '-');\r\n}\r\nfunction isInsideFormula(segment) {\r\n    var lastChar = segment.last(1);\r\n    return segment.length > 0\r\n        && (isTextCharacter(lastChar)\r\n            || lastChar == ')'\r\n            || lastChar == ']');\r\n}\r\nfunction isTextCharacter(char) {\r\n    return (char >= 'A' && char <= 'Z') || (char >= 'a' && char <= 'z');\r\n}\r\n/** Exceptions, where the following number is NOT a charge number. */\r\nvar NOT_CHARGE_NUMBER_COMPOUNDS = [\"PO\", \"NH\", \"NO\", \"VO\", \"IO\"];\r\n/**\r\n * Heuristic function that determines whether the current\r\n * number is a charge or an atom number.\r\n */\r\nfunction isChargeNumberHeuristic(number, prevSegment) {\r\n    // If the previous segment is quite short, it's likely it's a charge.\r\n    // However, there are exception, such \"PO\", where it's not a charge number.\r\n    if (prevSegment.type == \"subsuperscript\" || prevSegment.type == \"newline\")\r\n        return true;\r\n    var text = extractLastTextCharacters(prevSegment.text);\r\n    if (text.length <= 2 && NOT_CHARGE_NUMBER_COMPOUNDS.indexOf(text) === -1) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\nfunction isLastSegmentSuperscriptCharge(segments, chargeChar) {\r\n    if (segments.length == 0)\r\n        return false;\r\n    var lastSegment = segments[segments.length - 1];\r\n    return lastSegment.type == \"superscript\"\r\n        && lastSegment.text == chargeChar;\r\n}\r\n/**\r\n * Extract last part of a string made of solely text characters.\r\n * E.g. \"6 Fe\" -> \"Fe\"\r\n */\r\nfunction extractLastTextCharacters(input, limit) {\r\n    var index;\r\n    var lowerBound = limit ? Math.max(input.length - 1 - limit, 0) : 0;\r\n    for (index = input.length - 1; index >= lowerBound; index--) {\r\n        if (!isTextCharacter(input[index])) {\r\n            break;\r\n        }\r\n    }\r\n    return input.substr(index + 1);\r\n}\r\nvar UNITS = [\"cm\", \"m\", \"mm\", \"dm\"];\r\nfunction endsInUnit(input) {\r\n    var lastCharacters = extractLastTextCharacters(input, 3);\r\n    UNITS.indexOf(lastCharacters);\r\n    return UNITS.indexOf(lastCharacters) !== -1;\r\n}\r\n","import { Group, Path, Shape } from \"paper\";\r\nimport { addEdgeLipsReversed, addMarkers, mirrorX, setDefaultStyle, smoothCorner } from \"../draw\";\r\nimport { P, R, Segments } from \"./common\";\r\nvar Cylinder = /** @class */ (function () {\r\n    function Cylinder() {\r\n    }\r\n    Cylinder.prototype.render = function (appearance) {\r\n        // let width = 30\r\n        // let height = 200\r\n        // let baseRadius = 35\r\n        // let baseHeight = 10\r\n        var height = appearance.height;\r\n        var width = 14 + height / 12.5;\r\n        var baseRadius = width * 1;\r\n        var baseHeight = width / 4;\r\n        var cylinder = new Path(Segments([[0, 0]], [[0, height]], [[(baseRadius - width / 2), height + baseHeight]]));\r\n        smoothCorner(cylinder.segments[1], 2.0);\r\n        mirrorX(cylinder, -width / 2);\r\n        addEdgeLipsReversed(cylinder);\r\n        setDefaultStyle(cylinder);\r\n        var graphic = new Group([cylinder]);\r\n        addMarkers(graphic, P(-5.0, height), 0, P(0, 10.0));\r\n        var hitShape = [\r\n            Shape.Rectangle(R(-width, 0, width, height)),\r\n            Shape.Rectangle(R(-width / 2 - baseRadius, height, baseRadius * 2, baseHeight))\r\n        ];\r\n        var liquidMask = new Path.Rectangle(R(-width, 0, width, height));\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShape,\r\n            liquidMask: liquidMask,\r\n            snapping: graphic.placeable(),\r\n        };\r\n    };\r\n    Cylinder.properties = {\r\n        label: \"Graduated cylinder\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            height: 200,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", label: \"Size\", key: \"height\",\r\n                min: 80, max: 300,\r\n            }\r\n        ],\r\n    };\r\n    return Cylinder;\r\n}());\r\nexport { Cylinder };\r\n","import { StyledTextCreator } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, R, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path, PointText } from \"paper\";\r\nvar JACK_STROKE = \"#333333\";\r\nvar switchText = new StyledTextCreator({\r\n    fontFamily: \"sans-serif\",\r\n    fontSize: 7,\r\n    fillColor: \"#ffffff\",\r\n});\r\nvar markerTexts = new StyledTextCreator({\r\n    fontFamily: \"sans-serif\",\r\n    fontSize: 8,\r\n    fillColor: \"#888\",\r\n    justification: \"center\"\r\n});\r\nvar PowerPack = /** @class */ (function () {\r\n    function PowerPack() {\r\n    }\r\n    PowerPack.prototype.render = function (appearance) {\r\n        var casing = new Path.Rectangle(R(0, 0, 185, 100), 3.0)\r\n            .withStroke(\"default\")\r\n            .withGradientFill(\"down\", Gradients.box(SharedColors.deviceGrey.color(), { shift: 0.1 }));\r\n        var dial = new Path.Circle(P(0, 0), 20)\r\n            .withStroke(\"default\").withGradientFill(\"right-down\", Gradients.cylinder(\"#555555\".color()));\r\n        var dialGroup = new Group([dial]);\r\n        var dialRange = 270;\r\n        var maxVoltage = 12;\r\n        var minVoltage = 0;\r\n        for (var voltage = minVoltage; voltage <= maxVoltage; voltage++) {\r\n            var angle = ((voltage - minVoltage) / (maxVoltage - minVoltage) - 0.5) * dialRange;\r\n            var marker = new Path.Line(P(0, -24), P(0, -27)).withStroke(1.0, \"#888888\");\r\n            marker.rotate(angle, P(0, 0));\r\n            dialGroup.addChild(marker);\r\n            var text = markerTexts.create(voltage.toString(), P(0, -32).rotate(angle, P(0, 0)).add(P(0, 3)), voltage == appearance.voltage ? { fontWeight: \"bold\", fillColor: \"#333\" } : {});\r\n            dialGroup.addChild(text);\r\n        }\r\n        var currentVoltageMarker = new Path.Line(P(0, -6), P(0, -18)).withStroke(\"default\", \"#ccc\");\r\n        currentVoltageMarker.rotate(((appearance.voltage - minVoltage) / (maxVoltage - minVoltage) - 0.5) * dialRange, P(0, 0));\r\n        dialGroup.addChild(currentVoltageMarker);\r\n        dialGroup.position = P(73, 55);\r\n        // Connection jacks.\r\n        var acJack1 = createJack(\"#dbc222\").withPosition(P(130, 40));\r\n        var acJack2 = createJack(\"#dbc222\").withPosition(P(160, 40));\r\n        var dcJack1 = createJack(\"#f61f2f\").withPosition(P(130, 80));\r\n        var dcJack2 = createJack(\"#414141\").withPosition(P(160, 80));\r\n        var acLabel = jackLabel(\"ac\").withPosition(P(145, 25));\r\n        var dcLabel = jackLabel(\"dc\").withPosition(P(145, 65));\r\n        // Switch.\r\n        var switchButton = new Path.Rectangle(R(15, 20, 13, 30), 2.0)\r\n            .withStroke(3.0, \"#222222\")\r\n            .withGradientFill(\"down\", [[\"#333333\", 0.0], [\"#555555\", 0.45], [\"#888888\", 0.55], [\"#999999\", 1.0]]);\r\n        var oText = switchText.create(\"O\", P(22, 29), { fillColor: \"#999999\" });\r\n        var iText = switchText.create(\"I\", P(22, 44));\r\n        var graphic = new Group([\r\n            casing, dialGroup, acJack1, acJack2, dcJack1, dcJack2, acLabel, dcLabel, switchButton,\r\n            oText, iText,\r\n        ]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: casing.placeable(),\r\n        };\r\n    };\r\n    PowerPack.properties = {\r\n        label: \"Power pack\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            voltage: 8\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"voltage\", label: \"Voltage\",\r\n                min: 0, max: 12\r\n            }\r\n        ],\r\n    };\r\n    return PowerPack;\r\n}());\r\nexport { PowerPack };\r\nexport var createJack = function (color) { return new Group([\r\n    new Path.Circle(P(0, 0), 6).withStroke(\"thinner\", JACK_STROKE).withFill(color),\r\n    new Path.Circle(P(0, 0), 3).withFill(JACK_STROKE)\r\n]); };\r\nvar jackLabel = function (text) { return new Group([\r\n    new PointText({\r\n        point: P(0, 4),\r\n        content: text.toUpperCase(),\r\n        fillColor: \"#888\",\r\n        fontFamiy: \"sans-serif\",\r\n        fontSize: 9,\r\n        justification: \"center\",\r\n    }),\r\n    new Path(Segments([[-15, 5]], [[-15, 0]], [[-9, 0]])).withStroke(1.0, \"#888\"),\r\n    new Path(Segments([[15, 5]], [[15, 0]], [[9, 0]])).withStroke(1.0, \"#888\"),\r\n]); };\r\n","import { P, Pivot, R, Segments, SharedColors, SharedGradients } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nvar wheelColor = \"#444444\".color();\r\nvar Trolley = /** @class */ (function () {\r\n    function Trolley() {\r\n    }\r\n    Trolley.prototype.render = function (appearance) {\r\n        var length = appearance.length;\r\n        var height = length / 10 + 20;\r\n        var wheelRadius = height * 0.6;\r\n        var wheelFill = [\r\n            [wheelColor.hex(), 0.6],\r\n            [wheelColor.darken(0.2).hex(), 0.79],\r\n            [wheelColor.hex(), 0.8],\r\n        ];\r\n        var innerWheel = new Path.Circle(P(length - wheelRadius - 10, height - 10), wheelRadius)\r\n            .withStroke(\"default\")\r\n            .setRadialGradientFill(wheelFill);\r\n        var outerWheel = new Path.Circle(P(10 + wheelRadius, height - 10), wheelRadius)\r\n            .withStroke(\"default\")\r\n            .setRadialGradientFill(wheelFill);\r\n        var bars = new Group([\r\n            new Path.Rectangle(R(length / 2, 0, 15, length / 3, Pivot.BOTTOM_CENTER))\r\n                .withGradientFill(\"right\", SharedGradients.cylinderMetal)\r\n        ]);\r\n        var body = new Path.Rectangle(R(0, 0, length, height), 2.0)\r\n            .withStroke(\"default\", SharedColors.wood.stroke)\r\n            .withGradientFill(\"down\", SharedColors.wood.gradient);\r\n        var stopper = new Group([\r\n            new Path.Rectangle(R(0, 10, 80, 10, Pivot.TOP_RIGHT)).withGradientFill(\"down\", SharedGradients.metal),\r\n            new Path(Segments([[-80, 9]], [[-95, 7]])).mirrorY(15).close().withFill(\"#111111\")\r\n        ]);\r\n        // Assemble.\r\n        var trolleyGroup = new Group([innerWheel, body, outerWheel]);\r\n        var graphic = new Group([stopper, bars, trolleyGroup]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: [\r\n                trolleyGroup.bounds.toShape(),\r\n                bars.bounds.toShape(),\r\n                stopper.bounds.toShape(),\r\n            ],\r\n            pivot: body.bounds.center,\r\n            snapping: [\r\n                trolleyGroup.placeable(),\r\n                body.topEdgeAsPlaceableSurface(),\r\n            ]\r\n        };\r\n    };\r\n    Trolley.properties = {\r\n        label: \"Trolley\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            length: 300\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"length\", label: \"Length\",\r\n                min: 200, max: 350, step: 5, unit: \"mm\",\r\n            }\r\n        ],\r\n    };\r\n    return Trolley;\r\n}());\r\nexport { Trolley };\r\n","import { StyledTextCreator } from \"apparatus/draw\";\r\nimport { P, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nvar SimpleVoltmeter = /** @class */ (function () {\r\n    function SimpleVoltmeter() {\r\n        this.textStyler = new StyledTextCreator({\r\n            fontFamily: \"sans-serif\",\r\n            fillColor: SharedColors.stroke\r\n        });\r\n    }\r\n    SimpleVoltmeter.prototype.render = function (appearance) {\r\n        var circle = new Path.Circle(P(0, 0), appearance.size / 2)\r\n            .withStroke(\"default\").withFill(\"white\");\r\n        var text = this.textStyler.create(\"V\", P(0, appearance.size * 0.44 * 0.7), { fontSize: appearance.size * 0.7 });\r\n        var graphic = new Group([circle, text]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    SimpleVoltmeter.properties = {\r\n        label: \"Voltmeter (Symbol)\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            size: 60\r\n        },\r\n        appearanceSpecs: [],\r\n    };\r\n    return SimpleVoltmeter;\r\n}());\r\nexport { SimpleVoltmeter };\r\n","// Selection of tools to visually indicate keyboard shorcuts.\r\nimport * as React from 'react';\r\n/** Converts an array of strings representing keys to look like keyboard keys. */\r\nexport function formatShortcuts() {\r\n    var shortcuts = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        shortcuts[_i] = arguments[_i];\r\n    }\r\n    return shortcuts.map(function (s) { return formatShortcut(s); }).join(\" or \");\r\n}\r\n/** Formats a single keyboard shortcutp. */\r\nfunction formatShortcut(shortcut) {\r\n    var formatted = \"\";\r\n    if (shortcut.ctrl) {\r\n        formatted += \"<span class=\\\"keyboardKey\\\">\" + ctrlKey() + \"</span> + \";\r\n    }\r\n    formatted += \"<span class=\\\"keyboardKey\\\">\" + shortcut.key + \"</span>\";\r\n    return formatted;\r\n}\r\n/** Returns true if the current system is a Mac. */\r\nfunction isMac() {\r\n    return navigator.userAgent.indexOf('Mac') !== -1;\r\n}\r\n/** Returns  for Macs, Ctrl otherwise. */\r\nexport function ctrlKey() {\r\n    return isMac() ? \"\" : \"Ctrl\";\r\n}\r\nexport var Key = function (props) { return (React.createElement(React.Fragment, null,\r\n    props.ctrl ? React.createElement(React.Fragment, null,\r\n        React.createElement(CtrlKey, null),\r\n        \" + \") : null,\r\n    React.createElement(\"span\", { className: \"keyboardKey\" }, props.k))); };\r\nexport var FAKey = function (props) { return (React.createElement(React.Fragment, null,\r\n    React.createElement(\"span\", { className: \"keyboardKey\" },\r\n        React.createElement(\"i\", { className: \"fa\" + props.icon })))); };\r\nexport var CtrlKey = function () { return (React.createElement(\"span\", { className: \"keyboardKey\" }, ctrlKey())); };\r\n","var __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { g } from \"analytics\";\r\nimport { DEMO_COLOUR_SWATCHES, FONT_FAMILY_OPTIONS, TEXT_COLOUR_SWATCHES } from \"apparatus/text/appearance\";\r\nimport { UpdateArrowProperties } from \"arrows/command\";\r\nimport { commandProcessor } from \"command/command\";\r\nimport { SENTINEL_INDETERMINATE_RADIO, SENTINEL_TEXT_PLACEHOLDER } from \"panel/appearance_spec_converter\";\r\nimport { sectionsForMultipleItems } from \"panel/propertyPanel\";\r\nimport { convertDemoSwatchesToRadioOptions } from \"panel/shared\";\r\nimport * as React from \"react\";\r\nimport { ChemMark } from \"text/parse\";\r\nvar MIN_FONT_SIZE = 8;\r\nvar MAX_FONT_SIZE = 25;\r\nfunction createUpdateCommand(arrows, key, newValue) {\r\n    return new UpdateArrowProperties(arrows.map(function (a) {\r\n        var _a, _b;\r\n        return ({ id: a.id, value: (_a = {}, _a[key] = newValue, _a), previousValue: (_b = {}, _b[key] = a[key], _b) });\r\n    }));\r\n}\r\nfunction getConsistentValue(arrows, key) {\r\n    var value = arrows[0][key];\r\n    if (arrows.length == 1)\r\n        return value;\r\n    for (var _i = 0, arrows_1 = arrows; _i < arrows_1.length; _i++) {\r\n        var arrow = arrows_1[_i];\r\n        if (arrow[key] !== value)\r\n            return;\r\n    }\r\n    return value;\r\n}\r\n/** Creates Panel UI for arrows. */\r\nexport function arrowPanelUI(selected, arrows, app, tiers) {\r\n    var _a, _b;\r\n    // TODO: Fix this casting.\r\n    var components = arrows.map(function (a) { return app.getObjectComponent(a.id); });\r\n    var styleElements = [\r\n        {\r\n            spec: \"slider\",\r\n            key: \"arrow_font\",\r\n            label: \"Text size\",\r\n            min: MIN_FONT_SIZE,\r\n            max: MAX_FONT_SIZE,\r\n            initialValue: arrows[0].fontSize,\r\n            onStart: function () { return app.setIsInteracting(true); },\r\n            onChange: function (value) {\r\n                components.forEach(function (c) { return c === null || c === void 0 ? void 0 : c.setState({ fontSize: value }); });\r\n            },\r\n            onEnd: function (_, final) {\r\n                app.setIsInteracting(false);\r\n                app.setArrowTemplate({ fontSize: final });\r\n                commandProcessor.execute(createUpdateCommand(arrows, \"fontSize\", final));\r\n            }\r\n        },\r\n        {\r\n            spec: \"select\",\r\n            key: \"fontFace\",\r\n            label: \"Font\",\r\n            value: arrows[0].fontFamily,\r\n            options: FONT_FAMILY_OPTIONS,\r\n            onSelectChange: function (_, value) {\r\n                app.setArrowTemplate({ fontFamily: value });\r\n                commandProcessor.execute(createUpdateCommand(arrows, \"fontFamily\", value));\r\n            },\r\n            id: \"fontFace\",\r\n        },\r\n        tiers.allow(\"boost\") ?\r\n            {\r\n                spec: \"color\",\r\n                key: \"color\",\r\n                label: \"Colour\",\r\n                value: arrows[0].textColor,\r\n                swatches: TEXT_COLOUR_SWATCHES,\r\n                onColorChange: function (value) {\r\n                    components.forEach(function (c) { return c.setState({ textColor: value }); });\r\n                },\r\n                onColorEnd: function (finalValue) {\r\n                    if (finalValue == arrows[0].textColor)\r\n                        return;\r\n                    commandProcessor.execute(createUpdateCommand(arrows, \"textColor\", finalValue));\r\n                },\r\n            } : {\r\n            spec: \"radio\",\r\n            id: \"labelColor\",\r\n            key: \"color-radio\",\r\n            label: \"Colour\",\r\n            options: convertDemoSwatchesToRadioOptions(DEMO_COLOUR_SWATCHES),\r\n            value: (_a = getConsistentValue(arrows, \"textColor\")) !== null && _a !== void 0 ? _a : SENTINEL_INDETERMINATE_RADIO,\r\n            onChange: function (previous, final) {\r\n                commandProcessor.execute(createUpdateCommand(arrows, \"textColor\", final));\r\n            }\r\n        },\r\n        textAlignToggleButtons(arrows),\r\n    ];\r\n    var consistentShowArrow = getConsistentValue(arrows, \"showArrow\");\r\n    var consistentEndStyle = getConsistentValue(arrows, \"endStyle\");\r\n    var arrowSection = [\r\n        {\r\n            spec: \"checkbox-group\",\r\n            label: \"Arrow\",\r\n            key: \"arrow\",\r\n            checkboxes: __spreadArrays([\r\n                {\r\n                    label: \"Enable\", value: consistentShowArrow, id: \"show-arrow\",\r\n                    onCheckedChange: function (value) {\r\n                        g(\"UpdateAppearance\", \"Arrow::showArrow\");\r\n                        commandProcessor.execute(createUpdateCommand(arrows, \"showArrow\", value));\r\n                    }\r\n                }\r\n            ], consistentShowArrow ? [{\r\n                    label: \"Show head\",\r\n                    value: consistentEndStyle !== undefined ? consistentEndStyle == \"triangle\" : undefined,\r\n                    id: \"show_arrow_head\",\r\n                    onCheckedChange: function (value) {\r\n                        g(\"UpdateAppearance\", \"Arrow::endStyle\");\r\n                        var endStyle = value ? \"triangle\" : \"none\";\r\n                        commandProcessor.execute(createUpdateCommand(arrows, \"endStyle\", endStyle));\r\n                        // Update the arrow so that next arrow drawn uses this style.\r\n                        app.setArrowTemplate({ endStyle: endStyle });\r\n                    },\r\n                }] : []),\r\n        }\r\n    ];\r\n    if (consistentShowArrow) {\r\n        arrowSection.push({\r\n            spec: \"slider\",\r\n            label: \"Thickness\",\r\n            key: \"arrowThickness\",\r\n            min: 1.5, max: 6.0, step: 0.5,\r\n            initialValue: arrows[0].arrowThickness,\r\n            tier: \"boost\",\r\n            onChange: function (value) {\r\n                components.forEach(function (c) { return c === null || c === void 0 ? void 0 : c.setState({ arrowThickness: value }); });\r\n            },\r\n            onEnd: function (_, final) {\r\n                commandProcessor.execute(createUpdateCommand(arrows, \"arrowThickness\", final));\r\n                // Update template so next arrow uses this thickness.\r\n                app.setArrowTemplate({ arrowThickness: final });\r\n            }\r\n        });\r\n    }\r\n    var currentLabel = getConsistentValue(arrows, \"label\");\r\n    return {\r\n        title: \"Label\",\r\n        icon: \"font\",\r\n        tabs: __spreadArrays([\r\n            {\r\n                type: \"text\",\r\n                sections: [\r\n                    {\r\n                        header: \"Label\",\r\n                        icon: \"font\",\r\n                        elements: [\r\n                            {\r\n                                spec: \"textarea\",\r\n                                rows: 3,\r\n                                label: \"Text\",\r\n                                key: \"arrow_text\",\r\n                                text: currentLabel !== null && currentLabel !== void 0 ? currentLabel : \"\",\r\n                                placeholder: SENTINEL_TEXT_PLACEHOLDER.if(currentLabel === undefined),\r\n                                enableReplacements: true,\r\n                                onFocus: function () { app.setIsInteracting(true); },\r\n                                onChange: function (value) {\r\n                                    components.forEach(function (c) { return c === null || c === void 0 ? void 0 : c.setState({ label: value }); });\r\n                                },\r\n                                onEnd: function (previous, final) {\r\n                                    app.setIsInteracting(false);\r\n                                    if (previous == final)\r\n                                        return;\r\n                                    g(\"UpdateAppearance\", \"Arrow::text\");\r\n                                    commandProcessor.execute(createUpdateCommand(arrows, \"label\", final));\r\n                                },\r\n                            },\r\n                        ],\r\n                    },\r\n                    {\r\n                        header: \"ChemText\",\r\n                        icon: \"subscript\",\r\n                        elements: [\r\n                            {\r\n                                spec: \"checkbox-group\",\r\n                                key: \"is_chem_mark_enabled\",\r\n                                label: ChemMark.uiDescription,\r\n                                wideLabel: true,\r\n                                checkboxes: [{\r\n                                        label: \"\",\r\n                                        useSwitch: true,\r\n                                        id: \"is_chem_mark_enabled\",\r\n                                        value: getConsistentValue(arrows, \"isChemMarkEnabled\"),\r\n                                        tier: \"boost\",\r\n                                        allowWhenLocked: true,\r\n                                        onCheckedChange: function (value) {\r\n                                            g(\"UpdateAppearance\", \"Arrow::ChemMark\");\r\n                                            commandProcessor.execute(createUpdateCommand(arrows, \"isChemMarkEnabled\", value));\r\n                                        }\r\n                                    }]\r\n                            },\r\n                            React.createElement(ChemMark.Hint, { key: \"chemmark_hint\", showUpgradeHint: (_b = getConsistentValue(arrows, \"isChemMarkEnabled\")) !== null && _b !== void 0 ? _b : false })\r\n                        ]\r\n                    }\r\n                ]\r\n            },\r\n            {\r\n                type: \"text-style\",\r\n                colorDot: getConsistentValue(arrows, \"textColor\"),\r\n                sections: [\r\n                    {\r\n                        header: \"Style\",\r\n                        icon: \"font\",\r\n                        elements: styleElements\r\n                    },\r\n                    {\r\n                        header: \"Arrow\",\r\n                        icon: \"long-arrow-alt-right\",\r\n                        elements: arrowSection,\r\n                    },\r\n                ]\r\n            }\r\n        ], (arrows.length > 1 ? sectionsForMultipleItems(selected, app).tabs : []))\r\n    };\r\n}\r\nvar TEXT_ALIGN_OPTIONS = [\"left\", \"center\", \"right\"];\r\nfunction textAlignToggleButtons(arrows) {\r\n    var consistentValue = getConsistentValue(arrows, \"textAlign\");\r\n    var currentIndex = consistentValue ? TEXT_ALIGN_OPTIONS.indexOf(consistentValue) : -1;\r\n    return {\r\n        spec: \"toggle-horizontal-buttons\",\r\n        highlightIndex: currentIndex,\r\n        key: \"textAlign\",\r\n        label: \"Text Align\",\r\n        size: \"small\",\r\n        tier: \"boost\",\r\n        buttons: TEXT_ALIGN_OPTIONS.map(function (align) {\r\n            return {\r\n                buttonLabel: align.capitalise(),\r\n                icon: \"align-\" + align,\r\n                onClick: function () {\r\n                    commandProcessor.execute(createUpdateCommand(arrows, \"textAlign\", align));\r\n                }\r\n            };\r\n        })\r\n    };\r\n}\r\n","import { setItemsRotation } from \"store/actions\";\r\nimport { appStore } from \"store/store\";\r\nvar RotateItems = /** @class */ (function () {\r\n    function RotateItems(values) {\r\n        var _this = this;\r\n        this.executeRotations = {};\r\n        this.undoRotations = {};\r\n        values.forEach(function (value) {\r\n            _this.executeRotations[value.id.id] = value.rotation;\r\n            _this.undoRotations[value.id.id] = value.originalRotation;\r\n        });\r\n    }\r\n    RotateItems.prototype.execute = function () {\r\n        appStore.dispatch(setItemsRotation(this.executeRotations));\r\n    };\r\n    RotateItems.prototype.undo = function () {\r\n        appStore.dispatch(setItemsRotation(this.undoRotations));\r\n    };\r\n    return RotateItems;\r\n}());\r\nexport { RotateItems };\r\n","var __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { breakPathClosed, setDefaultStyle, uniteAll } from \"apparatus/draw\";\r\nimport { P, Pivot, R } from \"apparatus/library/common\";\r\nimport { SVG } from \"apparatus/svg\";\r\nimport { Path, Shape } from \"paper\";\r\nexport function condenserCaseShape(height, sideletRadius, sidelets) {\r\n    if (sidelets === void 0) { sidelets = \"none\"; }\r\n    var inletRadius = 15;\r\n    var body = new Path.Rectangle(R(0, 0, 36, height, Pivot.TOP_CENTER), 20);\r\n    var inlet = new Path.Rectangle(R(0, 3, inletRadius, 23, Pivot.BOTTOM_CENTER));\r\n    var outlet = new Path.Rectangle(R(0, height - 3, inletRadius, 23, Pivot.TOP_CENTER));\r\n    var combinedShape = uniteAll(body, outlet, inlet);\r\n    var snap = [\r\n        { type: \"connectable\", at: P(0, height + 20), facing: 180 },\r\n        { type: \"connectable\", at: P(0, -20), facing: 0 },\r\n    ];\r\n    var graphic;\r\n    if (sidelets == \"none\") {\r\n        graphic = breakPathClosed(combinedShape, 4, 10);\r\n        return { group: graphic, snap: snap };\r\n    }\r\n    // Create sidelets.\r\n    var sidelet = new Path.Rectangle(R(0, 30, 50, sideletRadius, Pivot.CENTER_LEFT));\r\n    combinedShape = uniteAll(combinedShape, sidelet);\r\n    snap.push({ type: \"connectable\", at: P(50, 30), facing: 90 });\r\n    if (sidelets != \"top-only\") {\r\n        var sidelet2 = new Path.Rectangle(R(0, height - 30, 50, sideletRadius, sidelets == \"same\" ? Pivot.CENTER_LEFT : Pivot.CENTER_RIGHT));\r\n        combinedShape = uniteAll(combinedShape, sidelet2);\r\n        if (sidelets == \"same\") {\r\n            graphic = breakPathClosed(combinedShape, 4, 9, 13, 18);\r\n            snap.push({ type: \"connectable\", at: P(50, height - 30), facing: 90 });\r\n        }\r\n        else {\r\n            graphic = breakPathClosed(combinedShape, 3, 8, 13, 18);\r\n            snap.push({ type: \"connectable\", at: P(-50, height - 30), facing: 270 });\r\n        }\r\n    }\r\n    else {\r\n        graphic = breakPathClosed(combinedShape, 4, 9, 14);\r\n    }\r\n    return {\r\n        group: graphic,\r\n        snap: snap,\r\n    };\r\n}\r\nexport var CommonCondenser;\r\n(function (CommonCondenser) {\r\n    var NoPorts;\r\n    (function (NoPorts) {\r\n        NoPorts.defaultAppearance = {\r\n            height: 240\r\n        };\r\n        NoPorts.appearanceSpecs = [\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Height\",\r\n                min: 200, max: 350, unit: \"mm\"\r\n            }\r\n        ];\r\n    })(NoPorts = CommonCondenser.NoPorts || (CommonCondenser.NoPorts = {}));\r\n    CommonCondenser.defaultAppearance = {\r\n        ports: \"same\",\r\n        height: 240,\r\n    };\r\n    CommonCondenser.appearanceSpecs = __spreadArrays(NoPorts.appearanceSpecs, [\r\n        {\r\n            spec: \"radio\", key: \"ports\", label: \"Ports\",\r\n            options: [\r\n                { value: \"same\", label: \"Same side\" },\r\n                { value: \"opposite\", label: \"Opposite sides\", tier: \"boost\" },\r\n            ],\r\n            allowSelectingTierLockedOptions: true,\r\n        }\r\n    ]);\r\n    function isBoostRequiredForAppearance(appearance) {\r\n        return appearance.ports === \"opposite\";\r\n    }\r\n    CommonCondenser.isBoostRequiredForAppearance = isBoostRequiredForAppearance;\r\n})(CommonCondenser || (CommonCondenser = {}));\r\nvar FractionatingColumn = /** @class */ (function () {\r\n    function FractionatingColumn() {\r\n    }\r\n    FractionatingColumn.prototype.render = function (appearance) {\r\n        var graphic = SVG.fractionating();\r\n        graphic.scale(1.5);\r\n        setDefaultStyle(graphic);\r\n        var hitShape = Shape.Rectangle(graphic.bounds);\r\n        var snapping = { type: \"connectable\", at: P(77, 10.5), facing: 90 };\r\n        return { graphic: graphic, hitShape: hitShape, snapping: snapping };\r\n    };\r\n    FractionatingColumn.properties = {\r\n        label: \"Fractionating Column\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {},\r\n        appearanceSpecs: [],\r\n    };\r\n    return FractionatingColumn;\r\n}());\r\nexport { FractionatingColumn };\r\nvar AllihnCondenser = /** @class */ (function () {\r\n    function AllihnCondenser() {\r\n    }\r\n    AllihnCondenser.prototype.render = function (appearance) {\r\n        var graphic = SVG.allihn();\r\n        graphic.scale(1.5);\r\n        setDefaultStyle(graphic);\r\n        var hitShape = Shape.Rectangle(graphic.bounds);\r\n        return { graphic: graphic, hitShape: hitShape, snapping: LIEBIG_GRAHAM_ALLIHN_CONDENSER_SNAPPINGS };\r\n    };\r\n    AllihnCondenser.properties = {\r\n        label: \"Allihn Condenser\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {},\r\n        appearanceSpecs: [],\r\n    };\r\n    return AllihnCondenser;\r\n}());\r\nexport { AllihnCondenser };\r\nvar GrahamCondenser = /** @class */ (function () {\r\n    function GrahamCondenser() {\r\n    }\r\n    GrahamCondenser.prototype.render = function (appearance) {\r\n        var graphic = SVG.graham();\r\n        graphic.scale(1.5);\r\n        setDefaultStyle(graphic);\r\n        var hitShape = Shape.Rectangle(graphic.bounds);\r\n        return { graphic: graphic, hitShape: hitShape, snapping: LIEBIG_GRAHAM_ALLIHN_CONDENSER_SNAPPINGS };\r\n    };\r\n    GrahamCondenser.properties = {\r\n        label: \"Graham Condenser\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {},\r\n        appearanceSpecs: [],\r\n    };\r\n    return GrahamCondenser;\r\n}());\r\nexport { GrahamCondenser };\r\nexport var LIEBIG_GRAHAM_ALLIHN_CONDENSER_SNAPPINGS = [\r\n    { type: \"connectable\", at: P(51, 26.5), facing: 90 },\r\n    { type: \"connectable\", at: P(51, 200.5), facing: 90 },\r\n    { type: \"connectable\", at: P(8, -27), facing: 0 },\r\n    { type: \"connectable\", at: P(9.25, 247), facing: 180 },\r\n];\r\n","import { P, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar Sun = /** @class */ (function () {\r\n    function Sun() {\r\n    }\r\n    Sun.prototype.render = function (appearance) {\r\n        var sun = Shape.Circle(P(0, 0), 70);\r\n        sun.setRadialGradientFill([\r\n            [\"#face75\", 0.5],\r\n            [\"#face75aa\", 0.51],\r\n            [\"#face7500\", 1.0]\r\n        ]);\r\n        var graphic = new Group([sun]);\r\n        if (appearance.showRays) {\r\n            var arrow = new Group([\r\n                new Path.Line(P(50, 0), P(120, 0)),\r\n                new Path(Segments([[115, -5]], [[120, 0]], [[115, 5]])),\r\n            ]);\r\n            arrow.withStroke(3.0, \"#face75\");\r\n            var arrow1 = arrow.clone();\r\n            arrow1.position.y += 20;\r\n            var arrow2 = arrow.clone();\r\n            arrow2.position.y -= 20;\r\n            graphic.addChildren([arrow, arrow1, arrow2]);\r\n        }\r\n        graphic.scale(appearance.scale, P(0, 0));\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            pivot: P(0, 0)\r\n        };\r\n    };\r\n    Sun.properties = {\r\n        label: \"Sun\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            showRays: false,\r\n            scale: 1.0,\r\n        },\r\n        appearanceSpecs: [\r\n            { spec: \"checkbox\", key: \"showRays\", label: \"Rays\", subLabel: \"Show\" },\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.5, max: 1.5, step: 0.01, unit: \"%\",\r\n            }\r\n        ],\r\n    };\r\n    return Sun;\r\n}());\r\nexport { Sun };\r\n","import { mirrorX } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { lerp, P, Segments } from \"apparatus/library/common\";\r\nimport { Color, Gradient, Path, Point, Segment } from \"paper\";\r\nvar DEFLATED_SHAPE = Segments(\r\n// v1\r\n// [[39, 40],[-16, -6],[24, -3]],\r\n// [[48, -15],[25, 20],[-42, -2]],\r\n// v2\r\n// [[46, 29],[-33, 13],[22, 1]],\r\n// [[48, -15],[27, 13],[-45, -8]]\r\n// v3\r\n// [[42, 39],[-40, -28],[18, 13]],\r\n// [[48, -15],[18, 12],[-38, -26]],\r\n// v4\r\n[[40, 30], [-33, -7], [15, 3]], [[35, -30], [19, 4], [-40, -9]]);\r\nvar Balloon = /** @class */ (function () {\r\n    function Balloon() {\r\n    }\r\n    Balloon.isBoostRequiredForAppearance = function (appearance) {\r\n        return appearance.inflation < 1.0;\r\n    };\r\n    Balloon.prototype.render = function (appearance) {\r\n        var size = appearance.size * 10 / 1.833333;\r\n        var lipRadius = appearance.lipDiameter / 2;\r\n        var neckLength = appearance.neckLength;\r\n        var fillColor = appearance.color.color();\r\n        var strokeColor = fillColor.darken(0.4);\r\n        var graphic = new Path(Segments([[lipRadius, neckLength], , [5, 0]], [[lipRadius, neckLength - 5]], [[lipRadius, 0]], [[size * appearance.roundness, -size], [0, size / 70 * 40], [0, -size / 70 * 80]]));\r\n        mirrorX(graphic);\r\n        graphic.close();\r\n        graphic.withStroke(\"default\", strokeColor.hex());\r\n        interpolateSegment(graphic.segments[3], DEFLATED_SHAPE[0], 1.0 - appearance.inflation);\r\n        interpolateSegment(graphic.segments[4], DEFLATED_SHAPE[1], 1.0 - appearance.inflation);\r\n        graphic.fillColor = new Color(new Gradient(Gradients.simple(fillColor, -20), true), P(graphic.bounds.right * lerp(0.8, -0.7, appearance.inflation), graphic.bounds.top * 0.7), P(0, 0));\r\n        return {\r\n            graphic: graphic,\r\n            pivot: P(0, 0),\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    Balloon.properties = {\r\n        label: \"Balloon\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            size: 14,\r\n            neckLength: 20,\r\n            lipDiameter: 16,\r\n            roundness: 0.7,\r\n            color: \"#6ca5ba\",\r\n            inflation: 1.0,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 4, max: 25, step: 0.1, unit: \"cm\"\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"roundness\", label: \"Roundness\",\r\n                min: 0.5, max: 0.9, step: 0.01, tier: \"boost\"\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"neckLength\", label: \"Neck length\",\r\n                min: 15, max: 50, unit: \"mm\", tier: \"boost\"\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"lipDiameter\", label: \"Lip diameter\",\r\n                min: 10, max: 40, unit: \"mm\",\r\n            },\r\n            {\r\n                spec: \"color\", key: \"color\", label: \"Colour\",\r\n            },\r\n            // {\r\n            //     spec: \"slider\", key: \"inflation\", label: \"Air inflation\",\r\n            //     min: 0.0, max: 1.0, step: 0.01, unit: \"%\"\r\n            // },\r\n            {\r\n                spec: \"radio\", key: \"inflation\", label: \"Shape\",\r\n                options: [\r\n                    { value: 1.0, label: \"Inflated\" },\r\n                    { value: 0.81, label: \"Almost inflated\", tier: \"boost\" },\r\n                    { value: 0.42, label: \"Semi-inflated\", tier: \"boost\" },\r\n                    { value: 0.08, label: \"Deflated\", tier: \"boost\" },\r\n                ],\r\n                allowSelectingTierLockedOptions: true,\r\n            }\r\n        ],\r\n    };\r\n    return Balloon;\r\n}());\r\nexport { Balloon };\r\n/** Interpolate between 2 segments. Assumes that both handleIn and handleOut are set.  */\r\nfunction interpolateSegment(from, to, ratio) {\r\n    var newSegment = new Segment(interpolatePointLinear(from.point, to.point, ratio), interpolatePointPolar(from.handleIn, to.handleIn, ratio), interpolatePointPolar(from.handleOut, to.handleOut, ratio));\r\n    from.handleIn = newSegment.handleIn;\r\n    from.handleOut = newSegment.handleOut;\r\n    from.point = newSegment.point;\r\n    return newSegment;\r\n}\r\nfunction interpolatePointLinear(start, end, ratio) {\r\n    return P(lerp(start.x, end.x, ratio), lerp(start.y, end.y, ratio));\r\n}\r\nfunction interpolatePointPolar(start, end, ratio) {\r\n    var point = new Point([0, 1]);\r\n    point.angle = lerp(start.angle, end.angle + (end.angle < 0 ? 360 : 0), ratio);\r\n    point.length = lerp(start.length, end.length, ratio);\r\n    return point;\r\n}\r\n/**\r\n * Deflated shape, original.\r\n * [[40, -20],[-29, -7],[23, 6]],\r\n * [[76, 30],[1, -19],[-1, 21]],\r\n * [[35, 32],[8, 15],[-10, -18]],\r\n */\r\n/**\r\n * Deflated shape. 2 points only.\r\n * [[40, -19],[-29, -6],[20, 4]],\r\n * [[35, 32],[20, 0],[-21, 0]],\r\n */ \r\n","import { setDefaultStyle } from \"apparatus/draw\";\r\nimport { Segments } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nimport { addEdgeLips, smoothCorner } from \"../draw\";\r\nvar ThieleTube = /** @class */ (function () {\r\n    function ThieleTube() {\r\n    }\r\n    ThieleTube.prototype.render = function (appearance) {\r\n        var outer = new Path(Segments([[0, 0]], [[0, 130], undefined, [3, 15]], [[30, 130], [-10, 5]], [[100, 90]], [[25, 50]], [[25, 0]]));\r\n        smoothCorner(outer.segments[3], 30.0);\r\n        addEdgeLips(outer);\r\n        var inner = new Path(Segments([[25, 62]], [[80, 90]], [[25, 118]]));\r\n        inner.closePath();\r\n        smoothCorner(inner.segments[1], 15.0);\r\n        var tube = outer.subtract(inner);\r\n        tube.scale(appearance.scale);\r\n        var hitShape = outer.clone();\r\n        outer.scale(appearance.scale);\r\n        var liquidMask = tube;\r\n        var graphic = new Group([inner, outer]);\r\n        setDefaultStyle(graphic);\r\n        return { graphic: graphic, hitShape: hitShape, liquidMask: liquidMask };\r\n    };\r\n    ThieleTube.properties = {\r\n        label: \"Thiele Tube\",\r\n        canContainLiquids: true,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            scale: 1.0,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.7, max: 1.5, step: 0.05,\r\n            }\r\n        ],\r\n    };\r\n    return ThieleTube;\r\n}());\r\nexport { ThieleTube };\r\n","import { SVG } from \"apparatus/svg\";\r\nvar Goggles = /** @class */ (function () {\r\n    function Goggles() {\r\n    }\r\n    Goggles.prototype.render = function (appearance) {\r\n        var graphic = SVG.goggles();\r\n        graphic.scale(1.8 * appearance.scale);\r\n        return { graphic: graphic, hitShape: graphic.bounds.toShape() };\r\n    };\r\n    Goggles.properties = {\r\n        label: \"Goggles\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            scale: 1.0\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.5, max: 3, step: 0.1\r\n            }\r\n        ],\r\n    };\r\n    return Goggles;\r\n}());\r\nexport { Goggles };\r\n","import { addEdgeLipsReversed, mirrorX, setDefaultStyle } from \"apparatus/draw\";\r\nimport * as p from \"paper\";\r\nimport { Segments, SharedColors } from \"./common\";\r\nvar VolumetricFlask = /** @class */ (function () {\r\n    function VolumetricFlask() {\r\n    }\r\n    VolumetricFlask.prototype.render = function (appearance) {\r\n        var neckRadius = 10;\r\n        var flask = new p.Path(Segments([[neckRadius, 0]], [[neckRadius, 160], undefined, [0, 5]], [[55, 225], [-6, -24], [4, 16]], [[32, 260], [10, 0]]));\r\n        mirrorX(flask);\r\n        flask.scale(appearance.size / 260);\r\n        var hitShape = flask.clone();\r\n        var liquidMask = flask.clone();\r\n        addEdgeLipsReversed(flask);\r\n        setDefaultStyle(flask);\r\n        var spiritLine = new p.Path(Segments([[-7, 100]], [[7, 100]]));\r\n        spiritLine.strokeColor = SharedColors.mark;\r\n        spiritLine.strokeWidth = 2.0;\r\n        spiritLine.strokeCap = \"butt\";\r\n        var scale = appearance.size / 260;\r\n        spiritLine.scale(scale, flask.bounds.center);\r\n        var graphic = new p.Group([flask, spiritLine]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShape,\r\n            liquidMask: liquidMask,\r\n            snapping: [\r\n                { type: \"placeable\", at: graphic.bounds.bottomCenter },\r\n                { type: \"neck\", top: graphic.bounds.topCenter, diameter: neckRadius * 2 * scale, facing: 0 }\r\n            ]\r\n        };\r\n    };\r\n    VolumetricFlask.properties = {\r\n        label: \"VolumetricFlask\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            size: 260\r\n        },\r\n        appearanceSpecs: [{\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 180, max: 500,\r\n            }],\r\n    };\r\n    return VolumetricFlask;\r\n}());\r\nexport { VolumetricFlask };\r\n","var __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, Pivot, R, Segments, SharedGradients } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar ORANGE_CYLINDER = Gradients.cylinder(\"#e8a271\".color());\r\nvar BLACK_CYLINDER = Gradients.cylinder(\"#444444\".color());\r\nvar ORANGE_BOX = Gradients.box(\"#e8a271\".color());\r\nvar BLACK_BOX = Gradients.box(\"#444444\".color());\r\nvar Battery = /** @class */ (function () {\r\n    function Battery() {\r\n    }\r\n    Battery.prototype.render = function (appearance) {\r\n        var scale = appearance.scale;\r\n        var strokeWidth = Math.min(5.0, 2.0 * scale);\r\n        var graphic = (function () {\r\n            switch (appearance.type) {\r\n                case \"aa\": return batteryCylinder(15, 51, strokeWidth);\r\n                case \"aaa\": return batteryCylinder(11, 45, strokeWidth);\r\n                case \"c\": return batteryCylinder(26, 50, strokeWidth);\r\n                case \"d\": return batteryCylinder(34, 62, strokeWidth);\r\n                case \"pp3\": return batteryRectangle(27, 49, strokeWidth, \"terminal\");\r\n                case \"4.5v\": return batteryRectangle(62, 67, strokeWidth, \"strip\");\r\n                case \"lantern6v\": return batteryRectangle(68, 115, strokeWidth, \"spring\");\r\n            }\r\n        })();\r\n        graphic.scale(appearance.scale);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.expand(10).toShape()\r\n        };\r\n    };\r\n    Battery.properties = {\r\n        label: \"Battery\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            scale: 1.0,\r\n            type: \"aa\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 1.0, max: 4.0, step: 0.1, unit: \"%\",\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"type\", label: \"Battery Type\",\r\n                options: [\r\n                    { value: \"aa\", label: \"AA (1.5V)\" },\r\n                    { value: \"aaa\", label: \"AAA (1.5V)\" },\r\n                    { value: \"pp3\", label: \"PP3 (9V)\" },\r\n                    { value: \"c\", label: \"C (1.5V)\" },\r\n                    { value: \"d\", label: \"D (1.5V)\" },\r\n                    { value: \"4.5v\", label: \"4.5V\" },\r\n                    { value: \"lantern6v\", label: \"Lantern (6V)\" },\r\n                ],\r\n            }\r\n        ],\r\n    };\r\n    return Battery;\r\n}());\r\nexport { Battery };\r\nfunction batteryCylinder(width, height, strokeWidth) {\r\n    var orangeBitHeight = height * 0.3;\r\n    var up = Shape.Rectangle(R(0, 0, width, orangeBitHeight, Pivot.TOP_CENTER), 2.0);\r\n    var below = Shape.Rectangle(R(0, orangeBitHeight - 4, width, height - orangeBitHeight + 4, Pivot.TOP_CENTER), 2.0);\r\n    var tip = Shape.Rectangle(R(0, 2, 6, 4, Pivot.BOTTOM_CENTER), 1);\r\n    var outline = up.toPath(false).unite(below.toPath(false)).unite(tip.toPath(false));\r\n    up.withGradientFill(\"right\", ORANGE_CYLINDER);\r\n    up.position.y += 0.5;\r\n    below.withGradientFill(\"right\", BLACK_CYLINDER);\r\n    tip.withGradientFill(\"right\", SharedGradients.cylinderMetal);\r\n    outline.withStroke(strokeWidth, \"#333333\");\r\n    return new Group([tip, below, up, outline]);\r\n}\r\nfunction batteryRectangle(width, height, strokeWidth, top) {\r\n    var orangeBitHeight = width * 0.32;\r\n    var extrasPre = [];\r\n    var extrasPost = [];\r\n    var up = Shape.Rectangle(R(0, 0, width, orangeBitHeight, Pivot.TOP_CENTER), 2.0);\r\n    var below = Shape.Rectangle(R(0, orangeBitHeight - 4, width, height - orangeBitHeight + 4, Pivot.TOP_CENTER), 2.0);\r\n    var outline = up.toPath(false)\r\n        .unite(below.toPath(false));\r\n    if (top == \"terminal\") {\r\n        var tip = Shape.Rectangle(R(-7, 2, 5, 4, Pivot.BOTTOM_CENTER), 0);\r\n        var tip2 = Shape.Rectangle(R(-7, -1, 7, 2, Pivot.BOTTOM_CENTER), 0);\r\n        var tip3 = Shape.Rectangle(R(8, 2, 6, 4, Pivot.BOTTOM_CENTER), 1);\r\n        outline = outline.unite(tip.toPath(false))\r\n            .unite(tip2.toPath(false))\r\n            .unite(tip3.toPath(false));\r\n        tip.withGradientFill(\"right\", SharedGradients.cylinderMetal);\r\n        tip2.withGradientFill(\"right\", SharedGradients.cylinderMetal);\r\n        tip3.withGradientFill(\"right\", SharedGradients.cylinderMetal);\r\n        extrasPre.push(tip, tip2, tip3);\r\n    }\r\n    up.withGradientFill(\"right\", ORANGE_BOX);\r\n    up.position.y += 0.5;\r\n    below.withGradientFill(\"right\", BLACK_BOX);\r\n    if (top == \"strip\") {\r\n        var leftStrip = new Path.Line(P(-width / 2 + 3, -0.5), P(2, -5)).withStroke(strokeWidth * 1.5, \"#333333\");\r\n        leftStrip.strokeCap = \"round\";\r\n        var rightStrip = new Path.Line(P(width / 2 - 3, -0.5), P(7, -5)).withStroke(strokeWidth * 1.5, \"#333333\");\r\n        rightStrip.strokeCap = \"round\";\r\n        extrasPost.push(leftStrip, rightStrip);\r\n    }\r\n    else if (top == \"spring\") {\r\n        var spring = new Path(Segments([[0, 0], [0, 2.5], [0, -2.5]], [[8, -3], [0, 2.5], [0, -2.5]], [[0, -6], [0, 2.5], [0, -2.5]], [[8, -9], [0, 2.5], [0, -2.5]], [[0, -12], [0, 2.5], [0, -2.5]]));\r\n        spring.withStroke(strokeWidth, \"#333333\");\r\n        var spring2 = spring.clone();\r\n        spring.position.x = -4;\r\n        spring2.position.x = width / 2 - 11;\r\n        extrasPost.push(spring, spring2);\r\n    }\r\n    outline.withStroke(strokeWidth, \"#333333\");\r\n    return new Group(__spreadArrays(extrasPre, [below, up, outline], extrasPost));\r\n}\r\n","import { strokeWidth } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { Interpolator, P, Pivot, R } from \"apparatus/library/common\";\r\nimport \"ext/color\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nimport { Random } from \"random/random\";\r\nvar BASE_COLOR = \"#e29866\".color();\r\nvar CorkRing = /** @class */ (function () {\r\n    function CorkRing() {\r\n        /** Older version for calculating the diameter of the circular cutout. */\r\n        this.diameterInterpolator = new Interpolator([80, 210], [80, 320]);\r\n        this.cutoutOffsetInterpolator = new Interpolator([80, 210], [8, 16]);\r\n    }\r\n    CorkRing.prototype.render = function (appearance) {\r\n        var width = appearance.width;\r\n        var base = new Path.Rectangle(R(0, 0, width, 30, Pivot.BOTTOM_CENTER), 2.0);\r\n        var shape;\r\n        if (appearance.crossSection) {\r\n            // Calculate the circular hole cutout as follows:\r\n            // https://math.stackexchange.com/questions/564058/calculate-the-radius-of-a-circle-given-the-chord-length-and-height-of-a-segment\r\n            // where h = 30 - 8 = 22\r\n            // and l = width - (some small offset)\r\n            var h = 22, l = width - this.cutoutOffsetInterpolator.interpolate(width);\r\n            var radius = (4 * h * h + l * l) / (8 * h);\r\n            var hole1 = new Path.Rectangle(R(0, 10, width - 50, 50, Pivot.BOTTOM_CENTER));\r\n            var hole2 = new Path.Circle(P(0, -8 - radius), radius);\r\n            shape = base.subtract(hole1).subtract(hole2);\r\n        }\r\n        else {\r\n            shape = base;\r\n        }\r\n        var graphic = applyCorkTexture(shape);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: [\r\n                { type: \"placeable_surface\", start: P(-1, -8), end: P(1, -8) },\r\n                graphic.placeable(),\r\n            ],\r\n            watermark: P(width / 2, -5)\r\n        };\r\n    };\r\n    CorkRing.properties = {\r\n        label: \"Cork ring\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            width: 120,\r\n            crossSection: false\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"width\", label: \"Width\",\r\n                min: 80, max: 210, unit: \"mm\"\r\n            },\r\n            {\r\n                spec: \"checkbox\", key: \"crossSection\", label: \"Cross-section\", subLabel: \"Show\"\r\n            }\r\n        ],\r\n    };\r\n    return CorkRing;\r\n}());\r\nexport { CorkRing };\r\n/**\r\n * Creates a cork-looking object from input of plain shapes.\r\n * Output contains the original input shape, modified.\r\n */\r\nfunction applyCorkTexture(shape) {\r\n    var r = new Random(166212);\r\n    var mask = shape.clone();\r\n    // Create a clipped group, containing the cork texture\r\n    var corkLayer = new Group([mask]);\r\n    corkLayer.clipped = true;\r\n    // Generate cork texture\r\n    for (var x = mask.bounds.left; x < mask.bounds.right; x += 20) {\r\n        for (var y = mask.bounds.top; y < mask.bounds.bottom; y += 20) {\r\n            var size = r.randomUnitValue(2.0) + 4.0;\r\n            var corkSpot = Shape.Circle(P(x, y).add(r.randomUnitVector(8.0)), size);\r\n            corkSpot.fillColor = \"#00000010\";\r\n            corkLayer.addChild(corkSpot);\r\n        }\r\n    }\r\n    // Set up shape.\r\n    shape.setGradientFill(\"right\", Gradients.cylinder(BASE_COLOR));\r\n    shape.withStroke(strokeWidth(\"default\"), BASE_COLOR.ladd(-20).sadd(-20).hex());\r\n    // Assemble.\r\n    var finalGroup = new Group([shape, corkLayer]);\r\n    return finalGroup;\r\n}\r\n","import * as Sentry from '@sentry/react';\r\nimport rawVersion from \"version\";\r\nimport { Consts } from \"./vars\";\r\n// Set up various libraries and plugins\r\n// Sentry\r\nif (Consts.isProd) {\r\n    Sentry.init({\r\n        dsn: Consts.sentryDsn,\r\n        release: rawVersion,\r\n        environment: Consts.isDev ? \"Dev\" : (Consts.isBeta ? \"Beta\" : \"Prod\")\r\n    });\r\n}\r\n// Toastr\r\nexport function setUpToastr() {\r\n    toastr.options.positionClass = \"toast-bottom-center\";\r\n    toastr.options.timeOut = 5000;\r\n    toastr.options.extendedTimeOut = 4000;\r\n    toastr.options.showDuration = 200;\r\n    toastr.options.hideDuration = 400;\r\n    toastr.options.showEasing = \"linear\";\r\n    toastr.options.hideEasing = \"linear\";\r\n    toastr.options.showMethod = \"fadeIn\";\r\n    toastr.options.hideMethod = \"fadeOut\";\r\n    toastr.options.preventDuplicates = true;\r\n}\r\n","/** Lightweight implementation of querystring */\r\nexport var querystring;\r\n(function (querystring) {\r\n    querystring.stringify = function (obj) {\r\n        if (!obj) {\r\n            return \"\";\r\n        }\r\n        var arrayFormatter = function (key, value) {\r\n            return value === null\r\n                ? encode(key)\r\n                : [encode(key), \"=\", encode(value)].join(\"\");\r\n        };\r\n        return Object.keys(obj)\r\n            .map(function (key) {\r\n            var val = obj[key];\r\n            if (val === undefined) {\r\n                return \"\";\r\n            }\r\n            if (val === null) {\r\n                return encode(key);\r\n            }\r\n            if (Array.isArray(val)) {\r\n                var result = [];\r\n                val.slice().forEach(function (val2) {\r\n                    if (val2 === undefined) {\r\n                        return;\r\n                    }\r\n                    result.push(arrayFormatter(key, val2));\r\n                });\r\n                return result.join(\"&\");\r\n            }\r\n            return encode(key) + \"=\" + encode(val);\r\n        })\r\n            .filter(function (x) {\r\n            return x.length > 0;\r\n        })\r\n            .join(\"&\");\r\n    };\r\n})(querystring || (querystring = {}));\r\nfunction encode(value) {\r\n    return strictUriEncode(value);\r\n}\r\nfunction strictUriEncode(str) {\r\n    return encodeURIComponent(str).replace(/[!'()*]/g, function (x) {\r\n        return \"%\" + x\r\n            .charCodeAt(0)\r\n            .toString(16)\r\n            .toUpperCase();\r\n    });\r\n}\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { Icon } from \"components/icon\";\r\nimport Flags from \"flags\";\r\nimport * as React from \"react\";\r\nimport { selectTool } from \"tools\";\r\nimport { Consts } from \"vars\";\r\nimport { formatTooltip } from \"../../view/tooltips\";\r\nvar toolMenuItems = [\r\n    {\r\n        name: \"select\",\r\n        icon: \"mouse-pointer\",\r\n        hint: \"Select & Move Items\",\r\n        shortcuts: [{ key: \"1\" }, { key: \"V\" }]\r\n    },\r\n    {\r\n        name: \"pan\",\r\n        icon: \"arrows-alt\",\r\n        hint: \"Pan workspace\",\r\n        shortcuts: [{ key: \"2\" }, { key: \"P\" }]\r\n    },\r\n    {\r\n        name: \"arrow\",\r\n        icon: \"font\",\r\n        hint: \"Label diagram <br/>with text and arrows\",\r\n        shortcuts: [{ key: \"3\" }, { key: \"T\" }]\r\n    },\r\n];\r\nif (Flags.isFreeHandToolEnabled) {\r\n    toolMenuItems.push({\r\n        name: \"freehand\",\r\n        icon: \"pencil-alt\",\r\n        hint: \"Draw an item by hand\",\r\n        shortcuts: [{ key: \"4\" }, { key: \"D\" }]\r\n    });\r\n}\r\nif (Consts.isDev) {\r\n    toolMenuItems.push({\r\n        name: \"pathedit\",\r\n        icon: \"bezier-curve\",\r\n        hint: \"Edit paths. DEV ONLY\",\r\n        shortcuts: []\r\n    });\r\n}\r\n/**\r\n * Toolbox is a button group that allows the user\r\n * to select a tool. Unlike a regular \"group of buttons\",\r\n * toolbox highlights the currently selected tool and only\r\n * one tool can be selected.\r\n */\r\nexport var Toolbox = function (props) { return (React.createElement(\"div\", { id: \"toolbox\", className: \"toolboxGroup\", key: \"toolbox\" }, toolMenuItems.map(function (i) { return React.createElement(Item, __assign({ key: i.name }, i, { active: props.tool === i.name })); }))); };\r\nvar Item = function (item) { return (React.createElement(\"div\", { key: item.name, id: \"tool-\" + item.name, className: item.active ? \"active\" : \"\", onClick: function () { return selectTool(item.name, \"click\"); }, title: formatTooltip(item.hint, item.shortcuts) },\r\n    React.createElement(Icon, { name: item.icon, fullWidth: true }))); };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { addEdgeLips, breakPath, glassFold, setDefaultStyle, smoothCorner } from \"apparatus/draw\";\r\nimport { DEFAULT_LIQUID_DATA, P, Segments } from \"apparatus/library/common\";\r\nimport { createTap, Tap } from \"apparatus/library/common/tap\";\r\nimport { Path } from \"paper\";\r\nvar DeanStarTrap = /** @class */ (function () {\r\n    function DeanStarTrap() {\r\n    }\r\n    DeanStarTrap.prototype.render = function (appearance) {\r\n        var bottomPart = [\r\n            [[-10, 76]],\r\n            [[-10, 150], , [0, 10]],\r\n            [[-5, 200], [0, -40]],\r\n            [[5, 200], , [0, -40]],\r\n            [[10, 150], [0, 10]]\r\n        ];\r\n        var basicShape = new Path(Segments.apply(void 0, __spreadArrays([[[-10, 0]],\r\n            [[-10, 57]],\r\n            [[-107, 85]],\r\n            [[-107, 142], , [-3, 0]],\r\n            [[-105, 172]],\r\n            [[-91, 172]],\r\n            [[-89, 142], [3, 0]],\r\n            [[-89, 99]]], bottomPart, [[[10, 0]]])));\r\n        var liquidMask = new Path(Segments.apply(void 0, __spreadArrays(bottomPart, [[[10, 76]]])));\r\n        smoothCorner(basicShape.segments[8], 4);\r\n        smoothCorner(basicShape.segments[7], 4);\r\n        smoothCorner(basicShape.segments[2], 10);\r\n        smoothCorner(basicShape.segments[1], 4);\r\n        addEdgeLips(basicShape);\r\n        var graphic = breakPath(basicShape, 8, 16);\r\n        setDefaultStyle(graphic);\r\n        // Add a glass fold at the T-junction.\r\n        graphic.addChild(glassFold(-8, 67, { rotation: -90 }));\r\n        // Add a tap.\r\n        var tap = createTap(appearance.tapOpening);\r\n        graphic.addChild(tap);\r\n        tap.position = P(0, 165);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            liquidMask: liquidMask,\r\n            pivot: basicShape.bounds.center\r\n        };\r\n    };\r\n    DeanStarTrap.properties = {\r\n        label: \"Dean-Stark Trap\",\r\n        canContainLiquids: true,\r\n        flippable: true,\r\n        defaultAppearance: __assign({}, Tap.defaultAppearance),\r\n        appearanceSpecs: [\r\n            Tap.appearanceSpec,\r\n        ],\r\n        defaultLiquidData: __assign(__assign({}, DEFAULT_LIQUID_DATA), { amountRatio: 0.75 })\r\n    };\r\n    return DeanStarTrap;\r\n}());\r\nexport { DeanStarTrap };\r\n","export function currencySymbol(currency) {\r\n    switch (currency) {\r\n        case \"gbp\": return \"\";\r\n        case \"eur\": return \"\";\r\n        case \"usd\": return \"$\";\r\n        case \"aud\": return \"A$\";\r\n        case \"sgd\": return \"S$\";\r\n        case \"mxn\": return \"Mex$\";\r\n        case \"cop\": return \"$\";\r\n    }\r\n}\r\nexport function currencyLabel(currency) {\r\n    switch (currency) {\r\n        case \"gbp\": return \"British Pound - GBP\";\r\n        case \"eur\": return \"Euro - EUR\";\r\n        case \"usd\": return \"US Dollar - USD\";\r\n        case \"aud\": return \"Australian Dollar - AUD\";\r\n        case \"sgd\": return \"Singapore Dollar - SGD\";\r\n        case \"mxn\": return \"Peso Mexicano - MXN\";\r\n        case \"cop\": return \"Peso Colombiano  - COP\";\r\n    }\r\n}\r\n/**\r\n * Converts an ISO Country code to the currency they use.\r\n * https://en.wikipedia.org/wiki/List_of_ISO_3166_country_codes\r\n * Or http://country.io/names.json\r\n */\r\nexport function countryCodeToCurrency(country) {\r\n    switch (country) {\r\n        case \"GB\":\r\n            return \"gbp\";\r\n        case \"AT\":\r\n        case \"BE\":\r\n        case \"CY\":\r\n        case \"EE\":\r\n        case \"FI\":\r\n        case \"FR\":\r\n        case \"DE\":\r\n        case \"GR\":\r\n        case \"IE\":\r\n        case \"IT\":\r\n        case \"LV\":\r\n        case \"LT\":\r\n        case \"LU\":\r\n        case \"MT\":\r\n        case \"NL\":\r\n        case \"PT\":\r\n        case \"SK\":\r\n        case \"SI\":\r\n        case \"ES\":\r\n            return \"eur\";\r\n        case \"AU\":\r\n            return \"aud\";\r\n        case \"SG\":\r\n            return \"sgd\";\r\n        case \"MX\":\r\n            return \"mxn\";\r\n        case \"CO\":\r\n            return \"cop\";\r\n        default:\r\n            return \"usd\";\r\n    }\r\n}\r\n","import { P, R, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nvar BAFFLE_COLOR = \"#999999\";\r\nvar FumeHood = /** @class */ (function () {\r\n    function FumeHood() {\r\n    }\r\n    FumeHood.prototype.render = function (appearance) {\r\n        var strokeThickness = 10.0;\r\n        var sashHeight = 600;\r\n        var sashSlide = appearance.sashOpening * 0.95 * sashHeight;\r\n        var fumeX = 430;\r\n        var outer1 = new Path(Segments([[0, 620]], [[-5, 620]], [[-30, 580]], [[-30, 0]], [[fumeX, 0]], [[fumeX, -100]])).withStroke(strokeThickness, SharedColors.stroke);\r\n        outer1.strokeCap = \"butt\";\r\n        var outer2 = new Path(Segments([[fumeX + 80, -100]], [[fumeX + 80, 0]], [[600, 0]], [[600, 1200]])).withStroke(strokeThickness, SharedColors.stroke);\r\n        var baffle1 = new Path.Line(P(100, 20), P(500, 350)).withStroke(\"thick\", BAFFLE_COLOR);\r\n        var baffle2 = new Path.Line(P(550, 400), P(550, 750)).withStroke(\"thick\", BAFFLE_COLOR);\r\n        var baffle3 = new Path.Line(P(550, 800), P(550, 1150)).withStroke(\"thick\", BAFFLE_COLOR);\r\n        var sash = new Path.Rectangle(R(1, 1200 - sashHeight - strokeThickness / 2, 10, sashHeight), 3.0)\r\n            .withStroke(\"thinner\", \"#56acd1\").withFill(\"#7bcbed50\");\r\n        sash.position.y -= sashSlide;\r\n        var workbench = new Path.Rectangle(R(0, 1200, 600, 200))\r\n            .withStroke(strokeThickness, SharedColors.stroke)\r\n            .withFill(\"#777777\");\r\n        var fumeHood = new Group([outer1, outer2, baffle1, baffle2, baffle3, sash, workbench]);\r\n        var graphic;\r\n        switch (appearance.display) {\r\n            case \"full\":\r\n                graphic = fumeHood;\r\n                break;\r\n            case \"clipped\":\r\n                var mask = new Path.Rectangle(R(-50, 500, 700, 800));\r\n                var faders = mask.clone();\r\n                mask.withFill(\"black\");\r\n                faders.setGradientFill(\"down\", [\r\n                    [\"#ffffffff\", 0.0],\r\n                    [\"#ffffff00\", 0.05],\r\n                    [\"#ffffff00\", 0.95],\r\n                    [\"#ffffffff\", 1.0],\r\n                ]);\r\n                graphic = new Group([mask, fumeHood, faders]);\r\n                graphic.clipped = true;\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            pivot: fumeHood.bounds.center,\r\n            snapping: [\r\n                { type: \"placeable_surface\", start: workbench.strokeBounds.topLeft, end: workbench.strokeBounds.topRight }\r\n            ]\r\n        };\r\n    };\r\n    FumeHood.properties = {\r\n        label: \"Fume Hood\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            sashOpening: 0.5,\r\n            display: \"clipped\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"display\", label: \"Display\",\r\n                options: [\r\n                    { value: \"full\", label: \"Full\" },\r\n                    { value: \"clipped\", label: \"Clipped\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"sashOpening\", label: \"Sash Opening\",\r\n                min: 0.0, max: 1.0, step: 0.01,\r\n            }\r\n        ],\r\n    };\r\n    return FumeHood;\r\n}());\r\nexport { FumeHood };\r\n","import { breakPath, setDefaultStyle, smoothCorner } from \"apparatus/draw\";\r\nimport { DEFAULT_LIQUID_DATA, P, Segments } from \"apparatus/library/common\";\r\nimport { Path } from \"paper\";\r\nvar Potometer = /** @class */ (function () {\r\n    function Potometer() {\r\n    }\r\n    Potometer.prototype.render = function (appearance) {\r\n        var length = appearance.length;\r\n        var path = new Path(Segments([[0, -80]], [[0, 0]], [[130 + length, 0]], [[130 + length, 35]], [[130 + length + 10, 35]], [[130 + length + 10, -10]], [[120, -10]], [[120, -50]], [[130, -70], [0, 10]], [[130, -120]], [[100, -120]], [[100, -70], , [0, 10]], [[110, -50]], [[110, -10]], [[50, -10]], [[50, -80]]));\r\n        smoothCorner(path.segments[14], 5);\r\n        smoothCorner(path.segments[5], 10);\r\n        smoothCorner(path.segments[2], 5);\r\n        smoothCorner(path.segments[1], 10);\r\n        var liquid = path.clone();\r\n        var hitShape = path.clone();\r\n        var graphic = breakPath(path, 6, 13);\r\n        setDefaultStyle(graphic);\r\n        // Adjust the liquid level\r\n        liquid.segments[13].point.y += 10;\r\n        liquid.segments[12].point.y += 10;\r\n        liquid.fillColor = DEFAULT_LIQUID_DATA.color.color().alpha(DEFAULT_LIQUID_DATA.alpha).string();\r\n        graphic.insertChild(0, liquid);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShape,\r\n            watermark: P(-5, -10)\r\n        };\r\n    };\r\n    Potometer.properties = {\r\n        label: \"Potometer\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            length: 160\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"length\", label: \"Length\",\r\n                min: 100, max: 300, unit: \"mm\"\r\n            }\r\n        ],\r\n    };\r\n    return Potometer;\r\n}());\r\nexport { Potometer };\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { clog } from \"log\";\r\n// Implementation of commands - undoable operations on the application store. */\r\nvar DEBUG = false;\r\nvar MAX_UNDOS = 50;\r\nvar CommandProcessor = /** @class */ (function () {\r\n    function CommandProcessor() {\r\n        /** Undo stack. Items should be pushed and popped. */\r\n        this.undoStack = [];\r\n        /** Red stack. Items should be pushed and popped. */\r\n        this.redoStack = [];\r\n        /** Whether current change are dirty. */\r\n        this.isDirty = false;\r\n    }\r\n    /**\r\n     * Executes a command. The command will be placed onto the undo stack.\r\n     * Redo stack is cleared. If a sequence is being recorded, the command\r\n     * is executed and added to the current sequence.\r\n     */\r\n    CommandProcessor.prototype.execute = function (command) {\r\n        command.execute();\r\n        if (DEBUG)\r\n            clog(\"Command:\", command);\r\n        if (this.recordingCommands) {\r\n            this.recordingCommands.push(command);\r\n        }\r\n        else {\r\n            this.pushToUndoStack(command);\r\n        }\r\n        // Destroy the redo stack.\r\n        this.redoStack.length = 0;\r\n        this.markDirty();\r\n    };\r\n    /**\r\n     * Executes a command, potentially replacing last command on the undo stack.\r\n     * @param replaceCommmand Returns a command to replace the last command, {@code false) otherwise\r\n     * @param newCommand Default new command if there is no command to replace.\r\n     */\r\n    CommandProcessor.prototype.executeReplacingLastCommand = function (replaceCommand, newCommand) {\r\n        if (this.undoStack.length == 0) {\r\n            this.execute(newCommand);\r\n            return;\r\n        }\r\n        var lastCommand = this.undoStack[this.undoStack.length - 1];\r\n        var maybeNewCommand = replaceCommand(lastCommand);\r\n        if (maybeNewCommand) {\r\n            // Replace the last command on the undo stack.\r\n            lastCommand.undo();\r\n            this.undoStack.pop();\r\n            this.execute(maybeNewCommand);\r\n        }\r\n        else {\r\n            this.execute(newCommand);\r\n        }\r\n    };\r\n    /**\r\n     * Starts recording a sequence of commands. All commands executed using execute() will be\r\n     * added to the sequence. The sequence is then put on the undo queue when calling finishRecording()\r\n     */\r\n    CommandProcessor.prototype.startRecording = function () {\r\n        if (this.recordingCommands) {\r\n            throw new Error(\"Command processor: already recording a sequence\");\r\n        }\r\n        this.recordingCommands = [];\r\n    };\r\n    /**\r\n     * Finishes recording current sequence and places all commands executed while recording onto\r\n     * the undo stack as a single command.\r\n     */\r\n    CommandProcessor.prototype.finishRecording = function () {\r\n        if (!this.recordingCommands) {\r\n            // TODO: We used to throw an error but this is too spammy. Reinvestigate if needed.\r\n            // throw new Error(\"Command processor: not currently recording a sequence\")\r\n            return;\r\n        }\r\n        switch (this.recordingCommands.length) {\r\n            case 0:\r\n                break;\r\n            case 1:\r\n                this.pushToUndoStack(this.recordingCommands[0]);\r\n                break;\r\n            default:\r\n                var sequence = new Sequence(this.recordingCommands);\r\n                this.pushToUndoStack(sequence);\r\n        }\r\n        this.recordingCommands = undefined;\r\n    };\r\n    /**\r\n     * Performs an undo.\r\n     * @returns false if the undo stack is empty.\r\n     */\r\n    CommandProcessor.prototype.undo = function () {\r\n        var command = this.undoStack.pop();\r\n        if (!command)\r\n            return false;\r\n        command.undo();\r\n        this.redoStack.push(command);\r\n        return true;\r\n    };\r\n    /**\r\n     * Performs a redo.\r\n     * @returns false if the redo stack is empty\r\n     */\r\n    CommandProcessor.prototype.redo = function () {\r\n        var command = this.redoStack.pop();\r\n        if (!command)\r\n            return false;\r\n        command.execute();\r\n        this.undoStack.push(command);\r\n        return true;\r\n    };\r\n    /** Clears both undo and redo stacks. */\r\n    CommandProcessor.prototype.clear = function () {\r\n        if (this.recordingCommands) {\r\n            console.error(\"Recording commands in progress, aborting recording.\");\r\n            this.recordingCommands.length = 0;\r\n        }\r\n        this.redoStack.length = 0;\r\n        this.undoStack.length = 0;\r\n        this.markClean();\r\n    };\r\n    /**\r\n     * Returns true if there are \"dirty\" (i.e unsaved) changes. Not always reliable,\r\n     * may return true even when clean.\r\n     */\r\n    CommandProcessor.prototype.hasDirtyChanges = function () {\r\n        return this.isDirty;\r\n    };\r\n    /** Mark changes as clean. */\r\n    CommandProcessor.prototype.markClean = function () {\r\n        this.isDirty = false;\r\n    };\r\n    CommandProcessor.prototype.markDirty = function () {\r\n        this.isDirty = true;\r\n    };\r\n    /** Only use this to push new commands. Pushing as a result of e.g. redo should push directly. */\r\n    CommandProcessor.prototype.pushToUndoStack = function (command) {\r\n        this.undoStack.push(command);\r\n        // Restrict the number of undo commands.\r\n        if (this.undoStack.length > MAX_UNDOS) {\r\n            this.undoStack.splice(0, this.undoStack.length - MAX_UNDOS);\r\n        }\r\n        this.markDirty();\r\n    };\r\n    return CommandProcessor;\r\n}());\r\nexport { CommandProcessor };\r\n// Returns a command class that does the inverse of another command class.\r\nexport function invert(commandClass) {\r\n    return /** @class */ (function (_super) {\r\n        __extends(class_1, _super);\r\n        function class_1() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        class_1.prototype.execute = function () {\r\n            _super.prototype.undo.call(this);\r\n        };\r\n        class_1.prototype.undo = function () {\r\n            _super.prototype.execute.call(this);\r\n        };\r\n        return class_1;\r\n    }(commandClass));\r\n}\r\n/** A command consisting of a sequence of commands. */\r\nvar Sequence = /** @class */ (function () {\r\n    function Sequence(commands) {\r\n        // Process the incoming commands, hoisting up any singleton sequences.\r\n        this.commands = commands.map(function (command) {\r\n            if (command instanceof Sequence && command.commands.length == 1) {\r\n                return command.commands[0];\r\n            }\r\n            else {\r\n                return command;\r\n            }\r\n        });\r\n    }\r\n    Sequence.prototype.execute = function () {\r\n        this.commands.forEach(function (command) { return command.execute(); });\r\n    };\r\n    Sequence.prototype.undo = function () {\r\n        for (var i = this.commands.length - 1; i >= 0; i--) {\r\n            this.commands[i].undo();\r\n        }\r\n    };\r\n    return Sequence;\r\n}());\r\nexport { Sequence };\r\nexport var commandProcessor = new CommandProcessor();\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { Pp } from \"apparatus/library/common\";\r\nimport { getDescendantIDs } from \"editing/grouping/operations\";\r\nimport appStore from \"store/store\";\r\nimport { add } from \"types\";\r\n/** Move an apparatus or an arrow. */\r\nvar Move = /** @class */ (function () {\r\n    /** IDs must be arrows or items. Groups are not supported. */\r\n    function Move(ids, delta) {\r\n        this.ids = ids;\r\n        this.delta = Pp(delta);\r\n    }\r\n    Move.prototype.execute = function () {\r\n        appStore.dispatchFn(\"Move\", Move.moveItem(this.ids, this.delta));\r\n    };\r\n    Move.prototype.undo = function () {\r\n        appStore.dispatchFn(\"Move\", Move.moveItem(this.ids, this.delta.multiply(-1)));\r\n    };\r\n    Move.moveItem = function (ids, delta) {\r\n        return function (state) { return (__assign(__assign({}, state), { items: state.items.map(function (item) {\r\n                if (ids.indexOf(item.id) === -1) {\r\n                    return item;\r\n                }\r\n                return __assign(__assign({}, item), add(item, delta));\r\n            }), arrows: state.arrows.map(function (arrow) {\r\n                if (ids.indexOf(arrow.id) === -1) {\r\n                    return arrow;\r\n                }\r\n                return __assign(__assign({}, arrow), { start: add(arrow.start, delta), end: add(arrow.end, delta) });\r\n            }) })); };\r\n    };\r\n    /** Moves a group. */\r\n    Move.group = function (groupId, delta) {\r\n        var group = appStore.groups().filter(function (g) { return g.id == groupId; })[0];\r\n        return new Move(getDescendantIDs(group), delta);\r\n    };\r\n    /** Moves one item. It can be an item, arrow or a group. */\r\n    Move.one = function (id, delta) {\r\n        if (id.type == \"group\") {\r\n            return Move.group(id, delta);\r\n        }\r\n        return new Move([id], delta);\r\n    };\r\n    return Move;\r\n}());\r\nexport { Move };\r\n/** Move individual items by different deltas. */\r\nvar MoveIndividual = /** @class */ (function () {\r\n    /** IDs must be arrows or items. Groups are not supported. */\r\n    function MoveIndividual(deltas) {\r\n        this.itemDeltaMap = {};\r\n        this.arrowDeltaMap = {};\r\n        for (var _i = 0, deltas_1 = deltas; _i < deltas_1.length; _i++) {\r\n            var d = deltas_1[_i];\r\n            switch (d.id.type) {\r\n                case \"apparatus\":\r\n                    this.itemDeltaMap[d.id.id] = d.delta;\r\n                    break;\r\n                case \"arrow\":\r\n                    this.arrowDeltaMap[d.id.id] = d.delta;\r\n                    break;\r\n                case \"group\": continue;\r\n            }\r\n        }\r\n    }\r\n    MoveIndividual.prototype.execute = function () {\r\n        var _this = this;\r\n        appStore.dispatchFn(\"Move\", function (state) { return _this.moveItems(state, 1); });\r\n    };\r\n    MoveIndividual.prototype.undo = function () {\r\n        var _this = this;\r\n        appStore.dispatchFn(\"Move\", function (state) { return _this.moveItems(state, -1); });\r\n    };\r\n    MoveIndividual.prototype.moveItems = function (state, multiplier) {\r\n        var _this = this;\r\n        return __assign(__assign({}, state), { items: state.items.map(function (item) {\r\n                var delta = _this.itemDeltaMap[item.id.id];\r\n                if (delta === undefined)\r\n                    return item;\r\n                return __assign(__assign({}, item), add(item, delta.multiply(multiplier)));\r\n            }), arrows: state.arrows.map(function (arrow) {\r\n                var delta = _this.arrowDeltaMap[arrow.id.id];\r\n                if (delta === undefined)\r\n                    return arrow;\r\n                return __assign(__assign({}, arrow), { start: add(arrow.start, delta), end: add(arrow.end, delta.multiply(multiplier)) });\r\n            }) });\r\n    };\r\n    return MoveIndividual;\r\n}());\r\nexport { MoveIndividual };\r\n","// This file contains shimmy types for libraries that don't provide typescript typings\r\nexport var RemodalStates;\r\n(function (RemodalStates) {\r\n    RemodalStates[\"OPENED\"] = \"opened\";\r\n    RemodalStates[\"CLOSED\"] = \"closed\";\r\n})(RemodalStates || (RemodalStates = {}));\r\nexport var IntroJs;\r\n(function (IntroJs) {\r\n    var Position;\r\n    (function (Position) {\r\n        Position[\"LEFT\"] = \"left\";\r\n        Position[\"RIGHT\"] = \"right\";\r\n        Position[\"TOP\"] = \"top\";\r\n    })(Position = IntroJs.Position || (IntroJs.Position = {}));\r\n})(IntroJs || (IntroJs = {}));\r\n","import { setDefaultStyleWithStroke } from \"apparatus/draw\";\r\nimport { R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nvar CapillaryTube = /** @class */ (function () {\r\n    function CapillaryTube() {\r\n    }\r\n    CapillaryTube.prototype.render = function (appearance) {\r\n        var width = appearance.width;\r\n        var length = appearance.length;\r\n        var shape = new Path.Rectangle(R(0, 0, width, length));\r\n        var liquidMask = shape.clone();\r\n        shape.remove();\r\n        var graphic = new Group([\r\n            new Path(Segments([[0, 0]], [[0, length]])),\r\n            new Path(Segments([[width, 0]], [[width, length]]))\r\n        ]);\r\n        setDefaultStyleWithStroke(\"thinner\", graphic);\r\n        return { graphic: graphic, hitShape: graphic.bounds.expand(20).toShape(), liquidMask: liquidMask };\r\n    };\r\n    CapillaryTube.properties = {\r\n        label: \"Capillary Tube\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            width: 6,\r\n            length: 150\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"width\", label: \"Diameter\",\r\n                min: 4, max: 8, step: 0.5\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"length\", label: \"Length\",\r\n                min: 60, max: 250,\r\n            }\r\n        ],\r\n    };\r\n    return CapillaryTube;\r\n}());\r\nexport { CapillaryTube };\r\n","// extracted by mini-css-extract-plugin","import { mirrorX } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { Gradient, Group, Path, Shape } from \"paper\";\r\nvar StickLighter = /** @class */ (function () {\r\n    function StickLighter() {\r\n    }\r\n    StickLighter.prototype.render = function (appearance) {\r\n        var casing = new Path(Segments([[6, 0]], [[8, 15]], [[23, 46], [2, -13], [-3, 20]], [[16, 93], [0, -7], [1, 20]], [[17, 130], [3, -9], [-5, 17]]));\r\n        mirrorX(casing);\r\n        casing.close()\r\n            .withStroke(\"default\", \"#999999\")\r\n            .withGradientFill(\"right\", Gradients.cylinder(\"#dddddd\".color()));\r\n        var nozzle = Shape.Rectangle(R(0, 0, 10, 90, Pivot.BOTTOM_CENTER))\r\n            .withGradientFill(\"right\", Gradients.cylinder(\"#444444\".color()));\r\n        var button = Shape.Rectangle(R(0, 40, 24, 30, Pivot.TOP_CENTER), 12);\r\n        button.fillColor = new paper.Color(new Gradient([[\"#eeeeee\", 0.6], [\"#ffffff\", 0.63], [\"#bbbbbb\", 1.0]], true), P(0, 40 + 30 - 12), P(0, 40 + 3));\r\n        button.withStroke(\"thinner\", \"#aaaaaa\");\r\n        var graphic = new Group([nozzle, casing, button]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    StickLighter.properties = {\r\n        label: \"Stick Lighter\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {},\r\n        appearanceSpecs: [],\r\n    };\r\n    return StickLighter;\r\n}());\r\nexport { StickLighter };\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as React from \"react\";\r\n/**\r\n * React wrapper around Remodal dialogs.\r\n *\r\n * How to use:\r\n *\r\n *   interface Props extends Remodal.Props {\r\n *     ...\r\n *   }\r\n *   export class MyModal extends Remodal<Props, State> {\r\n *    ...\r\n *     render = () => {\r\n *       <Remodal.Container {...this.props} ref={this.ref}>\r\n *        ...\r\n *       </Remodal.Container>\r\n *     }\r\n *   }\r\n */\r\nvar Remodal = /** @class */ (function (_super) {\r\n    __extends(Remodal, _super);\r\n    function Remodal(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.ref = React.createRef();\r\n        _this.modalId = generateModalId();\r\n        return _this;\r\n    }\r\n    Remodal.prototype.UNSAFE_componentWillMount = function () {\r\n        this.setState({ isOpened: false });\r\n    };\r\n    Remodal.prototype.componentDidMount = function () {\r\n        var _this = this;\r\n        var jqElement = $(this.ref.current);\r\n        this.remodal = jqElement.remodal();\r\n        var selector = \"[data-remodal-id=\" + this.modalId + \"]\";\r\n        $(document).on(\"opened\", selector, function () {\r\n            _this.setState({ isOpened: true });\r\n        });\r\n        $(document).on(\"closed\", selector, function () {\r\n            _this.setState({ isOpened: false });\r\n        });\r\n    };\r\n    Remodal.prototype.onOpen = function () {\r\n    };\r\n    Remodal.prototype.open = function () {\r\n        this.remodal.open();\r\n        this.onOpen();\r\n    };\r\n    Remodal.prototype.close = function () {\r\n        this.remodal.close();\r\n    };\r\n    Remodal.defaultState = { isOpened: false };\r\n    return Remodal;\r\n}(React.PureComponent));\r\nexport { Remodal };\r\n(function (Remodal) {\r\n    var Container = /** @class */ (function (_super) {\r\n        __extends(Container, _super);\r\n        function Container() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this.render = function () {\r\n                return React.createElement(\"div\", { className: \"remodal \" + _this.props.class || \"\", \"data-remodal-id\": _this.props.parent.modalId, ref: _this.props.parent.ref },\r\n                    React.createElement(\"button\", { \"data-remodal-action\": \"close\", className: \"remodal-close\" }),\r\n                    /** Display title with icon, if title is set.  */\r\n                    _this.props.title\r\n                        ? React.createElement(\"h2\", null,\r\n                            React.createElement(\"i\", { className: \"mr-2 fa-fw fa\" + _this.iconCss }),\r\n                            _this.props.title,\r\n                            \" \",\r\n                            _this.badge)\r\n                        : null,\r\n                    _this.props.center === true\r\n                        ? React.createElement(\"div\", { className: \"text-center\" }, _this.props.children)\r\n                        : _this.props.children);\r\n            };\r\n            return _this;\r\n        }\r\n        Object.defineProperty(Container.prototype, \"iconCss\", {\r\n            get: function () { var _a; return this.props.icon == \"loading\" ? \"l fa-spinner fa-pulse\" : (_a = \"d \" + this.props.icon) !== null && _a !== void 0 ? _a : \"\"; },\r\n            enumerable: false,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Container.prototype, \"badge\", {\r\n            get: function () {\r\n                if (!this.props.badge)\r\n                    return;\r\n                return React.createElement(\"span\", { className: \"badge badge-secondary align-top small\" }, this.props.badge);\r\n            },\r\n            enumerable: false,\r\n            configurable: true\r\n        });\r\n        return Container;\r\n    }(React.Component));\r\n    Remodal.Container = Container;\r\n})(Remodal || (Remodal = {}));\r\n/** Generates a random ID to use as a remodal ID */\r\nfunction generateModalId() {\r\n    return '_' + Math.random().toString(36).substr(2, 9);\r\n}\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { mirrorX } from \"apparatus/draw\";\r\n//import { setDefaultStyle } from \"apparatus/draw\";\r\nimport { Group, Path } from \"paper\";\r\nimport { setDefaultStyleWithStroke } from \"../draw\";\r\nimport { DEFAULT_LIQUID_DATA, Segments } from \"./common\";\r\nvar Cuvette = /** @class */ (function () {\r\n    function Cuvette() {\r\n    }\r\n    Cuvette.prototype.render = function (appearance) {\r\n        // Standard cuvettes are 45 by 12.5mm. We round here for clarity.\r\n        var width = 10;\r\n        var height = 50;\r\n        var graphic;\r\n        var liquidMask;\r\n        if (appearance.view == \"side\") {\r\n            // This is simple, just draw  abox\r\n            var depth = appearance.depth;\r\n            var outline = new Path(Segments([[0, 0]], [[0, height]], [[depth, height]], [[depth, 0]]));\r\n            liquidMask = outline.clone();\r\n            graphic = outline;\r\n        }\r\n        else {\r\n            var outside = new Path(Segments([[0, 0]], [[0, height]], [[width, height]], [[width, 0]]));\r\n            graphic = new Group([outside]);\r\n            var inside = (function () {\r\n                switch (appearance.type) {\r\n                    case \"macro\":\r\n                        return new Path(Segments([[0, 0]], [[0, height]]));\r\n                    case \"semi-micro\":\r\n                        return new Path(Segments([[0, 0]], [[0, 20]], [[2.5, 23]], [[2.5, 46]]));\r\n                    case \"micro\":\r\n                        return new Path(Segments([[0, 0]], [[0, 20]], [[3.5, 24]], [[3.5, 46]]));\r\n                }\r\n            })();\r\n            mirrorX(inside, width / 2);\r\n            liquidMask = inside.clone();\r\n            graphic.addChild(inside);\r\n        }\r\n        setDefaultStyleWithStroke(\"thinner\", graphic);\r\n        graphic.scale(appearance.scale);\r\n        liquidMask.scale(appearance.scale, graphic.bounds.center);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.expand(20).toShape(),\r\n            liquidMask: liquidMask,\r\n            snapping: graphic.placeable()\r\n        };\r\n    };\r\n    Cuvette.properties = {\r\n        label: \"Cuvette\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            depth: 20,\r\n            scale: 1.5,\r\n            type: \"semi-micro\",\r\n            view: \"side\"\r\n        },\r\n        defaultLiquidData: __assign(__assign({}, DEFAULT_LIQUID_DATA), { color: \"#ff2020\", amountRatio: 0.85 }),\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 1.0, max: 5.0, step: 0.1,\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"view\", label: \"View\",\r\n                options: [\r\n                    { value: \"side\", label: \"From the side\" },\r\n                    { value: \"front\", label: \"Front view\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"type\", label: \"Type\",\r\n                options: [\r\n                    { value: \"macro\", label: \"Macro\" },\r\n                    { value: \"semi-micro\", label: \"Semi-Micro\" },\r\n                    { value: \"micro\", label: \"Micro\", tier: \"boost\" },\r\n                ],\r\n                visible: function (a) { return a.view == \"front\"; }\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"depth\", label: \"Depth\",\r\n                min: 5, max: 100,\r\n                visible: function (a) { return a.view == \"side\"; }\r\n            },\r\n        ],\r\n    };\r\n    return Cuvette;\r\n}());\r\nexport { Cuvette };\r\n","// Base library pieces for defining new apparatus.\r\n//\r\n// 1. ApparatusComponent vs Apparatus\r\n//     - ApparatusComponent is a React component that gives access to the\r\n//    data and lifecycle routines. Each apparatus is housed inside this,\r\n//    regardless of its type.\r\n//     - Apparatus is the base class that can be extended to define\r\n//       how a specific apparatus type is rendered and styled.\r\n// 2. Creating new Apparatus\r\n//    Specific apparatus are defined inside the ./library folder\r\n//    and registered by the createApparatus method.\r\nimport { TUBE_DIAMETER_SPEC } from \"apparatus/library/tubes\";\r\nexport function commonSpecsForApparatusKind(kind) {\r\n    switch (kind) {\r\n        case \"tube\": return [TUBE_DIAMETER_SPEC];\r\n    }\r\n}\r\n","import { callApi } from \"api/api\";\r\nimport { logIn } from \"store/actions\";\r\nimport appStore from \"store/store\";\r\n/**\r\n * Executes reauth, using currently logged in credentials.\r\n * A no-op if currently user is not logged in.\r\n *\r\n * Use this to update the current tier after a purchase etc.\r\n */\r\nexport function reauthFromCurrentLogin() {\r\n    var state = appStore.loggedInState();\r\n    if (!state)\r\n        return;\r\n    callApi(\"reauth\", \"GET\", state.jwtToken, undefined, {\r\n        success: function (response) {\r\n            if (response.type == \"success\") {\r\n                appStore.dispatch(logIn({\r\n                    provider: response.provider,\r\n                    jwtToken: response.jwt,\r\n                    user: response.user,\r\n                    // This should presumably be false.\r\n                    firstTimeLogin: response.firstTimeLogin,\r\n                    tier: response.tier,\r\n                    // Silence popups here, let the parent call handle this.\r\n                    silencePopup: true\r\n                }));\r\n            }\r\n        }\r\n    });\r\n}\r\n","import { setDefaultStyle } from \"apparatus/draw\";\r\nimport { R } from \"apparatus/library/common\";\r\nimport { Shape } from \"paper\";\r\nvar BenchMat = /** @class */ (function () {\r\n    function BenchMat() {\r\n    }\r\n    BenchMat.prototype.render = function (appearance) {\r\n        var size = appearance.size;\r\n        var graphic = (function () {\r\n            switch (appearance.view) {\r\n                case \"top\":\r\n                    return Shape.Rectangle(R(0, 0, size, size), 4);\r\n                case \"side\":\r\n                    return Shape.Rectangle(R(0, 0, size, 10), 3);\r\n            }\r\n        })();\r\n        setDefaultStyle(graphic);\r\n        switch (appearance.color) {\r\n            case \"ceramic\":\r\n                graphic.strokeColor = \"#c2a690\";\r\n                graphic.fillColor = \"#d9c8b9\";\r\n                break;\r\n            case \"white\":\r\n                graphic.strokeColor = \"#bbbbbb\";\r\n                graphic.fillColor = \"#eeeeee\";\r\n                break;\r\n        }\r\n        var hitBounds = graphic.bounds;\r\n        if (appearance.view == \"side\") {\r\n            hitBounds = hitBounds.expand(10);\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitBounds.toShape(),\r\n            snapping: appearance.view == \"side\"\r\n                ? [graphic.topEdgeAsPlaceableSurface(), graphic.placeable()]\r\n                : undefined\r\n        };\r\n    };\r\n    BenchMat.properties = {\r\n        label: \"Bench Mat (Tile)\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            view: \"side\",\r\n            color: \"ceramic\",\r\n            size: 150,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 70, max: 200\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"color\", label: \"Colour\",\r\n                options: [\r\n                    { value: \"ceramic\", label: \"Ceramic\" },\r\n                    { value: \"white\", label: \"White\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"view\", label: \"View\",\r\n                options: [\r\n                    { value: \"top\", label: \"From top\" },\r\n                    { value: \"side\", label: \"From side\" },\r\n                ],\r\n            }\r\n        ],\r\n    };\r\n    return BenchMat;\r\n}());\r\nexport { BenchMat };\r\n","import { Gradients } from \"apparatus/gradients\";\r\nimport { P, Pivot, R, SharedColors } from \"apparatus/library/common\";\r\nimport { SVG } from \"apparatus/svg\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar RED = \"#d93021\";\r\nvar RED_STROKE = \"#992d23\";\r\nvar TorchBurner = /** @class */ (function () {\r\n    function TorchBurner() {\r\n    }\r\n    TorchBurner.prototype.render = function (appearance) {\r\n        var body = Shape.Rectangle(R(0, 0, 50, 130, Pivot.BOTTOM_CENTER))\r\n            .withStroke(\"default\", \"#888888\")\r\n            .withGradientFill(\"right\", Gradients.cylinder(\"#aaaaaa\".color()));\r\n        var mount = Shape.Rectangle(R(0, -130, 30, 30, Pivot.BOTTOM_CENTER))\r\n            .withStroke(\"default\", SharedColors.stroke)\r\n            .withGradientFill(\"right\", Gradients.box(\"#444444\".color()));\r\n        var button = new Path.Rectangle(R(-15, -144, 12, 18, Pivot.CENTER_RIGHT))\r\n            .withStroke(\"thin\", RED_STROKE)\r\n            .withGradientFill(\"right\", Gradients.box(RED.color(), { delta: 15, shift: 0.3 }));\r\n        var nozzleCasing = new Path.Rectangle(R(0, 0, 50, 18, Pivot.CENTER_LEFT))\r\n            .withStroke(\"default\", SharedColors.stroke)\r\n            .withGradientFill(\"down\", Gradients.cylinder(\"#444444\".color()));\r\n        var dial = new Path.Rectangle(R(48, 0, 18, 22, Pivot.CENTER_LEFT))\r\n            .withStroke(\"default\", RED_STROKE)\r\n            .withGradientFill(\"down\", Gradients.box(RED.color(), { delta: 15, shift: 0.3 }));\r\n        var nozzle = new Path.Rectangle(R(0, 0, 50, 16, Pivot.CENTER_RIGHT))\r\n            .withGradientFill(\"down\", Gradients.cylinder(\"#aaaaaa\".color(), 15));\r\n        var topPart = new Group([nozzle, nozzleCasing, dial]);\r\n        topPart.pivot = P(25, 0);\r\n        if (appearance.flame) {\r\n            var flame = SVG.blueFlame();\r\n            flame.rotate(-90);\r\n            flame.position = P(-49, 0);\r\n            flame.scale(appearance.flameScale);\r\n            topPart.insertChild(0, flame);\r\n        }\r\n        topPart.position = P(0, -160);\r\n        topPart.rotate(15);\r\n        var graphic = new Group([button, mount, body, topPart]);\r\n        return {\r\n            graphic: graphic,\r\n            pivot: body.bounds.center,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: body.placeable(),\r\n        };\r\n    };\r\n    TorchBurner.properties = {\r\n        label: \"Torch Burner\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            flame: true,\r\n            flameScale: 1.0\r\n        },\r\n        appearanceSpecs: [\r\n            { spec: \"checkbox\", key: \"flame\", label: \"Flame\", subLabel: \"Show\" },\r\n            {\r\n                spec: \"slider\", key: \"flameScale\", label: \"Flame Size\",\r\n                min: 0.7, max: 1.5, step: 0.05,\r\n                visible: function (a) { return a.flame; }\r\n            }\r\n        ],\r\n    };\r\n    return TorchBurner;\r\n}());\r\nexport { TorchBurner };\r\n","import { mirrorX, setDefaultStyle } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, Pivot, R, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path, PointText, Shape } from \"paper\";\r\nvar OxSatProbe = /** @class */ (function () {\r\n    function OxSatProbe() {\r\n        this.drivers = [\r\n            {\r\n                type: \"rectangle\",\r\n                minX: -150, maxX: 150,\r\n                minY: 0, maxY: 200,\r\n                toAppearance: function (p) { return ({ probeX: p.x, probeY: p.y }); },\r\n                fromAppearance: function (a) { return P(a.probeX, a.probeY); },\r\n                scale: 1.0,\r\n            }\r\n        ];\r\n    }\r\n    OxSatProbe.prototype.render = function (appearance) {\r\n        var probeOffsetX = appearance.probeX;\r\n        var probeOffsetY = appearance.probeY;\r\n        // Create a reader\r\n        var casing = Shape.Rectangle(R(0, 0, 60, 100, Pivot.TOP_CENTER), 4);\r\n        casing.fillColor = \"#dddddd\";\r\n        setDefaultStyle(casing);\r\n        var screen = Shape.Rectangle(R(0, 15, 50, 40, Pivot.TOP_CENTER), 2)\r\n            .withStroke(2.0, \"white\")\r\n            .withFill(SharedColors.lcdScreen);\r\n        var screenClip = screen.clone();\r\n        var button = Shape.Circle(P(-10, 80), 7);\r\n        button.fillColor = \"#a9b2b7\";\r\n        button.strokeWidth = 2.0;\r\n        button.strokeColor = \"#777c7f\";\r\n        var button2 = Shape.Circle(P(10, 80), 7);\r\n        button2.fillColor = \"#a9b2b7\";\r\n        button2.strokeWidth = 2.0;\r\n        button2.strokeColor = \"#777c7f\";\r\n        var satText = new PointText({\r\n            point: P(21, 32),\r\n            content: appearance.saturation,\r\n            fillColor: 'black',\r\n            fontFamily: 'sans-serif',\r\n            fontSize: 14,\r\n            justification: \"right\",\r\n        });\r\n        var satTextLabel = new PointText({\r\n            point: P(23, 11),\r\n            content: \"mg/L\",\r\n            fillColor: \"#555555\",\r\n            fontFamily: 'sans-serif',\r\n            fontSize: 9,\r\n            justification: \"right\",\r\n        });\r\n        var tempText = new PointText({\r\n            point: P(-18, 48),\r\n            content: appearance.temperature + \"\" + appearance.tempUnit,\r\n            fillColor: 'black',\r\n            fontFamily: 'sans-serif',\r\n            fontSize: 11,\r\n            justification: \"left\",\r\n        });\r\n        var screenDisplay = new Group([screenClip, satText, tempText]);\r\n        screenDisplay.clipped = true;\r\n        var reader = new Group([casing, screen, screenDisplay, satTextLabel, button, button2]);\r\n        // Create the probe\r\n        var probe = new Path(Segments([[10, 0], [0, -2]], [[10, 70]], [[5, 77]], [[5, 110], , [0, 2]])).close();\r\n        mirrorX(probe);\r\n        probe.withGradientFill(\"right\", Gradients.cylinder(\"#333333\".color()));\r\n        probe.position = probe.position.add(P(probeOffsetX, probeOffsetY));\r\n        // Create the wire.\r\n        var wire = new Path(Segments([[0, 100], undefined, [0, 50]], // Connects to the casing.\r\n        [[probeOffsetX, probeOffsetY], [0, -50]]));\r\n        setDefaultStyle(wire);\r\n        var graphic = new Group([reader, probe, wire]);\r\n        var hitShapes = [\r\n            probe.bounds.toShape(),\r\n            reader.bounds.toShape(),\r\n        ];\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShapes,\r\n            pivot: casing.bounds.center,\r\n        };\r\n    };\r\n    OxSatProbe.properties = {\r\n        label: \"Oxygen Saturation Probe\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            temperature: \"20\",\r\n            tempUnit: \"C\",\r\n            saturation: \"8.5\",\r\n            probeX: 150,\r\n            probeY: 100,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"text\", key: \"saturation\", label: \"Saturation\",\r\n                numbersOnly: true, maxLength: 5,\r\n            },\r\n            {\r\n                spec: \"text\", key: \"temperature\", label: \"Temperature\",\r\n                numbersOnly: true, maxLength: 5,\r\n            },\r\n            {\r\n                spec: \"toggle-buttons\", key: \"tempUnit\", label: \"Temperature unit\", size: \"text\",\r\n                options: [\r\n                    { value: \"C\", label: \"C\", icon: \"\" },\r\n                    { value: \"F\", label: \"F\", icon: \"\" },\r\n                ]\r\n            },\r\n        ],\r\n    };\r\n    return OxSatProbe;\r\n}());\r\nexport { OxSatProbe };\r\n","import { Path } from \"paper\";\r\nimport { mirrorX, setDefaultStyle } from \"../../draw\";\r\nimport { Segments } from \"../common\";\r\nvar PipetteBottle = /** @class */ (function () {\r\n    function PipetteBottle() {\r\n    }\r\n    PipetteBottle.prototype.render = function (appearance) {\r\n        var bottle = new Path(Segments([[9, 0]], [[10, 5], undefined, [0, 5]], [[20, 25], [0, -10]], [[20, 100]], [[0, 100]]));\r\n        mirrorX(bottle);\r\n        var liquidMask = bottle.clone();\r\n        setDefaultStyle(bottle);\r\n        return {\r\n            graphic: bottle,\r\n            liquidMask: liquidMask,\r\n            hitShape: bottle.bounds.toShape(),\r\n            snapping: bottle.placeable(),\r\n        };\r\n    };\r\n    PipetteBottle.properties = {\r\n        label: \"Pipette Bottle\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {},\r\n        appearanceSpecs: [],\r\n    };\r\n    return PipetteBottle;\r\n}());\r\nexport { PipetteBottle };\r\n","import apparatusSpecList from \"./specList\";\r\nexport function searchApparatus(term) {\r\n    if (term.length == 0) {\r\n        return [];\r\n    }\r\n    // Search is case-insensitive.\r\n    term = term.toLowerCase();\r\n    var results = [];\r\n    var _loop_1 = function (a) {\r\n        if (a.type.indexOf(term) !== -1) {\r\n            // Lower score means better match.\r\n            a.searchScore = 0;\r\n            results.push(a);\r\n        }\r\n        else if (a.lowerCaseName.indexOf(term) !== -1) {\r\n            // Search in the name as well.\r\n            // Lower score means better match.\r\n            a.searchScore = 0;\r\n            results.push(a);\r\n        }\r\n        else {\r\n            // search in additional terms\r\n            a.search.some(function (searchTerms, i) {\r\n                if (searchTerms.indexOf(term) !== -1) {\r\n                    a.searchScore = 1 + i;\r\n                    results.push(a);\r\n                    return true;\r\n                }\r\n                return false;\r\n            });\r\n        }\r\n    };\r\n    for (var _i = 0, apparatusSpecList_1 = apparatusSpecList; _i < apparatusSpecList_1.length; _i++) {\r\n        var a = apparatusSpecList_1[_i];\r\n        _loop_1(a);\r\n    }\r\n    // Sort the results\r\n    results.sort(function (a, b) {\r\n        // Compare by search score first\r\n        var scoreDiff = (a.searchScore || 0) - (b.searchScore || 0);\r\n        if (scoreDiff !== 0) {\r\n            return scoreDiff;\r\n        }\r\n        // Compare based on name\r\n        if (a.type < b.type) {\r\n            return -1;\r\n        }\r\n        return 1; // Equal names are (technically) not possible\r\n    });\r\n    return results;\r\n}\r\n","import { mirrorX, softShade } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, Pivot, R, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar BeamBalance = /** @class */ (function () {\r\n    function BeamBalance() {\r\n    }\r\n    BeamBalance.prototype.render = function (appearance) {\r\n        var tilt = appearance.tilt, size = appearance.size;\r\n        var plateWidth = size / 2.5 - 8; // (120)\r\n        var height = size; // (320)\r\n        var width = size / 2 + 126; // (286)\r\n        var halfWidth = width / 2; // (143)\r\n        var base = Shape.Rectangle(R(0, height, width + plateWidth / 2 + 20, 20, Pivot.CENTER), 2.0)\r\n            .withStroke(\"default\", SharedColors.stroke)\r\n            .withFill(\"#878c91\");\r\n        var pillar = Shape.Rectangle(R(0, 0, 25, height, Pivot.TOP_CENTER))\r\n            .withGradientFill(\"right\", Gradients.cylinder(\"#aaaaaa\".color()))\r\n            .withStroke(\"default\", SharedColors.stroke);\r\n        var beam = new Path(Segments([[halfWidth - 64, -24], [-10, -8]], [[halfWidth - 31, -3], [-6, 0]], [[halfWidth, -3], , [2, 0]], [[halfWidth, 8], [3, 0]], [[halfWidth - 30, 8], , [-10, 0]], [[halfWidth - 70, -10], [7, -2]], [[3, 3]], [[0, 15]])).close().withStroke(\"default\", SharedColors.stroke).withGradientFill(\"right-down\", Gradients.cylinder(\"#777777\".color()));\r\n        mirrorX(beam);\r\n        beam.rotate(tilt, P(0, 0));\r\n        var plate = Shape.Rectangle(R(0, height - 70, plateWidth, 10, Pivot.CENTER), 2.0)\r\n            .withGradientFill(\"right\", Gradients.cylinder(\"#cccccc\".color()))\r\n            .withStroke(\"thin\", \"#888888\");\r\n        var wire = new Path(Segments([[-plateWidth / 2, height - 70]], [[-plateWidth / 2, plateWidth * 0.6]], [[0, 0]], [[plateWidth / 2, plateWidth * 0.6]], [[plateWidth / 2, height - 70]])).withStroke(\"thin\", \"#888888\");\r\n        var scaleL = new Group([wire, plate]);\r\n        scaleL.pivot = P(0, 0);\r\n        scaleL.position = P(-halfWidth + 18, 2).rotate(tilt, P(0, 0));\r\n        var scaleR = scaleL.clone();\r\n        scaleR.position = P(halfWidth - 18, 2).rotate(tilt, P(0, 0));\r\n        // add markings.\r\n        var line_0 = new Path.Line(P(0, 23), P(0, 30)).withStroke(1.0, \"#555555\");\r\n        var line_1 = line_0.clone();\r\n        line_1.rotate(-10, P(0, 0));\r\n        var line_2 = line_0.clone();\r\n        line_2.rotate(10, P(0, 0));\r\n        var graphic = new Group([\r\n            pillar,\r\n            softShade(\"full\", null, P(0, -20), P(0, 25), \"#777777\", 10.0),\r\n            base, scaleL, scaleR, beam, line_0, line_1, line_2\r\n        ]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: [\r\n                base.bounds.toShape(),\r\n                beam.bounds.toShape(),\r\n                pillar.bounds.toShape(),\r\n                plate.bounds.toShape(),\r\n                scaleR.children[1].bounds.toShape(),\r\n            ],\r\n            pivot: pillar.bounds.center,\r\n            snapping: [\r\n                base.placeable(),\r\n                scaleL.children[1].topEdgeAsPlaceableSurface(),\r\n                scaleR.children[1].topEdgeAsPlaceableSurface(),\r\n            ]\r\n        };\r\n    };\r\n    BeamBalance.properties = {\r\n        label: \"Beam Balance\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            tilt: 0,\r\n            size: 240\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 180, max: 320,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"tilt\", label: \"Tilt\",\r\n                min: -10, max: 10, step: 0.1,\r\n            }\r\n        ],\r\n    };\r\n    return BeamBalance;\r\n}());\r\nexport { BeamBalance };\r\n","export function convertDemoSwatchesToRadioOptions(swatches) {\r\n    var options = [];\r\n    for (var label in swatches) {\r\n        options.push({ value: swatches[label], label: label });\r\n    }\r\n    // Push final option for More colours.\r\n    options.push({ value: \"____\", label: \"More colours\", tier: \"boost\" });\r\n    return options;\r\n}\r\n","import * as paper from \"paper\";\r\nimport { addEdgeLips, addMarkers, breakPath, mirrorX, removeLastSegment, setDefaultStyle, smoothCorner } from \"../draw\";\r\nimport { markerSpacing, P, Segments } from \"./common\";\r\nvar Beaker = /** @class */ (function () {\r\n    function Beaker() {\r\n        this.drivers = [\r\n            {\r\n                type: \"rectangle\",\r\n                minX: 30, maxX: 120,\r\n                minY: 40, maxY: 160,\r\n                fromAppearance: function (a) { return P(a.width, a.height); },\r\n                toAppearance: function (p) { return ({ width: p.x, height: p.y }); },\r\n                scale: 2.0,\r\n            }\r\n        ];\r\n    }\r\n    Beaker.prototype.render = function (appearance) {\r\n        var beakerPath = createBasicBeaker(appearance);\r\n        addEdgeLips(beakerPath);\r\n        // Clone this path as a liquid mask too.\r\n        var liquidMask = beakerPath.clone();\r\n        // Create a container for the graphic\r\n        var beakerGraphic = new paper.Group([beakerPath]);\r\n        markers(appearance, beakerGraphic);\r\n        setDefaultStyle(beakerGraphic);\r\n        var hitShape = paper.Shape.Rectangle(beakerPath.bounds);\r\n        return {\r\n            graphic: beakerGraphic,\r\n            hitShape: hitShape,\r\n            liquidMask: liquidMask,\r\n            snapping: [\r\n                { type: \"neck\", top: P(appearance.width / 2, 0), diameter: appearance.width, facing: 0 },\r\n                beakerGraphic.placeable(),\r\n            ]\r\n        };\r\n    };\r\n    Beaker.properties = {\r\n        label: \"Beaker\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            width: 80,\r\n            height: 100,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\",\r\n                key: \"width\",\r\n                label: \"Width\",\r\n                min: 30,\r\n                max: 120,\r\n            },\r\n            {\r\n                spec: \"slider\",\r\n                key: \"height\",\r\n                label: \"Height\",\r\n                min: 40,\r\n                max: 160,\r\n            },\r\n        ]\r\n    };\r\n    return Beaker;\r\n}());\r\nexport { Beaker };\r\nvar DisplacementBeaker = /** @class */ (function () {\r\n    function DisplacementBeaker() {\r\n    }\r\n    DisplacementBeaker.prototype.render = function (appearance) {\r\n        var beakerPath = createBasicBeaker(appearance);\r\n        var width = appearance.width;\r\n        // let height = appearance.height\r\n        // Add a spout, winding anti clockwise\r\n        beakerPath.insertSegments(5, Segments([[width, 25]], [[width + 15, 28]], [[width + 15, 18]], [[width, 10]]));\r\n        addEdgeLips(beakerPath);\r\n        // Clone this path as a liquid mask too.\r\n        var liquidMask = beakerPath.clone();\r\n        // Create a container for the graphic\r\n        var beakerGraphic = breakPath(beakerPath, 8);\r\n        setDefaultStyle(beakerGraphic);\r\n        markers(appearance, beakerGraphic);\r\n        var hitShape = paper.Shape.Rectangle(beakerPath.bounds);\r\n        return {\r\n            graphic: beakerGraphic,\r\n            hitShape: hitShape,\r\n            liquidMask: liquidMask,\r\n            snapping: [\r\n                beakerGraphic.placeable(),\r\n                { type: \"neck\", top: P(appearance.width / 2, 0), diameter: appearance.width, facing: 0 },\r\n            ]\r\n        };\r\n    };\r\n    DisplacementBeaker.properties = {\r\n        label: \"Displacement Beaker\",\r\n        canContainLiquids: true,\r\n        flippable: true,\r\n        defaultAppearance: Beaker.properties.defaultAppearance,\r\n        appearanceSpecs: Beaker.properties.appearanceSpecs,\r\n    };\r\n    return DisplacementBeaker;\r\n}());\r\nexport { DisplacementBeaker };\r\n/** Creates a basic beaker shape, without styles or edge lips. */\r\nfunction createBasicBeaker(appearance) {\r\n    var width = appearance.width;\r\n    var height = appearance.height;\r\n    var beakerPath = new paper.Path(Segments(\r\n    // beaker side\r\n    [[0, 0]], [[0, height]], \r\n    // beaker bottom\r\n    [[width / 2, height]]));\r\n    smoothCorner(beakerPath.segments[1]);\r\n    removeLastSegment(beakerPath);\r\n    mirrorX(beakerPath, width / 2);\r\n    return beakerPath;\r\n}\r\nfunction markers(appearance, group) {\r\n    addMarkers(group, new paper.Point(appearance.width - 5, appearance.height), 8, new paper.Point(0, markerSpacing));\r\n}\r\n","import { mirrorX } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, Pivot, R, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\n// https://www.sonicator.com/products/q2000-sonicator\r\nvar Sonicator = /** @class */ (function () {\r\n    function Sonicator() {\r\n        this.drivers = [\r\n            {\r\n                type: \"rectangle\",\r\n                minX: -500, maxX: 500,\r\n                minY: -600, maxY: 0,\r\n                fromAppearance: function (a) { return P(a.probeX, a.probeY); },\r\n                toAppearance: function (p) { return ({ probeX: p.x, probeY: p.y }); },\r\n                scale: 1.0,\r\n            }\r\n        ];\r\n    }\r\n    Sonicator.prototype.render = function (appearance) {\r\n        var probePosition = P(appearance.probeX, appearance.probeY);\r\n        var widthAndHeights = [\r\n            // Wire connector.\r\n            [10, 8],\r\n            // Top part.\r\n            [28, 35],\r\n            [32, 20],\r\n            [18, 15],\r\n            // Bottom part.\r\n            [18, 30],\r\n            [12, 25],\r\n            [16, 32],\r\n            [8, 40],\r\n            [6, 40],\r\n        ];\r\n        var y = 0;\r\n        var parts = widthAndHeights.map(function (_a) {\r\n            var width = _a[0], height = _a[1];\r\n            var shape = new Path.Rectangle(R(0, y, width, height, Pivot.TOP_CENTER));\r\n            y += height;\r\n            return shape;\r\n        });\r\n        parts[0].fillColor = \"black\";\r\n        for (var i = 1; i < 4; i++)\r\n            parts[i].withGradientFill(\"right\", Gradients.cylinder(\"#bbbbbb\".color(), 10));\r\n        for (var i = 4; i < parts.length; i++)\r\n            parts[i].withGradientFill(\"right\", Gradients.cylinder(\"#9a8d87\".color(), 10));\r\n        // Add together to a group.\r\n        var probe = new Group(parts);\r\n        // Create outline.\r\n        var outline = new Path().withStroke(\"default\");\r\n        outline.moveTo(P(0, 0));\r\n        var totalY = 0;\r\n        for (var _i = 0, widthAndHeights_1 = widthAndHeights; _i < widthAndHeights_1.length; _i++) {\r\n            var _a = widthAndHeights_1[_i], x = _a[0], y_1 = _a[1];\r\n            outline.lineTo(P(x / 2, totalY));\r\n            totalY += y_1;\r\n            outline.lineTo(P(x / 2, totalY));\r\n        }\r\n        mirrorX(outline);\r\n        probe.addChild(outline);\r\n        probe.pivot = P(0, 0);\r\n        probe.position = probePosition;\r\n        if (!appearance.showBase) {\r\n            return {\r\n                graphic: probe,\r\n                hitShape: probe.bounds.toShape(),\r\n            };\r\n        }\r\n        // Panel.\r\n        var panel = new Group([\r\n            Shape.Rectangle(R(0, 0, 100, 100), 3.0)\r\n                .withStroke(\"default\", SharedColors.devicePanel.stroke)\r\n                .withFill(SharedColors.devicePanel.fill),\r\n            // Screen.\r\n            Shape.Rectangle(R(10, 10, 80, 15), 3.0).withStroke(4.0, \"white\").withFill(SharedColors.lcdScreen)\r\n        ]);\r\n        for (var i = 0; i < 4; i++) {\r\n            for (var j = 0; j < 3; j++) {\r\n                panel.addChild(Shape.Rectangle(R(27 + j * 16, 32 + i * 16, 12, 12), 2.0).withFill(\"white\"));\r\n            }\r\n        }\r\n        // Box.\r\n        var box = new Group([\r\n            // Body.\r\n            Shape.Rectangle(R(0, 0, 240, 120, Pivot.CENTER), 4.0).withStroke(\"default\", \"#8e9499\").withFill(\"#c0c6cb\"),\r\n            // Panel.\r\n            panel.withPosition(P(60, 0))\r\n        ]);\r\n        var wire = new Path(Segments([[0, 0], , [Math.min(100, probePosition.x), 0]], [[probePosition.x, probePosition.y], [0, -85]])).withStroke(2.0, \"black\");\r\n        var graphic = new Group([wire, box, probe]);\r\n        return {\r\n            graphic: graphic,\r\n            pivot: box.bounds.center,\r\n            hitShape: [box.bounds.toShape(), probe.bounds.toShape()],\r\n            snapping: box.placeable(),\r\n            watermark: probePosition.add(P(8, 40)),\r\n        };\r\n    };\r\n    Sonicator.properties = {\r\n        label: \"Sonicator\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            probeX: 250,\r\n            probeY: -260,\r\n            showBase: true,\r\n        },\r\n        appearanceSpecs: [\r\n            { spec: \"checkbox\", key: \"showBase\", label: \"Show Base\" }\r\n        ],\r\n    };\r\n    return Sonicator;\r\n}());\r\nexport { Sonicator };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { mirrorX } from \"apparatus/draw\";\r\nimport { P, Segments } from \"apparatus/library/common\";\r\nimport { BasicShapes } from \"apparatus/library/shapes/common\";\r\nimport { Path } from \"paper\";\r\nvar Cross = /** @class */ (function () {\r\n    function Cross() {\r\n        this.drivers = [\r\n            {\r\n                type: \"rectangle\",\r\n                minX: 10, maxX: 80,\r\n                minY: 5, maxY: 30,\r\n                toAppearance: function (p) { return ({\r\n                    thickness: Math.min(p.y, p.x - 10),\r\n                    length: p.x,\r\n                }); },\r\n                fromAppearance: function (a) { return P(a.length, a.thickness); },\r\n                scale: 1.0,\r\n            }\r\n        ];\r\n    }\r\n    Cross.prototype.render = function (appearance) {\r\n        var thickness = appearance.thickness, length = appearance.length;\r\n        var graphic = new Path(Segments([[thickness, length]], [[thickness, thickness]], [[length, thickness]], [[length, -thickness]], [[thickness, -thickness]], [[thickness, -length]]));\r\n        graphic.closePath();\r\n        mirrorX(graphic);\r\n        var shape = graphic.clone();\r\n        // Styling.\r\n        BasicShapes.applyStyle(graphic, appearance);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: shape,\r\n        };\r\n    };\r\n    Cross.properties = {\r\n        label: \"Cross\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: __assign({ thickness: 10, length: 50 }, BasicShapes.defaultAppearance),\r\n        appearanceSpecs: __spreadArrays(BasicShapes.specs),\r\n    };\r\n    return Cross;\r\n}());\r\nexport { Cross };\r\n","export var DEFAULT_FONT_SIZE = 12;\r\nexport var Arrow;\r\n(function (Arrow) {\r\n    Arrow.defaultArrow = {\r\n        selected: false,\r\n        label: \"Label\",\r\n        fontSize: DEFAULT_FONT_SIZE,\r\n        endStyle: \"triangle\",\r\n        isChemMarkEnabled: false,\r\n        fontFamily: \"sans-serif\",\r\n        textColor: \"#000000\",\r\n        showArrow: true,\r\n        arrowThickness: 3.0,\r\n        textAlign: \"left\",\r\n    };\r\n})(Arrow || (Arrow = {}));\r\n","import * as Sentry from \"@sentry/react\";\r\nimport \"ext/js\";\r\nimport { Consts } from \"./vars\";\r\n/** Returns correctly pluralized term for given count */\r\nexport function pluralize(count, term, useNo) {\r\n    if (useNo === void 0) { useNo = false; }\r\n    if (count === 0) {\r\n        return (useNo ? \"No\" : \"0\") + \" \" + term + \"s\";\r\n    }\r\n    if (count === 1) {\r\n        return \"1 \" + term;\r\n    }\r\n    return count + \" \" + term + \"s\";\r\n}\r\nexport function crumb(category, message) {\r\n    Sentry.addBreadcrumb({ category: category, message: message });\r\n}\r\n/** Compares two floats to be \"equal\" enough */\r\nexport function equals(a, b) {\r\n    return Math.abs(a - b) < Consts.epsilon;\r\n}\r\nexport function getUrlParameter(paramName) {\r\n    var pageUrl = decodeURIComponent(window.location.search.substring(1));\r\n    var params = pageUrl.split('&');\r\n    for (var i = 0; i < params.length; i++) {\r\n        var param = params[i].split('=');\r\n        if (param[0] === paramName) {\r\n            return params[1] === undefined ? true : params[1];\r\n        }\r\n    }\r\n}\r\n/** Returns true if the current browser is IE or Edge. */\r\nexport function isIEOrEdge() {\r\n    var uaString = window.navigator.userAgent;\r\n    var match = /\\b(MSIE |Trident.*?rv:|Edge\\/)(\\d+)/.exec(uaString);\r\n    if (match)\r\n        return true;\r\n    return false;\r\n}\r\nexport var isIOS = window.navigator.platform && /iPad|iPhone|iPod/.test(navigator.platform);\r\nexport function isSafari() {\r\n    var isSafari = !!navigator.userAgent.match(/Version\\/[\\d\\.]+.*Safari/);\r\n    // var iOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\r\n    return isSafari;\r\n}\r\n/** Execute a block of code that may open a window. Use opener to open the window. */\r\nexport function opensWindow(fn) {\r\n    var opener;\r\n    if (isSafari()) {\r\n        // On Safari, we need to open the window immediately, otherwise it gets\r\n        // blocked and it's hard to open it.\r\n        // https://stackoverflow.com/questions/20696041/window-openurl-blank-not-working-on-imac-safari\r\n        var windowReferenceForSafari_1 = window.open();\r\n        if (windowReferenceForSafari_1 != null) {\r\n            windowReferenceForSafari_1.document.write(\"<html><body><center style='margin-top:5em'>Retrieving information, please wait...</center></body></html>\");\r\n            opener = function (url) {\r\n                windowReferenceForSafari_1.location.href = url;\r\n            };\r\n        }\r\n        else {\r\n            opener = function (url) { return window.open(url); };\r\n        }\r\n    }\r\n    else {\r\n        opener = function (url) { return window.open(url); };\r\n    }\r\n    fn(opener);\r\n}\r\n/** IE cannot download images directly so have use this method. */\r\nexport function saveBlobHack(el, mime) {\r\n    // Based on:\r\n    // https://github.com/mholt/PapaParse/issues/175\r\n    if (window.navigator.msSaveOrOpenBlob !== undefined) {\r\n        var data = $(el).attr(\"href\") || \"\";\r\n        // Remove the data URI header. Convert to binary.\r\n        var rawData = atob(data.replace(\"data:\" + mime + \";base64,\", \"\"));\r\n        var rawLength = rawData.length;\r\n        var dataArray = new Uint8Array(rawLength);\r\n        for (var i = 0; i < rawLength; i++) {\r\n            dataArray[i] = rawData.charCodeAt(i);\r\n        }\r\n        var blob = new Blob([dataArray], { type: mime });\r\n        // IE hack; see http://msdn.microsoft.com/en-us/library/ie/hh779016.aspx\r\n        var filename = (function () {\r\n            switch (mime) {\r\n                case \"image/svg\":\r\n                    return \"chemix.svg\";\r\n                case \"image/png\":\r\n                default:\r\n                    return \"chemix.png\";\r\n            }\r\n        })();\r\n        window.navigator.msSaveBlob(blob, filename);\r\n    }\r\n}\r\n/** Use after a switch to make sure all cases have been handled. */\r\nexport function assertUnreachable(e) {\r\n    throw new Error(\"Non-exhaustive switch\");\r\n}\r\nvar Lazy = /** @class */ (function () {\r\n    function Lazy(initializer) {\r\n        this.instance = null;\r\n        this.initializer = initializer;\r\n    }\r\n    Object.defineProperty(Lazy.prototype, \"value\", {\r\n        get: function () {\r\n            if (this.instance == null) {\r\n                this.instance = this.initializer();\r\n            }\r\n            return this.instance;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return Lazy;\r\n}());\r\nexport { Lazy };\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { commandProcessor } from \"command/command\";\r\nimport { Move } from \"editing/move\";\r\nimport { Tool } from \"paper\";\r\nimport store from \"store/store\";\r\nvar PanTool = /** @class */ (function (_super) {\r\n    __extends(PanTool, _super);\r\n    function PanTool(app) {\r\n        var _this = _super.call(this) || this;\r\n        _this.app = app;\r\n        _this.components = [];\r\n        _this.onMouseDown = function (event) {\r\n            _this.app.setIsInteracting(true);\r\n            var allIds = __spreadArrays(store.items().map(function (i) { return i.id; }), store.arrows().map(function (a) { return a.id; }));\r\n            _this.components = allIds.map(function (id) { return _this.app.getObjectComponent(id); });\r\n        };\r\n        _this.onMouseDrag = function (event) {\r\n            var delta = event.point.subtract(event.downPoint);\r\n            _this.components.map(function (c) { return c.setPositionDelta(delta); });\r\n        };\r\n        _this.onMouseUp = function (event) {\r\n            _this.app.setIsInteracting(false);\r\n            var delta = event.point.subtract(event.downPoint);\r\n            if (delta.isZero())\r\n                return;\r\n            commandProcessor.execute(new Move(_this.components.map(function (c) { return c.id; }), delta));\r\n            _this.components.length = 0;\r\n        };\r\n        return _this;\r\n    }\r\n    return PanTool;\r\n}(Tool));\r\nexport { PanTool };\r\n","import { P, SharedColors, SharedGradients } from \"apparatus/library/common\";\r\nimport { Group, Path, PointText } from \"paper\";\r\nvar MARKING_COLOR = \"#666666\";\r\nvar Protractor = /** @class */ (function () {\r\n    function Protractor() {\r\n    }\r\n    Protractor.prototype.render = function (appearance) {\r\n        var markings = appearance.labels;\r\n        var base = new Path();\r\n        base.moveTo(P(-50, 10));\r\n        base.lineTo(P(-50, 0));\r\n        base.arcTo(P(50, 0));\r\n        base.lineTo(P(50, 10));\r\n        base.close();\r\n        base.withStroke(\"default\", SharedColors.stroke).withGradientFill(\"right-down\", SharedGradients.glass);\r\n        var graphic = new Group([\r\n            base,\r\n            new Path.Arc(P(-10, 0), P(0, -10), P(10, 0)).withStroke(1.0, MARKING_COLOR),\r\n            new Path.Arc(P(-35, 0), P(0, -35), P(35, 0)).withStroke(1.0, MARKING_COLOR),\r\n        ]);\r\n        // Add markings.\r\n        var innerLineBase = new Path.Line(P(-10, 0), P(-35, 0)).withStroke(1.0, MARKING_COLOR);\r\n        var outerLineBase = new Path.Line(P(-47, 0), P(-50, 0)).withStroke(1.0, MARKING_COLOR);\r\n        for (var i = 0; i <= 18; i++) {\r\n            var angle = i * 10;\r\n            var innerLine = innerLineBase.clone();\r\n            if (i % 9 == 0)\r\n                innerLine.segments[0].point.x = 0;\r\n            innerLine.rotate(angle, P(0, 0));\r\n            var outerLine = outerLineBase.clone();\r\n            outerLine.rotate(angle, P(0, 0));\r\n            graphic.addChild(innerLine);\r\n            graphic.addChild(outerLine);\r\n            if (markings == \"all\" || (markings == \"every-second\" && i % 2 == 0)) {\r\n                // Larger font if only every second marking is shown.\r\n                var fontSize = markings == \"all\" ? 4 : 5.5;\r\n                var compression = markings == \"all\" ? 0.8 : 0.9;\r\n                var label = new PointText({\r\n                    point: P(0, -40),\r\n                    content: angle,\r\n                    fillColor: 'black',\r\n                    fontFamily: 'sans-serif',\r\n                    fontSize: fontSize,\r\n                    justification: 'center'\r\n                });\r\n                if (i == 9) {\r\n                    label.fontWeight = 'bold';\r\n                }\r\n                label.scale(compression, 1.0);\r\n                label.rotate(-90 + angle, P(0, 0));\r\n                graphic.addChild(label);\r\n            }\r\n        }\r\n        if (appearance.degree45) {\r\n            var degree45 = innerLineBase.clone();\r\n            degree45.segments[0].point.x = 0;\r\n            degree45.dashArray = [5, 3];\r\n            degree45.rotate(45, P(0, 0));\r\n            var degree135 = degree45.clone();\r\n            degree135.rotate(90, P(0, 0));\r\n            graphic.addChildren([degree45, degree135]);\r\n        }\r\n        innerLineBase.remove();\r\n        outerLineBase.remove();\r\n        graphic.scale(appearance.scale);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    Protractor.properties = {\r\n        label: \"Protractor\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            scale: 2.0,\r\n            labels: \"every-second\",\r\n            degree45: true,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 1.0, max: 3.0, step: 0.1, unit: \"%\",\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"labels\", label: \"Labels\",\r\n                options: [\r\n                    { value: \"off\", label: \"None\" },\r\n                    { value: \"every-second\", label: \"Every second\" },\r\n                    { value: \"all\", label: \"All\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"checkbox-group\", label: \"Markings\", checkboxes: [\r\n                    { key: \"degree45\", label: \"Show 45/135\" }\r\n                ]\r\n            },\r\n        ],\r\n    };\r\n    return Protractor;\r\n}());\r\nexport { Protractor };\r\n","import { setDefaultStyle } from \"apparatus/draw\";\r\nimport { Segments } from \"apparatus/library/common\";\r\nimport { Path } from \"paper\";\r\nimport { addEdgeLipsReversed, mirrorX } from \"../../draw\";\r\nvar PearFlask = /** @class */ (function () {\r\n    function PearFlask() {\r\n    }\r\n    PearFlask.prototype.render = function (appearance) {\r\n        var s = appearance.size / 100;\r\n        var shape = new Path(Segments([[10, -20]], [[10, 0], , [15 * s, 5 * s]], [[30 * s, 30 * s], [0, -15 * s], [0, 20 * s]], [[0, 90 * s], [10 * s, 0]]));\r\n        mirrorX(shape);\r\n        addEdgeLipsReversed(shape);\r\n        var liquidMask = shape.clone();\r\n        var graphic = shape;\r\n        setDefaultStyle(graphic);\r\n        return {\r\n            graphic: graphic,\r\n            liquidMask: liquidMask,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    PearFlask.properties = {\r\n        label: \"Pear-shaped flask\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            size: 120,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 80, max: 180,\r\n            }\r\n        ],\r\n    };\r\n    return PearFlask;\r\n}());\r\nexport { PearFlask };\r\n","var __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, Segments, SharedGradients } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\n/**\r\n * http://unisciencelab.com/product/combustion-spoon-nuffield/\r\n * https://www.sciencelab.co.ke/products/deflagrating-spoon-with-lid\r\n */\r\nvar CombustionSpoon = /** @class */ (function () {\r\n    function CombustionSpoon() {\r\n    }\r\n    CombustionSpoon.prototype.render = function (appearance) {\r\n        var bend = appearance.bend, cover = appearance.cover, shaded = appearance.shaded, largeSpoon = appearance.largeSpoon;\r\n        var spoon = new Path(largeSpoon\r\n            ? Segments([[0, 380], [0, 0], [0, 16]], [[22, 380], [0, 16], [0, 0]])\r\n            : Segments([[0, 380], [0, 0], [0, 3]], [[7, 380], [0, 3], [0, 0]])).withStroke(\"default\");\r\n        if (largeSpoon && shaded) {\r\n            spoon.close().withGradientFill(\"right\", SharedGradients.cylinderMetal);\r\n        }\r\n        var handle = new Path(Segments.apply(void 0, __spreadArrays([[[0, 0]]], (!bend ? [] :\r\n            [[[0, 240], , [0, 10]],\r\n                [[-12, 280], [0, -10]],\r\n                [[-12, 370], , [0, 5]]]), [[[0, 380], [0, -5]]]))).withStroke(\"default\");\r\n        var graphic = new Group([spoon, handle]);\r\n        if (cover) {\r\n            graphic.addChild(new Path.Line(P(-35, 0), P(35, 0))\r\n                .withStroke(\"thick\")\r\n                .setGradientStroke(\"right\", Gradients.cylinder(\"#f7ca6c\".color()))\r\n                .withPosition(P(0, appearance.coverPosition)));\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            pivot: P(0, 200),\r\n            hitShape: graphic.bounds.expand(10).toShape()\r\n        };\r\n    };\r\n    CombustionSpoon.properties = {\r\n        label: \"Combustion spoon\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            bend: false,\r\n            cover: false,\r\n            shaded: true,\r\n            largeSpoon: true,\r\n            coverPosition: 200,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"checkbox-group\", label: \"Spoon\",\r\n                checkboxes: [\r\n                    { key: \"largeSpoon\", label: \"Large\" },\r\n                    { key: \"shaded\", label: \"Shaded\", visible: function (a) { return a.largeSpoon; } },\r\n                ]\r\n            },\r\n            {\r\n                spec: \"checkbox-group\", label: \"Shaft\", checkboxes: [\r\n                    { key: \"bend\", label: \"Show bend\" },\r\n                    { key: \"cover\", label: \"Show cover\" },\r\n                ]\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"coverPosition\", label: \"Cover position\",\r\n                min: 160, max: 230,\r\n                visible: function (a) { return a.cover; }\r\n            },\r\n        ],\r\n    };\r\n    return CombustionSpoon;\r\n}());\r\nexport { CombustionSpoon };\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { g } from \"analytics\";\r\nimport { Remodal } from \"components/remodal\";\r\nimport * as React from 'react';\r\nimport { Articles } from \"support/beacon\";\r\nimport { Badge } from \"tiers/badge\";\r\nimport { TierContext } from \"tiers/context\";\r\nimport { isIEOrEdge, saveBlobHack } from \"utils\";\r\n/** Export image modal dialog. */\r\nvar ExportImage = /** @class */ (function (_super) {\r\n    __extends(ExportImage, _super);\r\n    function ExportImage(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.imageContainerRef = React.createRef();\r\n        _this.render = function () { return (React.createElement(Remodal.Container, { parent: _this, title: _this.title, icon: _this.state.isExportInProgress ? \"loading\" : \"fa-image\", center: true }, _this.state.exportedImages\r\n            ? _this.content_finished(_this.state.exportedImages)\r\n            : _this.content_inProgress())); };\r\n        /** Content to show when in progress. */\r\n        _this.content_inProgress = function () { return (React.createElement(\"p\", { key: \"a\" }, \"Larger images can take several seconds. Please be patient.\")); };\r\n        /** Content to show when export is finished. */\r\n        _this.content_finished = function (output) { return (React.createElement(TierContext.Consumer, null, function (tiers) { return ([\r\n            // Upgrade notice for higher quality.\r\n            !tiers.tier ? React.createElement(ImageQualityUpgrade, { key: \"image_quality_upgrade\", tiers: tiers }) : null,\r\n            // Container to hold the exported image, as a preview.\r\n            // This is empty and filled with an SVG in componentDidUpdate\r\n            React.createElement(\"div\", { key: \"imageContainer\", id: \"exported-image-container\", ref: _this.imageContainerRef }),\r\n            // On IE or Edge browser, show a notice.\r\n            isIEOrEdge() ? React.createElement(InternetExplorerNotice, { key: \"ieNotice\" }) : null,\r\n            // Instructions.\r\n            React.createElement(\"p\", { key: \"a\" }, \"Select a file format to download the image.\"),\r\n            // Export buttons.\r\n            React.createElement(\"p\", { key: \"export_buttons\", className: \"horizontal-button-group exportImageButtons\" },\r\n                React.createElement(DownloadButton, { key: \"jpg\", label: \"JPG\", mime: \"image/jpeg\", suffix: \"jpg\", data: output.jpgDataUrl, extraCss: \"highlight\" }),\r\n                React.createElement(DownloadButton, { key: \"png\", label: \"PNG\", mime: \"image/png\", suffix: \"png\", data: output.pngDataUrl }),\r\n                React.createElement(DownloadButton, { key: \"svg\", label: \"SVG\", mime: \"image/svg\", suffix: \"svg\", data: output.svgDataUrl, tiers: tiers })),\r\n            // Hint on which format to pick.\r\n            React.createElement(\"p\", { key: \"hint\", className: \"hint\" },\r\n                React.createElement(\"a\", { href: \"#\", \"data-beacon-article-sidebar\": Articles.IMAGE_FORMATS },\r\n                    React.createElement(\"i\", { className: \"fa fa-question-circle mr-1\" }),\r\n                    \"If unsure, select \\\"\",\r\n                    React.createElement(\"i\", { className: \"fa fa-download\" }),\r\n                    \" JPG\\\"\"))\r\n        ]); })); };\r\n        _this.state = __assign(__assign({}, Remodal.defaultState), { isExportInProgress: false });\r\n        return _this;\r\n    }\r\n    Object.defineProperty(ExportImage.prototype, \"title\", {\r\n        get: function () {\r\n            return this.state.isExportInProgress\r\n                ? \"Exporting diagram, please wait...\"\r\n                : \"Your diagram is ready!\";\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    ExportImage.prototype.componentDidUpdate = function () {\r\n        // Append the SVG image element if set.\r\n        var imageContainer = this.imageContainerRef.current;\r\n        if (imageContainer) {\r\n            if (this.state.exportedImages) {\r\n                imageContainer.appendChild(this.state.exportedImages.svgElement);\r\n            }\r\n            else {\r\n                // Remove children.\r\n                if (imageContainer.firstChild) {\r\n                    while (imageContainer.firstChild) {\r\n                        imageContainer.removeChild(imageContainer.firstChild);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return ExportImage;\r\n}(Remodal));\r\nexport { ExportImage };\r\n/** Download button for a particular image format. */\r\nvar DownloadButton = function (props) {\r\n    var isLocked = props.tiers && !props.tiers.allow(\"boost\");\r\n    return (React.createElement(\"a\", { className: \"remodal-confirm ui-button \" + props.extraCss || \"\", href: !isLocked ? props.data : undefined, onClick: function (e) { return !isLocked ? downloadImage(e.target, props.mime, props.label) : props.tiers.popup(\"SVG\"); }, download: \"chemix.\" + props.suffix },\r\n        React.createElement(\"i\", { className: \"fa fa-download\" }),\r\n        \" \",\r\n        props.label,\r\n        \" \\u00A0\",\r\n        isLocked ? React.createElement(Badge, { tier: \"boost\" }) : null));\r\n};\r\n/** IE has a rendering bug. Notify users of this. */\r\nvar InternetExplorerNotice = function () { return (React.createElement(\"p\", null,\r\n    React.createElement(\"b\", null, \"Internet Explorer/EDGE users:\"),\r\n    \" The preview may appear incorrect. \",\r\n    React.createElement(\"br\", null),\r\n    \"Do not worry, this does not affect the downloaded file.\")); };\r\n/** Handles downloading an image. */\r\nfunction downloadImage(element, mime, actionLog) {\r\n    g(\"SaveImage\", actionLog);\r\n    saveBlobHack(element, mime);\r\n}\r\nvar ImageQualityUpgrade = function (props) {\r\n    return React.createElement(\"div\", { className: \"inline-toast toast toast-info d-flex mb-3\" },\r\n        \"Your current image quality is Standard.\",\r\n        React.createElement(\"div\", { className: \"horizontal-button-group ml-auto pl-2\", style: { marginTop: \"-6px\", marginBottom: \"-6px\" } },\r\n            React.createElement(\"a\", { className: \"ui-button px-2\", href: \"#\", \"data-beacon-article-sidebar\": Articles.IMAGE_QUALITY }, \"Learn more\"),\r\n            React.createElement(\"div\", { className: \"ui-button px-2\", onClick: function () { return props.tiers.popup(\"ImageExport\"); } },\r\n                \"Upgrade to High Quality \",\r\n                React.createElement(Badge, { tier: \"boost\" }))));\r\n};\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { Balloon } from \"apparatus/library/accessories/balloon\";\r\nimport { Candle } from \"apparatus/library/accessories/candle\";\r\nimport { CorkRing } from \"apparatus/library/accessories/cork_ring\";\r\nimport { Goggles } from \"apparatus/library/accessories/goggles\";\r\nimport { DeskLamp } from \"apparatus/library/accessories/lamp\";\r\nimport { PaperClip } from \"apparatus/library/accessories/paper_clip\";\r\nimport { Scissors } from \"apparatus/library/accessories/scissors\";\r\nimport { Sellotape } from \"apparatus/library/accessories/sellotape\";\r\nimport { Smoke } from \"apparatus/library/accessories/smoke\";\r\nimport { Splint } from \"apparatus/library/accessories/splint\";\r\nimport { Tap } from \"apparatus/library/accessories/tap\";\r\nimport { TLCChamber } from \"apparatus/library/accessories/tlc_chamber\";\r\nimport { TLCPlate } from \"apparatus/library/accessories/tlc_plate\";\r\nimport { TLCSpot } from \"apparatus/library/accessories/tlc_spot\";\r\nimport { CottonWool } from \"apparatus/library/accessories/wool\";\r\nimport { Balance } from \"apparatus/library/balance\";\r\nimport { BenchMat } from \"apparatus/library/bench_mat\";\r\nimport { ChoiceChamber } from \"apparatus/library/biology/equipment/choice_chamber\";\r\nimport { CoverSlip } from \"apparatus/library/biology/equipment/cover_slip\";\r\nimport { Microplate } from \"apparatus/library/biology/equipment/microplates\";\r\nimport { MicroscopeSlide } from \"apparatus/library/biology/equipment/microscope_slide\";\r\nimport { PetriTop } from \"apparatus/library/biology/equipment/petri_top\";\r\nimport { Potometer } from \"apparatus/library/biology/equipment/potometer\";\r\nimport { Quadrat } from \"apparatus/library/biology/equipment/quadrat\";\r\nimport { Scalpel } from \"apparatus/library/biology/equipment/scalpel\";\r\nimport { Tweezers } from \"apparatus/library/biology/equipment/tweezers\";\r\nimport { WaterBath } from \"apparatus/library/biology/equipment/water_bath\";\r\nimport { Agar } from \"apparatus/library/biology/organic/agar\";\r\nimport { Bacteria } from \"apparatus/library/biology/organic/bacteria\";\r\nimport { Bug } from \"apparatus/library/biology/organic/bug\";\r\nimport { Leaf } from \"apparatus/library/biology/organic/leaf\";\r\nimport { PlantShoot } from \"apparatus/library/biology/organic/plant_shoot\";\r\nimport { PondWeed } from \"apparatus/library/biology/organic/pond_weed\";\r\nimport { Potato } from \"apparatus/library/biology/organic/potato\";\r\nimport { Root } from \"apparatus/library/biology/organic/root\";\r\nimport { Seed } from \"apparatus/library/biology/organic/seed\";\r\nimport { Shoot } from \"apparatus/library/biology/organic/shoot\";\r\nimport { StreakedBacteria } from \"apparatus/library/biology/organic/streaked_bacteria\";\r\nimport { Dirt } from \"apparatus/library/biology/other/dirt\";\r\nimport { PlantPot } from \"apparatus/library/biology/other/plant_pot\";\r\nimport { Sun } from \"apparatus/library/biology/other/sun\";\r\nimport { Borked } from \"apparatus/library/borked\";\r\nimport { Bung } from \"apparatus/library/bung\";\r\nimport { Burette } from \"apparatus/library/burette\";\r\nimport { CapillaryTube } from \"apparatus/library/capillary_tube\";\r\nimport { DEFAULT_LIQUID_DATA } from \"apparatus/library/common\";\r\nimport { CellCultureFlask } from \"apparatus/library/container/cell_flask\";\r\nimport { CentrifugeTube } from \"apparatus/library/container/centrifugeTube\";\r\nimport { EppendorfTube } from \"apparatus/library/container/eppendorfTube\";\r\nimport { ThermosFlask } from \"apparatus/library/container/thermos_flask\";\r\nimport { WeightBoat } from \"apparatus/library/container/weight_boat\";\r\nimport { Crucible, CrucileCover } from \"apparatus/library/crucible\";\r\nimport { Cuvette } from \"apparatus/library/cuvette\";\r\nimport { Camera, VideoCamera } from \"apparatus/library/decorative/camera\";\r\nimport { Drop } from \"apparatus/library/decorative/drop\";\r\nimport { Eye } from \"apparatus/library/decorative/eye\";\r\nimport { Mirror } from \"apparatus/library/decorative/mirror\";\r\nimport { Particles } from \"apparatus/library/decorative/particles\";\r\nimport { Desiccator } from \"apparatus/library/desiccator\";\r\nimport { Centrifuge } from \"apparatus/library/devices/centrifuge\";\r\nimport { Hofmann } from \"apparatus/library/devices/hofmann\";\r\nimport { Rotavap } from \"apparatus/library/devices/rotavap\";\r\nimport { Spectrophotometer } from \"apparatus/library/devices/spectrophotometer\";\r\nimport { SpetrophotometerSchematic } from \"apparatus/library/devices/spectrophotometer_schematic\";\r\nimport { AllihnCondenser2 } from \"apparatus/library/distillation/allihn\";\r\nimport { CowType } from \"apparatus/library/distillation/cow_type\";\r\nimport { DeanStarTrap as DeanStarkTrap } from \"apparatus/library/distillation/dean_stark_trap\";\r\nimport { FractionatingColumn2 } from \"apparatus/library/distillation/fractionating\";\r\nimport { LiebigCondenser } from \"apparatus/library/distillation/liebig\";\r\nimport { OilBubbler } from \"apparatus/library/distillation/oil_bubbler\";\r\nimport { ReceiverAdaptor } from \"apparatus/library/distillation/receiver_adaptor\";\r\nimport { SoxhletExtractor } from \"apparatus/library/distillation/soxhlet\";\r\nimport { SplashHead } from \"apparatus/library/distillation/splash_head\";\r\nimport { Vigreux } from \"apparatus/library/distillation/vigreux\";\r\nimport { Dropper } from \"apparatus/library/dropper\";\r\nimport { SimpleAmmeter } from \"apparatus/library/electrical/ammeter\";\r\nimport { Battery } from \"apparatus/library/electrical/battery\";\r\nimport { CrocodileClips } from \"apparatus/library/electrical/crocodile_clip\";\r\nimport { Magnet } from \"apparatus/library/electrical/magnet\";\r\nimport { PowerPack } from \"apparatus/library/electrical/powerpack\";\r\nimport { SimpleVoltmeter } from \"apparatus/library/electrical/voltmeter\";\r\nimport { EvaporatingDish } from \"apparatus/library/evaporating_dish\";\r\nimport { FilterFunnel, FilterPaper, FlutedFilterPaper } from \"apparatus/library/filter\";\r\nimport { GasJar } from \"apparatus/library/gas_jar\";\r\nimport { GasSyringe } from \"apparatus/library/gas_syringe\";\r\nimport { GasWashBottle } from \"apparatus/library/gas_wash_bottle\";\r\nimport { GlassWool } from \"apparatus/library/glass_wool\";\r\nimport { BoilingTube, BoilingTubeWithSideArm } from \"apparatus/library/heating/boilingtube\";\r\nimport { CombustionSpoon } from \"apparatus/library/heating/combustion_spoon\";\r\nimport { Peg } from \"apparatus/library/heating/peg\";\r\nimport { StickLighter } from \"apparatus/library/heating/stick_lighter\";\r\nimport { TestTubeHolder } from \"apparatus/library/heating/testTubeHolder\";\r\nimport { TorchBurner } from \"apparatus/library/heating/torch\";\r\nimport { HotPlate } from \"apparatus/library/hot_plate\";\r\nimport { MagneticStirrer, StirBar } from \"apparatus/library/magnetic_stirrer\";\r\nimport { OxSatProbe } from \"apparatus/library/measure/oxsat_probe\";\r\nimport { BeamBalance } from \"apparatus/library/measurement/beam_balance\";\r\nimport { DigitalAmmemter, DigitalVoltmeter } from \"apparatus/library/measurement/digital_meters\";\r\nimport { Hydrometer } from \"apparatus/library/measurement/hydrometer\";\r\nimport { Manometer } from \"apparatus/library/measurement/manometer\";\r\nimport { Micropipette } from \"apparatus/library/measurement/micropipette\";\r\nimport { Protractor } from \"apparatus/library/measurement/protractor\";\r\nimport { SuctionPear } from \"apparatus/library/measurement/suction_pear\";\r\nimport { TapeMeasure } from \"apparatus/library/measurement/tape\";\r\nimport { TripleBeamBalance } from \"apparatus/library/measurement/triple_beam_balance\";\r\nimport { VernierCaliper } from \"apparatus/library/measurement/vernier\";\r\nimport { HoffmanClamp } from \"apparatus/library/metallic/hoffman_clamp\";\r\nimport { NichromeLoop } from \"apparatus/library/metallic/nichrome_loops\";\r\nimport { SteelWool } from \"apparatus/library/metallic/steel_wool\";\r\nimport { MetalStrip } from \"apparatus/library/metalstrip\";\r\nimport { Mortar, Pestle } from \"apparatus/library/mortar\";\r\nimport { Nail } from \"apparatus/library/nail\";\r\nimport { Cable } from \"apparatus/library/physics/cable\";\r\nimport { GlassBlock } from \"apparatus/library/physics/glass_block\";\r\nimport { LightGate } from \"apparatus/library/physics/light_gates\";\r\nimport { Pulley } from \"apparatus/library/physics/pulley\";\r\nimport { Ramp } from \"apparatus/library/physics/ramp\";\r\nimport { RayBox } from \"apparatus/library/physics/raybox\";\r\nimport { SlottedWeight } from \"apparatus/library/physics/slotted_weight\";\r\nimport { Solenoid } from \"apparatus/library/physics/solenoid\";\r\nimport { Spring } from \"apparatus/library/physics/spring\";\r\nimport { Trolley } from \"apparatus/library/physics/trolley\";\r\nimport { MohrPipette, Pipette, PlasticPipette } from \"apparatus/library/pipette\";\r\nimport { Pump } from \"apparatus/library/pump\";\r\nimport { RasterImage } from \"apparatus/library/raster_image\";\r\nimport { ReagentBottle } from \"apparatus/library/reagent_bottle\";\r\nimport { RetortStand } from \"apparatus/library/retort\";\r\nimport { Ruler } from \"apparatus/library/ruler\";\r\nimport { SchlenkFlask } from \"apparatus/library/schlenk_flask\";\r\nimport { Arrow } from \"apparatus/library/shapes/arrow\";\r\nimport { Cross } from \"apparatus/library/shapes/cross\";\r\nimport { Curve, CurvedArrow, StirArrow } from \"apparatus/library/shapes/curve\";\r\nimport { Ellipse } from \"apparatus/library/shapes/ellipse\";\r\nimport { Line } from \"apparatus/library/shapes/line\";\r\nimport { Rectangle } from \"apparatus/library/shapes/rectangle\";\r\nimport { Star } from \"apparatus/library/shapes/star\";\r\nimport { Tick } from \"apparatus/library/shapes/tick\";\r\nimport { Triangle } from \"apparatus/library/shapes/triangle\";\r\nimport { Spatula } from \"apparatus/library/spatula\";\r\nimport { PlasticReagentBottle } from \"apparatus/library/storage/plastic_reagent_bottle\";\r\nimport { BuretteClamp } from \"apparatus/library/structure/burette_clamp\";\r\nimport { Syringe } from \"apparatus/library/syringe\";\r\nimport { TestTubeRack } from \"apparatus/library/test_tube_rack\";\r\nimport { Timer } from \"apparatus/library/timer\";\r\nimport { OsmosisTube } from \"apparatus/library/transportation/osmosis_tube\";\r\nimport { SchlenkLines } from \"apparatus/library/transportation/schlenk_lines\";\r\nimport { Tripod } from \"apparatus/library/tripod\";\r\nimport { Tube, TubeBend } from \"apparatus/library/tubes\";\r\nimport { VolumetricFlask } from \"apparatus/library/volumetric_flask\";\r\nimport { WatchGlass } from \"apparatus/library/watch_glass\";\r\nimport { WireGauze } from \"apparatus/library/wire_gauze\";\r\nimport { FreehandDrawing } from \"freehand/apparatus\";\r\nimport { ID } from \"store/id\";\r\nimport { Bottle } from \"./accessories/bottle\";\r\nimport { DropCounter } from \"./accessories/drop_counter\";\r\nimport { Faucet } from \"./accessories/faucet\";\r\nimport { FeltTipPen } from \"./accessories/felt_tip_pen\";\r\nimport { GHSHazardSymbol } from \"./accessories/ghs_hazard_symbol\";\r\nimport { GlassStopper } from \"./accessories/glass_stopper\";\r\nimport { Glove } from \"./accessories/glove\";\r\nimport { PlasticJointClip } from \"./accessories/joint_clip\";\r\nimport { Microscope } from \"./accessories/microscope\";\r\nimport { Pencil } from \"./accessories/pencil\";\r\nimport { PhPaper, PhPaperPack } from \"./accessories/ph_paper\";\r\nimport { Beaker, DisplacementBeaker } from \"./beaker\";\r\nimport { BuchnerFunnel } from \"./buchner\";\r\nimport { BunsenBurner } from \"./bunsen\";\r\nimport { Clamp, FrontClamp, Ring } from \"./clamp\";\r\nimport { ColdFinger } from \"./coldfinger\";\r\nimport { GasCylinder } from \"./container/gas_cylinder\";\r\nimport { PearFlask } from \"./container/pear_flask\";\r\nimport { ThistleTube } from \"./container/thistle\";\r\nimport { Cylinder } from \"./cylinder\";\r\nimport { Beads } from \"./decorative/beads\";\r\nimport { Bubbles } from \"./decorative/bubbles\";\r\nimport { Crystals } from \"./decorative/crystals\";\r\nimport { Flame } from \"./decorative/flame\";\r\nimport { IceCube } from \"./decorative/ice_cube\";\r\nimport { Label } from \"./decorative/label\";\r\nimport { Powder } from \"./decorative/powder\";\r\nimport { FumeHood } from \"./devices/fume_hood\";\r\nimport { Sonicator } from \"./devices/sonicator\";\r\nimport { DistillationFlask } from \"./distillation/distillation_flask\";\r\nimport { DistillationHead } from \"./distillation/distillation_head\";\r\nimport { GrahamCondenser2 } from \"./distillation/graham\";\r\nimport { WaterlessCondenser } from \"./distillation/waterless_condenser\";\r\nimport { ConicalFlask, ConicalFlaskWithSideArm } from \"./flask\";\r\nimport { Beehive } from \"./heating/beehive\";\r\nimport { CalorimetryCup } from \"./heating/calorimetry_cup\";\r\nimport { ClayTriangle } from \"./heating/clay_triangle\";\r\nimport { HeatingMantle } from \"./heating/mantle\";\r\nimport { SandBath } from \"./heating/sandbath\";\r\nimport { SpiritLamp } from \"./heating/spirit_lamp\";\r\nimport { Tongs } from \"./heating/tongs\";\r\nimport { Lamp } from \"./lamp\";\r\nimport { LiveEditApparatus } from \"./live_apparatus\";\r\nimport { Conductimeter } from \"./measure/conductimeter\";\r\nimport { DigitalThermometer } from \"./measure/digital_themormeter\";\r\nimport { PhProbe } from \"./measure/ph_probe\";\r\nimport { PipetteBottle } from \"./measurement/pipette_bottle\";\r\nimport { PetriDish } from \"./petri\";\r\nimport { BoilingFlask, RoundBottomFlask } from \"./roundBottomFlask\";\r\nimport { SeparatoryFunnel } from \"./separatory\";\r\nimport { Cuboid } from \"./shapes/cuboid\";\r\nimport { Cylinder as Cylinder3d } from \"./shapes/cylinder\";\r\nimport { Sphere } from \"./shapes/sphere\";\r\nimport { SpottingTile } from \"./spotting_tile\";\r\nimport { StirringRod } from \"./stirringRod\";\r\nimport { BuretteHolder } from \"./structure/burette_holder\";\r\nimport { LabJack } from \"./structure/jack\";\r\nimport { Table } from \"./table\";\r\nimport { Tank } from \"./tank\";\r\nimport { TestTube, TestTubeWithSideArm } from \"./testTube\";\r\nimport { Thermometer } from \"./thermometer\";\r\nimport { ThieleTube } from \"./thiele\";\r\nimport { DialysisTube } from \"./transportation/dialysis\";\r\nimport { DroppingFunnel } from \"./transportation/drop_funnel\";\r\nimport { AdapterTube, FourWayCrossing, STube, ThreeWayCrossing, UTube } from \"./tubes\";\r\nimport { WashBottle } from \"./utility/wash_bottle\";\r\nexport function createApparatus(type, position) {\r\n    var properties = apparatusClass(type).properties;\r\n    var liquidData = properties.defaultLiquidData || DEFAULT_LIQUID_DATA;\r\n    return {\r\n        id: ID.mint(\"apparatus\"),\r\n        type: type,\r\n        x: position.x,\r\n        y: position.y,\r\n        rotation: properties.defaultRotation || 0,\r\n        selected: false,\r\n        flipped: false,\r\n        appearance: __assign({}, properties.defaultAppearance),\r\n        liquid: properties.canContainLiquids ? liquidData : undefined\r\n    };\r\n}\r\nexport function apparatusClass(id) {\r\n    switch (id) {\r\n        case \"__live edit__\": return LiveEditApparatus;\r\n        case \"__brk\": return Borked;\r\n        case \"__raster image__\": return RasterImage;\r\n        case \"__freehand\": return FreehandDrawing;\r\n        case \"beaker\": return Beaker;\r\n        case \"test tube\": return TestTube;\r\n        case \"test tube with side arm\": return TestTubeWithSideArm;\r\n        case \"thermometer\": return Thermometer;\r\n        case \"conical flask\": return ConicalFlask;\r\n        case \"table\": return Table;\r\n        case \"petri dish\": return PetriDish;\r\n        case \"round bottom flask\": return RoundBottomFlask;\r\n        case \"retort stand\": return RetortStand;\r\n        case \"tank\": return Tank;\r\n        case \"cylinder\": return Cylinder;\r\n        case \"stirring rod\": return StirringRod;\r\n        case \"clamp\": return Clamp;\r\n        case \"clamp front\": return FrontClamp;\r\n        case \"bunsen\": return BunsenBurner;\r\n        case \"bung\": return Bung;\r\n        case \"volumetric flask\": return VolumetricFlask;\r\n        case \"reagent bottle\": return ReagentBottle;\r\n        case \"balance\": return Balance;\r\n        case \"pipette\": return Pipette;\r\n        case \"tube bend\": return TubeBend;\r\n        case \"tube\": return Tube;\r\n        case \"eye\": return Eye;\r\n        case \"dropper pipette\": return Dropper;\r\n        case \"magnetic stirrer-heater\": return MagneticStirrer;\r\n        case \"glass wool\": return GlassWool;\r\n        case \"tripod\": return Tripod;\r\n        case \"hot plate\": return HotPlate;\r\n        case \"magnetic stir bar\": return StirBar;\r\n        case \"liebig condenser\": return LiebigCondenser;\r\n        case \"burette\": return Burette;\r\n        case \"pump\": return Pump;\r\n        case \"fractionating column\": return FractionatingColumn2;\r\n        case \"filter funnel\": return FilterFunnel;\r\n        case \"drop\": return Drop;\r\n        case \"displacement beaker\": return DisplacementBeaker;\r\n        case \"filter paper\": return FilterPaper;\r\n        case \"fluted filter paper\": return FlutedFilterPaper;\r\n        case \"boiling flask\": return BoilingFlask;\r\n        case \"wire gauze\": return WireGauze;\r\n        case \"spatula\": return Spatula;\r\n        case \"gas jar\": return GasJar;\r\n        case \"pestle\": return Pestle;\r\n        case \"mortar\": return Mortar;\r\n        case \"test tube rack\": return TestTubeRack;\r\n        case \"thiele tube\": return ThieleTube;\r\n        case \"crucible\": return Crucible;\r\n        case \"cuvette\": return Cuvette;\r\n        case \"crucible cover\": return CrucileCover;\r\n        case \"desiccator\": return Desiccator;\r\n        case \"evaporating dish\": return EvaporatingDish;\r\n        case \"lamp\": return Lamp;\r\n        case \"timer\": return Timer;\r\n        case \"label\": return Label;\r\n        case \"spotting tile\": return SpottingTile;\r\n        case \"retort ring\": return Ring;\r\n        case \"plastic pipette\": return PlasticPipette;\r\n        case \"watch glass\": return WatchGlass;\r\n        case \"nail\": return Nail;\r\n        case \"bench mat\": return BenchMat;\r\n        case \"wooden splint\": return Splint;\r\n        case \"capillary tube\": return CapillaryTube;\r\n        case \"gas wash bottle\": return GasWashBottle;\r\n        case \"4-way crossing\": return FourWayCrossing;\r\n        case \"3-way crossing\": return ThreeWayCrossing;\r\n        case \"u-bent tube\": return UTube;\r\n        case \"s-bent tube\": return STube;\r\n        case \"glove\": return Glove;\r\n        case \"goggles\": return Goggles;\r\n        case \"gas syringe\": return GasSyringe;\r\n        case \"tube adapter\": return AdapterTube;\r\n        case \"ruler\": return Ruler;\r\n        case \"allihn\": return AllihnCondenser2;\r\n        case \"graham\": return GrahamCondenser2;\r\n        case \"cold finger\": return ColdFinger;\r\n        case \"conical flask with side arm\": return ConicalFlaskWithSideArm;\r\n        case \"buchner\": return BuchnerFunnel;\r\n        case \"separatory funnel\": return SeparatoryFunnel;\r\n        case \"tongs\": return Tongs;\r\n        case \"bubbles\": return Bubbles;\r\n        case \"crystals\": return Crystals;\r\n        case \"sand bath\": return SandBath;\r\n        case \"beehive stand\": return Beehive;\r\n        case \"clay triangle\": return ClayTriangle;\r\n        case \"digital thermometer\": return DigitalThermometer;\r\n        case \"calorimetry cup\": return CalorimetryCup;\r\n        case \"boiling tube\": return BoilingTube;\r\n        case \"boiling tube with sidearm\": return BoilingTubeWithSideArm;\r\n        case \"wash bottle\": return WashBottle;\r\n        case \"metal strip\": return MetalStrip;\r\n        case \"thistle tube\": return ThistleTube;\r\n        case \"pipette bottle\": return PipetteBottle;\r\n        case \"ice cube\": return IceCube;\r\n        case \"spirit lamp\": return SpiritLamp;\r\n        case \"powder\": return Powder;\r\n        case \"heating mantle\": return HeatingMantle;\r\n        case \"waterless condenser\": return WaterlessCondenser;\r\n        case \"burette holder\": return BuretteHolder;\r\n        case \"ph probe\": return PhProbe;\r\n        case \"conductimeter\": return Conductimeter;\r\n        case \"ghs hazard\": return GHSHazardSymbol;\r\n        case \"flame\": return Flame;\r\n        case \"peg\": return Peg;\r\n        case \"test tube holder\": return TestTubeHolder;\r\n        case \"centrifuge tube\": return CentrifugeTube;\r\n        case \"eppendorf tube\": return EppendorfTube;\r\n        case \"lab jack\": return LabJack;\r\n        case \"gas cylinder\": return GasCylinder;\r\n        case \"distillation head\": return DistillationHead;\r\n        case \"dropping funnel\": return DroppingFunnel;\r\n        case \"plastic joint clip\": return PlasticJointClip;\r\n        case \"glass stopper\": return GlassStopper;\r\n        case \"distillation flask\": return DistillationFlask;\r\n        case \"pear-shaped flask\": return PearFlask;\r\n        case \"microscope\": return Microscope;\r\n        case \"receiver adaptor\": return ReceiverAdaptor;\r\n        case \"schlenk flask\": return SchlenkFlask;\r\n        case \"dean-stark trap\": return DeanStarkTrap;\r\n        case \"croc clips\": return CrocodileClips;\r\n        case \"soxhlet extractor\": return SoxhletExtractor;\r\n        case \"rectangle\": return Rectangle;\r\n        case \"ellipse\": return Ellipse;\r\n        case \"schlenk lines\": return SchlenkLines;\r\n        case \"particles\": return Particles;\r\n        case \"plastic reagent bottle\": return PlasticReagentBottle;\r\n        case \"cork ring\": return CorkRing;\r\n        case \"rotavap\": return Rotavap;\r\n        case \"nichrome loop\": return NichromeLoop;\r\n        case \"leaf\": return Leaf;\r\n        case \"potato\": return Potato;\r\n        case \"hofmann\": return Hofmann;\r\n        case \"tlc plate\": return TLCPlate;\r\n        case \"tlc spot\": return TLCSpot;\r\n        case \"seed\": return Seed;\r\n        case \"petri top\": return PetriTop;\r\n        case \"cotton wool\": return CottonWool;\r\n        case \"agar\": return Agar;\r\n        case \"microscope slide\": return MicroscopeSlide;\r\n        case \"cover slip\": return CoverSlip;\r\n        case \"potometer\": return Potometer;\r\n        case \"tweezers\": return Tweezers;\r\n        case \"plant shoot\": return PlantShoot;\r\n        case \"shoot\": return Shoot;\r\n        case \"pot\": return PlantPot;\r\n        case \"pond weed\": return PondWeed;\r\n        case \"sun\": return Sun;\r\n        case \"quadrat\": return Quadrat;\r\n        case \"scalpel\": return Scalpel;\r\n        case \"dirt\": return Dirt;\r\n        case \"bacteria\": return Bacteria;\r\n        case \"cross\": return Cross;\r\n        case \"desk lamp\": return DeskLamp;\r\n        case \"splash head\": return SplashHead;\r\n        case \"tick\": return Tick;\r\n        case \"arrow\": return Arrow;\r\n        case \"beads\": return Beads;\r\n        case \"water bath\": return WaterBath;\r\n        case \"tape measure\": return TapeMeasure;\r\n        case \"root\": return Root;\r\n        case \"syringe\": return Syringe;\r\n        case \"bug\": return Bug;\r\n        case \"3dcylinder\": return Cylinder3d;\r\n        case \"scissors\": return Scissors;\r\n        case \"tap\": return Tap;\r\n        case \"curve\": return Curve;\r\n        case \"curved arrow\": return CurvedArrow;\r\n        case \"stir arrow\": return StirArrow;\r\n        case \"line\": return Line;\r\n        case \"cowtype\": return CowType;\r\n        case \"oil bubbler\": return OilBubbler;\r\n        case \"vigreux\": return Vigreux;\r\n        case \"mohr\": return MohrPipette;\r\n        case \"micropipette\": return Micropipette;\r\n        case \"microplate\": return Microplate;\r\n        case \"suction pear\": return SuctionPear;\r\n        case \"steel wool\": return SteelWool;\r\n        case \"hoffman clamp\": return HoffmanClamp;\r\n        case \"cell flask\": return CellCultureFlask;\r\n        case \"burette clamp\": return BuretteClamp;\r\n        case \"battery\": return Battery;\r\n        case \"camera\": return Camera;\r\n        case \"videocamera\": return VideoCamera;\r\n        case \"thermos\": return ThermosFlask;\r\n        case \"stick lighter\": return StickLighter;\r\n        case \"torch burner\": return TorchBurner;\r\n        case \"hydrometer\": return Hydrometer;\r\n        case \"balloon\": return Balloon;\r\n        case \"star\": return Star;\r\n        case \"streaked bacteria\": return StreakedBacteria;\r\n        case \"manometer\": return Manometer;\r\n        case \"osmosis tube\": return OsmosisTube;\r\n        case \"dialysis tube\": return DialysisTube;\r\n        case \"faucet\": return Faucet;\r\n        case \"adhesive tape\": return Sellotape;\r\n        case \"sonicator\": return Sonicator;\r\n        case \"bottle\": return Bottle;\r\n        case \"cuboid\": return Cuboid;\r\n        case \"ph paper\": return PhPaper;\r\n        case \"ph paper pack\": return PhPaperPack;\r\n        case \"drop counter\": return DropCounter;\r\n        case \"sphere\": return Sphere;\r\n        case \"fume hood\": return FumeHood;\r\n        case \"triangle\": return Triangle;\r\n        case \"pencil\": return Pencil;\r\n        case \"felt tip pen\": return FeltTipPen;\r\n        case \"spectrophotometer\": return Spectrophotometer;\r\n        case \"spectrophotometer-s\": return SpetrophotometerSchematic;\r\n        case \"candle\": return Candle;\r\n        case \"triple beam balance\": return TripleBeamBalance;\r\n        case \"smoke\": return Smoke;\r\n        case \"protractor\": return Protractor;\r\n        case \"beam balance\": return BeamBalance;\r\n        case \"oxsat probe\": return OxSatProbe;\r\n        case \"powerpack\": return PowerPack;\r\n        case \"spring\": return Spring;\r\n        case \"mirror\": return Mirror;\r\n        case \"combustion spoon\": return CombustionSpoon;\r\n        case \"magnet\": return Magnet;\r\n        case \"voltmeter-s\": return SimpleVoltmeter;\r\n        case \"ammeter-s\": return SimpleAmmeter;\r\n        case \"pulley\": return Pulley;\r\n        case \"cable\": return Cable;\r\n        case \"glass block\": return GlassBlock;\r\n        case \"slotted weight\": return SlottedWeight;\r\n        case \"raybox\": return RayBox;\r\n        case \"choice chamber\": return ChoiceChamber;\r\n        case \"vernier\": return VernierCaliper;\r\n        case \"digital voltmeter\": return DigitalVoltmeter;\r\n        case \"digital ammeter\": return DigitalAmmemter;\r\n        case \"solenoid\": return Solenoid;\r\n        case \"centrifuge\": return Centrifuge;\r\n        case \"weight boat\": return WeightBoat;\r\n        case \"paperclip\": return PaperClip;\r\n        case \"trolley\": return Trolley;\r\n        case \"ramp\": return Ramp;\r\n        case \"light gate\": return LightGate;\r\n        case \"tlc chamber\": return TLCChamber;\r\n    }\r\n}\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { setDefaultStyle } from \"apparatus/draw\";\r\nimport { P, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nimport { CommonCondenser, condenserCaseShape } from \"../condensers\";\r\nvar AllihnCondenser2 = /** @class */ (function () {\r\n    function AllihnCondenser2() {\r\n    }\r\n    AllihnCondenser2.isBoostRequiredForAppearance = function (appearance) {\r\n        return CommonCondenser.isBoostRequiredForAppearance(appearance);\r\n    };\r\n    AllihnCondenser2.prototype.render = function (appearance) {\r\n        var ports = appearance.ports, height = appearance.height;\r\n        var _a = condenserCaseShape(height, 15, ports), casing = _a.group, snapping = _a.snap;\r\n        var insideTube1 = new Path(Segments([[-7.5, 0]], [[-7.5, 10]], [[-5, 25]]));\r\n        var repeats = Math.floor((height - 60) / 35);\r\n        var offset = (height - repeats * 35) / 2 + 5;\r\n        for (var i = 0; i < repeats; i++) {\r\n            var y = 35 * i + offset;\r\n            insideTube1.addSegments(Segments([[-5, y], , [-7, 4]], [[-5, y + 25], [-7, -4]]));\r\n        }\r\n        insideTube1.addSegments(Segments([[-5, height - 25]], [[-7.5, height - 10]], [[-7.5, height]]));\r\n        var insideTube2 = insideTube1.clone();\r\n        insideTube2.scale(-1.0, 1.0, P(0, 0));\r\n        var graphic = new Group([casing, insideTube1, insideTube2]);\r\n        setDefaultStyle(graphic);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: snapping,\r\n            pivot: P(0, height / 2)\r\n        };\r\n    };\r\n    AllihnCondenser2.properties = {\r\n        label: \"Allihn Condenser\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: __assign({}, CommonCondenser.defaultAppearance),\r\n        appearanceSpecs: __spreadArrays(CommonCondenser.appearanceSpecs),\r\n    };\r\n    return AllihnCondenser2;\r\n}());\r\nexport { AllihnCondenser2 };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport * as Sentry from '@sentry/react';\r\nimport { loginProviderDisplayName } from \"api/auth/login_button\";\r\nimport { clearToken } from \"api/auth/storage\";\r\nimport { Arrays } from \"ext/array\";\r\nimport { ID } from \"store/id\";\r\nimport { Bcn } from \"support/beacon\";\r\nimport { getType } from 'typesafe-actions';\r\nimport * as actions from './actions';\r\nexport default (function (state, action) {\r\n    switch (action.type) {\r\n        case getType(actions.addItems): {\r\n            return __assign(__assign({}, state), { items: __spreadArrays(state.items, action.payload) });\r\n        }\r\n        case getType(actions.addItemsAtIndices): {\r\n            return (function () {\r\n                var newState = __assign({}, state);\r\n                var sortedByIndex = action.payload.sort(function (a, b) { return a.index - b.index; });\r\n                sortedByIndex.forEach(function (_a) {\r\n                    var item = _a.item, index = _a.index;\r\n                    newState.items.splice(index, 0, item);\r\n                });\r\n                return newState;\r\n            })();\r\n        }\r\n        case getType(actions.updateAppearance): {\r\n            var _a = action.payload, id_1 = _a.id, key_1 = _a.key, value_1 = _a.value;\r\n            var newState = __assign({}, state);\r\n            newState.items = state.items.map(function (item) {\r\n                if (item.id === id_1) {\r\n                    var newAppearance = __assign({}, item.appearance);\r\n                    newAppearance[key_1] = value_1;\r\n                    return __assign(__assign({}, item), { appearance: newAppearance });\r\n                }\r\n                return item;\r\n            });\r\n            return newState;\r\n        }\r\n        case getType(actions.updateItemsAppearance): {\r\n            var _b = action.payload, key_2 = _b.key, idsToValuesMap_1 = _b.idsToValuesMap;\r\n            var newState = __assign({}, state);\r\n            newState.items = state.items.map(function (item) {\r\n                var _a;\r\n                var newValue = idsToValuesMap_1[item.id.id];\r\n                if (newValue !== undefined) {\r\n                    return __assign(__assign({}, item), { appearance: __assign(__assign({}, item.appearance), (_a = {}, _a[key_2] = newValue, _a)) });\r\n                }\r\n                return item;\r\n            });\r\n            return newState;\r\n        }\r\n        case getType(actions.updateAppearanceProperties): {\r\n            var _c = action.payload, id_2 = _c.id, props_1 = _c.props;\r\n            var newState = __assign({}, state);\r\n            newState.items = state.items.map(function (item) {\r\n                return item.id === id_2\r\n                    ? __assign(__assign({}, item), { appearance: __assign(__assign({}, item.appearance), props_1) }) : item;\r\n            });\r\n            return newState;\r\n        }\r\n        case getType(actions.updateItemsAppearanceProperties): {\r\n            var _d = action.payload, ids_1 = _d.ids, props_2 = _d.props;\r\n            var newState = __assign({}, state);\r\n            newState.items = state.items.map(function (item) {\r\n                return Arrays.includes(ids_1, item.id)\r\n                    ? __assign(__assign({}, item), { appearance: __assign(__assign({}, item.appearance), props_2) }) : item;\r\n            });\r\n            return newState;\r\n        }\r\n        case getType(actions.removeItems): {\r\n            var ids = action.payload.ids;\r\n            var newState = __assign({}, state);\r\n            newState.items = state.items.filter(ID.notMatching(ids));\r\n            return newState;\r\n        }\r\n        case getType(actions.addToGroup): {\r\n            var groupsOperationData_1 = action.payload.data;\r\n            var newState = __assign({}, state);\r\n            var existingGroupIdNumbers_1 = [];\r\n            newState.groups = newState.groups.map(function (group) {\r\n                var _a;\r\n                if (!(group.id.id in groupsOperationData_1)) {\r\n                    return group;\r\n                }\r\n                existingGroupIdNumbers_1.push(group.id.id);\r\n                var childIdsToAdd = groupsOperationData_1[group.id.id];\r\n                (_a = group.items).push.apply(_a, childIdsToAdd);\r\n                return group;\r\n            });\r\n            // Add any new groups.\r\n            for (var groupIdNumber in groupsOperationData_1) {\r\n                var groupIdNumberAsNumber = +groupIdNumber;\r\n                if (existingGroupIdNumbers_1.indexOf(groupIdNumberAsNumber) === -1) {\r\n                    // Group does not exist yet.\r\n                    newState.groups.push({\r\n                        id: action.payload.groupIds[groupIdNumber],\r\n                        items: groupsOperationData_1[groupIdNumber]\r\n                    });\r\n                }\r\n            }\r\n            return newState;\r\n        }\r\n        case getType(actions.removeFromGroup): {\r\n            var groupsOperationData = action.payload.data;\r\n            var newState = __assign({}, state);\r\n            var newGroups = [];\r\n            var _loop_1 = function (group) {\r\n                if (group.id.id in groupsOperationData) {\r\n                    var childIdsTorRemove_1 = groupsOperationData[group.id.id];\r\n                    group.items = group.items.filter(function (i) { return childIdsTorRemove_1.indexOf(i) === -1; });\r\n                    // Only keep this group if it still has any children.\r\n                    if (group.items.length > 0) {\r\n                        newGroups.push(group);\r\n                    }\r\n                }\r\n                else {\r\n                    // This group is not concerned. Keep it.\r\n                    newGroups.push(group);\r\n                }\r\n            };\r\n            for (var _i = 0, _e = newState.groups; _i < _e.length; _i++) {\r\n                var group = _e[_i];\r\n                _loop_1(group);\r\n            }\r\n            newState.groups = newGroups;\r\n            return newState;\r\n        }\r\n        case getType(actions.setItemsRotation): {\r\n            var rotations_1 = action.payload.rotations;\r\n            var newState = __assign({}, state);\r\n            newState.items = state.items.map(function (item) {\r\n                if (item.id.id in rotations_1) {\r\n                    return __assign(__assign({}, item), { rotation: rotations_1[item.id.id] });\r\n                }\r\n                return item;\r\n            });\r\n            return newState;\r\n        }\r\n        case getType(actions.switchTool): {\r\n            var toolName = action.payload;\r\n            return __assign(__assign({}, state), { tool: toolName });\r\n        }\r\n        case getType(actions.setThemeStrokeThickness): {\r\n            return __assign(__assign({}, state), { theme: __assign(__assign({}, state.theme), { strokeThickness: action.payload }) });\r\n        }\r\n        case getType(actions.generic): {\r\n            var actionFn = action.payload.actionFn;\r\n            var newState = actionFn(state);\r\n            return newState;\r\n        }\r\n        case getType(actions.logIn): {\r\n            Bcn.setSessionData(action.payload.provider, action.payload.user, action.payload.tier);\r\n            Sentry.setUser({ id: action.payload.user.id, email: action.payload.user.email });\r\n            if (!(action.payload.silencePopup === true)) {\r\n                var title = action.payload.firstTimeLogin ? \"Thank you for signing up with Chemix!\" : \"Welcome back!\";\r\n                toastr.success(\"You are now signed in using\\n                \" + loginProviderDisplayName(action.payload.provider) + \"\\n                as \" + action.payload.user.handle, title);\r\n            }\r\n            return __assign(__assign({}, state), { auth: {\r\n                    state: \"logged_in\",\r\n                    provider: action.payload.provider,\r\n                    jwtToken: action.payload.jwtToken,\r\n                    user: action.payload.user,\r\n                }, tier: action.payload.tier });\r\n        }\r\n        case getType(actions.logOut): {\r\n            Bcn.unsetSessionData();\r\n            Sentry.setUser(null);\r\n            toastr.info(\"You have been signed out.\", \"Signed out.\");\r\n            clearToken();\r\n            return __assign(__assign({}, state), { auth: {\r\n                    state: \"logged_out\",\r\n                }, tier: undefined });\r\n        }\r\n        case getType(actions.eraseItems): {\r\n            return __assign(__assign({}, state), { items: [], arrows: [], groups: [] });\r\n        }\r\n        case getType(actions.replace): {\r\n            // Merge current state with the one in the given document.\r\n            // If the diagram is a template, do not set up information\r\n            // about current diagram.\r\n            var _f = action.payload, diagram = _f.diagram, isTemplate = _f.isTemplate;\r\n            return __assign(__assign(__assign({}, state), diagram.data), { currentCloudDiagram: !isTemplate\r\n                    ? {\r\n                        id: diagram.id,\r\n                        title: diagram.title,\r\n                    }\r\n                    : undefined });\r\n        }\r\n        case getType(actions.setCloudDiagram): {\r\n            return __assign(__assign({}, state), { currentCloudDiagram: action.payload });\r\n        }\r\n        case getType(actions._TESTONLY_resetState): {\r\n            // Override in tests only.\r\n            return state;\r\n        }\r\n        default: return state; // Needed for initial store state.\r\n    }\r\n});\r\n","import { Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nimport { setDefaultStyleWithStroke, smoothCorner } from \"../../draw\";\r\nvar GlassStopper = /** @class */ (function () {\r\n    function GlassStopper() {\r\n    }\r\n    GlassStopper.prototype.render = function (appearance) {\r\n        var d = appearance.diameter - 3.0;\r\n        var handle = new Path.Rectangle(R(0, -5, d + 15, 10, Pivot.BOTTOM_CENTER), 2.0);\r\n        var handle2 = new Path.Rectangle(R(0, 3, d / 2 + 4, 10, Pivot.BOTTOM_CENTER));\r\n        var stopper = new Path(Segments([[-d / 2 - 2, 0], , [2, -2]], [[d / 2 + 2, 0], [-2, -2]], [[d / 2 + 1, 30]], [[-d / 2 - 1, 30]]));\r\n        stopper.closePath();\r\n        smoothCorner(stopper.segments[3], 2.0);\r\n        smoothCorner(stopper.segments[2], 2.0);\r\n        var groundJoint = stopper.clone();\r\n        var outline = handle.unite(handle2).unite(stopper);\r\n        setDefaultStyleWithStroke(\"thin\", outline);\r\n        outline.strokeColor = \"#666666\";\r\n        outline.fillColor = \"#ffffff60\";\r\n        groundJoint.setGradientFill(\"right\", [[\"#888888\", 0.0], [\"#ffffff\", 0.5], [\"#888888\", 1.0]]);\r\n        groundJoint.opacity = 0.5;\r\n        groundJoint.strokeWidth = 0;\r\n        var graphic = new Group([groundJoint, outline]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.expand(20).toShape(),\r\n        };\r\n    };\r\n    GlassStopper.properties = {\r\n        label: \"Glass Stopper\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            diameter: 15\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"diameter\", label: \"Diameter\",\r\n                min: 10, max: 35, step: 0.1,\r\n            }\r\n        ],\r\n    };\r\n    return GlassStopper;\r\n}());\r\nexport { GlassStopper };\r\n","import { P } from \"apparatus/library/common\";\r\nimport { Color, Gradient, Group, Rectangle, Shape } from \"paper\";\r\nimport { setDefaultStyle } from \"../draw\";\r\nvar Table = /** @class */ (function () {\r\n    function Table() {\r\n        this.drivers = [\r\n            {\r\n                type: \"rectangle\",\r\n                minX: 400, maxX: 1500,\r\n                minY: 0, maxY: 20,\r\n                fromAppearance: function (a) { return P(a.width, 20); },\r\n                toAppearance: function (p) { return ({ width: p.x }); },\r\n                scale: 2.0,\r\n            }\r\n        ];\r\n    }\r\n    Table.prototype.render = function (appearance) {\r\n        var width = appearance.width;\r\n        var corner = 10.0;\r\n        var legOffset = appearance.legOffset;\r\n        var thickness = 40;\r\n        var legHeight = getLegHeight(appearance);\r\n        var tableTopRect = new Rectangle(0, 0, width, thickness);\r\n        var leftLegRect = new Rectangle(legOffset, corner, thickness, legHeight);\r\n        var rightLegRect = new Rectangle(width - thickness - legOffset, corner, thickness, legHeight);\r\n        var tableTop = Shape.Rectangle(tableTopRect, corner);\r\n        var leftLeg = Shape.Rectangle(leftLegRect);\r\n        var rightLeg = Shape.Rectangle(rightLegRect);\r\n        setDefaultStyle(tableTop, leftLeg, rightLeg);\r\n        switch (appearance.color) {\r\n            case \"white\":\r\n                tableTop.fillColor = \"white\";\r\n                leftLeg.fillColor = \"white\";\r\n                rightLeg.fillColor = \"white\";\r\n                break;\r\n            case \"brown\":\r\n                var gradient = new Gradient([\r\n                    [\"#ce9158\", 0.2],\r\n                    [\"#ad7847\", 0.21],\r\n                    [\"#704e2f\", 1.0]\r\n                ]);\r\n                tableTop.fillColor = new Color(gradient, tableTopRect.topCenter, tableTopRect.bottomCenter);\r\n                leftLeg.fillColor = new Color(gradient, leftLegRect.leftCenter, leftLegRect.rightCenter);\r\n                rightLeg.fillColor = new Color(gradient, rightLegRect.leftCenter, rightLegRect.rightCenter);\r\n        }\r\n        var graphic = new Group();\r\n        var legs = new Group();\r\n        var hitShapes = [tableTopRect];\r\n        if (appearance.legs == \"left\") {\r\n            legs.addChild(leftLeg);\r\n            hitShapes.push(leftLegRect);\r\n            rightLeg.remove();\r\n        }\r\n        else if (appearance.legs == \"right\") {\r\n            legs.addChild(rightLeg);\r\n            hitShapes.push(rightLegRect);\r\n            leftLeg.remove();\r\n        }\r\n        else if (appearance.legs == \"both\") {\r\n            legs.addChild(leftLeg);\r\n            legs.addChild(rightLeg);\r\n            hitShapes.push(rightLegRect);\r\n            hitShapes.push(leftLegRect);\r\n        }\r\n        else {\r\n            rightLeg.remove();\r\n            leftLeg.remove();\r\n        }\r\n        graphic.addChild(legs);\r\n        graphic.addChild(tableTop);\r\n        return {\r\n            graphic: graphic,\r\n            pivot: tableTopRect.center,\r\n            hitShape: hitShapes.map(Shape.Rectangle),\r\n            snapping: tableTop.topEdgeAsPlaceableSurface(),\r\n        };\r\n    };\r\n    Table.properties = {\r\n        label: \"Table\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            height: \"short\",\r\n            width: 700,\r\n            legs: \"both\",\r\n            color: \"brown\",\r\n            legOffset: 100,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\",\r\n                key: \"width\",\r\n                label: \"Width\",\r\n                min: 400,\r\n                max: 1500,\r\n            },\r\n            {\r\n                spec: \"radio\",\r\n                key: \"color\",\r\n                label: \"Colour\",\r\n                options: [\r\n                    { value: \"white\", label: \"White\" },\r\n                    { value: \"brown\", label: \"Brown\" },\r\n                ]\r\n            },\r\n            {\r\n                spec: \"radio\",\r\n                key: \"legs\",\r\n                label: \"Legs\",\r\n                options: [\r\n                    { value: \"none\", label: \"No legs\" },\r\n                    { value: \"both\", label: \"Both legs\" },\r\n                    { value: \"left\", label: \"Left only\" },\r\n                    { value: \"right\", label: \"Right only\" },\r\n                ]\r\n            },\r\n            {\r\n                spec: \"radio\",\r\n                key: \"height\",\r\n                label: \"Legs display\",\r\n                options: [\r\n                    { value: \"short\", label: \"Very short\" },\r\n                    { value: \"medium\", label: \"Short\" },\r\n                    { value: \"full\", label: \"Full height\" },\r\n                ],\r\n                visible: function (a) { return a.legs != \"none\"; },\r\n            },\r\n            {\r\n                spec: \"slider\",\r\n                key: \"legOffset\",\r\n                label: \"Leg offset\",\r\n                min: 0,\r\n                max: 100,\r\n                visible: function (a) { return a.legs != \"none\"; },\r\n            }\r\n        ],\r\n    };\r\n    return Table;\r\n}());\r\nexport { Table };\r\nfunction getLegHeight(appearance) {\r\n    switch (appearance.height) {\r\n        case \"short\": return 75;\r\n        case \"medium\":\r\n            return 150;\r\n        case \"full\": return 400;\r\n    }\r\n}\r\n","// Utilities for ensuring an uniform visual style across all apparatus.\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { strokeWidth as commonStrokeWidth } from \"apparatus/common\";\r\nimport * as color from \"color\";\r\nimport * as paper from \"paper\";\r\nimport * as common from \"./library/common\";\r\nimport { markerSize, P, R, Segments, SharedColors } from \"./library/common\";\r\nexport var defaultStrokeWidth = 4.0;\r\n/** Sets the default style. */\r\nexport function setDefaultStyle() {\r\n    var items = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        items[_i] = arguments[_i];\r\n    }\r\n    setDefaultStyleWithStroke.apply(void 0, __spreadArrays([\"default\"], items));\r\n}\r\n/**\r\n * Breaks a continuous path into multiple parts and returns them as a group.\r\n * Note this does not transfer any styles (e.g. stroke colour or width).\r\n * It is therefore recommended to break a path that has not yet been\r\n * styled. It also deletes the original path.\r\n */\r\nexport function breakPath(path) {\r\n    var indices = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        indices[_i - 1] = arguments[_i];\r\n    }\r\n    return breakPathInternal.apply(void 0, __spreadArrays([path, false], indices));\r\n}\r\n/** Same as breakPath, but the path is closed. */\r\nexport function breakPathClosed(path) {\r\n    var indices = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        indices[_i - 1] = arguments[_i];\r\n    }\r\n    return breakPathInternal.apply(void 0, __spreadArrays([path, true], indices));\r\n}\r\nfunction breakPathInternal(path, closePath) {\r\n    var indices = [];\r\n    for (var _i = 2; _i < arguments.length; _i++) {\r\n        indices[_i - 2] = arguments[_i];\r\n    }\r\n    var newGroup = new paper.Group();\r\n    var previousIndex = 0;\r\n    for (var _a = 0, indices_1 = indices; _a < indices_1.length; _a++) {\r\n        var index = indices_1[_a];\r\n        newGroup.addChild(new paper.Path(path.segments.slice(previousIndex, index)));\r\n        previousIndex = index;\r\n    }\r\n    // Add the final segment.\r\n    var lastSegment = new paper.Path(path.segments.slice(previousIndex, path.segments.length));\r\n    if (closePath) {\r\n        lastSegment.segments.push(path.segments[0]);\r\n    }\r\n    newGroup.addChild(lastSegment);\r\n    // Delete the original path.\r\n    path.remove();\r\n    return newGroup;\r\n}\r\n/** Sets the default style but with a custom stroke width. */\r\nexport function setDefaultStyleWithStroke(style) {\r\n    var items = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        items[_i - 1] = arguments[_i];\r\n    }\r\n    for (var _a = 0, items_1 = items; _a < items_1.length; _a++) {\r\n        var item = items_1[_a];\r\n        item.strokeColor = common.SharedColors.stroke;\r\n        item.strokeWidth = strokeWidth(style);\r\n        item.strokeCap = \"round\";\r\n    }\r\n}\r\nexport function strokeWidth(style) {\r\n    return commonStrokeWidth(style);\r\n}\r\nfunction addEdgeLipsInternal(path, lipSize, reverse) {\r\n    addEdgeLipsInternalOpen(path, lipSize, reverse);\r\n}\r\n// @ts-ignore: alternative edge lips implementation.\r\nfunction addEdgeLipsInternalClosed(path, lipSize, reverse) {\r\n    var lipAnchor = P(-1.0, 0).multiply(lipSize);\r\n    var lipRaise = -lipSize * 0.8;\r\n    var left = !reverse ? path.firstSegment : path.lastSegment;\r\n    var leftLip = new paper.Segment(P(left.point.x, left.point.y), !reverse ? undefined : lipAnchor, !reverse ? lipAnchor : undefined);\r\n    left.point.y += 10;\r\n    left[!reverse ? \"handleIn\" : \"handleOut\"] = lipAnchor.add([0, lipRaise]);\r\n    var rightLipAnchor = lipAnchor.multiply([-1, 1]);\r\n    var right = !reverse ? path.lastSegment : path.firstSegment;\r\n    var rightLip = new paper.Segment(P(right.point.x, right.point.y), !reverse ? rightLipAnchor : undefined, !reverse ? undefined : rightLipAnchor);\r\n    right.point.y += 10;\r\n    right[reverse ? \"handleIn\" : \"handleOut\"] = rightLipAnchor.add([0, lipRaise]);\r\n    path.insertSegments(0, !reverse ? [leftLip] : [rightLip]);\r\n    path.addSegments(!reverse ? [rightLip] : [leftLip]);\r\n    path.closed = true;\r\n}\r\n// @ts-ignore: alternative edge lips implementation.\r\nfunction addEdgeLipsInternalOpen(path, lipSize, reverse) {\r\n    var lipAnchor = P(0.6, 0.5).multiply(lipSize);\r\n    var left = !reverse ? path.firstSegment : path.lastSegment;\r\n    var leftLip = new paper.Segment(new paper.Point(left.point.x - lipSize, left.point.y), !reverse ? undefined : lipAnchor, !reverse ? lipAnchor : undefined);\r\n    left.point.y += lipSize * 2.5;\r\n    left[!reverse ? \"handleIn\" : \"handleOut\"] = P(0, -6);\r\n    var right = !reverse ? path.lastSegment : path.firstSegment;\r\n    var rightLipAnchor = lipAnchor.multiply([-1, 1]);\r\n    var rightLip = new paper.Segment(new paper.Point(right.point.x + lipSize, right.point.y), !reverse ? rightLipAnchor : undefined, !reverse ? undefined : rightLipAnchor);\r\n    right.point.y += lipSize * 2.5;\r\n    right[reverse ? \"handleIn\" : \"handleOut\"] = P(0, -6);\r\n    path.insertSegments(0, !reverse ? [leftLip] : [rightLip]);\r\n    path.addSegments(!reverse ? [rightLip] : [leftLip]);\r\n}\r\n/** Add \"lips\" to the apparatus. Use on e.g beakers, test tubes etc. */\r\nexport function addEdgeLips(path, lipSize) {\r\n    if (lipSize === void 0) { lipSize = common.lipSize; }\r\n    addEdgeLipsInternal(path, lipSize, false);\r\n}\r\nexport function addEdgeLipsReversed(path, lipSize) {\r\n    if (lipSize === void 0) { lipSize = common.lipSize; }\r\n    addEdgeLipsInternal(path, lipSize, true);\r\n}\r\n/** Mirrors existing segments, along an x= line. */\r\nexport function mirrorX(path, x) {\r\n    if (x === void 0) { x = 0; }\r\n    var newSegments = path.segments.map(function (segment) {\r\n        return new paper.Segment(segment.point.multiply([-1, 1]).add([x * 2, 0]), segment.handleOut ? segment.handleOut.multiply([-1, 1]) : undefined, segment.handleIn ? segment.handleIn.multiply([-1, 1]) : undefined);\r\n    });\r\n    newSegments.reverse();\r\n    path.addSegments(newSegments);\r\n}\r\n/** Mirrors existing segments, along an y= line. */\r\nexport function mirrorY(path, y) {\r\n    if (y === void 0) { y = 0; }\r\n    var newSegments = path.segments.map(function (segment) {\r\n        return new paper.Segment(segment.point.multiply([1, -1]).add([0, y * 2]), segment.handleOut ? segment.handleOut.multiply([1, -1]) : undefined, segment.handleIn ? segment.handleIn.multiply([1, -1]) : undefined);\r\n    });\r\n    newSegments.reverse();\r\n    path.addSegments(newSegments);\r\n}\r\n/**\r\n * Smoothes out a corner into a rounded corner. Works for\r\n * all corners, not just 90 degree ones.\r\n */\r\nexport function smoothCorner(segment, size) {\r\n    if (size === void 0) { size = common.cornerSize; }\r\n    // Determine directions to which to shift the points\r\n    // to create a rounded corner.\r\n    var previousVector = segment.previous.point.subtract(segment.point).normalize();\r\n    var nextVector = segment.next.point.subtract(segment.point).normalize();\r\n    // Create new points to replace this segment.\r\n    var segment1 = new paper.Segment(segment.point.add(previousVector.multiply(size)), undefined, new paper.Point(previousVector.multiply(-size * 0.5)));\r\n    var segment2 = new paper.Segment(segment.point.add(nextVector.multiply(size)), new paper.Point(nextVector.multiply(-size * 0.5)));\r\n    // Find position of the current segment in the path.\r\n    var path = segment.path;\r\n    var segmentIndexToRemove = findSegmentIndexInPath(segment);\r\n    path.removeSegment(segmentIndexToRemove);\r\n    path.insertSegments(segmentIndexToRemove, [segment1, segment2]);\r\n}\r\nexport function smoothCornersIndividual(path, corners) {\r\n    var indices = Object.keys(corners).map(Number);\r\n    var sortedIndices = indices.sort().reverse();\r\n    for (var _i = 0, sortedIndices_1 = sortedIndices; _i < sortedIndices_1.length; _i++) {\r\n        var index = sortedIndices_1[_i];\r\n        smoothCorner(path.segments[index], corners[index]);\r\n    }\r\n}\r\nexport function removeLastSegment(path) {\r\n    path.removeSegment(path.segments.length - 1);\r\n}\r\nfunction findSegmentIndexInPath(segment) {\r\n    var path = segment.path;\r\n    for (var i = 0; i < path.segments.length; i++) {\r\n        if (segment == path.segments[i]) {\r\n            return i;\r\n        }\r\n    }\r\n    return -1;\r\n}\r\n/** Adds markers (from the bottom) at regular intervals. The first one is skipped. */\r\nexport function addMarkers(group, start, stopY, step, size) {\r\n    if (step.y == 0)\r\n        return;\r\n    // If the step is specified as positive, invert it.\r\n    if (step.y > 0) {\r\n        step.x *= -1;\r\n        step.y *= -1;\r\n    }\r\n    var point = start.add(step); // Skip the first one, as it's usually the bottom of the apparatus.\r\n    var mark = markSymbol();\r\n    var count = 0;\r\n    while (point.y > stopY && count < 50) {\r\n        var markPlaced = mark.place(point);\r\n        if (size) {\r\n            markPlaced.scale(size / markerSize, 1.0, markPlaced.bounds.rightCenter);\r\n        }\r\n        group.addChild(markPlaced);\r\n        point = point.add(step);\r\n        count++;\r\n    }\r\n}\r\nexport function addMarkers2(group, opts) {\r\n    var _a;\r\n    var start = opts.start, step = opts.step, count = opts.count;\r\n    var majorEvery = (_a = opts.majorEvery) !== null && _a !== void 0 ? _a : 1;\r\n    var mark = markSymbol();\r\n    var point = new paper.Point(start);\r\n    for (var i = 0; i < count; i++) {\r\n        var isMajor = i % majorEvery === 0;\r\n        var symbol = group.addChild(mark.place(point));\r\n        if (!isMajor) {\r\n            symbol.scale(0.5, 1.0);\r\n        }\r\n        point.x += step.x;\r\n        point.y += step.y;\r\n    }\r\n}\r\n/** A u-shape visual hint to indicate 3-D-ness. */\r\nexport function glassFold(x, y, props) {\r\n    var _a, _b;\r\n    var size = (_a = props === null || props === void 0 ? void 0 : props.size) !== null && _a !== void 0 ? _a : 10;\r\n    var rotation = (_b = props === null || props === void 0 ? void 0 : props.rotation) !== null && _b !== void 0 ? _b : 0;\r\n    var fold = new paper.Path(Segments([[-0.5 * size, 0], , [0.2 * size, 0.2 * size]], [[0.5 * size, 0], [-0.2 * size, 0.2 * size]]));\r\n    fold.rotate(rotation);\r\n    fold.strokeWidth = strokeWidth(\"thinner\");\r\n    fold.position = P(x, y);\r\n    fold.strokeColor = SharedColors.glassFold;\r\n    return fold;\r\n}\r\nvar _markSymbol;\r\nexport function markSymbol() {\r\n    if (_markSymbol)\r\n        return _markSymbol;\r\n    // Create mark\r\n    var mark = paper.Shape.Rectangle(P(-markerSize, 0), new paper.Size(markerSize, strokeWidth(\"thinner\")));\r\n    mark.fillColor = SharedColors.mark;\r\n    _markSymbol = new paper.Symbol(mark, true);\r\n    return _markSymbol;\r\n}\r\nexport function disposeMarkSymbol() {\r\n    if (_markSymbol)\r\n        _markSymbol.definition.remove();\r\n    _markSymbol = undefined;\r\n}\r\nexport function metalRod(from, to) {\r\n    var normal = from.subtract(to).rotate(90).normalize().multiply(2.0);\r\n    var rod = new paper.Path.Line(from, to);\r\n    rod.strokeWidth = 12.0;\r\n    rod.strokeColor = new paper.Color(new paper.Gradient([\r\n        [common.SharedColors.darkMetal.color().ladd(20).hex(), 0.0],\r\n        [common.SharedColors.darkMetal.color().ladd(10).hex(), 1.0]\r\n    ]), from.add(normal), from.subtract(normal));\r\n    rod.strokeCap = \"round\";\r\n    var rodHighlight = new paper.Path.Line(from.add(normal), to.add(normal));\r\n    rodHighlight.strokeWidth = 2.0;\r\n    rodHighlight.strokeColor = \"#aaaaaa\";\r\n    rodHighlight.strokeCap = \"round\";\r\n    return [rod, rodHighlight];\r\n}\r\n// Creates a simple gradient from a single color.\r\nexport function simpleGradient(colorString) {\r\n    var baseColor = color(colorString);\r\n    var lightColor = baseColor.lighten(0.3);\r\n    return [[lightColor.hex(), 0.0], [baseColor.hex(), 1.0]];\r\n}\r\n/** Returns a unit vector pointing in given direction. */\r\nexport function unitVector(direction) {\r\n    switch (direction) {\r\n        case \"down\": return P(0, 1);\r\n        case \"up\": return P(0, -1);\r\n        case \"left\": return P(-1, 0);\r\n        case \"right\": return P(1, 0);\r\n    }\r\n}\r\n/**\r\n * Creates a new path, containing all the paths, united. The ordering should ensure\r\n * that at every step a single shape is created.\r\n */\r\nexport function uniteAll() {\r\n    var items = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        items[_i] = arguments[_i];\r\n    }\r\n    var path = items[0].unite(items[1], { insert: false });\r\n    for (var i = 2; i < items.length; i++) {\r\n        var newPath = path.unite(items[i], { insert: false });\r\n        path.remove();\r\n        path = newPath;\r\n    }\r\n    path.fillColor = null;\r\n    return path;\r\n}\r\nexport function createOutlinedGroup(width, strokeColor) {\r\n    var items = [];\r\n    for (var _i = 2; _i < arguments.length; _i++) {\r\n        items[_i - 2] = arguments[_i];\r\n    }\r\n    var group = new paper.Group(items);\r\n    var outline = uniteAll.apply(void 0, items);\r\n    outline.strokeColor = strokeColor;\r\n    outline.strokeWidth = typeof (width) === \"string\" ? strokeWidth(width) : width;\r\n    group.addChild(outline);\r\n    return group;\r\n}\r\nexport function setLiquidStyle(item, color, opacity) {\r\n    if (opacity === void 0) { opacity = SharedColors.defaultLiquidAlpha; }\r\n    item.strokeWidth = strokeWidth(\"liquid\");\r\n    item.strokeColor = color;\r\n    item.fillColor = color.color().alpha(opacity).string();\r\n}\r\n/**\r\n * Creates a soft-shaded effect. It can either be \"edge\" (one-sided, used for edges) or \"full\"\r\n * for internal shading. Best described as a \"blurred pill\" shaped.\r\n *\r\n * Specify offsetThickness to offset \"edge\" shades by the thickness\r\n */\r\nexport function softShade(type, offsetThickness, from, to, color, radius, strength) {\r\n    if (strength === void 0) { strength = 0.0; }\r\n    var delta = from.subtract(to);\r\n    var length = delta.length;\r\n    // Clamp radius.\r\n    radius = Math.min(radius, length / 2 - 1);\r\n    var width = type == \"edge\" ? radius : radius * 2;\r\n    // Render a group of 3 parts.\r\n    var gradient = [[color, strength], [color.substr(0, 7) + \"00\", 1.0]];\r\n    var topPart = new paper.Path.Rectangle(R(radius, 0, width, radius, common.Pivot.TOP_RIGHT));\r\n    topPart.fillColor = new paper.Color(new paper.Gradient(gradient, true), P(0, radius), P(0, 0));\r\n    var middlePart = new paper.Path.Rectangle(R(radius, radius, width, length - 2 * radius, common.Pivot.TOP_RIGHT));\r\n    if (type == \"edge\") {\r\n        middlePart.withGradientFill(\"right\", gradient);\r\n    }\r\n    else {\r\n        middlePart.withGradientFill(\"right\", [\r\n            [color.substr(0, 7) + \"00\", 0.0], [color, 0.5 - strength / 2], [color, 0.5 + strength / 2], [color.substr(0, 7) + \"00\", 1.0],\r\n        ]);\r\n    }\r\n    var bottomPart = new paper.Path.Rectangle(R(radius, length, width, radius, common.Pivot.BOTTOM_RIGHT));\r\n    bottomPart.fillColor = new paper.Color(new paper.Gradient(gradient, true), P(0, length - radius), P(0, length));\r\n    var group = new paper.Group([topPart, middlePart, bottomPart]);\r\n    group.pivot = P(0, 0);\r\n    group.rotate(delta.angle - 90);\r\n    group.position = to;\r\n    // Offset by thickness.\r\n    if (offsetThickness && type == \"edge\") {\r\n        var distance = strokeWidth(offsetThickness) / 2;\r\n        group.position = group.position.add(delta.rotate(-90).normalize(distance));\r\n    }\r\n    return group;\r\n}\r\nvar StyledTextCreator = /** @class */ (function () {\r\n    function StyledTextCreator(style) {\r\n        this.style = style;\r\n    }\r\n    StyledTextCreator.prototype.create = function (content, position, override, align) {\r\n        if (override === void 0) { override = {}; }\r\n        if (align === void 0) { align = \"center\"; }\r\n        return new paper.PointText(__assign(__assign({ point: position, content: content, style: this.style }, override), { justification: align }));\r\n    };\r\n    return StyledTextCreator;\r\n}());\r\nexport { StyledTextCreator };\r\nexport var MoreShapes;\r\n(function (MoreShapes) {\r\n    function diamond(x, y, size) {\r\n        var path = new paper.Path(Segments([[-size / 2, 0]], [[0, size / 2]], [[size / 2, 0]], [[0, -size / 2]]));\r\n        path.position.x = x;\r\n        path.position.y = y;\r\n        path.closePath();\r\n        return path;\r\n    }\r\n    MoreShapes.diamond = diamond;\r\n})(MoreShapes || (MoreShapes = {}));\r\nvar LazyRaster = /** @class */ (function () {\r\n    function LazyRaster(url) {\r\n        this.url = url;\r\n    }\r\n    LazyRaster.prototype.clone = function (callback) {\r\n        if (!this.raster) {\r\n            var raster_1 = new paper.Raster(this.url);\r\n            this.raster = raster_1;\r\n            raster_1.onLoad = function () {\r\n                callback(raster_1.clone());\r\n            };\r\n            // Remove from scene.\r\n            this.raster.remove();\r\n        }\r\n        else {\r\n            callback(this.raster.clone());\r\n        }\r\n    };\r\n    return LazyRaster;\r\n}());\r\nexport { LazyRaster };\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n// Mixin that extends an existing class, to be Interactable.\r\n// Usage: Interactable(paper.Shape, this)(...)\r\nexport function Interactable(Base, interaction) {\r\n    return /** @class */ (function (_super) {\r\n        __extends(class_1, _super);\r\n        function class_1() {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            var _this = _super.apply(this, args) || this;\r\n            _this.interaction = interaction;\r\n            return _this;\r\n        }\r\n        return class_1;\r\n    }(Base));\r\n}\r\nexport function graftInteraction(item, interaction) {\r\n    item.interaction = interaction;\r\n}\r\n// Match function that can be used for paper's hitTest or getItems\r\n// to retrieve an interactable.\r\nexport function InteractableMatcher(hit) {\r\n    var item = ('item' in hit ? hit.item : hit);\r\n    return 'interaction' in item && item.visible === true;\r\n}\r\n// Helper method to create a selectAndMove interaction\r\nexport function SelectAndMove(c) {\r\n    return { type: \"selectAndMove\", component: c };\r\n}\r\n// Helper method to create an adjustable interaction.\r\nexport function Adjustable(c) {\r\n    return { type: \"adjust\", component: c };\r\n}\r\n","import { R } from \"apparatus/library/common\";\r\nimport { Shape } from \"paper\";\r\nvar IceCube = /** @class */ (function () {\r\n    function IceCube() {\r\n    }\r\n    IceCube.prototype.render = function (appearance) {\r\n        var size = appearance.size;\r\n        var graphic = Shape.Rectangle(R(0, 0, size, size), 5).withStroke(\"thin\", \"#bbf0f2\");\r\n        graphic.setRadialGradientFill([[\"#f2ffffee\", 0.2], [\"#e6fcfcaa\", 1]]);\r\n        var hitShape = Shape.Rectangle(R(0, 0, size, size).expand(10));\r\n        return { graphic: graphic, hitShape: hitShape };\r\n    };\r\n    IceCube.properties = {\r\n        label: \"Ice cube\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            size: 24\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 15, max: 40\r\n            }\r\n        ],\r\n    };\r\n    return IceCube;\r\n}());\r\nexport { IceCube };\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { Icon } from \"components/icon\";\r\nimport * as React from \"react\";\r\nimport { Badge } from \"tiers/badge\";\r\n/**\r\n * A regular button that can optionally display an icon, on the left.\r\n */\r\nexport var Button = function (props) {\r\n    var _a;\r\n    return (React.createElement(\"button\", { className: \"ui-button \" + ((_a = props.extraClass) !== null && _a !== void 0 ? _a : \"\"), onClick: props.onClick, style: props.widthCss ? { width: props.widthCss } : undefined },\r\n        props.icon ? React.createElement(Icon, { name: props.icon, spacing: true }) : null,\r\n        props.buttonLabel,\r\n        props.tierLock ? React.createElement(Badge, { tier: props.tierLock }) : null));\r\n};\r\n/**\r\n * A button that displays an icon on the top, with text below.\r\n */\r\nexport var StackButton = function (props) {\r\n    var _a;\r\n    return (React.createElement(\"button\", { className: \"ui-button ui-stack-button \" + ((_a = props.extraClass) !== null && _a !== void 0 ? _a : \"\"), style: { width: props.widthCss }, onClick: props.onClick },\r\n        React.createElement(Icon, { name: props.icon, extraClass: \"my-1 fa-2x\", spacing: false }),\r\n        React.createElement(\"br\", null),\r\n        props.buttonLabel));\r\n};\r\n/**\r\n * A button that consists of an icon only.\r\n */\r\nexport var IconButton = function (props) {\r\n    var _a;\r\n    return (React.createElement(\"button\", { className: \"ui-button \" + ((_a = props.extraClass) !== null && _a !== void 0 ? _a : \"\"), onClick: props.onClick, style: { width: props.widthCss }, title: props.buttonLabel },\r\n        React.createElement(Icon, { name: props.icon, spacing: false })));\r\n};\r\n/**\r\n * Horizontal row of {@link IconButton}s.\r\n */\r\nexport var HorizontalIconButtons = function (props) {\r\n    var items = props.buttons.length;\r\n    var widthCss = Math.round(100 / items) + \"%\";\r\n    return React.createElement(\"div\", { className: \"horizontal-button-group\" }, props.buttons.map(function (b, i) { return React.createElement(IconButton, __assign({ key: i, widthCss: widthCss }, b)); }));\r\n};\r\n/**\r\n * Horizontal row of {@link StackButton}s, i.e. buttons with icons on top, text below.\r\n */\r\nexport var ToggleHorizontalButtons = function (props) {\r\n    var items = props.buttons.length;\r\n    var widthCss = Math.round(100 / items) + \"%\";\r\n    switch (props.size) {\r\n        case \"small\":\r\n            return React.createElement(\"div\", { className: \"horizontal-button-group\" }, props.buttons.map(function (b, i) {\r\n                return React.createElement(IconButton, __assign({ key: i, widthCss: widthCss, extraClass: i == props.highlightIndex ? \"highlight\" : undefined }, b));\r\n            }));\r\n        case \"large\":\r\n            return React.createElement(\"div\", { className: \"horizontal-button-group\" }, props.buttons.map(function (b, i) {\r\n                return React.createElement(StackButton, __assign({ key: i, widthCss: widthCss, extraClass: i == props.highlightIndex ? \"highlight\" : undefined }, b));\r\n            }));\r\n        case \"text\":\r\n            return React.createElement(\"div\", { className: \"horizontal-button-group\" }, props.buttons.map(function (b, i) {\r\n                return React.createElement(Button, __assign({ key: i, widthCss: widthCss, extraClass: i == props.highlightIndex ? \"highlight\" : undefined }, b, { icon: undefined }));\r\n            }));\r\n    }\r\n};\r\n/**\r\n * Vertically arranged {@link Buttons}s.\r\n */\r\nexport var VerticalButtons = function (props) { return (React.createElement(\"div\", { className: \"verticalButtonGroup\" }, props.buttons.map(function (b, i) { return React.createElement(Button, __assign({ key: i }, b)); }))); };\r\n/**\r\n * Horizontal buttons where 1 item is highlighted. Basically behaves\r\n * like a radio button group but using buttons.\r\n */\r\nvar HorizontalButtonsSwitcher = /** @class */ (function (_super) {\r\n    __extends(HorizontalButtonsSwitcher, _super);\r\n    function HorizontalButtonsSwitcher(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.state = { value: props.defaultValue };\r\n        return _this;\r\n    }\r\n    HorizontalButtonsSwitcher.prototype.render = function () {\r\n        var _this = this;\r\n        var _a;\r\n        return React.createElement(\"div\", { className: (_a = \"horizontal-button-group \" + this.props.className) !== null && _a !== void 0 ? _a : \"\" }, this.props.options.map(function (o) {\r\n            var _a;\r\n            return React.createElement(Button, { key: o.value, icon: o.icon, onClick: function () { _this.setState({ value: o.value }); _this.props.onSwitch(o.value); }, extraClass: ((_a = _this.props.extraClass) !== null && _a !== void 0 ? _a : \"\") + (_this.state.value == o.value ? \" highlight\" : \"\"), buttonLabel: o.buttonLabel });\r\n        }));\r\n    };\r\n    return HorizontalButtonsSwitcher;\r\n}(React.Component));\r\nexport { HorizontalButtonsSwitcher };\r\n","import { P } from \"apparatus/library/common\";\r\nimport { Group, Shape } from \"paper\";\r\nimport { Random } from \"random/random\";\r\nvar COLOR_SWATCHES = {\r\n    \"Default\": \"#cccccc\",\r\n    \"Red\": \"#E16060\",\r\n    \"Green\": \"#5EC63D\",\r\n    \"Blue\": \"#68B7D7\",\r\n};\r\nvar Bubbles = /** @class */ (function () {\r\n    function Bubbles() {\r\n    }\r\n    Bubbles.prototype.render = function (appearance) {\r\n        var rows = appearance.rows;\r\n        var bubblesPerRow = appearance.bubblesPerRow;\r\n        var spacing = appearance.spacing;\r\n        var baseSize = appearance.bubbleSize;\r\n        var r = new Random();\r\n        var graphic = new Group();\r\n        for (var y = 0; y < rows; y++) {\r\n            var xShift = y % 2 == 1 ? 0.5 : 0;\r\n            for (var x = 0; x < (bubblesPerRow - xShift * 2); x++) {\r\n                var position = P((x + xShift) * spacing, y * spacing);\r\n                var size = baseSize + r.randomUnitValue();\r\n                var bubble = Shape.Circle(position.add(r.randomUnitVector(spacing / 4)), size);\r\n                graphic.addChild(bubble);\r\n            }\r\n        }\r\n        graphic\r\n            .withStroke(\"thinner\", appearance.color)\r\n            .withFill(appearance.color.color().lighten(0.3).alpha(0.5).toString());\r\n        return { graphic: graphic, hitShape: graphic.bounds.toShape() };\r\n    };\r\n    Bubbles.properties = {\r\n        label: \"Bubbles\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            rows: 3,\r\n            bubblesPerRow: 4,\r\n            spacing: 18,\r\n            bubbleSize: 4,\r\n            color: \"#cccccc\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"rows\", label: \"Rows\",\r\n                min: 1, max: 5,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"bubblesPerRow\", label: \"Bubbles per row\",\r\n                min: 1, max: 10,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"spacing\", label: \"Spacing\",\r\n                min: 12, max: 30\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"bubbleSize\", label: \"Bubble size\",\r\n                min: 3.0, max: 8.0, step: 0.1,\r\n            },\r\n            {\r\n                spec: \"color\", key: \"color\", label: \"Colour\",\r\n                swatches: COLOR_SWATCHES,\r\n                demoSwatches: COLOR_SWATCHES,\r\n                tier: \"boost\"\r\n            }\r\n        ],\r\n    };\r\n    return Bubbles;\r\n}());\r\nexport { Bubbles };\r\n","import { strokeWidth } from \"apparatus/draw\";\r\nimport { P, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nvar LEAF_COLOR = \"#56bd6e\";\r\nvar OUTLINE_COLOR = LEAF_COLOR.color().ladd(-10).string();\r\nvar STEM_COLOR = \"#cbd676\";\r\nvar PondWeed = /** @class */ (function () {\r\n    function PondWeed() {\r\n    }\r\n    PondWeed.prototype.render = function (appearance) {\r\n        var length = appearance.length;\r\n        var stem = new Path(Segments([[0, 0]], [[0, length]]));\r\n        stem.strokeWidth = 4.0;\r\n        stem.strokeColor = STEM_COLOR;\r\n        stem.strokeCap = \"round\";\r\n        var leaf = new Path(Segments([[0, 0], , [5, -5]], [[12, 0], [0, -5], [0, 5]]));\r\n        leaf.scale(0.8, P(0, 0));\r\n        leaf.closePath();\r\n        leaf.withStroke(strokeWidth(\"thinner\"), OUTLINE_COLOR).withFill(LEAF_COLOR);\r\n        leaf.rotate(-10, P(0, 0));\r\n        var graphic = new Group([stem]);\r\n        for (var y = 0; y < length - 15; y += 12) {\r\n            var r = leaf.clone();\r\n            r.position = P(6, y);\r\n            var l = r.clone();\r\n            l.scale(-1.0, 1.0, P(0, 0));\r\n            graphic.addChildren([r, l]);\r\n        }\r\n        leaf.remove();\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: stem.strokeBounds.expand(30).toShape()\r\n        };\r\n    };\r\n    PondWeed.properties = {\r\n        label: \"Pond weed\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            length: 70\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"length\", label: \"Length\",\r\n                min: 50, max: 120, unit: \"mm\",\r\n            }\r\n        ],\r\n    };\r\n    return PondWeed;\r\n}());\r\nexport { PondWeed };\r\n","import { P } from \"apparatus/library/common\";\r\nimport { Group, Shape } from \"paper\";\r\nimport { Random } from \"random/random\";\r\n// const COLOR_SWATCHES = {\r\n//     \"Default\": \"#cccccc\",\r\n//     \"Red\": \"#E16060\",\r\n//     \"Green\": \"#5EC63D\",\r\n//     \"Blue\": \"#68B7D7\",\r\n// }\r\nvar Particles = /** @class */ (function () {\r\n    function Particles() {\r\n        this.drivers = [\r\n            {\r\n                type: \"rectangle\",\r\n                minX: 10, maxX: 200,\r\n                minY: 10, maxY: 200,\r\n                toAppearance: function (p) { return ({ width: p.x, height: p.y }); },\r\n                fromAppearance: function (a) { return P(a.width, a.height); },\r\n                scale: 2.0,\r\n            }\r\n        ];\r\n    }\r\n    Particles.prototype.render = function (appearance) {\r\n        var spacing = appearance.spacing;\r\n        var rows = Math.floor(appearance.height / spacing);\r\n        var particlesPerRow = Math.floor(appearance.width / spacing);\r\n        var baseSize = appearance.particleSize * (1.0 - appearance.blend);\r\n        var sizeIncreasePerRow = appearance.particleSize * appearance.blend / rows;\r\n        var r = new Random(123124);\r\n        var graphic = new Group();\r\n        for (var y = 0; y < rows; y++) {\r\n            var size = baseSize + y * sizeIncreasePerRow;\r\n            var xShift = y % 2 == 1 ? 0.5 : 0;\r\n            for (var x = 0; x < (particlesPerRow - xShift * 2); x++) {\r\n                var position = P((x + xShift) * spacing, y * spacing);\r\n                var finalSize = Math.max(0.1, size + r.randomUnitValue());\r\n                var particle = Shape.Circle(position.add(r.randomUnitVector(spacing / 4)), finalSize);\r\n                graphic.addChild(particle);\r\n            }\r\n        }\r\n        graphic.fillColor = appearance.color;\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            pivot: P(appearance.width / 2, appearance.height / 2)\r\n        };\r\n    };\r\n    Particles.properties = {\r\n        label: \"Particles\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            width: 50,\r\n            height: 50,\r\n            spacing: 10,\r\n            particleSize: 4,\r\n            color: \"#444444\",\r\n            blend: 0.5,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"width\", label: \"Rows\",\r\n                min: 10, max: 200,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Particles per row\",\r\n                min: 10, max: 200,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"spacing\", label: \"Spacing\",\r\n                min: 6, max: 10\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"particleSize\", label: \"Particles size\",\r\n                min: 3.0, max: 12.0, step: 0.1,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"blend\", label: \"Blending\",\r\n                min: 0.0, max: 1.0, step: 0.01,\r\n            },\r\n        ],\r\n    };\r\n    return Particles;\r\n}());\r\nexport { Particles };\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { ApparatusComponent } from \"apparatus/component\";\r\nimport ArrowComponent from \"arrows/component\";\r\nimport { exportFromCanvas } from \"editing/image_export\";\r\nimport { focusMainApp } from \"keyboard\";\r\nimport { EditorContextMenu } from \"layout/editor/context_menu\";\r\nimport { clog } from \"log\";\r\nimport * as React from \"react\";\r\nimport { Component, createElement } from \"react\";\r\nimport { ID } from \"store/id\";\r\nimport { NULL_SELECTION_METRICS } from \"types\";\r\nimport { Consts } from \"vars\";\r\nimport { exportFromCanvasJPGThumbnail } from \"../../editing/image_export\";\r\nimport { isItemUnlocked } from \"../../tiers/apparatus\";\r\nimport { toolCursors } from \"../../tools\";\r\nvar maxPixels = function (tier) {\r\n    if (!tier)\r\n        return Consts.pngMaxRenderPixelsMedium;\r\n    switch (tier) {\r\n        case \"boost\":\r\n        case \"plus\":\r\n            return Consts.pngMaxRenderPixels;\r\n    }\r\n};\r\n/**\r\n * Component that holds the canvas and everything that's drawn\r\n * inside it, including apparatus components.\r\n */\r\nvar EditorCanvasComponent = /** @class */ (function (_super) {\r\n    __extends(EditorCanvasComponent, _super);\r\n    function EditorCanvasComponent(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        /** Canvas element ref. */\r\n        _this.canvasElementRef = React.createRef();\r\n        // TODO: Avoid this by using states?\r\n        /** Refs to drawable components (apparatus, arrows..). */\r\n        _this.objectRefs = {};\r\n        _this.state = {};\r\n        return _this;\r\n    }\r\n    EditorCanvasComponent.prototype.getApparatusComponent = function (id) {\r\n        return this.objectRefs[ID.string(id)];\r\n    };\r\n    EditorCanvasComponent.prototype.getObjectComponent = function (id) {\r\n        return this.objectRefs[ID.string(id)];\r\n    };\r\n    EditorCanvasComponent.prototype.componentDidMount = function () {\r\n        // Set up canvas\r\n        var canvas = this.canvasElementRef.current;\r\n        paper.setup(canvas);\r\n        this.isPaperReady = true;\r\n        clog(\"Paper.js set up\");\r\n        // Set up layers\r\n        var layers = {\r\n            exportOnlyBacking: new paper.Layer(),\r\n            apparatus: new paper.Layer(),\r\n            arrows: new paper.Layer(),\r\n            overlay: new paper.Layer(),\r\n        };\r\n        this.layers = layers;\r\n        // Set the apparatus layer as default.\r\n        layers.apparatus.activate();\r\n    };\r\n    EditorCanvasComponent.prototype.setZoom = function (zoom) {\r\n        paper.project.view.zoom = zoom;\r\n    };\r\n    EditorCanvasComponent.prototype.getProjectBounds = function () {\r\n        var _this = this;\r\n        // Compute bounds of the diagram from individual object bounds.\r\n        var ids = __spreadArrays(this.props.arrows.map(function (arrow) { return arrow.id; }), this.props.items.map(function (item) { return item.id; }));\r\n        var items = ids.map(function (id) { return _this.objectRefs[ID.string(id)]; });\r\n        var bounds = new paper.Rectangle(items[0].bounds);\r\n        for (var _i = 0, items_1 = items; _i < items_1.length; _i++) {\r\n            var item = items_1[_i];\r\n            bounds.united(item.bounds);\r\n        }\r\n        return bounds;\r\n    };\r\n    EditorCanvasComponent.prototype.export = function () {\r\n        var pixels = maxPixels(this.props.tier);\r\n        return exportFromCanvas(paper.project, this.layers, this.getProjectBounds(), pixels);\r\n    };\r\n    EditorCanvasComponent.prototype.exportThumbnail = function () {\r\n        return exportFromCanvasJPGThumbnail(paper.project, this.layers, this.getProjectBounds());\r\n    };\r\n    EditorCanvasComponent.prototype.componentDidUpdate = function () {\r\n        // Reorder drawn items to match the order in the data store.\r\n        this.ensureVisualOrder();\r\n    };\r\n    EditorCanvasComponent.prototype.onCanvasMouseDownOrTouchStart = function () {\r\n        // Return focus to the app.\r\n        focusMainApp();\r\n    };\r\n    EditorCanvasComponent.prototype.render = function () {\r\n        var _this = this;\r\n        // Set zoom on paper project.\r\n        if (this.isPaperReady) {\r\n            this.setZoom(this.props.zoom);\r\n        }\r\n        // Render main canvas.\r\n        var canvas = createElement(\"canvas\", {\r\n            key: \"MainCanvas\",\r\n            className: \"editor\",\r\n            style: {\r\n                \"cursor\": toolCursors(this.props.tool),\r\n            },\r\n            resize: \"true\",\r\n            ref: this.canvasElementRef,\r\n            onMouseDown: function (e) { return _this.onCanvasMouseDownOrTouchStart(); },\r\n            onTouchStart: function (e) { return _this.onCanvasMouseDownOrTouchStart(); },\r\n            onContextMenu: function (e) {\r\n                e.preventDefault();\r\n                _this.setState({ contextMenu: { position: { x: e.clientX, y: e.clientY } } });\r\n                return false;\r\n            }\r\n        });\r\n        // Render apparatus components.\r\n        var apparatusComponents = this.props.items.map(function (item) {\r\n            return React.createElement(ApparatusComponent\r\n            // Use a key that includes the ID as well as type.\r\n            // ApparatusComponent once set up for a specific\r\n            // apparatus type can't be reused for another type.\r\n            , __assign({ \r\n                // Use a key that includes the ID as well as type.\r\n                // ApparatusComponent once set up for a specific\r\n                // apparatus type can't be reused for another type.\r\n                key: ID.string(item.id) + \"/\" + item.type, isWatermarkEnabled: !isItemUnlocked(item, _this.props.tier), ref: function (r) { return r\r\n                    ? _this.objectRefs[ID.string(item.id)] = r\r\n                    : delete _this.objectRefs[ID.string(item.id)]; } }, item));\r\n        });\r\n        // Render arrows.\r\n        var arrows = this.props.arrows.map(function (arrow) {\r\n            return React.createElement(ArrowComponent, __assign(__assign({}, arrow), { key: ID.string(arrow.id), ref: function (r) { return _this.objectRefs[ID.string(arrow.id)] = r; }, showAdjustables: _this.props.tool == \"select\" && arrow.selected }));\r\n        });\r\n        // Temporary arrow, one that the user is currently drawing.\r\n        var currentlyDrawnArrow = this.state.arrow\r\n            ? React.createElement(ArrowComponent, __assign(__assign({ key: \"__DrawnArrow\" }, this.state.arrow), { showAdjustables: false }))\r\n            : null;\r\n        return __spreadArrays([\r\n            canvas,\r\n            React.createElement(EditorContextMenu, { key: \"ContextMenu\", contextMenu: this.state.contextMenu, onClose: function () { return _this.setState({ contextMenu: undefined }); }, selected: this.props.selected }),\r\n            // The following are \"virtual components\", they don't\r\n            // contain any DOM, because the drawing is handled\r\n            // within the components, via paper.\r\n            currentlyDrawnArrow\r\n        ], apparatusComponents, arrows);\r\n    };\r\n    /**\r\n     * Ensure that paper items order matches the order in data store. Higher index\r\n     * in the data store implies the apparatus is drawn later/above lower index\r\n     * apparatus. (index 0 => drawn first | at the bottom)\r\n     */\r\n    EditorCanvasComponent.prototype.ensureVisualOrder = function () {\r\n        // Reorder Paper elements according to position.\r\n        for (var i = 1; i < this.props.items.length; i++) {\r\n            var id = ID.string(this.props.items[i].id);\r\n            var prevId = ID.string(this.props.items[i - 1].id);\r\n            var component = this.objectRefs[id];\r\n            var previousComponent = this.objectRefs[prevId];\r\n            component.item.moveAbove(previousComponent.item);\r\n        }\r\n    };\r\n    /** Compute the bounds on the current active selection. */\r\n    EditorCanvasComponent.prototype.computeSelectionMetrics = function () {\r\n        var _this = this;\r\n        var _a;\r\n        var ids = __spreadArrays(this.props.selected.arrows.map(function (arrow) { return arrow.id; }), this.props.selected.items.map(function (item) { return item.id; }));\r\n        var items = ids.map(function (id) { return _this.getObjectComponent(id); });\r\n        if (items.length == 0) {\r\n            return NULL_SELECTION_METRICS;\r\n        }\r\n        if (items.length == 1) {\r\n            var item = items[0];\r\n            // For certain items, calculate the bounds center and use that as the pivot.\r\n            var shouldUseBoundsCenter = (item instanceof ApparatusComponent) ? (_a = item.apparatus.shouldUseBoundsCenter) !== null && _a !== void 0 ? _a : false : false;\r\n            // Only one selected apparatus, take its natural position as pivot\r\n            // and bounds.\r\n            return {\r\n                pivot: shouldUseBoundsCenter ? items[0].bounds.center : items[0].currentPosition,\r\n                bounds: items[0].bounds\r\n            };\r\n        }\r\n        else {\r\n            // Multiple items. Calculate the encompassing bounds\r\n            // and take its center as pivot.\r\n            var encompassingBounds = new paper.Rectangle(items[0].bounds);\r\n            for (var _i = 0, items_2 = items; _i < items_2.length; _i++) {\r\n                var item = items_2[_i];\r\n                encompassingBounds.united(item.bounds);\r\n            }\r\n            return {\r\n                pivot: encompassingBounds.center,\r\n                bounds: encompassingBounds,\r\n            };\r\n        }\r\n    };\r\n    return EditorCanvasComponent;\r\n}(Component));\r\nexport { EditorCanvasComponent };\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { commandProcessor } from \"command/command\";\r\nimport * as React from \"react\";\r\nimport store from \"store/store\";\r\nimport { ZoomCommand } from \"view/zoom\";\r\n/**\r\n * Component to display the zoom slider.\r\n */\r\nvar ZoomSlider = /** @class */ (function (_super) {\r\n    __extends(ZoomSlider, _super);\r\n    function ZoomSlider() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        /** Ref to the DOM element. */\r\n        _this.elementRef = React.createRef();\r\n        return _this;\r\n    }\r\n    ZoomSlider.prototype.executeZoomCommand = function (zoom) {\r\n        if (store.zoom() != zoom) {\r\n            // Don't set zero zoom.\r\n            zoom = Math.max(0.01, zoom);\r\n            commandProcessor.execute(new ZoomCommand(store.zoom(), zoom));\r\n        }\r\n    };\r\n    ZoomSlider.prototype.componentDidMount = function () {\r\n        var slider = $(this.elementRef.current);\r\n        var self = this;\r\n        slider.slider({\r\n            value: 0.7,\r\n            min: -2,\r\n            max: 1,\r\n            step: 0.01,\r\n            animate: \"fast\",\r\n        }).slider(\"pips\", {\r\n            rest: \"label\",\r\n            step: 100,\r\n            labels: [\"25%\", \"50%\", \"100%\", \"150%\"]\r\n        }).slider(\"float\", {\r\n            formatLabel: function (value) {\r\n                return Math.floor(getZoomFromSliderValue(value) * 100) + \"%\";\r\n            }\r\n        }).on(\"slidestart\", function (e, ui) {\r\n            self.props.onStartZoom();\r\n        }).on(\"slide\", function (e, ui) {\r\n            // Convert to zoom level.\r\n            var zoomLevel = getZoomFromSliderValue(ui.value);\r\n            self.props.onUpdateZoom(zoomLevel);\r\n        }).on(\"slidestop\", function (e, ui) {\r\n            var newZoom = getZoomFromSliderValue(ui.value);\r\n            self.executeZoomCommand(newZoom);\r\n            self.props.onEndZoom();\r\n        }).on(\"slidechange\", function (e, ui) {\r\n            var newZoom = getZoomFromSliderValue(ui.value);\r\n            self.executeZoomCommand(newZoom);\r\n            self.props.onEndZoom();\r\n        });\r\n    };\r\n    ZoomSlider.prototype.componentDidUpdate = function () {\r\n        var currentSliderValue = $(this.elementRef.current).slider(\"value\");\r\n        var currentZoom = getZoomFromSliderValue(currentSliderValue);\r\n        if (currentZoom != this.props.zoom) {\r\n            var newZoomSlider = getSliderValueFromZoom(this.props.zoom);\r\n            $(this.elementRef.current).slider(\"value\", newZoomSlider);\r\n        }\r\n    };\r\n    ZoomSlider.prototype.render = function () {\r\n        return React.createElement(\"div\", { id: \"zoom-slider\", key: \"zoomSlider\", ref: this.elementRef });\r\n    };\r\n    return ZoomSlider;\r\n}(React.Component));\r\nexport { ZoomSlider };\r\n/** Converts a slider value to Zoom value.  */\r\nfunction getZoomFromSliderValue(value) {\r\n    return (value < 0 ? Math.pow(2, value) : 1 + value / 2);\r\n}\r\n/** Converts zoom value to slider value. */\r\nfunction getSliderValueFromZoom(zoom) {\r\n    return zoom <= 1 ? Math.log(zoom) / Math.log(2) : 2 * zoom - 1;\r\n}\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { P, Segments } from \"apparatus/library/common\";\r\nimport { BasicShapes } from \"apparatus/library/shapes/common\";\r\nimport { Path } from \"paper\";\r\nvar Tick = /** @class */ (function () {\r\n    function Tick() {\r\n        this.drivers = [\r\n            // Length.\r\n            {\r\n                type: \"rectangle\",\r\n                minX: 40, maxX: 250,\r\n                minY: 40, maxY: 250,\r\n                toAppearance: function (p) { return ({\r\n                    length: (p.x + p.y) / 2 * Math.SQRT2,\r\n                }); },\r\n                fromAppearance: function (a) {\r\n                    var x = a.length / Math.SQRT2;\r\n                    return P(x, -x);\r\n                },\r\n                scale: 1.0,\r\n            },\r\n            {\r\n                type: \"rectangle\",\r\n                minX: 0, maxX: 0,\r\n                minY: 5, maxY: 50,\r\n                toAppearance: function (p) { return ({\r\n                    thickness: p.y / Math.SQRT2 * 2,\r\n                }); },\r\n                fromAppearance: function (a) { return P(0, a.thickness / 2 * Math.SQRT2); },\r\n                scale: 1.0,\r\n            }\r\n        ];\r\n    }\r\n    Tick.prototype.render = function (appearance) {\r\n        var thickness = appearance.thickness, length = appearance.length;\r\n        var semiLength = length * 0.5;\r\n        var halfThick = thickness * 0.5;\r\n        var graphic = new Path(Segments([[-halfThick, -halfThick]], [[-halfThick, -length]], [[halfThick, -length]], [[halfThick, halfThick]], [[-semiLength, halfThick]], [[-semiLength, -halfThick]]));\r\n        graphic.closePath();\r\n        graphic.rotate(45, P(0, 0));\r\n        var shape = graphic.clone();\r\n        BasicShapes.applyStyle(graphic, appearance);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: shape,\r\n        };\r\n    };\r\n    Tick.properties = {\r\n        label: \"Tick\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: __assign({ thickness: 40, length: 120 }, BasicShapes.defaultAppearance),\r\n        appearanceSpecs: __spreadArrays(BasicShapes.specs),\r\n    };\r\n    return Tick;\r\n}());\r\nexport { Tick };\r\n","import { strokeWidth } from \"apparatus/common\";\r\nimport { mirrorX, simpleGradient, smoothCorner } from \"apparatus/draw\";\r\nimport { Path, Size } from \"paper\";\r\nimport { clamp, P, Pivot, R, Segments } from \"./common\";\r\nvar HOLE_GAP = 10;\r\nvar MIN_GAP = 2;\r\nvar MIN_DIAMETER = 8;\r\nvar MAX_DIAMETER = 100;\r\nvar TAPERING = 0.9;\r\nvar Bung = /** @class */ (function () {\r\n    function Bung() {\r\n    }\r\n    Bung.prototype.render = function (appearance) {\r\n        var diameter = appearance.diameter;\r\n        var height = 25;\r\n        var bung = new Path(Segments([[diameter / 2, 0]], [[diameter / 2 * TAPERING, height]]));\r\n        mirrorX(bung);\r\n        smoothCorner(bung.segments[2], 3.0);\r\n        smoothCorner(bung.segments[1], 3.0);\r\n        bung.closed = true;\r\n        var graphic = bung;\r\n        if (appearance.hole == \"one\") {\r\n            var holeDiameter = Math.min(appearance.holeDiameter, diameter * TAPERING - 5);\r\n            var topLeft = P(-holeDiameter / 2, -10);\r\n            var size = new Size(holeDiameter, 50);\r\n            var holeSubtract = new Path.Rectangle(topLeft, size);\r\n            graphic = bung.subtract(holeSubtract);\r\n        }\r\n        else if (appearance.hole == \"two\") {\r\n            var space = diameter * TAPERING - 5;\r\n            var holeDiameter = appearance.holeDiameter, holeDiameter2 = appearance.holeDiameter2;\r\n            var excess = holeDiameter + holeDiameter2 + HOLE_GAP - space;\r\n            var gap = HOLE_GAP;\r\n            if (excess > 0) {\r\n                // Too cramped. Need to distribute the excess evenly.\r\n                // First, absorb it in the gap.\r\n                if (excess < (HOLE_GAP - MIN_GAP)) {\r\n                    // All absorbed in the gap.\r\n                    gap -= excess;\r\n                }\r\n                else {\r\n                    // Absorb in the gap and distribute between the two holes evenly.\r\n                    gap = MIN_GAP;\r\n                    excess -= (HOLE_GAP - MIN_GAP);\r\n                    var totalDiameter = holeDiameter + holeDiameter2;\r\n                    holeDiameter -= excess * (holeDiameter / totalDiameter);\r\n                    holeDiameter2 -= excess * (holeDiameter2 / totalDiameter);\r\n                }\r\n            }\r\n            var totalSpace = holeDiameter + holeDiameter2 + gap;\r\n            var leftHoleSubtract = new Path.Rectangle(R(-totalSpace / 2, -10, holeDiameter, 50, Pivot.TOP_LEFT));\r\n            var rightHoleSubtract = new Path.Rectangle(R(totalSpace / 2, -10, holeDiameter2, 50, Pivot.TOP_RIGHT));\r\n            graphic = bung.subtract(leftHoleSubtract).subtract(rightHoleSubtract);\r\n        }\r\n        graphic\r\n            .withGradientFill(\"right\", simpleGradient(appearance.color))\r\n            .withStroke(\"thinner\", appearance.color.color().darken(0.1).hex());\r\n        return {\r\n            graphic: graphic, hitShape: graphic.bounds.expand(5).toShape(),\r\n            snapping: {\r\n                type: \"pluggable\", at: P(0, height / 2),\r\n                requestDiameter: requestDiameter\r\n            }\r\n        };\r\n    };\r\n    Bung.properties = {\r\n        label: \"Bung / Stopper\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            diameter: 22,\r\n            color: \"#dd7d2e\",\r\n            hole: \"none\",\r\n            holeDiameter: 15,\r\n            holeDiameter2: 15,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"diameter\", label: \"Diameter\",\r\n                min: MIN_DIAMETER, max: MAX_DIAMETER, unit: \"mm\",\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"color\", label: \"Material\",\r\n                options: [\r\n                    { value: \"#dd7d2e\", label: \"Orange Rubber\" },\r\n                    { value: \"#aaaaaa\", label: \"White Rubber\" },\r\n                    { value: \"#824b20\", label: \"Cork\" },\r\n                ]\r\n            },\r\n            {\r\n                spec: \"toggle-buttons\", key: \"hole\", label: \"Holes\", size: \"text\",\r\n                options: [\r\n                    { value: \"none\", label: \"0\", icon: \"\" },\r\n                    { value: \"one\", label: \"1\", icon: \"\" },\r\n                    { value: \"two\", label: \"2\", icon: \"\" },\r\n                ]\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"holeDiameter\", label: \"Hole diameter\",\r\n                min: 5, max: 40,\r\n                visible: function (a) { return a.hole == \"one\"; },\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"holeDiameter\", label: \"#1 diameter\",\r\n                min: 5, max: 40,\r\n                visible: function (a) { return a.hole == \"two\"; },\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"holeDiameter2\", label: \"#2 diameter\",\r\n                min: 5, max: 40,\r\n                visible: function (a) { return a.hole == \"two\"; },\r\n            }\r\n        ],\r\n    };\r\n    return Bung;\r\n}());\r\nexport { Bung };\r\nfunction requestDiameter(diameter) {\r\n    var newDiameter = diameter / (0.5 + TAPERING / 2) - strokeWidth(\"default\");\r\n    return { diameter: clamp(newDiameter, MIN_DIAMETER, MAX_DIAMETER).round(0) };\r\n}\r\n","import { setDefaultStyle, strokeWidth } from \"apparatus/draw\";\r\nimport { P, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path, Symbol } from \"paper\";\r\nimport { condenserCaseShape } from \"../condensers\";\r\nvar Vigreux = /** @class */ (function () {\r\n    function Vigreux() {\r\n    }\r\n    Vigreux.prototype.render = function (appearance) {\r\n        var _a = condenserCaseShape(230, 15), graphic = _a.group, snap = _a.snap;\r\n        setDefaultStyle(graphic);\r\n        var perf = new Symbol(perforation());\r\n        for (var y = 40; y < 200; y += 30) {\r\n            graphic.addChild(perf.place(P(0, y)));\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: snap,\r\n        };\r\n    };\r\n    Vigreux.properties = {\r\n        label: \"Vigreux Column\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {},\r\n        appearanceSpecs: [],\r\n    };\r\n    return Vigreux;\r\n}());\r\nexport { Vigreux };\r\nfunction perforation() {\r\n    // Straight triangles.\r\n    var triangle1l = new Path(Segments([[-18, 0]], [[-8, 5]], [[-18, 10]]));\r\n    var triangle1r = triangle1l.clone();\r\n    triangle1r.scale(-1, 1, P(0, 0));\r\n    var circle = new Path.Circle(P(0, 5), 4);\r\n    // Bent triangles\r\n    var triangle2l = new Path(Segments([[-18, 15]], [[-8, 25], [0, -9], [0, -6]], [[-18, 25]]));\r\n    var triangle2r = triangle2l.clone();\r\n    triangle2r.scale(-1, 1, P(0, 0));\r\n    var drop = new Path(Segments([[0, 15], [-8, 0], [8, 0]], [[0, 25]])).close();\r\n    var group = new Group([triangle1l, triangle1r, triangle2l, triangle2r, circle, drop]);\r\n    group.withStroke(strokeWidth(\"thinner\"), SharedColors.glassFold);\r\n    return group;\r\n}\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport * as Sentry from \"@sentry/react\";\r\nimport { g } from \"analytics\";\r\nimport { LoginButton } from \"api/auth/login_button\";\r\nimport { reauthFromCurrentLogin } from \"api/auth/reauth\";\r\nimport { storeToken } from \"api/auth/storage\";\r\nimport { Remodal } from \"components/remodal\";\r\nimport Flags from \"flags\";\r\nimport { StaySignedInCheckbox } from \"layout/top_bar/account\";\r\nimport { clog } from \"log\";\r\nimport * as React from 'react';\r\nimport appStore from \"store/store\";\r\nimport { Articles } from \"support/beacon\";\r\nimport { countryCodeToCurrency } from \"tiers/currency\";\r\nimport { Disclaimer, PlansGrid } from \"tiers/promo_plus\";\r\nimport { ComparisonTable } from \"tiers/promo_table\";\r\nimport { Consts } from \"vars\";\r\nimport { setUpQTip } from \"view/tooltips\";\r\nimport { callApi } from \"../api/api\";\r\nimport { isSafari } from \"../utils\";\r\n/** Maximum number of layers that Boost users can add to a container. */\r\nexport var MAX_BOOST_DIAGRAM_LAYERS = 5;\r\n/** Maximum number of diagrams that Boost users can store in cloud. */\r\nexport var BOOST_TOTAL_DIAGRAMS = 75;\r\n/** Maximum number of diagrams that free users can store in cloud. */\r\nexport var FREE_TOTAL_DIAGRAMS = 3;\r\n/** Number of item customisations */\r\nexport var ITEM_CUSTOMISATIONS = \"100+\";\r\nvar WAIT_FOR_CURRENCY_THRESHOLD_MS = 500;\r\nvar PlusPromoModal = /** @class */ (function (_super) {\r\n    __extends(PlusPromoModal, _super);\r\n    function PlusPromoModal(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.state = {\r\n            isOpened: false,\r\n            staySignedIn: false,\r\n            schoolPlanStudents: 0,\r\n            schoolPlanMaxDiagrams: 0,\r\n        };\r\n        return _this;\r\n    }\r\n    PlusPromoModal.prototype.onLoginSuccess = function (token, tier) {\r\n        if (this.state.staySignedIn) {\r\n            clog(\"Token written to storage\");\r\n            storeToken(token);\r\n        }\r\n        // Check if the user has a plan\r\n        if (tier) {\r\n            // This user has a plan already. Close promo.\r\n            this.close();\r\n        }\r\n        else {\r\n            // Leave this open if the user is not signed up to a plan\r\n            // Hide the sign in section.\r\n            $('#promoSignInSection').hide();\r\n        }\r\n    };\r\n    PlusPromoModal.prototype.toggleStayLoggedIn = function (stayLoggedIn) {\r\n        this.setState({\r\n            staySignedIn: stayLoggedIn\r\n        });\r\n    };\r\n    PlusPromoModal.prototype.checkout = function (plan, currency, interval) {\r\n        var _this = this;\r\n        g(\"CheckoutButtonClick\", this.state.analyticsTag);\r\n        var request = {\r\n            plan: plan,\r\n            currency: currency,\r\n            interval: interval,\r\n        };\r\n        // On Safari, we need to open the window immediately, otherwise it gets\r\n        // blocked and it's hard to open it.\r\n        // https://stackoverflow.com/questions/20696041/window-openurl-blank-not-working-on-imac-safari\r\n        var windowReferenceForSafari;\r\n        if (isSafari()) {\r\n            windowReferenceForSafari = window.open();\r\n            windowReferenceForSafari === null || windowReferenceForSafari === void 0 ? void 0 : windowReferenceForSafari.document.write(\"<html><body><center style='margin-top:5em'>Retrieving information, please wait...</center></body></html>\");\r\n        }\r\n        callApi(\"plans/createCheckoutSession\", \"POST\", appStore.loggedInState(), request, {\r\n            success: function (response) {\r\n                // There are two cases:\r\n                if (response.sessionId) {\r\n                    // 1) User does not yet have a plan. Checkout session has been created.\r\n                    var sessionId = response.sessionId;\r\n                    var checkoutUrl = \"./checkout.html?sessionId=\" + sessionId + \"&stripePk=\" + Consts.stripePublicKey;\r\n                    if (windowReferenceForSafari) {\r\n                        // For Safari, just assign the location.\r\n                        windowReferenceForSafari.location.href = checkoutUrl;\r\n                    }\r\n                    else {\r\n                        // Otherwise use window.open.\r\n                        window.open(checkoutUrl);\r\n                    }\r\n                    g(\"CheckoutWindowOpen\", _this.state.analyticsTag);\r\n                }\r\n                else if (response.tier) {\r\n                    var tier = response.tier;\r\n                    reauthFromCurrentLogin();\r\n                    toastr.success(\"You can now enjoy full features of Chemix!\", \"Congratulations! You are now a \" + tier.capitalise() + \" user!\");\r\n                    _this.close();\r\n                    g(\"CheckoutWindowOpen\", \"RecoverSuccess\");\r\n                }\r\n                else {\r\n                    // Unknown case.\r\n                    Sentry.captureMessage(\"Unexpected response from createCheckoutSession\", Sentry.Severity.Error);\r\n                }\r\n            },\r\n        });\r\n    };\r\n    PlusPromoModal.prototype.render = function () {\r\n        var _this = this;\r\n        return React.createElement(Remodal.Container, { parent: this, class: \"promo-modal wide\", title: \"Get more done with Chemix!\", icon: \"fa-bolt\" },\r\n            Flags.isPromoEnabled ? React.createElement(PromoBanner, null) : null,\r\n            React.createElement(PlansGrid, { defaultCurrency: this.state.defaultCurrency, onCheckout: function (plan, currency, interval) { return _this.checkout(plan, currency, interval); }, signedIn: this.props.auth.state == \"logged_in\", onClose: function () { return _this.close(); }, onUpdateSchoolPlan: function (_a) {\r\n                    var students = _a.students, maxDiagrams = _a.maxDiagrams;\r\n                    return _this.setState({ schoolPlanStudents: students, schoolPlanMaxDiagrams: maxDiagrams });\r\n                }, analyticsTag: this.state.analyticsTag }),\r\n            React.createElement(\"div\", { className: \"collapse text-center\", id: \"promoSignInSection\" },\r\n                React.createElement(\"p\", null, \"Signing in takes less than a minute and you'll be able to pick up from where you left off.\"),\r\n                React.createElement(LoginButton, { providerName: \"google\", auth: this.props.auth, active: this.state.isOpened, onClick: function () { return g(\"SignInButton\", \"promo:google\"); }, onSuccess: function (token, tier) { return _this.onLoginSuccess(token, tier); } }),\r\n                React.createElement(LoginButton, { providerName: \"microsoft\", auth: this.props.auth, active: this.state.isOpened, onClick: function () { return g(\"SignInButton\", \"promo:microsoft\"); }, onSuccess: function (token, tier) { return _this.onLoginSuccess(token, tier); } }),\r\n                React.createElement(LoginButton, { providerName: \"twitter\", auth: this.props.auth, active: this.state.isOpened, onClick: function () { return g(\"SignInButton\", \"promo:twitter\"); }, onSuccess: function (token, tier) { return _this.onLoginSuccess(token, tier); } }),\r\n                React.createElement(LoginButton, { providerName: \"facebook\", auth: this.props.auth, active: this.state.isOpened, onClick: function () { return g(\"SignInButton\", \"promo:facebook\"); }, onSuccess: function (token, tier) { return _this.onLoginSuccess(token, tier); } }),\r\n                React.createElement(\"div\", { className: \"text-center\" },\r\n                    React.createElement(StaySignedInCheckbox, { key: \"stayLoggedIn\", value: this.state.staySignedIn, onChange: function (v) { return _this.toggleStayLoggedIn(v); } }))),\r\n            React.createElement(Disclaimer, null),\r\n            React.createElement(ComparisonTable, { students: this.state.schoolPlanStudents, maxDiagrams: this.state.schoolPlanMaxDiagrams }));\r\n    };\r\n    PlusPromoModal.prototype.componentDidMount = function () {\r\n        _super.prototype.componentDidMount.call(this);\r\n        setUpQTip(this.ref);\r\n    };\r\n    PlusPromoModal.prototype.triggerOpen = function (analyticsTag) {\r\n        var _this = this;\r\n        this.setState({ analyticsTag: analyticsTag });\r\n        // Attempt to prefetch user's country to determine currency.\r\n        // However if this takes too long, open anyway.\r\n        // If already fetched, don't fetch again.\r\n        if (this.state.defaultCurrency || Consts.isDev) {\r\n            this.open();\r\n            return;\r\n        }\r\n        setTimeout(function () { return _this.open(); }, WAIT_FOR_CURRENCY_THRESHOLD_MS);\r\n        var self = this;\r\n        $.get(\"https://ipinfo.io?token=a91f57b3b0b7ec\", function (response) {\r\n            var countryCode = response.country;\r\n            var selectedCurrency = countryCodeToCurrency(countryCode);\r\n            self.setState({ defaultCurrency: selectedCurrency });\r\n            // Trigger open, but only if we already haven't opened.\r\n            if (!self.state.isOpened) {\r\n                _this.open();\r\n            }\r\n        }, \"jsonp\");\r\n    };\r\n    return PlusPromoModal;\r\n}(Remodal));\r\nexport { PlusPromoModal };\r\nvar PromoBanner = function () { return React.createElement(React.Fragment, null,\r\n    React.createElement(\"div\", { className: \"inline-toast custom-icon toast toast-warning mt-3 mb-1 mx-5\" },\r\n        React.createElement(\"i\", { className: \"fad fa-hat-santa fa-lg mr-1 align-middle\", style: __assign(__assign({}, fadColors(\"white\", \"crimson\")), { \"textShadow\": \"0 0 5px #ffffffaa\" }) }),\r\n        React.createElement(\"i\", { className: \"fad fa-tree-decorated fa-lg mr-1 align-middle\", style: __assign(__assign({}, fadColors(\"mediumseagreen\", \"gold\")), { \"textShadow\": \"0 0 5px #ffffffaa\" }) }),\r\n        React.createElement(\"i\", { className: \"fad fa-snowman fa-lg mr-2 align-middle\", style: __assign(__assign({}, fadColors(\"brown\", \"white\")), { \"textShadow\": \"0 0 5px #ffffffaa\" }) }),\r\n        React.createElement(\"b\", null, \"Holiday Deal: 15% off for 1 year!\"),\r\n        \"\\u00A0Simply enter the promo code \",\r\n        React.createElement(\"b\", { className: \"text-danger\" }, \"WINTERHOLIDAY\"),\r\n        \" during checkout.\",\r\n        React.createElement(\"br\", null)),\r\n    React.createElement(\"div\", { className: \"text-muted mx-5 mb-3\" },\r\n        \"Offer available until 14th January 2021. New subscribers only. \",\r\n        React.createElement(\"a\", { \"data-beacon-article-modal\": Articles.CHRISTMAS_PROMO, className: \"text-muted\", href: \"#\" }, \"Click for more details\"))); };\r\nexport var fadColors = function (primary, secondary) { return ({\r\n    \"--fa-primary-color\": primary,\r\n    \"--fa-secondary-color\": secondary,\r\n    \"--fa-secondary-opacity\": 1.0,\r\n}); };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { setDefaultStyle } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, Pivot, R } from \"apparatus/library/common\";\r\nimport { TestTube } from \"apparatus/library/testTube\";\r\nimport { CompoundPath, Group, Shape } from \"paper\";\r\nvar WOOD_STROKE = \"#382b1e\";\r\nvar TestTubeRack = /** @class */ (function () {\r\n    function TestTubeRack() {\r\n    }\r\n    TestTubeRack.convertToLatest = function (a) {\r\n        if (!a.type) {\r\n            a.type = \"simple\";\r\n        }\r\n        return __assign(__assign({}, TestTubeRack.properties.defaultAppearance), a);\r\n    };\r\n    TestTubeRack.prototype.render = function (appearance) {\r\n        return (function () {\r\n            switch (appearance.type) {\r\n                case \"simple\": return renderSimple(appearance);\r\n                case \"wooden\": return renderWooden(appearance);\r\n            }\r\n        })();\r\n    };\r\n    TestTubeRack.properties = {\r\n        label: \"Test Tube Rack\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            slots: 4,\r\n            gap: TestTube.properties.defaultAppearance.width,\r\n            height: 100,\r\n            type: \"wooden\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"type\", label: \"Type\",\r\n                options: [\r\n                    { value: \"wooden\", label: \"Wooden\" },\r\n                    { value: \"simple\", label: \"Simple\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"slots\", label: \"Number of slots\",\r\n                min: 4, max: 8, step: 1\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Height\",\r\n                min: 60, max: 200,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"gap\", label: \"Gap size\",\r\n                min: 8, max: 30,\r\n                visible: function (a) { return a.type === \"simple\"; }\r\n            }\r\n        ],\r\n    };\r\n    return TestTubeRack;\r\n}());\r\nexport { TestTubeRack };\r\nfunction renderSimple(appearance) {\r\n    var height = appearance.height;\r\n    var slots = appearance.slots;\r\n    var step = 40;\r\n    var gap = appearance.gap;\r\n    var wall = step - gap;\r\n    var sideWall = 20;\r\n    var graphic = new CompoundPath({});\r\n    graphic.moveTo(P(0, 0));\r\n    graphic.lineBy(P(0, -height));\r\n    graphic.lineBy(P(sideWall, 0));\r\n    for (var i = 0; i < slots; i++) {\r\n        graphic.moveBy(P(gap, 0));\r\n        graphic.lineBy(P(wall, 0));\r\n    }\r\n    graphic.lastSegment.remove();\r\n    graphic.lineBy(P(sideWall, 0));\r\n    graphic.lineBy(P(0, height)),\r\n        graphic.lineTo(P(0, 0));\r\n    setDefaultStyle(graphic);\r\n    graphic.strokeCap = \"butt\";\r\n    return {\r\n        graphic: graphic,\r\n        hitShape: graphic.bounds.toShape(),\r\n        snapping: graphic.placeable(),\r\n    };\r\n}\r\nfunction renderWooden(appearance) {\r\n    var height = appearance.height;\r\n    var width = 30 + (appearance.slots - 1) * 50;\r\n    var horizontalPartThickness = 8;\r\n    var verticalPartThickness = 12;\r\n    // Calculate the offset needed for the gradient,\r\n    // to give the horizontal bars have a subtle shadow\r\n    var gradientOffset = 18 / width;\r\n    var top = Shape.Rectangle(R(0, 20, width, horizontalPartThickness, Pivot.TOP_LEFT), 3.0)\r\n        .withStroke(\"default\", WOOD_STROKE)\r\n        .withGradientFill(\"right\", Gradients.reflected([\"#704e2f\", gradientOffset], [\"#916943\", gradientOffset + 0.03]));\r\n    var bottom = top.clone();\r\n    bottom.position.y = height - horizontalPartThickness;\r\n    var left = Shape.Rectangle(R(0, 0, verticalPartThickness, height, Pivot.TOP_LEFT), 3.0)\r\n        .withStroke(\"default\", WOOD_STROKE)\r\n        .withGradientFill(\"right\", [\r\n        [\"#ce9158\", 0.2],\r\n        [\"#ad7847\", 0.21],\r\n        [\"#704e2f\", 1.0]\r\n    ]);\r\n    var right = left.clone();\r\n    right.position.x += width - verticalPartThickness;\r\n    var graphic = new Group([top, bottom, left, right]);\r\n    return {\r\n        graphic: graphic,\r\n        hitShape: graphic.bounds.toShape(),\r\n        snapping: graphic.placeable()\r\n    };\r\n}\r\n","import { P, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar METAL = [\r\n    [\"#dddddd\", 0.2],\r\n    [\"#aaaaaa\", 0.9],\r\n];\r\nvar CrocodileClips = /** @class */ (function () {\r\n    function CrocodileClips() {\r\n    }\r\n    CrocodileClips.prototype.render = function (appearance) {\r\n        var topPart = new Path(Segments([[-185, -14], [-4, 0]], [[120, -48], , [10, -1]], [[122, -34], [10, -1]], [[98, -31]], [[35, -16], , [-10, 2]], [[0, 10], [20, 0], [-40, 0]], [[-44, -10], , [-7, -10]], [[-65, -9], [7, -10]], [[-76, 3]], [[-86, -7]], [[-96, 4]], [[-106, -6]], [[-116, 5]], [[-126, -5]], [[-136, 6]], [[-146, -4]], [[-156, 7]], [[-166, -3]], [[-176, 8]], [[-186, -5]]));\r\n        topPart.closePath();\r\n        topPart.setGradientFill(\"right-down\", METAL);\r\n        var bottomPart = new Path(Segments([[-176, 20]], [[-166, 9]], [[-156, 19]], [[-146, 7]], [[-136, 18]], [[-127, 6]], [[-117, 17]], [[-108, 5]], [[-98, 16]], [[-89, 4]], [[-79, 14]], [[-69, 3], , [30, 30]], [[-30, 0], [-5, 10], [25, -50]], [[36, 13], [-5, -20], [2, 8]], [[110, 15]], [[140, 10]], [[200, 8]], [[200, 31]], [[-170, 31], , [-6, 0]]));\r\n        bottomPart.closePath();\r\n        bottomPart.setGradientFill(\"right-up\", METAL);\r\n        topPart.rotate(appearance.opening * 20, P(0, 0));\r\n        var graphic = new Group([topPart, bottomPart]);\r\n        graphic.pivot = P(0, 0);\r\n        graphic.strokeWidth = Math.min(3.0, appearance.scale * 1.5);\r\n        graphic.strokeColor = SharedColors.darkMetal;\r\n        var pivot = Shape.Circle(P(-2, 2), 12);\r\n        pivot.fillColor = SharedColors.mediumMetal;\r\n        graphic.addChild(pivot);\r\n        graphic.scale(0.2 * appearance.scale);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            pivot: P(0, 0)\r\n        };\r\n    };\r\n    CrocodileClips.properties = {\r\n        label: \"Crocodile Clips\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            scale: 1.0,\r\n            opening: 0.0\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.7, max: 2.0, step: 0.05\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"opening\", label: \"Opening\",\r\n                min: 0, max: 1, step: 0.1\r\n            }\r\n        ],\r\n    };\r\n    return CrocodileClips;\r\n}());\r\nexport { CrocodileClips };\r\n","import { lerp, P, Polar, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path, Segment } from \"paper\";\r\nvar Spring = /** @class */ (function () {\r\n    function Spring() {\r\n    }\r\n    // static isBoostRequiredForAppearance(appearance: SpringAppearance) {\r\n    //     return appearance.shade /*TIERLOCK*/\r\n    // }\r\n    Spring.prototype.render = function (appearance) {\r\n        var spring = new Path().withStroke(\"thick\", appearance.shade ? \"#777777\" : SharedColors.stroke);\r\n        var radius = appearance.diameter / 2;\r\n        var distance = radius * lerp(5, 0.0, Math.pow(appearance.compression, 0.5)) + 7;\r\n        var handle = distance / 3;\r\n        var loops = appearance.loops;\r\n        for (var i = 0; i < loops; i++) {\r\n            spring.addSegments([\r\n                new Segment(P(-radius, i * distance), Polar(handle, 0), Polar(handle, 180)),\r\n                new Segment(P(radius, (i + 0.5) * distance), Polar(handle, 0), Polar(handle, -180))\r\n            ]);\r\n        }\r\n        var graphic = new Group([spring]);\r\n        if (appearance.shade) {\r\n            var shade1 = spring.clone();\r\n            var gradient1 = [];\r\n            var gradientStep = 1.0 / (loops * 2 - 1) * 2.0;\r\n            for (var i = 0; i < loops; i++) {\r\n                gradient1.push([\"#00000000\", (i + 0.0) * gradientStep], [\"#000000cc\", Math.min(1, (i + 0.15) * gradientStep)], [\"#000000cc\", Math.min(1, (i + 0.35) * gradientStep)], [\"#00000000\", Math.min(1, (i + 0.5) * gradientStep)]);\r\n            }\r\n            shade1.setGradientStroke(\"down\", gradient1);\r\n            var shade2 = spring.clone();\r\n            shade2.strokeWidth = Math.max(1, shade2.strokeWidth - 2);\r\n            shade2.setGradientStroke(\"right\", [[\"#ffffff00\", 0.1], [\"#ffffff60\", 0.4], [\"#ffffff00\", 0.7]]);\r\n            graphic.addChildren([shade1, shade2]);\r\n        }\r\n        spring.addSegments([new Segment(P(0, loops * distance + 7.5), P(0, -15))]);\r\n        spring.insertSegments(0, [new Segment(P(0, -distance * 0.5 - 7.5), undefined, P(0, 15))]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.expand(5).toShape()\r\n        };\r\n    };\r\n    Spring.properties = {\r\n        label: \"Spring\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            diameter: 15,\r\n            loops: 6,\r\n            compression: 0.3,\r\n            shade: false,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"loops\", label: \"Loops\",\r\n                min: 3, max: 20, step: 1,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"diameter\", label: \"Diameter\",\r\n                min: 10, max: 50, step: 1.0, unit: \"mm\"\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"compression\", label: \"Compression\",\r\n                min: 0, max: 1, step: 0.01, unit: \"%\",\r\n            },\r\n            {\r\n                spec: \"checkbox\", key: \"shade\", label: \"Shading\", subLabel: \"3D\", allowWhenLocked: true,\r\n            }\r\n        ],\r\n    };\r\n    return Spring;\r\n}());\r\nexport { Spring };\r\n","export var Cookie;\r\n(function (Cookie) {\r\n    /** How many days to store the cookie for. */\r\n    var DAYS = 365;\r\n    function read(name) {\r\n        var result = new RegExp('(?:^|; )' + encodeURIComponent(name) + '=([^;]*)').exec(document.cookie);\r\n        return result ? result[1] : null;\r\n    }\r\n    Cookie.read = read;\r\n    function write(name, value, days) {\r\n        if (days === void 0) { days = DAYS; }\r\n        var date = new Date();\r\n        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\r\n        var expires = \"; expires=\" + date.toUTCString();\r\n        document.cookie = name + \"=\" + value + expires + \"; path=/\";\r\n    }\r\n    Cookie.write = write;\r\n    function remove(name) {\r\n        write(name, \"\", -1);\r\n    }\r\n    Cookie.remove = remove;\r\n})(Cookie || (Cookie = {}));\r\n","import { Keys } from \"keyboard\";\r\nexport var TextReplacements;\r\n(function (TextReplacements) {\r\n    function onKeyPress(input, event) {\r\n        var _a;\r\n        input.undoReplacement = null;\r\n        var text = input.ref.current.value;\r\n        var selectionEnd = (_a = input.ref.current.selectionEnd) !== null && _a !== void 0 ? _a : 0;\r\n        var r = textReplacement(event.key, text, selectionEnd);\r\n        if (r) {\r\n            switch (r.action) {\r\n                case \"replace\":\r\n                    var pre = text.substring(0, selectionEnd - r.length);\r\n                    var post = text.substring(selectionEnd, text.length);\r\n                    var newCursorPosition = selectionEnd - r.length + r.text.length;\r\n                    input.manuallySetText(pre + r.text + post, newCursorPosition);\r\n                    input.undoReplacement = { original: text.substring(0, selectionEnd) + \")\" + post, position: selectionEnd + 1 };\r\n                    event.preventDefault();\r\n            }\r\n        }\r\n    }\r\n    TextReplacements.onKeyPress = onKeyPress;\r\n    function onKeyDown(input, event) {\r\n        if (input.undoReplacement && event.keyCode == Keys.BACKSPACE) {\r\n            var _a = input.undoReplacement, original = _a.original, position = _a.position;\r\n            input.manuallySetText(original, position);\r\n            input.undoReplacement = null;\r\n            event.preventDefault();\r\n            return;\r\n        }\r\n    }\r\n    TextReplacements.onKeyDown = onKeyDown;\r\n})(TextReplacements || (TextReplacements = {}));\r\nfunction textReplacement(key, text, selection) {\r\n    if (key != \")\")\r\n        return;\r\n    var startBracketLocation = text.substring(0, selection).lastIndexOf(\"(\");\r\n    if (startBracketLocation === -1)\r\n        return;\r\n    var toReplace = text.substring(startBracketLocation + 1, selection);\r\n    // Check replacements.\r\n    var capitalGreek = replaceGreek(toReplace);\r\n    if (capitalGreek) {\r\n        return { action: \"replace\", text: capitalGreek, length: toReplace.length + 1 };\r\n    }\r\n    return;\r\n}\r\nfunction replaceGreek(replace) {\r\n    var found = CAPITAL_GREEK_LETTERS.indexOf(replace);\r\n    if (found > -1)\r\n        return String.fromCharCode(CAPITAL_GREEK_ALPHA + found);\r\n    var found2 = SMALL_GREEK_LETTERS.indexOf(replace);\r\n    if (found2 > -1)\r\n        return String.fromCharCode(SMALL_GREEK_ALPHA + found2);\r\n}\r\nvar CAPITAL_GREEK_ALPHA = 913;\r\nvar CAPITAL_GREEK_LETTERS = [\r\n    \"Alpha\",\r\n    \"Beta\",\r\n    \"Gamma\",\r\n    \"Delta\",\r\n    \"Epsilon\",\r\n    \"Zeta\",\r\n    \"Eta\",\r\n    \"Theta\",\r\n    \"Iota\",\r\n    \"Kappa\",\r\n    \"Lambda\",\r\n    \"Mu\",\r\n    \"Nu\",\r\n    \"Xi\",\r\n    \"Omicron\",\r\n    \"Pi\",\r\n    \"Rho\",\r\n    \"___GAP___\",\r\n    \"Sigma\",\r\n    \"Tau\",\r\n    \"Upsilon\",\r\n    \"Phi\",\r\n    \"Chi\",\r\n    \"Psi\",\r\n    \"Omega\",\r\n];\r\nvar SMALL_GREEK_ALPHA = 945;\r\nvar SMALL_GREEK_LETTERS = [\r\n    \"alpha\",\r\n    \"beta\",\r\n    \"gamma\",\r\n    \"delta\",\r\n    \"epsilon\",\r\n    \"zeta\",\r\n    \"eta\",\r\n    \"theta\",\r\n    \"iota\",\r\n    \"kappa\",\r\n    \"lambda\",\r\n    \"mu\",\r\n    \"nu\",\r\n    \"xi\",\r\n    \"omicron\",\r\n    \"pi\",\r\n    \"rho\",\r\n    \"___GAP___\",\r\n    \"sigma\",\r\n    \"tau\",\r\n    \"upsilon\",\r\n    \"___phi___\",\r\n    \"chi\",\r\n    \"psi\",\r\n    \"omega\",\r\n    \"__iotadialytika__\",\r\n    \"__upsilondialytika__\",\r\n    \"__omicrontonos__\",\r\n    \"__upsilontonos__\",\r\n    \"__omegatonos__\",\r\n    \"__kai__\",\r\n    \"beta2\",\r\n    \"theta2\",\r\n    \"__upsilonhook__\",\r\n    \"__upsilonhookacute__\",\r\n    \"__upsilondiaeresis__\",\r\n    \"phi\",\r\n];\r\n","import { strokeWidth } from \"apparatus/draw\";\r\nimport { P, R } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar Quadrat = /** @class */ (function () {\r\n    function Quadrat() {\r\n    }\r\n    Quadrat.prototype.render = function (appearance) {\r\n        var size = appearance.scale * appearance.size;\r\n        var grid = Number(appearance.gridType);\r\n        var step = size / grid;\r\n        var frame = Shape.Rectangle(R(0, 0, size, size));\r\n        var graphic = new Group();\r\n        // Vertical.\r\n        for (var i = 1; i < grid; i++) {\r\n            graphic.addChild(new Path.Line(P(i * step, 0), P(i * step, size)));\r\n            graphic.addChild(new Path.Line(P(0, i * step), P(size, i * step)));\r\n        }\r\n        graphic.withStroke(strokeWidth(\"default\"), \"#aaaaaa\");\r\n        frame.withStroke(10.0, \"#b37132\");\r\n        graphic.addChild(frame);\r\n        graphic.scale(appearance.scale);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    Quadrat.properties = {\r\n        label: \"Quadrat\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            size: 300,\r\n            scale: 0.75,\r\n            gridType: \"5\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 300, max: 600, unit: \"mm\"\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.25, max: 1, step: 0.01, unit: \"%\",\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"gridType\", label: \"Grid\",\r\n                options: [\r\n                    { value: \"3\", label: \"3x3\" },\r\n                    { value: \"5\", label: \"5x5\" },\r\n                    { value: \"7\", label: \"7x7\", tier: \"boost\" },\r\n                    { value: \"10\", label: \"10x10\", tier: \"boost\" },\r\n                ],\r\n            }\r\n        ],\r\n    };\r\n    return Quadrat;\r\n}());\r\nexport { Quadrat };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { Arrays } from \"ext/array\";\r\nimport { ID } from \"store/id\";\r\nimport appStore from \"store/store\";\r\nvar GroupObjects = /** @class */ (function () {\r\n    /** Creates a group from given child IDs. The group's ID can be optionally specified. */\r\n    function GroupObjects(ids, groupId) {\r\n        this.newGroup = {\r\n            id: groupId !== null && groupId !== void 0 ? groupId : ID.mint(\"group\"),\r\n            items: ids,\r\n        };\r\n    }\r\n    GroupObjects.prototype.execute = function () {\r\n        var _this = this;\r\n        /** Pass a shallow copy, not a reference. */\r\n        appStore.dispatchFn(\"Group\", function (store) { return createGroup(store, __assign({}, _this.newGroup)); });\r\n    };\r\n    GroupObjects.prototype.undo = function () {\r\n        var _this = this;\r\n        appStore.dispatchFn(\"Ungroup\", function (store) { return ungroup(store, _this.newGroup); });\r\n    };\r\n    return GroupObjects;\r\n}());\r\nexport { GroupObjects };\r\nvar BreakGroup = /** @class */ (function () {\r\n    function BreakGroup(group) {\r\n        this.group = group;\r\n    }\r\n    BreakGroup.prototype.execute = function () {\r\n        var _this = this;\r\n        appStore.dispatchFn(\"Ungroup\", function (store) { return ungroup(store, _this.group); });\r\n    };\r\n    BreakGroup.prototype.undo = function () {\r\n        var _this = this;\r\n        appStore.dispatchFn(\"Group\", function (store) { return createGroup(store, _this.group); });\r\n    };\r\n    return BreakGroup;\r\n}());\r\nexport { BreakGroup };\r\nfunction createGroup(store, parent) {\r\n    var childIds = parent.items;\r\n    var newStore = __assign(__assign({}, store), { arrows: store.arrows.map(function (a) { return Arrays.includes(childIds, a.id) ? __assign(__assign({}, a), { parentGroup: parent.id }) : a; }), items: store.items.map(function (i) { return Arrays.includes(childIds, i.id) ? __assign(__assign({}, i), { parentGroup: parent.id }) : i; }), groups: store.groups.map(function (g) { return Arrays.includes(childIds, g.id) ? __assign(__assign({}, g), { parentGroup: parent.id }) : g; }) });\r\n    newStore.groups.push(parent);\r\n    return newStore;\r\n}\r\nfunction ungroup(store, group) {\r\n    var childIds = group.items;\r\n    return __assign(__assign({}, store), { arrows: store.arrows.map(function (a) { return Arrays.includes(childIds, a.id) ? __assign(__assign({}, a), { parentGroup: undefined }) : a; }), items: store.items.map(function (i) { return Arrays.includes(childIds, i.id) ? __assign(__assign({}, i), { parentGroup: undefined }) : i; }), groups: store.groups.filter(function (g) { return g.id !== group.id; }).map(function (g) { return Arrays.includes(childIds, g.id) ? __assign(__assign({}, g), { parentGroup: undefined }) : g; }) });\r\n}\r\n","import { mirrorX, strokeWidth } from \"apparatus/draw\";\r\nimport { Interpolator, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nvar PlasticReagentBottle = /** @class */ (function () {\r\n    function PlasticReagentBottle() {\r\n        this.radiusInterpolator = new Interpolator([60, 180], [30, 60]);\r\n    }\r\n    PlasticReagentBottle.prototype.render = function (appearance) {\r\n        var radius = this.radiusInterpolator.interpolate(appearance.size);\r\n        var height = appearance.size;\r\n        var bottleBackPart = new Path(Segments([[radius, 0], [0, radius * -0.75]], [[radius, height]]));\r\n        mirrorX(bottleBackPart);\r\n        bottleBackPart.closePath();\r\n        var outline = bottleBackPart.clone().withStroke(strokeWidth(\"default\"), \"#888888\");\r\n        bottleBackPart.setGradientFill(\"right\", [[\"#dddddd\", 0.0], [\"#eeeeee\", 0.15], [\"#eeeeee\", 0.85], [\"#dddddd\", 1.0]]);\r\n        // const bottleFrontPart = new Path(Segments(\r\n        //     [[radius, 10],[-20, radius * -0.5]],\r\n        //     [[radius, height]],\r\n        // ))\r\n        // mirrorX(bottleFrontPart)\r\n        // bottleFrontPart.closePath()\r\n        // bottleFrontPart.setGradientFill(\"right\", [[\"#dddddd\", 0.0], [\"#eeeeee\", 0.15], [\"#eeeeee\", 0.85], [\"#dddddd\", 1.0]])\r\n        var lightLine = new Path(Segments([[-radius, height - 20]], [[radius, height - 20]])).withStroke(2.0, \"#f6f6f6\");\r\n        var darkLine = new Path(Segments([[-radius, 10 + height / 10]], [[radius, 10 + height / 10]])).withStroke(2.0, \"#cccccc\");\r\n        var cap = new Path(Segments([[radius - 10, 0]], [[radius - 10, 14]], [[radius - 5, 14]], [[radius - 5, 22]]));\r\n        mirrorX(cap);\r\n        cap.closePath();\r\n        cap.position.y -= 30 + height / 10;\r\n        cap.setGradientFill(\"right\", [[\"#5668e3\", 0.0], [\"#7e9cfc\", 0.3], [\"#5668e3\", 1.0]]);\r\n        cap.withStroke(strokeWidth(\"default\"), \"#2b3aa3\");\r\n        var graphic = new Group([bottleBackPart, darkLine, lightLine, outline, cap]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: graphic.placeable(),\r\n        };\r\n    };\r\n    PlasticReagentBottle.properties = {\r\n        label: \"Plastic Reagent Bottle\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            size: 100\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 60, max: 180\r\n            }\r\n        ],\r\n    };\r\n    return PlasticReagentBottle;\r\n}());\r\nexport { PlasticReagentBottle };\r\n","import { setDefaultStyle } from \"apparatus/draw\";\r\nimport { P, Segments } from \"apparatus/library/common\";\r\nimport { Path } from \"paper\";\r\nvar Ramp = /** @class */ (function () {\r\n    function Ramp() {\r\n        this.shouldUseBoundsCenter = true;\r\n    }\r\n    Ramp.prototype.render = function (appearance) {\r\n        var lengthM = appearance.length, angle = appearance.angle;\r\n        var length = lengthM * 1000;\r\n        var height = length * Math.sin(angle.toRadians());\r\n        var width = length * Math.cos(angle.toRadians());\r\n        var graphic = new Path(Segments([[0, 0]], [[width, height]], [[0, height]])).close()\r\n            .withStroke(\"default\")\r\n            .withFill(\"#aaaaaa\");\r\n        var hitShape = graphic.clone();\r\n        setDefaultStyle(graphic);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShape,\r\n            pivot: P(width, height),\r\n            snapping: [\r\n                { type: \"placeable_surface\", start: P(0, 0), end: P(width, height), facing: \"auto\" },\r\n                { type: \"placeable\", at: graphic.strokeBounds.bottomCenter }\r\n            ]\r\n        };\r\n    };\r\n    Ramp.properties = {\r\n        label: \"Ramp\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            length: 1.0,\r\n            angle: 25\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"length\", label: \"Length\",\r\n                min: 0.5, max: 2.5, step: 0.05, unit: \"m\"\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"angle\", label: \"Angle\",\r\n                min: 5, max: 45, step: 5, unit: \"\",\r\n            }\r\n        ],\r\n    };\r\n    return Ramp;\r\n}());\r\nexport { Ramp };\r\n","import { SVG } from \"apparatus/svg\";\r\nvar PlantShoot = /** @class */ (function () {\r\n    function PlantShoot() {\r\n    }\r\n    PlantShoot.prototype.render = function (appearance) {\r\n        var graphic = SVG.plant(appearance.display - 1);\r\n        graphic.scale(appearance.scale);\r\n        // Recolor it.\r\n        if (appearance.color === \"dead\") {\r\n            for (var _i = 0, _a = graphic.children[1].children; _i < _a.length; _i++) {\r\n                var path = _a[_i];\r\n                var color = path.fillColor.toCSS(true);\r\n                path.fillColor = DEAD_RECOLOR[color];\r\n            }\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    PlantShoot.properties = {\r\n        label: \"Plant shoot\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            display: 3,\r\n            scale: 1.0,\r\n            color: \"alive\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"display\", label: \"Growth phase\",\r\n                min: 1, max: 6\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.25, max: 2.0, step: 0.01, unit: \"%\"\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"color\", label: \"Style\",\r\n                options: [\r\n                    { value: \"alive\", label: \"Alive\" },\r\n                    { value: \"dead\", label: \"Dead\" },\r\n                ],\r\n            }\r\n        ],\r\n    };\r\n    return PlantShoot;\r\n}());\r\nexport { PlantShoot };\r\nvar DEAD_RECOLOR = {\r\n    \"#579b3c\": \"#8c8069\",\r\n    \"#8fc444\": \"#ccc389\"\r\n};\r\n// function renderOld(appearance: PlantShootAppearance): RenderParts {\r\n//     const stem = new Path(Segments(\r\n//         [[-17, 31],[7, 10],[5, 1]],\r\n//         [[-2, 37],[-8, -2],[-6, -9]],\r\n//         [[8, -2],[-1, -9],[6, -3]],\r\n//         [[4, 31],[-3, -19],[2, 13]],\r\n//         [[29, 31],[-2, 0],[8, -4]],\r\n//         [[11, 41],[20, 0],[-9, 8]],\r\n//         [[10, 66]],\r\n//         [[4, 66]],\r\n//         [[1, 46],[-1, 14],[2, -4]]\r\n//     ))\r\n//     stem.closePath()\r\n//     stem.position = P(1, 9)\r\n//     stem.fillColor = DEFAULT_COLOR.color().ladd(-10).string()\r\n//     const graphic = new Group([stem])\r\n//     const leaf1 = Leaf.createLeaf(DEFAULT_COLOR, 60)\r\n//     const leaf2 = leaf1.clone()\r\n//     const leaf3 = leaf1.clone()\r\n//     leaf1.rotate(-110)\r\n//     leaf2.rotate(-180)\r\n//     leaf2.scale(0.8)\r\n//     leaf3.scale(0.7, -0.7)\r\n//     leaf2.position = P(-50, 0)\r\n//     leaf1.position = P(0, -60)\r\n//     leaf3.position = P(50, 0)\r\n//     graphic.addChildren([leaf1, leaf2, leaf3])\r\n//     return {\r\n//         graphic: graphic,\r\n//         hitShape: graphic.bounds.toShape()\r\n//     }\r\n// }\r\n","import { setDefaultStyle } from \"apparatus/draw\";\r\nimport { Segments } from \"apparatus/library/common\";\r\nimport { Path } from \"paper\";\r\nvar EvaporatingDish = /** @class */ (function () {\r\n    function EvaporatingDish() {\r\n    }\r\n    EvaporatingDish.prototype.render = function (appearance) {\r\n        var graphic = getGraphicPath(appearance);\r\n        var hitShape = graphic.clone();\r\n        var liquidShape = graphic.clone();\r\n        setDefaultStyle(graphic);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShape,\r\n            liquidMask: liquidShape,\r\n            snapping: graphic.placeable(),\r\n        };\r\n    };\r\n    EvaporatingDish.properties = {\r\n        label: \"Evaporating Dish\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            diameter: 65,\r\n            style: \"default\"\r\n        },\r\n        flippable: true,\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"diameter\", label: \"Diameter\",\r\n                min: 50, max: 100\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"style\", label: \"Style\",\r\n                options: [\r\n                    { value: \"default\", label: \"Default\" },\r\n                    { value: \"simple\", label: \"Simple\" },\r\n                ],\r\n            }\r\n        ],\r\n    };\r\n    return EvaporatingDish;\r\n}());\r\nexport { EvaporatingDish };\r\nfunction getGraphicPath(appearance) {\r\n    var diameter = appearance.diameter;\r\n    var height;\r\n    switch (appearance.style) {\r\n        case \"default\":\r\n            height = diameter * 0.5;\r\n            return new Path(Segments([[0, 0]], [[diameter / 4, height], [-diameter / 5, 0]], [[diameter / 4 * 3, height], undefined, [diameter / 5, 0]], [[diameter - 3, 5]], [[diameter + 3, -1], [-1, 3]]));\r\n        case \"simple\":\r\n            height = diameter * 0.36;\r\n            return new Path(Segments([[0, 0], , [0, height / 3]], [[diameter / 2, height], [-diameter * 0.36, 0], [diameter * 0.36, 0]], [[diameter, 0], [0, height / 3]]));\r\n    }\r\n}\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { addEdgeLips, breakPath, setDefaultStyle } from \"apparatus/draw\";\r\nimport { P, Segments } from \"apparatus/library/common\";\r\nimport { createTap, Tap } from \"apparatus/library/common/tap\";\r\nimport { Path } from \"paper\";\r\nvar SchlenkFlask = /** @class */ (function () {\r\n    function SchlenkFlask() {\r\n    }\r\n    SchlenkFlask.isBoostRequiredForAppearance = function (a) {\r\n        return a.shape === \"cylinder\";\r\n    };\r\n    SchlenkFlask.prototype.render = function (appearance) {\r\n        var shape = shapePath(appearance.shape);\r\n        addEdgeLips(shape);\r\n        var hitShape = shape.bounds.toShape();\r\n        var liquidMask = shape.clone();\r\n        var graphic;\r\n        switch (appearance.shape) {\r\n            case \"cylinder\":\r\n                graphic = breakPath(shape, 10);\r\n                break;\r\n            case \"sphere\":\r\n                graphic = breakPath(shape, 9);\r\n                break;\r\n        }\r\n        setDefaultStyle(graphic);\r\n        var tap = createTap(appearance.tapOpening);\r\n        graphic.addChild(tap);\r\n        tap.rotate(215);\r\n        tap.scale(0.9);\r\n        tap.position = P(52, 45);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: hitShape,\r\n            liquidMask: liquidMask,\r\n        };\r\n    };\r\n    SchlenkFlask.properties = {\r\n        label: \"Schlenk Flask\",\r\n        canContainLiquids: true,\r\n        flippable: true,\r\n        defaultAppearance: __assign({ shape: \"sphere\" }, Tap.defaultAppearance),\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"shape\", label: \"Shape\",\r\n                options: [\r\n                    { value: \"sphere\", label: \"Spherical\" },\r\n                    { value: \"cylinder\", label: \"Cylindrical\", tier: \"boost\" },\r\n                ],\r\n                allowSelectingTierLockedOptions: true,\r\n            },\r\n            Tap.appearanceSpec,\r\n        ],\r\n    };\r\n    return SchlenkFlask;\r\n}());\r\nexport { SchlenkFlask };\r\nfunction shapePath(shape) {\r\n    switch (shape) {\r\n        case \"sphere\":\r\n            return new Path(Segments([[-13, 0]], [[-13, 40], , [-3, 0]], [[-15, 60], , [-18, 5]], [[-44, 104], [0, -18], [0, 18]], [[0, 146], [-28, 0], [28, 0]], [[47, 100], [0, 22], [0, -14]], [[45, 70], [-2, 6], [5, -15]], [[90, -6]], [[85, -10]], [[30, 63], [9, 0], [-9, 0]], [[15, 55], [0, 5]], [[13, 40], [3, 0]], [[13, 0]]));\r\n        case \"cylinder\":\r\n            return new Path(Segments([[-13, 0]], [[-13, 40], , [-3, 0]], [[-15, 60], , [-18, 10]], [[-30, 104]], // Bottom of flask\r\n            [[-30, 260], , [0, 35]], [[30, 260], [0, 35]], [[30, 100], [0, 22], [0, -14]], [[45, 70], [-2, 6], [5, -15]], [[90, -6]], [[85, -10]], [[30, 63], [9, 0], [-9, 0]], [[15, 55], [0, 5]], [[13, 40], [3, 0]], [[13, 0]]));\r\n    }\r\n}\r\n","import { setDefaultStyle } from \"apparatus/draw\";\r\nimport { P, Pivot, R, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar LabJack = /** @class */ (function () {\r\n    function LabJack() {\r\n    }\r\n    LabJack.prototype.render = function (appearance) {\r\n        var height = appearance.height;\r\n        var halfHeight = height / 2;\r\n        // Create basic arm.\r\n        var armLength = 100;\r\n        var armWidth = 10;\r\n        var arm = Shape.Rectangle(R(-armWidth / 2, 0, armLength + armWidth, armWidth, Pivot.BOTTOM_LEFT), armWidth / 2);\r\n        setDefaultStyle(arm);\r\n        arm.fillColor = SharedColors.lightMetal;\r\n        // Calculate how much to rotate the arm by to reach desired (total) height\r\n        var rotateBy = Math.asin(halfHeight / armLength).toDegrees();\r\n        arm.rotate(rotateBy, P(armLength, -armWidth / 2));\r\n        // Clone to create the second arm.\r\n        var arm2 = arm.clone();\r\n        arm2.position.y -= halfHeight;\r\n        // Clone the arms to create the flipped arms, forming the \"X\" pattern.\r\n        var arm3 = arm.clone();\r\n        arm3.scale(-1.0, 1.0);\r\n        var arm4 = arm2.clone();\r\n        arm4.scale(-1.0, 1.0);\r\n        // Put all the arms together and place in correct position.\r\n        var arms = new Group([arm, arm2, arm3, arm4]);\r\n        // Add base and top.\r\n        var base = Shape.Rectangle(R(-10, -5, 120, 15));\r\n        setDefaultStyle(base);\r\n        base.fillColor = \"#3c82c9\";\r\n        base.strokeColor = \"#26527f\";\r\n        var platform = base.clone();\r\n        platform.position.y -= height + 10;\r\n        // Turn knob + bar.\r\n        var bar = new Path(Segments([[-7, -halfHeight - 5]], [[120, -halfHeight - 5]]));\r\n        bar.strokeWidth = 5.0;\r\n        bar.strokeColor = SharedColors.mediumMetal;\r\n        var knob = Shape.Rectangle(R(120, -halfHeight - 5, 12, 20, Pivot.CENTER_LEFT));\r\n        setDefaultStyle(knob);\r\n        knob.fillColor = \"#444444\";\r\n        // Assemble together.\r\n        var jack = new Group([arms, base, platform]);\r\n        var graphic = new Group([bar, knob, jack]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            pivot: P(50, 0),\r\n            snapping: [\r\n                jack.placeable(),\r\n                jack.topEdgeAsPlaceableSurface(),\r\n            ]\r\n        };\r\n    };\r\n    LabJack.properties = {\r\n        label: \"Scissor Jack\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            height: 50\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Height\",\r\n                min: 30, max: 150\r\n            }\r\n        ],\r\n    };\r\n    return LabJack;\r\n}());\r\nexport { LabJack };\r\n","import { createOutlinedGroup, mirrorX } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, Pivot, R, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { CIRCULAR_RATIO } from \"apparatus/library/transportation/osmosis_tube\";\r\nimport { Group, Path } from \"paper\";\r\nvar NORTH_COLOR = \"#f12a2a\";\r\nvar SOUTH_COLOR = \"#1482f5\";\r\nvar Magnet = /** @class */ (function () {\r\n    function Magnet() {\r\n    }\r\n    Magnet.prototype.render = function (appearance) {\r\n        switch (appearance.shape) {\r\n            case \"horseshoe\": return this.renderHorseshoe(appearance);\r\n            case \"bar\": return this.renderBar(appearance);\r\n        }\r\n    };\r\n    Magnet.prototype.renderBar = function (appearance) {\r\n        var northPole = new Path.Rectangle(R(0, 0, 45, 22, Pivot.CENTER_RIGHT))\r\n            .withGradientFill(\"right-down\", Gradients.cylinder(NORTH_COLOR.color()));\r\n        var southPole = new Path.Rectangle(R(0, 0, 45, 22, Pivot.CENTER_LEFT))\r\n            .withGradientFill(\"right-down\", Gradients.cylinder(SOUTH_COLOR.color()));\r\n        var graphic = createOutlinedGroup(\"default\", SharedColors.stroke, northPole, southPole);\r\n        graphic.scale(appearance.scale);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    Magnet.prototype.renderHorseshoe = function (appearance) {\r\n        var thickness = 18;\r\n        var halfShape = [\r\n            [[0, 90 - thickness], , [CIRCULAR_RATIO * (40 - thickness), 0]],\r\n            [[40 - thickness, 50], [0, CIRCULAR_RATIO * (40 - thickness)]],\r\n            [[40 - thickness, 0]],\r\n            [[40, 0]],\r\n            [[40, 50], , [0, CIRCULAR_RATIO * 40]],\r\n            [[0, 90], [CIRCULAR_RATIO * 40, 0]]\r\n        ];\r\n        var southPole = new Path(Segments.apply(void 0, halfShape)).close();\r\n        var northPole = southPole.clone();\r\n        northPole.scale(-1.0, 1.0, P(0, 0));\r\n        northPole.withGradientFill(\"right-down\", Gradients.cylinder(NORTH_COLOR.color()));\r\n        southPole.withGradientFill(\"right-down\", Gradients.cylinder(SOUTH_COLOR.color()));\r\n        var outline = new Path(Segments.apply(void 0, halfShape)).close().withStroke(\"default\");\r\n        mirrorX(outline);\r\n        var graphic = new Group([northPole, southPole, outline]);\r\n        graphic.scale(appearance.scale);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    Magnet.properties = {\r\n        label: \"Magnet\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            shape: \"bar\",\r\n            scale: 1.0,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"shape\", label: \"Shape\",\r\n                options: [\r\n                    { value: \"bar\", label: \"Bar\" },\r\n                    { value: \"horseshoe\", label: \"Horseshoe\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.5, max: 3.0, step: 0.01, unit: \"%\"\r\n            }\r\n        ],\r\n    };\r\n    return Magnet;\r\n}());\r\nexport { Magnet };\r\n","import { SVG } from \"apparatus/svg\";\r\nvar Bug = /** @class */ (function () {\r\n    function Bug() {\r\n    }\r\n    Bug.prototype.render = function (appearance) {\r\n        var allBugs = SVG.bugs();\r\n        var index = appearance.type.split(\",\");\r\n        var graphic = allBugs.children[+index[1] + 1].clone();\r\n        graphic.scale(appearance.scale);\r\n        allBugs.remove();\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.expand(10).toShape()\r\n        };\r\n    };\r\n    Bug.properties = {\r\n        label: \"Bug\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            type: \"0,0\",\r\n            scale: 1.0\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.5, max: 3, step: 0.01, unit: \"%\"\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"type\", label: \"Bug type\",\r\n                options: [\r\n                    { value: \"0,0\", label: \"Generic\" },\r\n                    { value: \"0,2\", label: \"Ant\" },\r\n                    { value: \"0,6\", label: \"Spider\" },\r\n                    { value: \"0,7\", label: \"Ladybug\" },\r\n                ],\r\n            }\r\n        ],\r\n    };\r\n    return Bug;\r\n}());\r\nexport { Bug };\r\n","import { SVG } from \"apparatus/svg\";\r\nvar GHSHazardSymbol = /** @class */ (function () {\r\n    function GHSHazardSymbol() {\r\n    }\r\n    GHSHazardSymbol.prototype.render = function (appearance) {\r\n        var graphic = SVG.GHS[appearance.hazard]();\r\n        graphic.scale(0.2 * appearance.scale);\r\n        return { graphic: graphic, hitShape: graphic.bounds.toShape() };\r\n    };\r\n    GHSHazardSymbol.properties = {\r\n        label: \"GHS Hazard Symbol\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            hazard: \"flammable\",\r\n            scale: 1.0,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"hazard\", label: \"Hazard\",\r\n                options: [\r\n                    { value: \"explosion\", label: \"01: Explosive\" },\r\n                    { value: \"flammable\", label: \"02: Flammable\" },\r\n                    { value: \"oxidising\", label: \"03: Oxidising\" },\r\n                    { value: \"gas\", label: \"04: Compressed Gas\" },\r\n                    { value: \"acid\", label: \"05: Corrosive\" },\r\n                    { value: \"toxic\", label: \"06: Toxic\" },\r\n                    { value: \"harm\", label: \"07: Harmful\" },\r\n                    { value: \"health\", label: \"08: Health Hazard\" },\r\n                    { value: \"pollution\", label: \"09: Environmental\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.9, max: 2.0, step: 0.01,\r\n                tier: \"boost\",\r\n            }\r\n        ],\r\n    };\r\n    return GHSHazardSymbol;\r\n}());\r\nexport { GHSHazardSymbol };\r\n","var __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport Flags from \"flags\";\r\nexport var APPARATUS_MODULES = [\"chemistry\", \"heating\", \"various\", \"shapes\", \"biology\", \"physics\", \"distillation\", \"measurement\"];\r\nexport var moduleDisplayName = function (module) {\r\n    switch (module) {\r\n        case \"chemistry\":\r\n            return \"Chemistry\";\r\n        case \"various\":\r\n            return \"Accessories\";\r\n        case \"shapes\":\r\n            return \"Shapes\";\r\n        case \"physics\":\r\n            return \"Physics\";\r\n        case \"biology\":\r\n            return \"Biology\";\r\n        case \"distillation\":\r\n            return \"Distillation\";\r\n        case \"measurement\":\r\n            return \"Measurement\";\r\n        case \"heating\":\r\n            return \"Heating\";\r\n    }\r\n};\r\nexport var moduleDisplayIcon = function (module) {\r\n    switch (module) {\r\n        case \"chemistry\":\r\n            return \"flask\";\r\n        case \"various\":\r\n            return \"box-open\";\r\n        case \"shapes\":\r\n            return \"shapes\";\r\n        case \"physics\":\r\n            return \"atom\";\r\n        case \"biology\":\r\n            return \"leaf\";\r\n        case \"distillation\":\r\n            return \"tint\";\r\n        case \"measurement\":\r\n            return \"ruler\";\r\n        case \"heating\":\r\n            return \"flame\";\r\n    }\r\n};\r\n/** List all categories, in the desired order. */\r\nexport var apparatusCategories = {\r\n    \"chemistry\": __spreadArrays([\r\n        \"Containers\",\r\n        \"Filtering\",\r\n        \"Metallic\",\r\n        \"Ceramic\"\r\n    ], (!Flags.isPhysicsEnabled ? [\"Electrical\"] : []), [\r\n        \"Devices\",\r\n        \"Chromatography\",\r\n        \"Storage\",\r\n    ]),\r\n    \"heating\": [\r\n        \"Heating\",\r\n    ],\r\n    \"measurement\": [\r\n        \"Measurement\",\r\n        \"_Mea_Extraction\",\r\n    ],\r\n    \"biology\": [\r\n        \"_Bio_Equipment\",\r\n        \"Organic\",\r\n        \"_Bio_Other\",\r\n    ],\r\n    \"physics\": __spreadArrays([\r\n        \"Optics\"\r\n    ], (Flags.isPhysicsEnabled ? [\"Electrical\"] : []), [\r\n        \"Dynamics\",\r\n    ]),\r\n    \"distillation\": [\r\n        \"Condensers\",\r\n        \"Distillation\",\r\n        \"Transportation\"\r\n    ],\r\n    \"various\": [\r\n        \"Substances\",\r\n        \"Accessories\",\r\n        \"Labelling\",\r\n    ],\r\n    \"shapes\": [\r\n        \"Basic shapes\",\r\n        \"Arrows\",\r\n        \"3D\",\r\n    ],\r\n};\r\n// Maps from category to its parent module & icon.\r\nexport var categoryToModuleMap = {};\r\nfor (var _i = 0, APPARATUS_MODULES_1 = APPARATUS_MODULES; _i < APPARATUS_MODULES_1.length; _i++) {\r\n    var module = APPARATUS_MODULES_1[_i];\r\n    var displayName = moduleDisplayName(module);\r\n    var icon = moduleDisplayIcon(module);\r\n    for (var _a = 0, _b = apparatusCategories[module]; _a < _b.length; _a++) {\r\n        var category = _b[_a];\r\n        categoryToModuleMap[category] = { display: displayName, icon: icon };\r\n    }\r\n}\r\n","import { Move } from \"editing/move\";\r\nexport var Distribute;\r\n(function (Distribute) {\r\n    function distributeCenters(components, axis) {\r\n        if (components.length <= 2)\r\n            return;\r\n        // Sort components by their centers.\r\n        components.sort(function (a, b) { return a.alignmentBounds.center[axis] - b.alignmentBounds.center[axis]; });\r\n        // Get the extremities and determine step.\r\n        var high = components[components.length - 1].alignmentBounds.center[axis];\r\n        var low = components[0].alignmentBounds.center[axis];\r\n        var step = (high - low) / (components.length - 1);\r\n        // Move each component to desired new location.\r\n        return components.map(function (c, i) {\r\n            var moveTo = low + step * i;\r\n            var delta = { x: 0, y: 0 };\r\n            delta[axis] = moveTo - c.alignmentBounds.center[axis];\r\n            return Move.one(c.id, delta);\r\n        });\r\n    }\r\n    Distribute.distributeCenters = distributeCenters;\r\n    function distributeGaps(components, axis) {\r\n        if (components.length <= 2)\r\n            return;\r\n        var lowEdge = axis == \"x\" ? \"left\" : \"top\";\r\n        var highEdge = axis == \"x\" ? \"right\" : \"bottom\";\r\n        var sizeProperty = axis == \"x\" ? \"width\" : \"height\";\r\n        // Sort components by their centers.\r\n        components.sort(function (a, b) { return a.alignmentBounds.center[axis] - b.alignmentBounds.center[axis]; });\r\n        // Calculate total gap.\r\n        var totalGap = 0;\r\n        for (var i = 0; i < components.length - 1; i++) {\r\n            totalGap += components[i + 1].alignmentBounds[lowEdge] - components[i].alignmentBounds[highEdge];\r\n        }\r\n        var gapStep = totalGap / (components.length - 1);\r\n        // Move each component to desired new location.\r\n        var desiredLowEdge = components[0].alignmentBounds[lowEdge];\r\n        return components.map(function (c, i) {\r\n            var delta = { x: 0, y: 0 };\r\n            delta[axis] = desiredLowEdge - c.alignmentBounds[lowEdge];\r\n            // Compute the next desired edge.\r\n            desiredLowEdge += c.alignmentBounds[sizeProperty] + gapStep;\r\n            return Move.one(c.id, delta);\r\n        });\r\n    }\r\n    Distribute.distributeGaps = distributeGaps;\r\n})(Distribute || (Distribute = {}));\r\n","import * as paper from \"paper\";\r\nimport rawVersion from \"version\";\r\n/** Stripe public keys */\r\nvar StripePublicKeys;\r\n(function (StripePublicKeys) {\r\n    StripePublicKeys.test = \"pk_test_yDkVHgKFZSODA9gfm2TfLXbI00rCtT94nG\";\r\n    StripePublicKeys.live = \"pk_live_AcpjKxoOR2Yj08DBTLm1dlaW00iCYYHpDq\";\r\n})(StripePublicKeys || (StripePublicKeys = {}));\r\nexport var Consts;\r\n(function (Consts) {\r\n    Consts.isDev = location.hostname == \"localhost\";\r\n    Consts.isProd = !Consts.isDev;\r\n    Consts.isBeta = location.pathname.lastIndexOf(\"/beta\", 0) === 0;\r\n    Consts.version = rawVersion + (Consts.isDev ? \"-dev\" : (Consts.isBeta ? \"-beta\" : \"\"));\r\n    Consts.majorVersion = Consts.version.match(\"[0-9]*\\.[0-9]*\")[0];\r\n    Consts.epsilon = 0.0001;\r\n    Consts.googleAnalyticsCategory = \"Chemix\" + Consts.version;\r\n    Consts.firebaseAppUrl = \"https://chemixapp.firebaseio.com/chemix/diagrams/\";\r\n    /** Maximum number of pixels to render in H igh Quality. */\r\n    Consts.pngMaxRenderPixels = 3800000;\r\n    /** Max number of pixels to use when rendering in Standard quality. */\r\n    Consts.pngMaxRenderPixelsMedium = 480000;\r\n    // Sentry-related configuration\r\n    Consts.sentryDsn = \"https://d95a293d03b14780a9c5051cd44a0e7e@sentry.io/154256\";\r\n    Consts.stripePublicKey = Consts.isDev ? StripePublicKeys.test : StripePublicKeys.live;\r\n})(Consts || (Consts = {}));\r\n// Debug consts\r\nexport var Debug;\r\n(function (Debug) {\r\n    Debug.HIT_SHAPES = false;\r\n    Debug.CENTERS = false;\r\n    Debug.LIQUID_MASK = false;\r\n    Debug.SHAPES = false;\r\n})(Debug || (Debug = {}));\r\nif (Consts.isDev) {\r\n    window[\"Debug\"] = Debug;\r\n    window[\"paper\"] = paper;\r\n}\r\n","import { P, Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nimport { mirrorX, setDefaultStyleWithStroke } from \"../../draw\";\r\nexport var Tap;\r\n(function (Tap) {\r\n    Tap.defaultAppearance = {\r\n        tapOpening: 1.0\r\n    };\r\n    function appearanceSpecFor(key, label) {\r\n        if (label === void 0) { label = \"Tap position\"; }\r\n        return { spec: \"slider\", key: key, label: label, min: 0.0, max: 1.0, step: 0.25, pipsStep: 1 };\r\n    }\r\n    Tap.appearanceSpecFor = appearanceSpecFor;\r\n    Tap.appearanceSpec = appearanceSpecFor(\"tapOpening\");\r\n    Tap.isClosed = function (opening) { return opening <= 0.5; };\r\n    Tap.create = createTap;\r\n})(Tap || (Tap = {}));\r\n/**\r\n * Create a tap/stop cock commonly seen on burettes,\r\n * adddition funnels etc.\r\n */\r\nexport function createTap(opening, reverseShading) {\r\n    if (opening === void 0) { opening = 1.0; }\r\n    if (reverseShading === void 0) { reverseShading = false; }\r\n    var body = new Path(Segments([[9.5, -5]], [[9.5, 14]], [[6.5, 24]]));\r\n    mirrorX(body);\r\n    body.closePath();\r\n    setDefaultStyleWithStroke(\"thin\", body);\r\n    body.setGradientFill(reverseShading ? \"left\" : \"right\", [\r\n        [\"#c6c6c6\", 0.2],\r\n        [\"#a0a0a0\", 0.3],\r\n        [\"#868686\", 0.7],\r\n        [\"#686868\", 0.8],\r\n    ]);\r\n    var knob = Shape.Circle(P(0, 0), 6);\r\n    // knob.fillColor = \"#888888\"\r\n    knob.setRadialGradientFill([[\"#dddddd\", 0.4], [\"#aaaaaa\", 0.7]]);\r\n    var handle1 = Shape.Rectangle(R(4, 0, 18, 6, Pivot.CENTER_LEFT), 2.0);\r\n    setDefaultStyleWithStroke(\"thinner\", knob);\r\n    // handle1.strokeColor = \"#950309\"\r\n    handle1.setGradientFill(\"right\", [[\"#950309\", 0.2], [\"#ba0206\", 0.6]]);\r\n    // handle1.fillColor = \"#ba0206\"\r\n    var handle2 = handle1.clone();\r\n    handle2.rotate(180, P(0, 0));\r\n    var knobAndHandles = new Group([handle1, handle2, knob]);\r\n    knobAndHandles.position.y += 8;\r\n    knobAndHandles.rotate(90 * opening);\r\n    var graphic = new Group([body, knobAndHandles]);\r\n    graphic.pivot = P(0, 0);\r\n    return graphic;\r\n}\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { SharedColors } from \"apparatus/library/common\";\r\nimport { Deselect, DeselectAndSelect, Select, UpdateAppearanceProperties } from \"command/basic\";\r\nimport { commandProcessor, Sequence } from \"command/command\";\r\nimport { getDescendantIDs, getRootGroup } from \"editing/grouping/operations\";\r\nimport { InteractableMatcher } from \"editing/interaction\";\r\nimport { RotateItems } from \"editing/rotation/rotate_command\";\r\nimport { evaluatePrecomputedSnappings, precomputeSnapping } from \"editing/snapping/compute\";\r\nimport { Key, Point, project, Rectangle, Shape, Size, Tool } from \"paper\";\r\nimport { ID } from \"store/id\";\r\nimport appStore from \"store/store\";\r\nimport { Move } from \"./move\";\r\n/** Stronger snap distance for zoom level 1. */\r\nvar STRONG_SNAP_DISTANCE = 20.0;\r\nvar MultiTool = /** @class */ (function (_super) {\r\n    __extends(MultiTool, _super);\r\n    function MultiTool(layers, app) {\r\n        var _this = _super.call(this) || this;\r\n        // Selection box (visual).\r\n        _this.selectionBox = (function () {\r\n            var box = Shape.Rectangle(new Point(0, 0), new Size(0, 0));\r\n            // Style the selection box.\r\n            box.strokeColor = SharedColors.selectionGreen;\r\n            box.fillColor = SharedColors.selectionGreen + \"40\"; // With alpha\r\n            box.strokeWidth = 1.0;\r\n            box.radius = 0;\r\n            box.visible = false;\r\n            return box;\r\n        })();\r\n        _this.onMouseDown = function (event) {\r\n            // On mouse down, there are 2 options:\r\n            // A) Down on an apparatus\r\n            //    a) Apparatus already selected.\r\n            //       1) If moved, then move current selection.\r\n            //       2) Else, no change (apparatus remains selected)\r\n            //    b) Apparatus not already selected\r\n            //       1) If moved, then move this apparatus only\r\n            //       2) Else, select this apparatus\r\n            // b) Down on empty space\r\n            //    Draw selection box.\r\n            commandProcessor.startRecording();\r\n            _this.operation = _this.startOperation(event);\r\n            if (_this.operation.type == \"moving\" || _this.operation.type == \"adjusting\") {\r\n                // We hide the HTLM-based selection box, but only when moving or adjusting.\r\n                _this.appInterface.setIsInteracting(true);\r\n                // Set the state to moving.\r\n                _this.appInterface.setIsMovingItems(true);\r\n            }\r\n        };\r\n        _this.onMouseDrag = function (event) {\r\n            if (!_this.operation)\r\n                return;\r\n            // Vector from downPoint to current point.\r\n            var deltaVector = event.point.subtract(event.downPoint);\r\n            switch (_this.operation.type) {\r\n                case \"moving\":\r\n                    var adjustedDelta = _this.deltaVector(deltaVector, _this.operation);\r\n                    var moveVector_1 = adjustedDelta.delta;\r\n                    _this.operation.movedComponents.forEach(function (c) { return c.setPositionDelta(moveVector_1); });\r\n                    break;\r\n                case \"adjusting\":\r\n                    _this.operation.adjustable.setDelta(deltaVector);\r\n                    break;\r\n                case \"selection\":\r\n                case \"selection_on_top\":\r\n                    // Draw the selection box.\r\n                    _this.selectionBox.visible = true;\r\n                    _this.selectionBox.size = new Size(deltaVector).abs();\r\n                    _this.selectionBox.position = event.downPoint.add(deltaVector.divide(2.0));\r\n            }\r\n        };\r\n        _this.onMouseUp = function (event) {\r\n            _this.selectionBox.visible = false;\r\n            if (!_this.operation) {\r\n                _this.appInterface.setIsInteracting(false);\r\n                _this.appInterface.setIsMovingItems(false);\r\n                commandProcessor.finishRecording();\r\n                return;\r\n            }\r\n            switch (_this.operation.type) {\r\n                case \"moving\":\r\n                    // Apparatus have been moved. Commit this change as a command.\r\n                    // Vector from downPoint to current point. If it's a zero vector, skip\r\n                    var deltaVector = event.point.subtract(event.downPoint);\r\n                    if (deltaVector.isZero())\r\n                        break;\r\n                    var adjustedDelta = _this.deltaVector(deltaVector, _this.operation);\r\n                    deltaVector = adjustedDelta.delta;\r\n                    // Create a move command for each moved apparatus.\r\n                    var moveCommand = new Move(_this.operation.movedComponents.map(function (c) { return c.id; }), deltaVector);\r\n                    // Check if there are appearance changes.\r\n                    var appearanceChangeCommands = [];\r\n                    if (adjustedDelta.appearanceChange) {\r\n                        var id = adjustedDelta.appearanceChange.id;\r\n                        var item = appStore.items().filter(ID.matching(id))[0];\r\n                        if (item) {\r\n                            var prevSpecs = item.appearance;\r\n                            var newSpecs = adjustedDelta.appearanceChange.partialSpecs;\r\n                            appearanceChangeCommands = [\r\n                                new UpdateAppearanceProperties(id, newSpecs, prevSpecs),\r\n                                new RotateItems([{ id: id, rotation: adjustedDelta.appearanceChange.rotation, originalRotation: item.rotation }])\r\n                            ];\r\n                        }\r\n                    }\r\n                    if (appearanceChangeCommands.length > 0) {\r\n                        commandProcessor.execute(new Sequence(__spreadArrays([moveCommand], appearanceChangeCommands)));\r\n                    }\r\n                    else {\r\n                        commandProcessor.execute(moveCommand);\r\n                    }\r\n                    break;\r\n                case \"adjusting\":\r\n                    var delta = event.point.subtract(event.downPoint);\r\n                    if (delta.isZero()) {\r\n                        if (_this.operation.adjustable.onNoop) {\r\n                            commandProcessor.execute(_this.operation.adjustable.onNoop());\r\n                        }\r\n                        break;\r\n                    }\r\n                    var command = _this.operation.adjustable.onEnd(delta);\r\n                    commandProcessor.execute(command);\r\n                    break;\r\n                case \"selection\":\r\n                case \"selection_on_top\":\r\n                    // Complete selection.\r\n                    var selectionHitRectangle = new Rectangle(event.downPoint, event.point);\r\n                    if (selectionHitRectangle.isEmpty() && _this.operation.type == \"selection\")\r\n                        break;\r\n                    // If a hit rectangle is available, use getItems, otherwise hit test 1 item only.\r\n                    var interactableItems = void 0;\r\n                    if (!selectionHitRectangle.isEmpty()) {\r\n                        interactableItems = project.getItems({\r\n                            overlapping: selectionHitRectangle,\r\n                            match: InteractableMatcher,\r\n                        });\r\n                    }\r\n                    else {\r\n                        var hitResult = project.hitTest(event.downPoint, {\r\n                            fill: true,\r\n                            bounds: true,\r\n                            stroke: true,\r\n                            match: InteractableMatcher,\r\n                        });\r\n                        if (hitResult) {\r\n                            interactableItems = [hitResult.item];\r\n                        }\r\n                        else {\r\n                            interactableItems = [];\r\n                        }\r\n                    }\r\n                    var components = interactableItems.filter(function (i) { return i.interaction.type == \"selectAndMove\"; }).map(function (i) { return i.interaction.component; });\r\n                    if (components.length > 0) {\r\n                        if (_this.operation.type == \"selection\") {\r\n                            var ids = convertToIdsExpandingGroups(components);\r\n                            commandProcessor.execute(new Select(ids));\r\n                        }\r\n                        else {\r\n                            // Check if the newly selected items are all already selected. If so,\r\n                            // remove them from the selection. Otherwise select them.\r\n                            var notSelectedComponents = components.filter(function (c) { return !c.isSelected; });\r\n                            if (notSelectedComponents.length > 0) {\r\n                                // Select these items.\r\n                                var notSelectedIds = convertToIdsExpandingGroups(notSelectedComponents);\r\n                                commandProcessor.execute(new Select(notSelectedIds));\r\n                            }\r\n                            else {\r\n                                var ids = convertToIdsExpandingGroups(components);\r\n                                commandProcessor.execute(new Deselect(ids));\r\n                            }\r\n                        }\r\n                    }\r\n                    break;\r\n            }\r\n            // Disable visualisation of snap points.\r\n            for (var _i = 0, _a = appStore.items(); _i < _a.length; _i++) {\r\n                var data = _a[_i];\r\n                var apparatus = _this.appInterface.getApparatusComponent(data.id);\r\n                apparatus === null || apparatus === void 0 ? void 0 : apparatus.setState({ visualiseSnapping: undefined });\r\n            }\r\n            _this.appInterface.setIsInteracting(false);\r\n            _this.appInterface.setIsMovingItems(false);\r\n            commandProcessor.finishRecording();\r\n            _this.operation = undefined;\r\n        };\r\n        _this.appInterface = app;\r\n        layers.overlay.addChild(_this.selectionBox);\r\n        return _this;\r\n    }\r\n    // Private helpers.\r\n    MultiTool.prototype.startOperation = function (event) {\r\n        var _this = this;\r\n        if (Key.modifiers.shift) {\r\n            return { type: \"selection_on_top\" };\r\n        }\r\n        var foundTarget = project.hitTest(event.downPoint, {\r\n            fill: true,\r\n            bounds: true,\r\n            stroke: true,\r\n            match: InteractableMatcher,\r\n        });\r\n        // Resolve the apparatus.\r\n        if (foundTarget == null) {\r\n            // Down event landed on empty space.\r\n            // Deselect currently selected items.\r\n            var deselectIds = appStore.selectedObjectsID();\r\n            if (deselectIds.length > 0) {\r\n                commandProcessor.execute(new Deselect(deselectIds));\r\n            }\r\n            return { type: \"selection\" };\r\n        }\r\n        // Otherwise down event landed on an item.\r\n        var foundInteractable = foundTarget.item;\r\n        // First determine what type of interaction is associated with this component.\r\n        var interaction = foundInteractable.interaction;\r\n        switch (interaction.type) {\r\n            case \"selectAndMove\":\r\n                // Determine if this apparatus is already selected.\r\n                var component = interaction.component;\r\n                if (!component.isSelected) {\r\n                    // Deselect currently selected items, if any.\r\n                    var deselectIds = appStore.selectedObjectsID();\r\n                    // Determine if this item is part of a group.\r\n                    var selectIds = void 0;\r\n                    if (component.parentGroup) {\r\n                        // This component is part of a group. Select all other\r\n                        // grouped components.\r\n                        var rootGroup = getRootGroup(component.parentGroup);\r\n                        selectIds = getDescendantIDs(rootGroup);\r\n                    }\r\n                    else {\r\n                        // Select just this apparatus.\r\n                        selectIds = [component.id];\r\n                    }\r\n                    commandProcessor.execute(new DeselectAndSelect({\r\n                        select: selectIds,\r\n                        deselect: deselectIds\r\n                    }));\r\n                }\r\n                // Retrieve components of currently selected items.\r\n                var selectedItems = appStore.selectedObjectsID()\r\n                    .map(function (id) { return _this.appInterface.getObjectComponent(id); });\r\n                // Snapping:\r\n                // 1) Get non-selected apparatus\r\n                // 2) For every snap point in the selection, find the delta to every snap point\r\n                //    in the non-selected apparatus.\r\n                var selectedApparatus = [];\r\n                var allApparatus = [];\r\n                for (var _i = 0, _a = appStore.items(); _i < _a.length; _i++) {\r\n                    var data = _a[_i];\r\n                    var apparatus = this.appInterface.getApparatusComponent(data.id);\r\n                    if (!apparatus)\r\n                        continue;\r\n                    allApparatus.push(apparatus);\r\n                    if (apparatus.isSelected) {\r\n                        selectedApparatus.push(apparatus);\r\n                    }\r\n                }\r\n                var snapping = [];\r\n                snapping = precomputeSnapping(selectedApparatus, allApparatus);\r\n                return {\r\n                    type: \"moving\",\r\n                    movedComponents: selectedItems,\r\n                    snapping: snapping,\r\n                };\r\n            case \"adjust\":\r\n                return {\r\n                    type: \"adjusting\",\r\n                    adjustable: interaction.component,\r\n                };\r\n        }\r\n    };\r\n    /**\r\n     * Returns the delta vector to use for movement, taking into account\r\n     * potential snapping points. Potentially, other properties may also be changed.\r\n     */\r\n    MultiTool.prototype.deltaVector = function (rawDeltaVector, operation) {\r\n        // If Shift is held down, snap the vector to horizontal/vertical\r\n        if (Key.modifiers.shift) {\r\n            rawDeltaVector.angle = Math.round(rawDeltaVector.angle / 90) * 90;\r\n        }\r\n        // Snapping is disabled by holding down Ctrl.\r\n        if (Key.modifiers.control || Key.modifiers.command) {\r\n            return { delta: rawDeltaVector };\r\n        }\r\n        // Evaluate snapping.\r\n        if (operation.snapping.length > 0) {\r\n            var snappedData = evaluatePrecomputedSnappings(rawDeltaVector, operation.snapping, STRONG_SNAP_DISTANCE / appStore.zoom());\r\n            if (snappedData) {\r\n                return snappedData;\r\n            }\r\n        }\r\n        return { delta: rawDeltaVector };\r\n    };\r\n    return MultiTool;\r\n}(Tool));\r\n/**\r\n * Turns a list of components into IDs. If any components are part of a group,\r\n * the group is expanded fully, including descednant IDs in the return value.\r\n */\r\nfunction convertToIdsExpandingGroups(components) {\r\n    var ids = [];\r\n    components.forEach(function (c) {\r\n        ids.push.apply(ids, (c.parentGroup ? getDescendantIDs(getRootGroup(c.parentGroup)) : [c.id]));\r\n    });\r\n    return ids;\r\n}\r\nexport default MultiTool;\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { Button } from \"components/button\";\r\nimport { Remodal } from \"components/remodal\";\r\nimport { SearchBox } from \"components/searchbox\";\r\nimport * as React from 'react';\r\nimport { Badge } from \"tiers/badge\";\r\nimport { TierContext } from \"tiers/context\";\r\nimport { callApi } from \"../api/api\";\r\nimport { toPercent } from \"../view/formatters\";\r\nimport { DiagramFile } from \"./diagram\";\r\nvar DIAGRAMS_PER_PAGE = 12;\r\n/** \"About Chemix\" modal dialog. */\r\nvar FileOpenModal = /** @class */ (function (_super) {\r\n    __extends(FileOpenModal, _super);\r\n    function FileOpenModal(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.showFilesRef = React.createRef();\r\n        _this.state = {\r\n            isOpened: false,\r\n            isLoading: false,\r\n        };\r\n        return _this;\r\n    }\r\n    Object.defineProperty(FileOpenModal.prototype, \"icon\", {\r\n        get: function () {\r\n            return this.state.isLoading ? \"loading\" : \"fa-cloud\";\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    FileOpenModal.prototype.render = function () {\r\n        var auth = this.props.auth;\r\n        return React.createElement(Remodal.Container, { parent: this, class: \"cloud-browse-modal\", title: \"Open diagram\", icon: this.icon }, auth.state === \"logged_in\" ? React.createElement(ShowFiles, { auth: auth, ref: this.showFilesRef, parent: this }) : null);\r\n    };\r\n    FileOpenModal.prototype.refresh = function () {\r\n        var showFiles = this.showFilesRef.current;\r\n        if (showFiles) {\r\n            showFiles.setState({ page: 1, search: \"\" }, function () {\r\n                return showFiles.fetch({ page: 1 });\r\n            });\r\n        }\r\n    };\r\n    return FileOpenModal;\r\n}(Remodal));\r\nexport { FileOpenModal };\r\nvar ShowFiles = /** @class */ (function (_super) {\r\n    __extends(ShowFiles, _super);\r\n    function ShowFiles(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.isLoading = function () { return _this.state.currentFetchToken !== undefined; };\r\n        _this.onOpen = function (diagramId) {\r\n            _this.props.parent.close();\r\n            // Invoke the API to mark the diagram as opened.\r\n            callApi(\"diagram/opened\", \"POST\", _this.props.auth, { id: diagramId }, {\r\n                success: function () { },\r\n                generic: function () { }\r\n            });\r\n        };\r\n        _this.state = { diagrams: [], page: 0, totalPages: 0, search: \"\" };\r\n        return _this;\r\n    }\r\n    ShowFiles.prototype.render = function () {\r\n        var _this = this;\r\n        var _a, _b;\r\n        var now = new Date();\r\n        return React.createElement(React.Fragment, null,\r\n            ((_a = this.state.usage) === null || _a === void 0 ? void 0 : _a.total) === 0 ?\r\n                React.createElement(\"p\", null, \"You don't have any diagrams stored in the cloud yet.\")\r\n                : this.state.diagrams.length === 0 && !this.isLoading() && this.state.search ?\r\n                    React.createElement(\"p\", null,\r\n                        \"No diagrams matching \\\"\",\r\n                        this.state.search,\r\n                        \"\\\"\")\r\n                    : undefined,\r\n            React.createElement(\"div\", { className: \"row mb-2 \" + (((_b = this.state.usage) === null || _b === void 0 ? void 0 : _b.total) == 0 ? \"d-none\" : \"\") },\r\n                React.createElement(\"div\", { className: \"col-12 col-md-6 col-lg-4\" },\r\n                    React.createElement(SearchBox, { value: this.state.search, onChange: function (value) { return _this.setState({ search: value }, function () { return _this.fetch({ page: _this.state.page }); }); }, placeholder: \"Search diagrams\", throttleMs: 500 }))),\r\n            React.createElement(\"div\", { className: \"row no-gutters file-grid \" + (this.isLoading() ? \"loading\" : \"\") }, this.state.diagrams.map(function (d) {\r\n                return React.createElement(DiagramFile, { key: \"\" + d.created, now: now, diagram: d, \r\n                    // TODO: Fetch correct page after deletion/rename\r\n                    onDelete: function () { return _this.fetch({ page: _this.state.page }); }, onRename: function () { _this.setState({ page: 1 }); _this.fetch({ page: 1 }); }, onOpen: _this.onOpen });\r\n            })),\r\n            this.state.usage ?\r\n                React.createElement(UsageMeter, { limit: this.state.usage.limit, total: this.state.usage.total })\r\n                : undefined,\r\n            this.state.totalPages > 1 ?\r\n                React.createElement(\"div\", { className: \"text-center\" },\r\n                    React.createElement(Pager, { currentPage: this.state.page, totalPages: this.state.totalPages, onSelectPage: function (page) { return _this.fetch({ page: page }); } }))\r\n                : undefined);\r\n    };\r\n    ShowFiles.prototype.setCurrentFetchToken = function (token) {\r\n        if (token !== undefined) {\r\n            this.setState({ currentFetchToken: token });\r\n            this.props.parent.setState({ isLoading: true });\r\n        }\r\n        else {\r\n            this.setState({ currentFetchToken: undefined });\r\n            this.props.parent.setState({ isLoading: false });\r\n        }\r\n    };\r\n    ShowFiles.prototype.fetch = function (options) {\r\n        var _this = this;\r\n        var page = options.page;\r\n        var search = this.state.search;\r\n        // Generate a fetch token.\r\n        var fetchToken = (Math.random() * 10000).round();\r\n        this.setCurrentFetchToken(fetchToken);\r\n        var request = {\r\n            pageSize: DIAGRAMS_PER_PAGE,\r\n            page: page - 1,\r\n            search: search,\r\n        };\r\n        callApi(\"diagrams\", \"GET\", this.props.auth, request, {\r\n            success: function (response) {\r\n                if (_this.state.currentFetchToken != fetchToken)\r\n                    return;\r\n                var diagrams = response.diagrams.map(function (d) { return ({\r\n                    id: d.id,\r\n                    title: d.title,\r\n                    thumbnail: d.thumbnailBase64,\r\n                    rawData: d.data,\r\n                    created: new Date(d.created),\r\n                    modified: new Date(d.modified),\r\n                }); });\r\n                _this.setState({\r\n                    diagrams: diagrams,\r\n                    page: response.page + 1,\r\n                    totalPages: response.totalPages,\r\n                    usage: response.usage,\r\n                });\r\n                // Only reset the fetch token if the tokens matched.\r\n                _this.setCurrentFetchToken();\r\n            },\r\n        });\r\n    };\r\n    return ShowFiles;\r\n}(React.Component));\r\nvar Pager = function (props) {\r\n    var buttons = [];\r\n    var _loop_1 = function () {\r\n        if (props.currentPage == i) {\r\n            buttons.push(React.createElement(Button, { key: \"page_\" + i, extraClass: \"narrower highlight\", buttonLabel: i.toString(), onClick: function () { } }));\r\n        }\r\n        else {\r\n            var page_1 = i;\r\n            buttons.push(React.createElement(Button, { key: \"page_\" + i, extraClass: \"narrower\", buttonLabel: i.toString(), onClick: function () { return props.onSelectPage(page_1); } }));\r\n        }\r\n    };\r\n    for (var i = 1; i <= props.totalPages; i++) {\r\n        _loop_1();\r\n    }\r\n    return React.createElement(\"div\", { className: \"horizontal-button-group\" }, buttons);\r\n};\r\nvar UsageMeter = function (props) {\r\n    var percent = toPercent(Math.min(props.limit, props.total) / props.limit);\r\n    var color = \"secondary\";\r\n    var barColor = \"info\";\r\n    var textClass = \"\";\r\n    if (props.total >= props.limit) {\r\n        color = \"danger\";\r\n        textClass = \"text-danger\";\r\n        barColor = \"danger\";\r\n    }\r\n    return React.createElement(\"div\", { className: \"border border-\" + color + \" rounded text-left p-2\", style: { maxWidth: 220 } },\r\n        React.createElement(\"div\", { className: textClass },\r\n            \"Diagrams used: \",\r\n            props.total,\r\n            \" / \",\r\n            props.limit),\r\n        React.createElement(\"div\", { className: \"progress bg-secondary\", style: { height: 8 } },\r\n            React.createElement(\"div\", { className: \"progress-bar bg-\" + barColor, role: \"progressbar\", style: { width: percent } })),\r\n        React.createElement(MaybeUpgradeButton, null));\r\n};\r\nvar MaybeUpgradeButton = function () {\r\n    return React.createElement(TierContext.Consumer, null, function (tiers) { return (!tiers.tier\r\n        ? React.createElement(React.Fragment, null,\r\n            \"Need more storage? \",\r\n            React.createElement(\"div\", { className: \"ui-button\", onClick: function () { return tiers.popup('cloud'); } },\r\n                \"Upgrade\",\r\n                React.createElement(Badge, { tier: \"boost\" })))\r\n        : null); });\r\n};\r\n","import { mirrorX, setDefaultStyle } from \"apparatus/draw\";\r\nimport { R, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar Eye = /** @class */ (function () {\r\n    function Eye() {\r\n    }\r\n    Eye.prototype.render = function (appearance) {\r\n        // The eye is drawn facing upwards\r\n        var width = 40;\r\n        var halfWidth = width / 2;\r\n        var height = 30;\r\n        var outside = new Path(Segments([[0, 0]], [[halfWidth, height]]));\r\n        mirrorX(outside, halfWidth);\r\n        setDefaultStyle(outside);\r\n        var cornea = new Path(Segments([[5, 5], undefined, [5, -5]]));\r\n        mirrorX(cornea, halfWidth);\r\n        setDefaultStyle(cornea);\r\n        var lens = Shape.Ellipse(R(10, 2, width - 20, 8));\r\n        lens.fillColor = SharedColors.stroke;\r\n        var graphic = new Group([outside, cornea, lens]);\r\n        if (appearance.goggles) {\r\n            var goggles = new Path(Segments([[0, -6], [7, -6], [5, -10]])).withFill(\"#307ed1\").close();\r\n            mirrorX(goggles, halfWidth);\r\n            graphic.addChild(goggles);\r\n        }\r\n        var pivot = outside.bounds.center;\r\n        var hitShapes = [graphic.bounds.toShape()];\r\n        // Line of sight\r\n        var lineOfSight = appearance.line;\r\n        if (lineOfSight > 0) {\r\n            var line = new Path(Segments([[halfWidth, 0]], [[halfWidth, -lineOfSight]]));\r\n            line.strokeColor = \"#808080\";\r\n            line.strokeWidth = 2.0;\r\n            line.dashArray = [10, 12];\r\n            graphic.addChild(line);\r\n            hitShapes.push(Shape.Rectangle(R(halfWidth - 10, -lineOfSight, 20, lineOfSight)));\r\n        }\r\n        return { graphic: graphic, hitShape: hitShapes, pivot: pivot };\r\n    };\r\n    Eye.properties = {\r\n        label: \"Eye\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            line: 0,\r\n            goggles: false,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", label: \"Line of sight\", key: \"line\",\r\n                min: 0, max: 600, step: 10,\r\n            },\r\n            { spec: \"checkbox\", label: \"Safety goggles\", key: \"goggles\", subLabel: \"Show\" },\r\n        ],\r\n        defaultRotation: 90\r\n    };\r\n    return Eye;\r\n}());\r\nexport { Eye };\r\n","import { clamp } from \"apparatus/library/common\";\r\nimport { Deselect } from \"command/basic\";\r\nimport { clog } from \"log\";\r\nimport store from \"store/store\";\r\n/*\r\n * Functions and helpers for exporting current canvas\r\n * into various image formats.\r\n */\r\n/** Maximum zoom level to use when exporting (retina). */\r\nvar MAX_RENDER_ZOOM = 1.2;\r\nvar THUMBNAIL_WIDTH = 450;\r\nvar THUMBNAIL_HEIGHT = 300;\r\nvar THUMBNAIL_PADDING = 15;\r\nexport function exportFromCanvasJPGThumbnail(project, layers, bounds) {\r\n    // Deselect any selected items. Do this first as this\r\n    // will trigger a React update, setting the zoom.\r\n    var deselectCommand = new Deselect(store.selectedObjectsID());\r\n    deselectCommand.execute();\r\n    // Store current view properties.\r\n    var currentViewSize = project.view.viewSize;\r\n    var currentCenter = project.view.center;\r\n    var currentZoom = project.view.zoom;\r\n    // Calculate temporary render zoom, depending on the amount of\r\n    // space the diagram takes and what's allowed.\r\n    var _a = getExportZoomForThumbnail(bounds), scale = _a.scale, x = _a.x, y = _a.y;\r\n    // Shift the view center to align with center of the items.\r\n    project.view.center = bounds.center;\r\n    // Temporarily set zoom. If the export does not stay at this zoom, it means\r\n    // some other update is triggering setZoom back to the correct value during\r\n    // the export (this method is called on a background thread.)\r\n    project.view.zoom = scale;\r\n    // Scale down to (280, 180) using values from getExportZoomForThumbnail.\r\n    var scaledBounds = bounds.scale(x, y);\r\n    // Expand bounds just to be sure.\r\n    scaledBounds = scaledBounds.expand(THUMBNAIL_PADDING);\r\n    // Shift the items so that they are moved to the top left corner\r\n    // as opposed to centered in the view. This is important for next step.\r\n    // Intuition: currentViewSize is zoom-independent size of the canvas. We are trying\r\n    // to find how much space the scaled image takes up on the canvas, so we can\r\n    // calculate the gap we need to remove. viewCenter is zoom-dependent and so\r\n    // we need to scale by exportZoom to get the right amount of shift.\r\n    var shift = new paper.Point(currentViewSize.subtract(scaledBounds.size).divide(2 * scale));\r\n    project.view.center = project.view.center.add(shift);\r\n    // Restrict render area to the scaled bounds. Note that the top-left corner stays at 0,0\r\n    project.view.viewSize = scaledBounds.size;\r\n    // Add a white rectangle to the backing layer before exporting JPG.\r\n    // Expand the regular bounds by about 30 which should cover most small\r\n    // zooms.\r\n    var backingRectangle = scaledBounds.scale(1 / scale).expand(30).toShape();\r\n    backingRectangle.fillColor = \"white\";\r\n    layers.exportOnlyBacking.addChild(backingRectangle);\r\n    // Trigger render then export to JPG.\r\n    project.view.draw();\r\n    var jpgData = project.view.element.toDataURL(\"image/jpeg\", 0.8);\r\n    // Revert.\r\n    layers.exportOnlyBacking.removeChildren();\r\n    project.view.viewSize = currentViewSize;\r\n    project.view.center = currentCenter;\r\n    project.view.zoom = currentZoom;\r\n    deselectCommand.undo();\r\n    return jpgData;\r\n}\r\n/**\r\n * Exports the current canvas contents to multiple image formats.\r\n *\r\n * This function is very delicate and assumes that\r\n * no other processing/editing occurs at the same time.\r\n * It relies on the data store, the current canvas state\r\n * and Paper.js operations to prepare for export.\r\n *\r\n * It will make destructive edits to the canvas itself,\r\n * which it then attempts to revert at the end.\r\n *\r\n * @param project Paper project to export from\r\n * @param layers Layers of the current project\r\n * @param bounds Strict bounds (no padding), in paper coordinates\r\n *               of the area in canvas to be exported.\r\n */\r\nexport function exportFromCanvas(project, layers, bounds, maxPixels) {\r\n    // Deselect any selected items. Do this first as this\r\n    // will trigger a React update, setting the zoom.\r\n    var deselectCommand = new Deselect(store.selectedObjectsID());\r\n    deselectCommand.execute();\r\n    // Store current view properties.\r\n    var currentViewSize = project.view.viewSize;\r\n    var currentCenter = project.view.center;\r\n    var currentZoom = project.view.zoom;\r\n    // Calculate temporary render zoom, depending on the amount of\r\n    // space the diagram takes and what's allowed.\r\n    var exportZoom = getExportZoom(bounds, maxPixels);\r\n    clog(\"Rendering image at zoom level \" + exportZoom);\r\n    // Shift the view center to align with center of the items.\r\n    project.view.center = bounds.center;\r\n    // Temporarily set zoom. If the export does not stay at this zoom, it means\r\n    // some other update is triggering setZoom back to the correct value during\r\n    // the export (this method is called on a background thread.)\r\n    project.view.zoom = exportZoom;\r\n    // Scale the bounds to export zoom, around the view center.\r\n    // This only works because we have adjusted the view center\r\n    // to the bounds' center, avoiding ugly maths.\r\n    var scaledBounds = bounds.scale(exportZoom);\r\n    // Expand bounds just to be sure.\r\n    scaledBounds = scaledBounds.expand(5.0);\r\n    // Shift the items so that they are moved to the top left corner\r\n    // as opposed to centered in the view. This is important for next step.\r\n    // Intuition: currentViewSize is zoom-independent size of the canvas. We are trying\r\n    // to find how much space the scaled image takes up on the canvas, so we can\r\n    // calculate the gap we need to remove. viewCenter is zoom-dependent and so\r\n    // we need to scale by exportZoom to get the right amount of shift.\r\n    var shift = new paper.Point(currentViewSize.subtract(scaledBounds.size).divide(2 * exportZoom));\r\n    project.view.center = project.view.center.add(shift);\r\n    // Restrict render area to the scaled bounds. Note that the top-left corner stays at 0,0\r\n    project.view.viewSize = scaledBounds.size;\r\n    // Export SVG.\r\n    var svgElement = project.exportSVG();\r\n    svgElement.setAttribute(\"viewBox\", \"0 0 \" + scaledBounds.width + \" \" + scaledBounds.height);\r\n    // Trigger render then export to PNG.\r\n    project.view.draw();\r\n    var pngData = project.view.element.toDataURL(\"image/png\");\r\n    // Add a white rectangle to the backing layer before exporting JPG.\r\n    // Expand the regular bounds by about 30 which should cover most small\r\n    // zooms.\r\n    var backingRectangle = bounds.expand(30).toShape();\r\n    backingRectangle.fillColor = \"white\";\r\n    layers.exportOnlyBacking.addChild(backingRectangle);\r\n    // Trigger render then export to JPG.\r\n    project.view.draw();\r\n    var jpgData = project.view.element.toDataURL(\"image/jpeg\", 0.8);\r\n    // Revert.\r\n    layers.exportOnlyBacking.removeChildren();\r\n    project.view.viewSize = currentViewSize;\r\n    project.view.center = currentCenter;\r\n    project.view.zoom = currentZoom;\r\n    deselectCommand.undo();\r\n    // Convert SVG element to data url.\r\n    var seralizer = new XMLSerializer();\r\n    var svgString = seralizer.serializeToString(svgElement);\r\n    // btoa can sometimes fail, see\r\n    // https://stackoverflow.com/questions/23223718/failed-to-execute-btoa-on-window-the-string-to-be-encoded-contains-characte\r\n    var svgDataUrl = \"data:image/svg;base64,\" + btoa(unescape(encodeURIComponent(svgString)));\r\n    return { svgElement: svgElement, svgDataUrl: svgDataUrl, pngDataUrl: pngData, jpgDataUrl: jpgData };\r\n}\r\n/**\r\n * Computes the correct zoom for given bounds. This ensures that PNGs and JPGs\r\n * are not overly huge. This also adjusts for display density.\r\n */\r\nfunction getExportZoom(bounds, maxPixels) {\r\n    var pixelRatio = paper.project.view.pixelRatio;\r\n    var pixelRatioSquared = pixelRatio * pixelRatio;\r\n    var currentSize = Math.max(bounds.width * bounds.height * pixelRatioSquared, 10000);\r\n    var rawZoom = Math.sqrt(maxPixels / currentSize);\r\n    var zoom = Math.min(rawZoom, MAX_RENDER_ZOOM * 2 / pixelRatio);\r\n    zoom = clamp(zoom, 0.01, 10);\r\n    return zoom;\r\n}\r\n/** Compute zoom for scaling down for a thumbnail. */\r\nfunction getExportZoomForThumbnail(bounds) {\r\n    var pixelRatio = paper.project.view.pixelRatio;\r\n    var scaleY = (THUMBNAIL_HEIGHT - THUMBNAIL_PADDING * 2) / bounds.height / pixelRatio;\r\n    var scaleX = (THUMBNAIL_WIDTH - THUMBNAIL_PADDING * 2) / bounds.width / pixelRatio;\r\n    var scale = Math.min(scaleY, scaleX);\r\n    scale = clamp(scale, 0.01, 10);\r\n    return { scale: scale, x: scaleX, y: scaleY };\r\n}\r\n","import * as React from \"react\";\r\n/**\r\n * \"square\" -> \"fas fa-square\"\r\n * \"r,square\" -> \"far fa-square\"\r\n */\r\nfunction fontAwesomeCss(input) {\r\n    if (input[1] === \",\") {\r\n        return \"fa\" + input[0] + \" fa-\" + input.substring(2);\r\n    }\r\n    else {\r\n        return \"fas fa-\" + input;\r\n    }\r\n}\r\nexport var Icon = function (props) {\r\n    var _a, _b, _c;\r\n    return (props.name.indexOf(\"chemicons-\") === 0\r\n        ? React.createElement(\"i\", { className: \"chemicons \" + props.name + \" \" + ((_a = props.extraClass) !== null && _a !== void 0 ? _a : \"\") }) // Render a Chemicon\r\n        : React.createElement(\"i\", { className: fontAwesomeCss(props.name) + \" \" + (((_b = props.fullWidth) !== null && _b !== void 0 ? _b : true) ? \"fa-fw\" : \"\") + \" \" + (props.spacing === true ? \"mr-hem\" : \"\") + \" \" + ((_c = props.extraClass) !== null && _c !== void 0 ? _c : \"\") }) // Render a font-awesome icon\r\n    );\r\n};\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { Remodal } from \"components/remodal\";\r\nimport * as React from 'react';\r\nimport { Bcn } from \"support/beacon\";\r\nimport { TierContext } from \"tiers/context\";\r\nimport { runTutorial } from \"tutorial\";\r\nimport { CtrlKey, FAKey, Key } from \"view/keyboard_shortucts\";\r\nimport { g } from \"../../analytics\";\r\n/** Help modal dialog. */\r\nvar HelpModal = /** @class */ (function (_super) {\r\n    __extends(HelpModal, _super);\r\n    function HelpModal() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.render = function () { return (React.createElement(Remodal.Container, { parent: _this, title: \"Help\", icon: \"fa-question-circle\", class: \"help-modal\" },\r\n            React.createElement(\"div\", { className: \"row text-left mb-4\" },\r\n                React.createElement(HelpItemWrapper, null,\r\n                    React.createElement(\"button\", { onClick: function () { return runTutorial(); }, \"data-remodal-action\": \"confirm\", className: \"ui-button\" },\r\n                        React.createElement(\"i\", { className: \"fas fa-fw fa-lg fa-magic mr-2\" }),\r\n                        \"Quick Tutorial\")),\r\n                React.createElement(HelpItemWrapper, null,\r\n                    React.createElement(\"a\", { href: \"https://help.chemix.org\", onClick: function () { return g('HelpDlg:HelpCenter'); }, className: \"ui-button\", target: \"help\" },\r\n                        React.createElement(\"i\", { className: \"fas fa-fw fa-lg fa-book mr-2\" }),\r\n                        \"Open Help Center\")),\r\n                React.createElement(HelpItemWrapper, null,\r\n                    React.createElement(\"a\", { href: \"https://help.chemix.org/faq\", onClick: function () { return g('HelpDlg:FAQ'); }, className: \"ui-button\", target: \"help\" },\r\n                        React.createElement(\"i\", { className: \"fas fa-fw fa-lg fa-question mr-2\" }),\r\n                        \"Open FAQ\")),\r\n                React.createElement(TierContext.Consumer, null, function (tiers) {\r\n                    return React.createElement(HelpItemWrapper, null,\r\n                        React.createElement(\"button\", { onClick: function () { return tiers.popup(\"Help\"); }, className: \"ui-button w-100\" },\r\n                            React.createElement(\"i\", { className: \"fas fa-fw fa-lg fa-dollar-sign mr-2\" }),\r\n                            \"See Pricing\"));\r\n                }),\r\n                React.createElement(HelpItemWrapper, null,\r\n                    React.createElement(\"a\", { href: \"https://chemix.kampsite.co/\", onClick: function () { return g('HelpDlg:FAQ'); }, className: \"ui-button\", target: \"_blank\" },\r\n                        React.createElement(\"i\", { className: \"fas fa-fw fa-lg fa-comment-alt-plus mr-2\" }),\r\n                        \"Suggest feature / item\")),\r\n                React.createElement(HelpItemWrapper, null,\r\n                    React.createElement(\"button\", { \"data-remodal-action\": \"confirm\", onClick: function () { g('HelpDlg:OpenChat'); Bcn.ask(); }, className: \"ui-button w-100\" },\r\n                        React.createElement(\"i\", { className: \"fal fa-fw fa-lg fa-comment fa-flip-horizontal mr-2\" }),\r\n                        \"Start a chat\"))),\r\n            React.createElement(\"h3\", null,\r\n                React.createElement(\"i\", { className: \"fad fa-keyboard\" }),\r\n                \" Keyboard shortcuts\"),\r\n            React.createElement(KeyboardShortcuts, null))); };\r\n        return _this;\r\n    }\r\n    return HelpModal;\r\n}(Remodal));\r\nexport { HelpModal };\r\nexport var KeyboardShortcuts = function () { return (React.createElement(React.Fragment, null,\r\n    React.createElement(\"div\", { className: \"row text-left\" },\r\n        React.createElement(\"div\", { className: \"col-12 col-md-6 px-1\" },\r\n            React.createElement(\"table\", { className: \"table text-light table-sm table-borderless\" },\r\n                React.createElement(\"tbody\", null,\r\n                    React.createElement(\"tr\", null,\r\n                        React.createElement(\"td\", { className: \"text-right\" },\r\n                            React.createElement(Key, { k: \"1\" }),\r\n                            \" or \",\r\n                            React.createElement(Key, { k: \"V\" })),\r\n                        React.createElement(\"td\", null, \"Select and Move items.\")),\r\n                    React.createElement(\"tr\", null,\r\n                        React.createElement(\"td\", { className: \"text-right\" },\r\n                            React.createElement(Key, { k: \"2\" }),\r\n                            \" or \",\r\n                            React.createElement(Key, { k: \"P\" })),\r\n                        React.createElement(\"td\", null, \"Pan workspace\")),\r\n                    React.createElement(\"tr\", null,\r\n                        React.createElement(\"td\", { className: \"text-right\" },\r\n                            React.createElement(Key, { k: \"3\" }),\r\n                            \" or \",\r\n                            React.createElement(Key, { k: \"T\" })),\r\n                        React.createElement(\"td\", null, \"Label tool (draw text and arrows)\")),\r\n                    React.createElement(Shortcut, { ctrl: true, k: \"F\" }, \"Search apparatus\"),\r\n                    React.createElement(Shortcut, { ctrl: true, k: \"E\" }, \"Export diagram as an image\"),\r\n                    React.createElement(Shortcut, { ctrl: true, k: \"N\" }, \"Create new diagram\")))),\r\n        React.createElement(\"div\", { className: \"col-12 col-md-6 px-1\" },\r\n            React.createElement(\"table\", { className: \"table text-light table-sm table-borderless\" },\r\n                React.createElement(\"tbody\", null,\r\n                    React.createElement(\"tr\", null,\r\n                        React.createElement(\"td\", { className: \"text-right\" },\r\n                            \"Hold \",\r\n                            React.createElement(Shift, null)),\r\n                        React.createElement(\"td\", null, \"Move items horizontally/vertically\")),\r\n                    React.createElement(\"tr\", null,\r\n                        React.createElement(\"td\", { className: \"text-right\" },\r\n                            \"Hold \",\r\n                            React.createElement(CtrlKey, null)),\r\n                        React.createElement(\"td\", null, \"Temporarily disable snapping\")),\r\n                    React.createElement(\"tr\", null,\r\n                        React.createElement(\"td\", { className: \"text-right\" },\r\n                            \"\\u00A0\",\r\n                            React.createElement(Arrows, null)),\r\n                        React.createElement(\"td\", null,\r\n                            \"Move items by a \",\r\n                            React.createElement(\"b\", null, \"medium\"),\r\n                            \" step\")),\r\n                    React.createElement(\"tr\", null,\r\n                        React.createElement(\"td\", { className: \"text-right\" },\r\n                            React.createElement(NoWrap, null,\r\n                                React.createElement(Shift, null),\r\n                                \" + \"),\r\n                            React.createElement(Arrows, null)),\r\n                        React.createElement(\"td\", null,\r\n                            \"Move items by a \",\r\n                            React.createElement(\"b\", null, \"large\"),\r\n                            \" step\")),\r\n                    React.createElement(\"tr\", null,\r\n                        React.createElement(\"td\", { className: \"text-right\" },\r\n                            React.createElement(NoWrap, null,\r\n                                React.createElement(CtrlKey, null),\r\n                                \" + \",\r\n                                React.createElement(Shift, null),\r\n                                \" + \"),\r\n                            React.createElement(Arrows, null)),\r\n                        React.createElement(\"td\", null,\r\n                            \"Move items by a \",\r\n                            React.createElement(\"b\", null, \"small\"),\r\n                            \" step\")),\r\n                    React.createElement(\"tr\", null,\r\n                        React.createElement(\"td\", { className: \"text-right\" },\r\n                            React.createElement(Rotate, null),\r\n                            \" + Hold \",\r\n                            React.createElement(Shift, null)),\r\n                        React.createElement(\"td\", null, \"Rotate with 22.5\\u00B0 increments\")),\r\n                    React.createElement(\"tr\", null,\r\n                        React.createElement(\"td\", { className: \"text-right\" },\r\n                            React.createElement(Rotate, null),\r\n                            \" + Hold \",\r\n                            React.createElement(CtrlKey, null)),\r\n                        React.createElement(\"td\", null, \"Rotate with 1\\u00B0 increments\")),\r\n                    React.createElement(\"tr\", null,\r\n                        React.createElement(\"td\", { className: \"text-right\" },\r\n                            React.createElement(Rotate, null),\r\n                            \" + Hold \",\r\n                            React.createElement(Key, { k: \"Alt\" })),\r\n                        React.createElement(\"td\", null, \"Rotate freely.\")))))))); };\r\nvar HelpItemWrapper = function (props) { return React.createElement(\"div\", { className: \"col-12 col-sm-6 col-md-4 mb-2\" }, props.children); };\r\nvar Rotate = function () { return React.createElement(\"i\", { className: \"fa fa-sync-alt\" }); };\r\nvar Shift = function () { return React.createElement(\"span\", { className: \"keyboardKey\" },\r\n    React.createElement(\"i\", { className: \"far fa-arrow-alt-up\" })); };\r\nvar Arrows = function () { return (React.createElement(React.Fragment, null,\r\n    React.createElement(NoWrap, null,\r\n        React.createElement(FAKey, { icon: \"s fa-arrow-left\" }),\r\n        React.createElement(FAKey, { icon: \"s fa-arrow-up\" }),\r\n        React.createElement(FAKey, { icon: \"s fa-arrow-right\" }),\r\n        React.createElement(FAKey, { icon: \"s fa-arrow-down\" })))); };\r\nexport var Shortcut = function (props) { return (React.createElement(\"tr\", null,\r\n    React.createElement(\"td\", { className: \"text-right\" },\r\n        React.createElement(Key, { k: props.k, ctrl: props.ctrl })),\r\n    React.createElement(\"td\", null,\r\n        props.children,\r\n        \" \"))); };\r\nvar NoWrap = function (_a) {\r\n    var children = _a.children;\r\n    return (React.createElement(\"span\", { style: { whiteSpace: \"nowrap\" } }, children));\r\n};\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n/**\r\n * Information about how this apparatus can snap to\r\n * other type of apparatus.\r\n */\r\nexport var Snap;\r\n(function (Snap) {\r\n    /** This is ugly but converts a mask to a filter list. */\r\n    function typeFilterFrom(mask) {\r\n        var filter = [];\r\n        Object.keys(mask).forEach(function (k) {\r\n            if (mask[k])\r\n                filter.push(k);\r\n        });\r\n        return filter;\r\n    }\r\n    Snap.typeFilterFrom = typeFilterFrom;\r\n    /** Returns facing in degrees. */\r\n    function getFacing(snap) {\r\n        if (snap.facing === undefined)\r\n            return 0;\r\n        if (snap.facing !== \"auto\")\r\n            return snap.facing;\r\n        return snap.end.subtract(snap.start).angle;\r\n    }\r\n    Snap.getFacing = getFacing;\r\n})(Snap || (Snap = {}));\r\n/** Method that applies a coordinate transformation on all point-related items. */\r\nexport function transform(snapping, flipped, transform) {\r\n    var _a;\r\n    switch (snapping.type) {\r\n        case \"placeable\":\r\n        case \"connectable\":\r\n            return __assign(__assign({}, snapping), { facing: ((_a = snapping.facing) !== null && _a !== void 0 ? _a : 0) * (flipped ? -1 : 1), at: transform(snapping.at) });\r\n        case \"attachable\":\r\n        case \"spotting_tile_placeable\":\r\n        case \"tlc_spot\":\r\n        case \"pluggable\":\r\n            return __assign(__assign({}, snapping), { at: transform(snapping.at) });\r\n        case \"placeable_surface\":\r\n        case \"attachable_on\":\r\n        case \"tlc_plate\":\r\n            return __assign(__assign({}, snapping), { start: transform(snapping.start), end: transform(snapping.end) });\r\n        case \"spotting_tile\":\r\n            return {\r\n                type: \"spotting_tile\",\r\n                at: snapping.at.map(transform),\r\n            };\r\n        case \"neck\":\r\n            return __assign(__assign({}, snapping), { top: transform(snapping.top) });\r\n    }\r\n}\r\n","// Contains definitions and APIs used throughout the app\r\nexport function metricsEqual(a, b) {\r\n    return a.pivot.x == b.pivot.x &&\r\n        a.pivot.y == b.pivot.y &&\r\n        a.bounds.x == b.bounds.x &&\r\n        a.bounds.y == b.bounds.y &&\r\n        a.bounds.width == b.bounds.width &&\r\n        a.bounds.height == b.bounds.height;\r\n}\r\nexport function convertFromPaperToHTMLCoordinates(metrics) {\r\n    var offset = paper.project.view.bounds.topLeft;\r\n    var zoom = paper.view.zoom;\r\n    return {\r\n        pivot: {\r\n            x: (metrics.pivot.x - offset.x) * zoom,\r\n            y: (metrics.pivot.y - offset.y) * zoom,\r\n        },\r\n        bounds: {\r\n            x: (metrics.bounds.x - offset.x) * zoom,\r\n            y: (metrics.bounds.y - offset.y) * zoom,\r\n            width: metrics.bounds.width * zoom,\r\n            height: metrics.bounds.height * zoom,\r\n        },\r\n    };\r\n}\r\nexport var NULL_SELECTION_METRICS = {\r\n    pivot: { x: 0, y: 0 },\r\n    bounds: { x: 0, y: 0, width: 0, height: 0 },\r\n};\r\n// Helper methods to work with position.\r\nexport function add(p1, p2) {\r\n    return { x: p1.x + p2.x, y: p1.y + p2.y };\r\n}\r\n","var __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { commonSpecsForApparatusKind } from \"apparatus\";\r\nimport { apparatusClass } from \"apparatus/library\";\r\nimport { createSingleLayerLiquidPropsSection } from \"panel/apparatus_panel_ui\";\r\nimport { chemMarkPropsSection, convertAppearanceSpecs } from \"panel/appearance_spec_converter\";\r\nimport { sectionsForMultipleItems } from \"panel/propertyPanel\";\r\nexport function sectionsForMultipleItemsOfSameType(selected, app, tiers) {\r\n    var sections = [];\r\n    var apparatusKlass = apparatusClass(selected.items[0].type);\r\n    var specs;\r\n    if (selected.sameApparatusType) {\r\n        specs = apparatusKlass.properties.appearanceSpecs;\r\n    }\r\n    else if (selected.sameApparatusKind) {\r\n        specs = commonSpecsForApparatusKind(selected.sameApparatusKind);\r\n    }\r\n    else {\r\n        // This should not happen.\r\n        specs = apparatusKlass.properties.appearanceSpecs;\r\n    }\r\n    sections.push({\r\n        header: \"Style\",\r\n        icon: \"sliders-h\",\r\n        hideHeaderIfFirst: true,\r\n        elements: convertAppearanceSpecs(specs, selected.items[0], selected.items, app, tiers)\r\n    });\r\n    // Does the apparatus support ChemMark?\r\n    if (selected.sameApparatusType && apparatusKlass.properties.chemMarkAppearanceKey) {\r\n        sections.push(chemMarkPropsSection(selected.items, apparatusKlass.properties.chemMarkAppearanceKey));\r\n    }\r\n    // Extract tools section. Extracting only from first tab.\r\n    var multipleItemsPanelProps = sectionsForMultipleItems(selected, app);\r\n    sections.push.apply(sections, multipleItemsPanelProps.tabs[0].sections);\r\n    return {\r\n        title: apparatusKlass.properties.label + \" (\" + selected.items.length + \")\",\r\n        icon: \"mouse-pointer\",\r\n        tabs: __spreadArrays([\r\n            {\r\n                type: \"property\",\r\n                sections: sections,\r\n            }\r\n        ], (apparatusKlass.properties.canContainLiquids ? [{\r\n                type: \"liquid\",\r\n                colorDot: selected.getConsistentItemsLiquidColor(),\r\n                sections: [\r\n                    {\r\n                        header: \"Liquid\",\r\n                        icon: \"tint\",\r\n                        hideHeaderIfFirst: true,\r\n                        elements: createSingleLayerLiquidPropsSection(selected.items, app)\r\n                    }\r\n                ]\r\n            }] : []))\r\n    };\r\n}\r\n","import { P, S, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar ARC_SIZE = 6;\r\nvar Colors;\r\n(function (Colors) {\r\n    Colors.snapOutline = \"#68a343\";\r\n    Colors.snapFill = \"#fc03c2\";\r\n})(Colors || (Colors = {}));\r\nexport function visualiseSnappings(layer, snappings, filter) {\r\n    for (var _i = 0, snappings_1 = snappings; _i < snappings_1.length; _i++) {\r\n        var snapping = snappings_1[_i];\r\n        if (filter.length == 0 || filter.indexOf(snapping.type) !== -1) {\r\n            layer.addChild(visualiseSnapping(snapping));\r\n        }\r\n    }\r\n}\r\nfunction visualiseSnapping(snap) {\r\n    switch (snap.type) {\r\n        case \"placeable\":\r\n        case \"spotting_tile_placeable\":\r\n        case \"attachable\":\r\n        case \"tlc_spot\":\r\n            return createPoint(snap.at);\r\n        case \"neck\":\r\n            return createTriangle(snap.top, snap.facing);\r\n        case \"pluggable\":\r\n            return createTriangle(snap.at, 0);\r\n        case \"placeable_surface\":\r\n        case \"attachable_on\":\r\n        case \"tlc_plate\":\r\n            return createLine(snap.start, snap.end);\r\n        case \"connectable\":\r\n            return createHalfCircle(snap.at, snap.facing);\r\n        case \"spotting_tile\":\r\n            return createGrid(snap.at);\r\n    }\r\n}\r\nfunction createLine(start, end) {\r\n    var line = new Path([S(start), S(end)]);\r\n    line.strokeWidth = 2.0;\r\n    line.strokeColor = Colors.snapFill;\r\n    line.strokeScaling = false;\r\n    return line;\r\n}\r\nfunction createPoint(at) {\r\n    var circle = Shape.Circle(at, 1.0);\r\n    circle.strokeWidth = 4.0;\r\n    circle.strokeColor = Colors.snapFill;\r\n    circle.strokeScaling = false;\r\n    return circle;\r\n}\r\nfunction createTriangle(at, rotation) {\r\n    var triangle = new Path([S(P(at.x - 2, at.y)), S(P(at.x + 2, at.y)), S(P(at.x, at.y + 7))]);\r\n    triangle.close();\r\n    triangle.strokeWidth = 4.0;\r\n    triangle.strokeColor = Colors.snapFill;\r\n    triangle.strokeScaling = false;\r\n    triangle.rotate(rotation, at);\r\n    return triangle;\r\n}\r\nfunction createHalfCircle(at, rotation) {\r\n    var arc = new Path(Segments([[at.x - ARC_SIZE, at.y], undefined, [0, ARC_SIZE * 1.4]], [[at.x + ARC_SIZE, at.y], [0, ARC_SIZE * 1.4]]));\r\n    arc.closePath();\r\n    arc.fillColor = Colors.snapFill;\r\n    arc.rotate(rotation, at);\r\n    return arc;\r\n}\r\nfunction createGrid(at) {\r\n    return new Group(at.map(function (p) { return createPoint(p); }));\r\n}\r\n","import { P } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nimport { Random } from \"random/random\";\r\nvar RENDER_AS_POINTS = true;\r\n/**\r\n * - http://microbiology4us.blogspot.com/2019/01/confirmed-test-for-coliform-bacteria.html\r\n */\r\nvar StreakedBacteria = /** @class */ (function () {\r\n    function StreakedBacteria() {\r\n    }\r\n    StreakedBacteria.prototype.render = function (appearance) {\r\n        var diameter = appearance.diameter;\r\n        var radius = diameter / 2;\r\n        var random = new Random();\r\n        var graphic = new Group([\r\n        // Shape.Circle(P(0,0), 50).withFill(\"#eeeeee\")\r\n        ]);\r\n        var colourGradient = [\r\n            [appearance.color, 0.1],\r\n            [appearance.color.color().alpha(0.3).string(), 1.0],\r\n        ];\r\n        for (var quadrant = 0; quadrant < appearance.stage; quadrant++) {\r\n            var startAngle = -180 + quadrant * 72;\r\n            var endAngle = startAngle + 75;\r\n            for (var i = 0; i < 4; i++) {\r\n                var distance = 0.9;\r\n                var from = Po(startAngle - i * 10, distance * radius);\r\n                var to = Po(endAngle + i * 10, (distance - streakSpread(quadrant, i)) * radius);\r\n                graphic.addChildren(streak(from, to, random, bacteriaStepMultiplier(quadrant, i), randomFactor(quadrant, i), colourGradient));\r\n            }\r\n        }\r\n        var raster = graphic.rasterize();\r\n        graphic.remove();\r\n        return {\r\n            graphic: raster,\r\n            hitShape: raster.bounds.toShape(),\r\n            pivot: P(0, 0),\r\n        };\r\n    };\r\n    StreakedBacteria.properties = {\r\n        label: \"Bacteria (Streaked)\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            stage: 4,\r\n            color: \"#cccccc\",\r\n            diameter: 100,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"diameter\", label: \"Diameter\",\r\n                min: 35, max: 150, step: 5, unit: \"mm\"\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"stage\", label: \"Quadrants\",\r\n                min: 1, max: 4, pipsStep: 1,\r\n            },\r\n            { spec: \"color\", key: \"color\", label: \"Colour\" }\r\n        ],\r\n    };\r\n    return StreakedBacteria;\r\n}());\r\nexport { StreakedBacteria };\r\n/* Parameters for different lines and quadrants. */\r\nfunction streakSpread(quadrant, line) {\r\n    if (quadrant < 3)\r\n        return 0;\r\n    return line * 0.15;\r\n}\r\nfunction bacteriaStepMultiplier(quadrant, line) {\r\n    switch (quadrant) {\r\n        case 0: return 1.0;\r\n        case 1: return 1.5;\r\n        case 2: return 2.5;\r\n        case 3:\r\n        default:\r\n            return 4.0;\r\n    }\r\n}\r\nfunction randomFactor(quadrant, line) {\r\n    switch (quadrant) {\r\n        default:\r\n        case 0:\r\n        case 1: return 1.0;\r\n        case 2: return 0.5;\r\n        case 3: return 0.5;\r\n    }\r\n}\r\n/* Helper methods */\r\n// Returns a Point, in polar coordinates.\r\nfunction Po(angleInDegrees, length) {\r\n    var p = P(0, length);\r\n    p.angle = angleInDegrees;\r\n    return p;\r\n}\r\nfunction streak(from, to, random, bacteriaStepMultiplier, randomFactor, gradientStops) {\r\n    var bacteriaRadius = 1.5;\r\n    if (RENDER_AS_POINTS) {\r\n        var stepLength = bacteriaRadius * bacteriaStepMultiplier;\r\n        var items = [];\r\n        var start = from;\r\n        var delta = to.subtract(from);\r\n        var step = delta.normalize(stepLength);\r\n        for (var i = 0; i < delta.length / stepLength; i++) {\r\n            start = start.add(step);\r\n            var position = (randomFactor > 0) ? start.add(random.randomUnitVector(randomFactor)) : start;\r\n            var shape = Shape.Circle(position, bacteriaRadius);\r\n            shape.setRadialGradientFill(gradientStops);\r\n            items.push(shape);\r\n        }\r\n        return items;\r\n    }\r\n    else {\r\n        var line = new Path.Line(from, to);\r\n        line.strokeWidth = 1.0;\r\n        line.strokeColor = \"#40404080\";\r\n        return [line];\r\n    }\r\n}\r\n","import { addMarkers, mirrorX, setDefaultStyle } from \"apparatus/draw\";\r\nimport { P, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nvar HUB_COLORS = {\r\n    \"Green\": \"#519e82\",\r\n    \"Yellow\": \"#e8d387\",\r\n    \"Black\": \"#414040\",\r\n    \"Blue\": \"#2c82a2\",\r\n    \"Pink\": \"#be94aa\",\r\n    \"Purple\": \"#a185c7\",\r\n};\r\nvar DEMO_COLOURS = {\r\n    \"Green\": \"#519e82\",\r\n    \"Yellow\": \"#e8d387\",\r\n    \"Black\": \"#414040\",\r\n    \"Blue\": \"#2c82a2\",\r\n};\r\nvar Syringe = /** @class */ (function () {\r\n    function Syringe() {\r\n    }\r\n    Syringe.prototype.render = function (appearance) {\r\n        var length = appearance.size;\r\n        var diameter = 16;\r\n        var outletLength = 3;\r\n        var radius = diameter / 2;\r\n        var plungerRadius = radius;\r\n        var outletRadius = 3;\r\n        var body = new Path(Segments(\r\n        // Start from the tip\r\n        [[outletRadius, length + outletLength]], [[outletRadius, length]], [[radius, length - 3], [0, 3]], // Slight rounded corner\r\n        [[radius, 0], undefined, [30, -2]]));\r\n        mirrorX(body);\r\n        var liquidMask = body.clone();\r\n        setDefaultStyle(body);\r\n        // Plunger.\r\n        var plunger = new Path(Segments([[plungerRadius, length - 5], [0, 3]], [[plungerRadius, -2], undefined, [20, -1]]));\r\n        mirrorX(plunger);\r\n        plunger.closePath();\r\n        setDefaultStyle(plunger);\r\n        plunger.fillColor = \"#eeeeee\";\r\n        plunger.position.y -= appearance.plungerSlide * length;\r\n        var hub = new Path(Segments([[5, length + 2]], [[4, length + 13]], [[3, length + 14]], [[2, length + 22]]));\r\n        mirrorX(hub);\r\n        hub.closePath();\r\n        hub.fillColor = appearance.hubColor;\r\n        var needle = new Path(Segments([[0, length + 2]], [[0, length + appearance.needleSize + 20]]));\r\n        needle.strokeWidth = 2.0;\r\n        needle.strokeColor = \"black\";\r\n        var graphic = new Group([body, plunger, needle, hub]);\r\n        addMarkers(graphic, P(plungerRadius - 5, length - 2), 0.3 * length, P(0, 10));\r\n        return {\r\n            graphic: graphic,\r\n            liquidMask: liquidMask,\r\n            hitShape: graphic.bounds.expand(10).toShape(),\r\n            pivot: body.bounds.center,\r\n        };\r\n    };\r\n    Syringe.properties = {\r\n        label: \"Syringe\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            plungerSlide: 0.4,\r\n            size: 90,\r\n            needleSize: 30,\r\n            hubColor: \"#519e82\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 60, max: 120\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"plungerSlide\", label: \"Plunger slide\",\r\n                min: 0.0, max: 0.7, step: 0.01,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"needleSize\", label: \"Needle size\",\r\n                min: 20, max: 50\r\n            },\r\n            { spec: \"color\", key: \"hubColor\", label: \"Hub colour\", swatches: HUB_COLORS, tier: \"boost\", demoSwatches: DEMO_COLOURS },\r\n        ],\r\n    };\r\n    return Syringe;\r\n}());\r\nexport { Syringe };\r\n","export function isSpecialError(error) {\r\n    return \"error_type\" in error;\r\n}\r\n","import { g } from \"analytics\";\r\nimport { commandProcessor } from \"command/command\";\r\n// This method is just a wrapper around the\r\n// command processors's undo/redo operations.\r\nexport function undo(source) {\r\n    if (commandProcessor.undo()) {\r\n        g(\"Undo\", source);\r\n    }\r\n    else {\r\n        g(\"Undo-noop\", source);\r\n        toastr.info(\"No more steps to undo\");\r\n    }\r\n}\r\nexport function redo(source) {\r\n    if (commandProcessor.redo()) {\r\n        g(\"Redo\", source);\r\n    }\r\n    else {\r\n        g(\"Redo-noop\", source);\r\n        toastr.info(\"No more steps to redo\");\r\n    }\r\n}\r\n","import { Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nimport { Gradients } from \"../../gradients\";\r\nvar Pencil = /** @class */ (function () {\r\n    function Pencil() {\r\n    }\r\n    Pencil.isBoostRequiredForAppearance = function (a) {\r\n        return a.eraser === true;\r\n    };\r\n    Pencil.prototype.render = function (appearance) {\r\n        var length = appearance.length, scale = appearance.scale;\r\n        var body = new Path(Segments([[0, -5]], [[length, -5]], [[length + 24, 0]], [[length, 5]], [[0, 5]])).close();\r\n        var outline = body.clone();\r\n        outline.withStroke(\"thinner\");\r\n        body.withGradientFill(\"down\", [[\"#fad368\", 0.33], [\"#f9c531\", 0.34], [\"#f9c531\", 0.66], [\"#e3b134\", 0.67]]);\r\n        var tip = new Path(Segments([[length, -5]], [[length + 24, 0]], [[length, 5]])).withFill(\"#e39763\");\r\n        var carbon = new Path(Segments([[length + 12, -2.5]], [[length + 24, 0]], [[length + 12, 2.5]])).withFill(\"#222222\");\r\n        var graphic = new Group([body, tip, carbon]);\r\n        if (appearance.eraser) {\r\n            var metal = new Path.Rectangle(R(8, 0, 5, 10, Pivot.CENTER_LEFT))\r\n                .withGradientFill(\"up\", Gradients.simple(\"#aaaaaa\".color(), 20));\r\n            var eraser = new Path.Rectangle(R(0, 0, 10, 10, Pivot.CENTER_LEFT))\r\n                .withGradientFill(\"up\", Gradients.simple(\"#d8706f\".color(), 20));\r\n            graphic.addChild(eraser);\r\n            graphic.addChild(metal);\r\n        }\r\n        graphic.addChild(outline);\r\n        graphic.scale(scale);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.expand(10).toShape()\r\n        };\r\n    };\r\n    Pencil.properties = {\r\n        label: \"Pencil\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            length: 150,\r\n            scale: 1.0,\r\n            eraser: false,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.8, max: 2.0, step: 0.1, unit: \"%\",\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"length\", label: \"Length\",\r\n                min: 80, max: 180, unit: \"mm\"\r\n            },\r\n            {\r\n                spec: \"checkbox\", key: \"eraser\", label: \"Show eraser\", tier: \"boost\", allowWhenLocked: true,\r\n            },\r\n        ],\r\n    };\r\n    return Pencil;\r\n}());\r\nexport { Pencil };\r\n","export function strokeWidth(style) {\r\n    return currentStrokeWidths[style];\r\n}\r\n/*\r\n * Stroke Thickness Overriding\r\n */\r\nvar strokeWidthsForTheme = {\r\n    s: {\r\n        thicker: 4.0,\r\n        thick: 3.0,\r\n        default: 2.0,\r\n        thin: 1.5,\r\n        thinner: 1.0,\r\n        liquid: 1.0,\r\n    },\r\n    m: {\r\n        thicker: 6.0,\r\n        thick: 4.0,\r\n        default: 3.0,\r\n        thin: 2.0,\r\n        thinner: 1.5,\r\n        liquid: 1.5,\r\n    },\r\n    l: {\r\n        thicker: 8.0,\r\n        thick: 5.0,\r\n        default: 4.0,\r\n        thin: 3.0,\r\n        thinner: 2.0,\r\n        liquid: 2.0,\r\n    }\r\n};\r\nvar currentStrokeWidths = strokeWidthsForTheme.m;\r\n/** Call this to globally update thte current thickness theme */\r\nexport function setGloballyStrokeThicknessTheme(theme) {\r\n    currentStrokeWidths = strokeWidthsForTheme[theme];\r\n}\r\n","import { SVG } from \"apparatus/svg\";\r\nvar Root = /** @class */ (function () {\r\n    function Root() {\r\n    }\r\n    Root.prototype.render = function (appearance) {\r\n        var graphic = SVG.root();\r\n        graphic.scale(appearance.scale);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            watermark: graphic.bounds.center,\r\n        };\r\n    };\r\n    Root.properties = {\r\n        label: \"Root\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            scale: 1.0\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.5, max: 2.0, step: 0.01, unit: \"%\",\r\n            }\r\n        ],\r\n    };\r\n    return Root;\r\n}());\r\nexport { Root };\r\n","import { P, Pivot, R, SharedColors, SharedGradients } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar GlassBlock = /** @class */ (function () {\r\n    function GlassBlock() {\r\n    }\r\n    GlassBlock.prototype.render = function (appearance) {\r\n        var ior = appearance.ior, width = appearance.width, length = appearance.length, incidentLength = appearance.incidentLength, emergentLength = appearance.emergentLength, rayThickness = appearance.rayThickness;\r\n        var incidenceAngleD = appearance.incidenceAngleD;\r\n        var glass = Shape.Rectangle(R(0, 0, length, width, Pivot.TOP_CENTER))\r\n            .withGradientFill(\"right-down\", SharedGradients.glass)\r\n            .withStroke(\"thin\", SharedColors.glassEdge);\r\n        var graphic = new Group([glass]);\r\n        if (appearance.showRay) {\r\n            // Precalculate max incidenceAngle.\r\n            var maxRefractionAngleD = Math.atan((length - 10) / width).toDegrees();\r\n            var maxIncidenceAngleD = Math.asin(Math.sin(maxRefractionAngleD.toRadians()) * ior).toDegrees();\r\n            if (maxIncidenceAngleD) {\r\n                incidenceAngleD = Math.min(maxIncidenceAngleD, incidenceAngleD);\r\n            }\r\n            // IOR = sin(i) / sin(r)\r\n            var refractionAngleD = Math.asin(Math.sin(incidenceAngleD.toRadians()) / ior).toDegrees();\r\n            // Calculate the point of entry (top) and exit (top) such that the ray passes through\r\n            // rectangle center.\r\n            var entryPoint = P(-Math.tan(refractionAngleD.toRadians()) * width / 2, 0);\r\n            var exitPoint = P(-entryPoint.x, width);\r\n            var ray = new Path();\r\n            ray.addSegments([\r\n                entryPoint.add(P(0, -incidentLength).rotate(-incidenceAngleD)),\r\n                entryPoint,\r\n                exitPoint,\r\n                exitPoint.add(P(0, emergentLength).rotate(-incidenceAngleD))\r\n            ]);\r\n            ray.withStroke(rayThickness, SharedColors.ray);\r\n            graphic.insertChild(0, ray);\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: glass.bounds.expand(5).toShape(),\r\n            pivot: glass.bounds.center,\r\n        };\r\n    };\r\n    GlassBlock.properties = {\r\n        label: \"Glass Block\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            showRay: true,\r\n            incidenceAngleD: 40,\r\n            ior: 1.517,\r\n            length: 100,\r\n            width: 40,\r\n            incidentLength: 100,\r\n            emergentLength: 100,\r\n            rayThickness: 2.0\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"width\", label: \"Width\",\r\n                min: 20, max: 100,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"length\", label: \"Length\",\r\n                min: 80, max: 200,\r\n            },\r\n            { spec: \"header\", header: \"Laser ray\", icon: \"sliders-h\" },\r\n            { spec: \"checkbox\", key: \"showRay\", label: \"Show\" },\r\n            {\r\n                spec: \"slider\", key: \"incidenceAngleD\", label: \"Angle of incidence\",\r\n                min: 0, max: 89,\r\n                visible: function (a) { return a.showRay; },\r\n                unit: \"\", pipsStep: 45\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"ior\", label: \"Index of refraction\",\r\n                min: 1.0, max: 3.0,\r\n                visible: function (a) { return a.showRay; },\r\n                step: 0.001, pipsStep: 1000,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"incidentLength\", label: \"Incident ray\",\r\n                min: 10, max: 300,\r\n                visible: function (a) { return a.showRay; }\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"emergentLength\", label: \"Emergent ray\",\r\n                min: 10, max: 300,\r\n                visible: function (a) { return a.showRay; }\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"rayThickness\", label: \"Thickness\",\r\n                min: 1.0, max: 5.0,\r\n                visible: function (a) { return a.showRay; }\r\n            }\r\n        ],\r\n    };\r\n    return GlassBlock;\r\n}());\r\nexport { GlassBlock };\r\n","import { Consts } from \"./vars\";\r\n/** Shortcut for logging events via Google analytics. */\r\nexport function g(action, label, value) {\r\n    var data = { 'event_category': Consts.googleAnalyticsCategory };\r\n    if (label) {\r\n        data['event_label'] = label;\r\n    }\r\n    if (value) {\r\n        data['value'] = value;\r\n    }\r\n    gtag('event', action, data);\r\n}\r\n// Make it globally available as \"GLog\"\r\n;\r\nwindow.GLog = g;\r\n","import { setDefaultStyleWithStroke } from \"apparatus/draw\";\r\nimport { P } from \"apparatus/library/common\";\r\nimport { SVG } from \"apparatus/svg\";\r\nimport { Shape } from \"paper\";\r\nvar GlassWool = /** @class */ (function () {\r\n    function GlassWool() {\r\n    }\r\n    GlassWool.prototype.render = function (appearance) {\r\n        var graphic = SVG.glassWool();\r\n        graphic.scale(1.5 * appearance.scale, P(0, 0));\r\n        graphic.scale(1.0, appearance.squish, P(0, 0));\r\n        setDefaultStyleWithStroke(\"thinner\", graphic);\r\n        graphic.fillColor = appearance.color + '80';\r\n        var hitShape = Shape.Rectangle(graphic.bounds);\r\n        return { graphic: graphic, hitShape: hitShape };\r\n    };\r\n    GlassWool.properties = {\r\n        label: \"Glass Wool\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            scale: 1.0,\r\n            squish: 1.0,\r\n            color: \"#dddddd\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.5, max: 2.0, step: 0.1,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"squish\", label: \"Squish\",\r\n                min: 0.6, max: 1.0, step: 0.01,\r\n            },\r\n            {\r\n                spec: \"color\", key: \"color\", label: \"Colour\",\r\n                swatches: {\r\n                    \"White\": \"#ffffff\",\r\n                    \"Grey\": \"#dddddd\",\r\n                    \"Light blue\": \"#D1E4EB\",\r\n                }\r\n            }\r\n        ],\r\n    };\r\n    return GlassWool;\r\n}());\r\nexport { GlassWool };\r\n","import { Group, Path } from \"paper\";\r\nimport { setDefaultStyleWithStroke } from \"../../draw\";\r\nimport { P, Segments } from \"../common\";\r\nvar Tongs = /** @class */ (function () {\r\n    function Tongs() {\r\n    }\r\n    Tongs.isBoostRequiredForAppearance = function (a) {\r\n        return a.type == \"crucible\";\r\n    };\r\n    Tongs.prototype.render = function (appearance) {\r\n        var wing = new Path(wingShapes[appearance.type](appearance.size));\r\n        wing.rotate(appearance.opening, P(0, 0));\r\n        // Create second wing by vertically flipping it.\r\n        var wing2 = wing.clone();\r\n        wing2.scale(1, -1.0, P(0, 0));\r\n        var graphic = new Group([wing, wing2]);\r\n        setDefaultStyleWithStroke(\"thick\", graphic);\r\n        if (appearance.view == \"side\") {\r\n            graphic.scale(1, 0.6);\r\n        }\r\n        return { graphic: graphic, hitShape: graphic.bounds.toShape() };\r\n    };\r\n    Tongs.properties = {\r\n        label: \"Beaker/Crucible Tongs\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            type: \"beaker\",\r\n            size: 90,\r\n            opening: 5,\r\n            view: \"top\",\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"type\", label: \"Type\",\r\n                options: [\r\n                    { value: \"beaker\", label: \"Beaker tongs\" },\r\n                    { value: \"crucible\", label: \"Crucible tongs\", tier: \"boost\" },\r\n                ],\r\n                allowSelectingTierLockedOptions: true,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 70, max: 120,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"opening\", label: \"Opening\",\r\n                min: 0, max: 35,\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"view\", label: \"View angle\",\r\n                options: [\r\n                    { value: \"top\", label: \"Top\" },\r\n                    { value: \"side\", label: \"Side\" },\r\n                ],\r\n            }\r\n        ],\r\n    };\r\n    return Tongs;\r\n}());\r\nexport { Tongs };\r\nvar wingShapes = {\r\n    \"beaker\": function (size) {\r\n        return Segments([[-40, -10]], [[-44, -30], [5, 0]], [[-70, -30], undefined, [-15, 0]], [[-70, -5], [-15, 0]], [[-15, -5], undefined, [8, 0]], [[15, 5], undefined, [30, 10]], [[15 + size, 3], [-30, 10]]);\r\n    },\r\n    \"crucible\": function (size) {\r\n        var gap = size - 65;\r\n        return Segments([[-40, -10]], [[-44, -30], [5, 0]], [[-70, -30], undefined, [-15, 0]], [[-70, -5], [-15, 0]], [[-15, -5], undefined, [8, 0]], [[15, 5], [-15, 0]], [[15 + gap, 5], undefined, [5, 0]], [[15 + gap + 25, 12], [-7, 0], [7, 0]], [[15 + gap + 50, 5], [-5, 0]], [[15 + size, 3]]);\r\n    }\r\n};\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { setDefaultStyle } from \"apparatus/draw\";\r\nimport { P } from \"apparatus/library/common\";\r\nimport { CompoundPath, Group } from \"paper\";\r\nimport { CommonCondenser, condenserCaseShape } from \"../condensers\";\r\nvar FractionatingColumn2 = /** @class */ (function () {\r\n    function FractionatingColumn2() {\r\n    }\r\n    FractionatingColumn2.prototype.render = function (appearance) {\r\n        var height = appearance.height;\r\n        var _a = condenserCaseShape(height, 15, \"top-only\"), casing = _a.group, snapping = _a.snap;\r\n        var inside = new CompoundPath({});\r\n        inside.moveTo(P(0, 45));\r\n        inside.lineTo(P(0, height - 20));\r\n        var width = 20;\r\n        for (var y = 55; y < height - 25; y += 18) {\r\n            inside.moveTo(P(-width / 2, y));\r\n            inside.lineTo(P(width / 2, y));\r\n        }\r\n        var graphic = new Group([casing, inside]);\r\n        setDefaultStyle(graphic);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: snapping,\r\n            pivot: P(0, height / 2)\r\n        };\r\n    };\r\n    FractionatingColumn2.properties = {\r\n        label: \"Fractionating Column\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: __assign(__assign({}, CommonCondenser.NoPorts.defaultAppearance), { height: 270 }),\r\n        appearanceSpecs: __spreadArrays(CommonCondenser.NoPorts.appearanceSpecs),\r\n    };\r\n    return FractionatingColumn2;\r\n}());\r\nexport { FractionatingColumn2 };\r\n","// Wraper around <input type=\"text\" />\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { TextReplacements } from \"components/text_replacements\";\r\nimport * as React from \"react\";\r\nvar TextAreaInput = /** @class */ (function (_super) {\r\n    __extends(TextAreaInput, _super);\r\n    function TextAreaInput(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.ref = React.createRef();\r\n        _this.state = { text: _this.props.text };\r\n        return _this;\r\n    }\r\n    TextAreaInput.prototype.componentWillUnmount = function () {\r\n        this.props.onEnd(this.props.text, this.state.text);\r\n    };\r\n    TextAreaInput.prototype.UNSAFE_componentWillReceiveProps = function (nextProps) {\r\n        this.setState({ text: nextProps.text });\r\n    };\r\n    TextAreaInput.prototype.onChange = function (event) {\r\n        var value = event.target.value;\r\n        this.setState({ text: event.target.value });\r\n        this.props.onChange(value);\r\n    };\r\n    TextAreaInput.prototype.onKeyPress = function (event) {\r\n        if (this.props.enableReplacements === true)\r\n            TextReplacements.onKeyPress(this, event);\r\n    };\r\n    TextAreaInput.prototype.onKeyDown = function (event) {\r\n        if (this.props.enableReplacements === true)\r\n            TextReplacements.onKeyDown(this, event);\r\n    };\r\n    TextAreaInput.prototype.manuallySetText = function (newText, newCursorPosition) {\r\n        var _this = this;\r\n        this.setState({ text: newText }, function () { return _this.ref.current.setSelectionRange(newCursorPosition, newCursorPosition); });\r\n        this.props.onChange(newText);\r\n    };\r\n    TextAreaInput.prototype.onBlur = function (event) {\r\n        this.props.onEnd(this.props.text, this.state.text);\r\n    };\r\n    TextAreaInput.prototype.render = function () {\r\n        var _this = this;\r\n        var _a;\r\n        return React.createElement(\"textarea\", { value: this.state.text, rows: (_a = this.props.rows) !== null && _a !== void 0 ? _a : 8, className: \"ui-input\", onFocus: function (e) { var _a; return (_a = _this.props.onFocus) === null || _a === void 0 ? void 0 : _a.call(null); }, onChange: function (e) { return _this.onChange(e); }, onKeyPress: function (e) { return _this.onKeyPress(e); }, onKeyDown: function (e) { return _this.onKeyDown(e); }, onBlur: function (e) { return _this.onBlur(e); }, ref: this.ref, placeholder: this.props.placeholder });\r\n    };\r\n    return TextAreaInput;\r\n}(React.Component));\r\nexport { TextAreaInput };\r\n","import { Consts } from \"vars\";\r\n/** Is Prod and meets minimum version. */\r\nexport var isProdFrom = function (version) { return Consts.isProd && isAtLeastVersion(version); };\r\n/** Is Prod and meets minimum version, or is Dev. */\r\nexport var isFrom = function (version, extra) { return Consts.isDev || isProdFrom(version) || ((extra === null || extra === void 0 ? void 0 : extra.beta) == true && Consts.isBeta); };\r\nvar Flags;\r\n(function (Flags) {\r\n    /**\r\n     * Freehand tool.\r\n     */\r\n    Flags.isFreeHandToolEnabled = Consts.isDev;\r\n    /** Enable editing multiple items of same type. */\r\n    Flags.isEditingMultipleItemsOfSameTypeEnabled = true;\r\n    /** Enable Physics */\r\n    Flags.isPhysicsEnabled = Consts.isDev || Consts.isBeta;\r\n    Flags.isPromoEnabled = Consts.isDev || (currentDateBetween(\"2020-12-14\", \"2021-01-14\"));\r\n    Flags.isNewTemplatesEnabled = Consts.isDev || Consts.isBeta;\r\n})(Flags || (Flags = {}));\r\n/** Returns true if the current version is at least this version. */\r\nfunction isAtLeastVersion(minVersion) {\r\n    var current = parseVersion(Consts.version);\r\n    var min = parseVersion(minVersion);\r\n    return current[0] > min[0] || (current[0] == min[0] && current[1] >= min[1]);\r\n}\r\n/** Parses verion as major.minor. */\r\nfunction parseVersion(versionAsString) {\r\n    var matches = versionAsString.match(\"([0-9]*)\\.([0-9]*)\");\r\n    return [+matches[1], +matches[2]];\r\n}\r\nfunction currentDateBetween(after, before) {\r\n    var now = new Date().getTime();\r\n    var afterDate = Date.parse(after);\r\n    var beforeDate = Date.parse(before);\r\n    return now > afterDate && now < beforeDate;\r\n}\r\n// @ts-ignore unused\r\nfunction currentDateAfter(date) {\r\n    var now = new Date().getTime();\r\n    return now > Date.parse(date);\r\n}\r\nexport default Flags;\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { mirrorX } from \"apparatus/draw\";\r\nimport { INFINITE_BOUNDS } from \"apparatus/driver\";\r\nimport { P, Segments } from \"apparatus/library/common\";\r\nimport { BasicShapes } from \"apparatus/library/shapes/common\";\r\nimport { Group, Path } from \"paper\";\r\nvar Curve = /** @class */ (function () {\r\n    function Curve() {\r\n        this.shouldUseBoundsCenter = true;\r\n        this.drivers = Curve.drivers;\r\n    }\r\n    Curve.prototype.render = function (a) {\r\n        var _a = drawCurve(a), path = _a.path, xray = _a.xray;\r\n        BasicShapes.StrokeOnly.apply(path, a);\r\n        return {\r\n            graphic: path,\r\n            hitShape: BasicShapes.bounds(path),\r\n            xray: xray,\r\n            pivot: P(0, 0)\r\n        };\r\n    };\r\n    Curve.properties = {\r\n        label: \"Curve\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: __assign({ end1x: -150, end1y: 0, pivot1x: -40, pivot1y: -80, end2x: 200, end2y: 0, pivot2x: 140, pivot2y: 40 }, BasicShapes.StrokeOnly.defaultAppearance),\r\n        appearanceSpecs: __spreadArrays(BasicShapes.StrokeOnly.specs),\r\n    };\r\n    Curve.drivers = [\r\n        __assign(__assign({ type: \"rectangle\" }, INFINITE_BOUNDS), { toAppearance: function (p) { return ({ end1x: p.x, end1y: p.y }); }, fromAppearance: function (a) { return P(a.end1x, a.end1y); }, scale: 1.0 }),\r\n        __assign(__assign({ type: \"rectangle\" }, INFINITE_BOUNDS), { toAppearance: function (p) { return ({ pivot1x: p.x, pivot1y: p.y }); }, fromAppearance: function (a) { return P(a.pivot1x, a.pivot1y); }, scale: 1.0 }),\r\n        __assign(__assign({ type: \"rectangle\" }, INFINITE_BOUNDS), { toAppearance: function (p) { return ({ end2x: p.x, end2y: p.y }); }, fromAppearance: function (a) { return P(a.end2x, a.end2y); }, scale: 1.0 }),\r\n        __assign(__assign({ type: \"rectangle\" }, INFINITE_BOUNDS), { toAppearance: function (p) { return ({ pivot2x: p.x, pivot2y: p.y }); }, fromAppearance: function (a) { return P(a.pivot2x, a.pivot2y); }, scale: 1.0 }),\r\n    ];\r\n    return Curve;\r\n}());\r\nexport { Curve };\r\nvar CurvedArrow = /** @class */ (function () {\r\n    function CurvedArrow() {\r\n        this.shouldUseBoundsCenter = true;\r\n        this.drivers = Curve.drivers;\r\n    }\r\n    CurvedArrow.prototype.render = function (a) {\r\n        var _a = drawCurve(a), path = _a.path, xray = _a.xray;\r\n        var graphic = new Group([path]);\r\n        var drawEndArrow = a.arrows === \"both\" || a.arrows === \"end\";\r\n        var drawStartArrow = a.arrows === \"both\" || a.arrows === \"start\";\r\n        if (drawEndArrow) {\r\n            graphic.addChild(drawArrowHead(path.segments[1], \"handleIn\", a.size));\r\n        }\r\n        if (drawStartArrow) {\r\n            graphic.addChild(drawArrowHead(path.segments[0], \"handleOut\", a.size));\r\n        }\r\n        BasicShapes.StrokeOnly.apply(graphic, a);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: BasicShapes.bounds(graphic),\r\n            xray: xray,\r\n            pivot: P(0, 0)\r\n        };\r\n    };\r\n    CurvedArrow.properties = {\r\n        label: \"Curved Arrow\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: __assign(__assign({}, Curve.properties.defaultAppearance), { arrows: \"end\", size: 15 }),\r\n        appearanceSpecs: __spreadArrays(Curve.properties.appearanceSpecs, [\r\n            BasicShapes.header,\r\n            {\r\n                spec: \"toggle-buttons\",\r\n                size: \"small\",\r\n                key: \"arrows\",\r\n                label: \"Arrows\",\r\n                options: [\r\n                    { icon: \"long-arrow-left\", label: \"Start\", value: \"start\" },\r\n                    { icon: \"long-arrow-right\", label: \"End\", value: \"end\" },\r\n                    { icon: \"arrows-h\", label: \"Both\", value: \"both\" },\r\n                ]\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Arrow size\",\r\n                min: 10, max: 50\r\n            }\r\n        ]),\r\n    };\r\n    return CurvedArrow;\r\n}());\r\nexport { CurvedArrow };\r\nvar StirArrow = /** @class */ (function () {\r\n    function StirArrow() {\r\n    }\r\n    StirArrow.prototype.render = function (a) {\r\n        var path = new Path(Segments([[10, 0], , [19, 2]], [[16, 20], [18, -5], [-8, 2]]));\r\n        mirrorX(path);\r\n        var drawEndArrow = a.arrows === \"both\" || a.arrows === \"end\";\r\n        var drawStartArrow = a.arrows === \"both\" || a.arrows === \"start\";\r\n        var graphic = new Group([path]);\r\n        graphic.scale(a.size / 50);\r\n        if (drawEndArrow) {\r\n            graphic.addChild(drawArrowHead(path.segments[path.segments.length - 1], \"handleIn\", 10));\r\n        }\r\n        if (drawStartArrow) {\r\n            graphic.addChild(drawArrowHead(path.segments[0], \"handleOut\", 10));\r\n        }\r\n        BasicShapes.StrokeOnly.apply(graphic, a);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: BasicShapes.bounds(graphic),\r\n            pivot: path.bounds.center,\r\n        };\r\n    };\r\n    StirArrow.properties = {\r\n        label: \"Stirring motion arrow\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            arrows: \"both\",\r\n            size: 50,\r\n            stroke: \"#777777\",\r\n            strokeThickness: 3.0,\r\n        },\r\n        appearanceSpecs: __spreadArrays(BasicShapes.StrokeOnly.specs, [\r\n            BasicShapes.header,\r\n            {\r\n                spec: \"toggle-buttons\",\r\n                size: \"small\",\r\n                key: \"arrows\",\r\n                label: \"Arrows\",\r\n                options: [\r\n                    { icon: \"long-arrow-right\", label: \"Clockwise\", value: \"end\" },\r\n                    { icon: \"long-arrow-left\", label: \"Anti-clockwise\", value: \"start\" },\r\n                    { icon: \"arrows-h\", label: \"Both\", value: \"both\" },\r\n                ]\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 30, max: 120\r\n            }\r\n        ]),\r\n    };\r\n    return StirArrow;\r\n}());\r\nexport { StirArrow };\r\nexport function drawCurve(a) {\r\n    var path = new Path(Segments([[a.end1x, a.end1y], , [a.pivot1x - a.end1x, a.pivot1y - a.end1y]], [[a.end2x, a.end2y], [a.pivot2x - a.end2x, a.pivot2y - a.end2y]]));\r\n    var xray = new Path(Segments([[a.end1x, a.end1y]], [[a.pivot1x, a.pivot1y]], [[a.pivot2x, a.pivot2y]], [[a.end2x, a.end2y]]));\r\n    return { path: path, xray: xray };\r\n}\r\nexport function drawArrowHead(segment, normalKey, size, opts) {\r\n    var _a;\r\n    var normal = segment[normalKey].normalize();\r\n    var adjustAngle = (_a = opts === null || opts === void 0 ? void 0 : opts.adjustAngle) !== null && _a !== void 0 ? _a : 0;\r\n    var p1 = normal.rotate(45 + adjustAngle).multiply(size).add(segment.point);\r\n    var p2 = normal.rotate(-45 + adjustAngle).multiply(size).add(segment.point);\r\n    return new Path([p1, segment.point, p2]);\r\n}\r\n","import { Gradients } from \"apparatus/gradients\";\r\nimport { P, Pivot, R, SharedColors } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nvar WALL_COLOR = \"#d9ab5f\";\r\nvar Pulley = /** @class */ (function () {\r\n    function Pulley() {\r\n    }\r\n    Pulley.prototype.render = function (appearance) {\r\n        var radius = appearance.radius, distance = appearance.distance, wall = appearance.wall;\r\n        var pulley = new Path.Circle(P(0, 0), radius)\r\n            .withStroke(\"default\").withFill(\"#cccccc\");\r\n        var attachment = new Path.Rectangle(R(0, 10, 20, radius + distance + 15, Pivot.BOTTOM_CENTER), 5.0)\r\n            .withStroke(\"default\")\r\n            .withGradientFill(\"right-down\", Gradients.cylinder(\"#999999\".color()));\r\n        var nut = new Path.Circle(P(0, 0), 3.0).withFill(SharedColors.stroke);\r\n        var graphic = new Group([pulley, attachment, nut]);\r\n        if (wall) {\r\n            var y = -(radius + distance);\r\n            graphic.addChildren([\r\n                new Path.Rectangle(R(0, y, 100, 30, Pivot.BOTTOM_CENTER))\r\n                    .withGradientFill(\"down\", [[WALL_COLOR + \"00\", 0.0], [WALL_COLOR, 0.8]]),\r\n                new Path.Line(P(-50, y), P(50, y)).withStroke(\"default\"),\r\n            ]);\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            pivot: P(0, 0),\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    Pulley.properties = {\r\n        label: \"Pulley\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            radius: 50,\r\n            distance: 50,\r\n            wall: false\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"radius\", label: \"Pulley radius\",\r\n                min: 30, max: 80\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"distance\", label: \"Distance from wall\",\r\n                min: 20, max: 200\r\n            },\r\n            { spec: \"checkbox\", label: \"Wall\", subLabel: \"Show\", key: \"wall\" }\r\n        ],\r\n    };\r\n    return Pulley;\r\n}());\r\nexport { Pulley };\r\n","import { setDefaultStyle } from \"apparatus/draw\";\r\nimport { SVG } from \"apparatus/svg\";\r\nimport { Group } from \"paper\";\r\nvar Desiccator = /** @class */ (function () {\r\n    function Desiccator() {\r\n    }\r\n    Desiccator.prototype.render = function (appearance) {\r\n        var desiccator = SVG.desiccator();\r\n        var graphic = new Group([desiccator]);\r\n        if (appearance.lid == \"on\") {\r\n            var lid = SVG.desiccator_lid();\r\n            graphic.addChild(lid);\r\n            lid.position.y -= 25;\r\n        }\r\n        graphic.scale(2.0 * appearance.scale);\r\n        setDefaultStyle(graphic);\r\n        return { graphic: graphic, hitShape: graphic.bounds.toShape() };\r\n    };\r\n    Desiccator.properties = {\r\n        label: \"Desiccator\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            scale: 1.0,\r\n            lid: \"none\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.8, max: 2.0, step: 0.05\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"lid\", label: \"Lid\",\r\n                options: [\r\n                    { value: \"none\", label: \"No lid\" },\r\n                    { value: \"on\", label: \"Lid on\" },\r\n                ]\r\n            }\r\n        ],\r\n    };\r\n    return Desiccator;\r\n}());\r\nexport { Desiccator };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { DEFAULT_LIQUID_DATA, Segments } from \"apparatus/library/common\";\r\nimport { Path } from \"paper\";\r\nimport { breakPath, mirrorX, setDefaultStyle } from \"../../draw\";\r\n// Based on https://www.jaytecglass.co.uk/laboratory-glassware/industry-glassware/thistle-funnels/\r\nvar ThistleTube = /** @class */ (function () {\r\n    function ThistleTube() {\r\n    }\r\n    ThistleTube.prototype.render = function (appearance) {\r\n        var height = appearance.height;\r\n        var baseShape = new Path(Segments([[16, 0]], [[10, 10], undefined, [10, 4]], [[23, 30], [0, -8], [0, 10]], [[4, 50], [8, -1]], [[4, height]]));\r\n        mirrorX(baseShape);\r\n        var liquidMask = baseShape.clone();\r\n        var hitShape = baseShape.clone();\r\n        var graphic = breakPath(baseShape, 5);\r\n        setDefaultStyle(graphic);\r\n        return { graphic: graphic, liquidMask: liquidMask, hitShape: hitShape };\r\n    };\r\n    ThistleTube.properties = {\r\n        label: \"Thistle tube\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            height: 250,\r\n        },\r\n        defaultLiquidData: __assign(__assign({}, DEFAULT_LIQUID_DATA), { amountRatio: 0.9 }),\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"height\", label: \"Height\",\r\n                min: 180, max: 300\r\n            }\r\n        ],\r\n    };\r\n    return ThistleTube;\r\n}());\r\nexport { ThistleTube };\r\n","import * as React from \"react\";\r\nimport { Badge } from \"tiers/badge\";\r\n/** Allows access to current auth state via React context */\r\nexport var TierContext = React.createContext({\r\n    tier: undefined,\r\n    popup: function (analyticsLabel) { return alert(\"Subscribe to Chemix plus for more features.\"); },\r\n    allow: function (itemOrTier) { return false; },\r\n    badge: function (itemOrTier) { return null; },\r\n});\r\nvar LoggedInTierContextValue = /** @class */ (function () {\r\n    function LoggedInTierContextValue(tier, popup) {\r\n        this.tier = tier;\r\n        this.popup = popup;\r\n    }\r\n    LoggedInTierContextValue.prototype.allow = function (itemOrTier) {\r\n        if (typeof itemOrTier === \"string\") {\r\n            return meets(itemOrTier, this.tier);\r\n        }\r\n        else {\r\n            // If the item does not have a tier, it's considered basic.\r\n            var itemTier = itemOrTier.tier;\r\n            if (!itemTier)\r\n                return true;\r\n            return meets(itemTier, this.tier);\r\n        }\r\n    };\r\n    LoggedInTierContextValue.prototype.badge = function (itemOrTier, extraClass) {\r\n        if (this.allow(itemOrTier)) {\r\n            return null;\r\n        }\r\n        if (typeof itemOrTier === \"string\") {\r\n            return React.createElement(Badge, { tier: itemOrTier, extraClass: extraClass });\r\n        }\r\n        else {\r\n            var itemTier = itemOrTier.tier;\r\n            if (!itemTier)\r\n                return null;\r\n            return React.createElement(Badge, { tier: itemTier, extraClass: extraClass });\r\n        }\r\n    };\r\n    return LoggedInTierContextValue;\r\n}());\r\nexport { LoggedInTierContextValue };\r\n/**\r\n * Returns true if the current context meets the given tier, i.e.\r\n * the current user with given {@param tier} is allowed to use\r\n * the {@param requested} item based on its tier.\r\n */\r\nfunction meets(requested, current) {\r\n    if (!current)\r\n        return false;\r\n    // If the item is locked to plus, current tier must be plus or higher.\r\n    if (requested == \"plus\")\r\n        return current == \"plus\";\r\n    // If the item is locked to boost, current tier must be boost or higher.\r\n    if (requested == \"boost\")\r\n        return (current == \"plus\" || current == \"boost\");\r\n    // All other cases, return true.\r\n    return true;\r\n}\r\n","// App's Store\r\n// When adding new information, check ConnectedApp to see how the data is mapped.\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport * as Sentry from \"@sentry/react\";\r\nimport { LOGGED_OUT_STATE } from \"api/auth/types\";\r\nimport { createStore } from \"redux\";\r\nimport { generic } from \"store/actions\";\r\nimport { ID } from \"store/id\";\r\nimport reducer from \"./reducers\";\r\nexport var DEFAULT_THEME = {\r\n    strokeThickness: \"m\"\r\n};\r\n/**\r\n * Stores information for operating on multiple groups, e.g. adding child IDs\r\n * to multiple groups at once. Effectively a dictionary, whose key is the\r\n * group ID number and children are IDs.\r\n */\r\nvar GroupsOperationData = /** @class */ (function () {\r\n    function GroupsOperationData() {\r\n        this.data = {};\r\n        /** Maps from id number to the real Group ID. We must use these otherwise equality does not work. */\r\n        this.groupIds = {};\r\n        this.groupCache = {};\r\n    }\r\n    GroupsOperationData.prototype.add = function (groupId, child) {\r\n        if (!(groupId.id in this.data)) {\r\n            this.data[groupId.id] = [];\r\n            this.groupIds[groupId.id] = groupId;\r\n        }\r\n        this.data[groupId.id].push(child);\r\n    };\r\n    /** Do NOT mix calls to remove and add! */\r\n    GroupsOperationData.prototype.remove = function (groupId, child) {\r\n        if (!(groupId.id in this.data)) {\r\n            this.data[groupId.id] = [];\r\n            this.groupIds[groupId.id] = groupId;\r\n        }\r\n        this.data[groupId.id].push(child);\r\n        // If the group has a parent and would end up with\r\n        // no children, remove that group too.\r\n        var group = this.getGroup(groupId);\r\n        if (group.items.length == this.data[groupId.id].length && group.parentGroup) {\r\n            this.remove(group.parentGroup, groupId);\r\n        }\r\n    };\r\n    GroupsOperationData.prototype.getGroup = function (groupId) {\r\n        if (groupId.id in this.groupCache) {\r\n            return this.groupCache[groupId.id];\r\n        }\r\n        var group = appStore.getState().groups.filter(ID.matching(groupId))[0];\r\n        this.groupCache[groupId.id] = group;\r\n        return group;\r\n    };\r\n    GroupsOperationData.prototype.hasData = function () {\r\n        return Object.keys(this.data).length > 0;\r\n    };\r\n    return GroupsOperationData;\r\n}());\r\nexport { GroupsOperationData };\r\nvar initialState = {\r\n    zoom: 1,\r\n    items: [],\r\n    arrows: [],\r\n    groups: [],\r\n    tool: \"select\",\r\n    auth: LOGGED_OUT_STATE,\r\n    theme: __assign({}, DEFAULT_THEME),\r\n};\r\nvar sentryReduxEnhancer = Sentry.createReduxEnhancer({});\r\nexport var appStore = createStore(reducer, initialState, sentryReduxEnhancer);\r\nexport default {\r\n    // Data accessors.\r\n    items: function () { return appStore.getState().items; },\r\n    arrows: function () { return appStore.getState().arrows; },\r\n    groups: function () { return appStore.getState().groups; },\r\n    // Proxy to execute actionss.\r\n    dispatch: function (action) { appStore.dispatch(action); },\r\n    dispatchFn: function (description, fn) { appStore.dispatch(generic(description, fn)); },\r\n    // Helper methods.\r\n    selectedItems: function () {\r\n        return appStore.getState().items.filter(function (item) { return item.selected; });\r\n    },\r\n    selectedArrows: function () {\r\n        return appStore.getState().arrows.filter(function (arrow) { return arrow.selected; });\r\n    },\r\n    zoom: function () {\r\n        return appStore.getState().zoom;\r\n    },\r\n    // Filters down a list of IDs to those that exist.\r\n    filterExisting: function (ids) {\r\n        return ids.filter(function (id) {\r\n            switch (id.type) {\r\n                case \"arrow\":\r\n                    return appStore.getState().arrows.some(function (a) { return a.id === id; });\r\n                case \"apparatus\":\r\n                    return appStore.getState().items.some(function (a) { return a.id === id; });\r\n                case \"group\":\r\n                    return appStore.getState().groups.some(function (g) { return g.id === id; });\r\n            }\r\n        });\r\n    },\r\n    // TODO: Clean up this as well. This was a hack to return all IDs for\r\n    // all selecpted objects.\r\n    selectedObjectsID: function () {\r\n        var selectedApparatusIDs = appStore.getState().items.filter(function (i) { return i.selected; }).map(function (i) { return i.id; });\r\n        var selectedArrowsIDs = appStore.getState().arrows.filter(function (i) { return i.selected; }).map(function (i) { return i.id; });\r\n        var allIds = [];\r\n        allIds.push.apply(allIds, selectedApparatusIDs);\r\n        allIds.push.apply(allIds, selectedArrowsIDs);\r\n        return allIds;\r\n    },\r\n    // Returns the logged in state, or null if not logged in.\r\n    loggedInState: function () {\r\n        var auth = appStore.getState().auth;\r\n        if (auth.state == \"logged_in\") {\r\n            return auth;\r\n        }\r\n        return;\r\n    }\r\n};\r\nexport function extractDebugInfoFromStore() {\r\n    var state = appStore.getState();\r\n    return {\r\n        tier: state.tier,\r\n        tool: state.tool,\r\n        zoom: state.zoom,\r\n        currentCloudDiagram: state.currentCloudDiagram,\r\n        arrowsCount: state.arrows.length,\r\n        itemsCount: state.items.length,\r\n    };\r\n}\r\n","import { P, R } from \"apparatus/library/common\";\r\nimport { CompoundPath, Group, Path } from \"paper\";\r\nvar Ruler = /** @class */ (function () {\r\n    function Ruler() {\r\n    }\r\n    Ruler.prototype.render = function (appearance) {\r\n        var length = appearance.length;\r\n        var height = 25;\r\n        var margin = 15;\r\n        var spacing = appearance.unit == \"metric\" ? 10 : 12.7;\r\n        var bigStep = appearance.unit == \"metric\" ? 10 : 2; // Draw a big tick every <bigStep> mark.\r\n        var markings = new CompoundPath({});\r\n        var x = 0;\r\n        var i = 0;\r\n        while (x <= length) {\r\n            markings.moveTo(P(x, 1.5));\r\n            markings.lineTo(P(x, i % bigStep == 0 ? 10 : 7));\r\n            i += 1;\r\n            x += spacing;\r\n        }\r\n        markings.strokeColor = \"#666666\";\r\n        markings.strokeWidth = 2.0;\r\n        var ruler = new Path.Rectangle(R(-margin, 0, x - spacing + margin * 2, height));\r\n        var _a = rulerColor(appearance.color), fill = _a.fill, stroke = _a.stroke;\r\n        ruler.fillColor = fill;\r\n        ruler.strokeWidth = 3.0;\r\n        ruler.strokeColor = stroke;\r\n        return { graphic: new Group([ruler, markings]), hitShape: ruler.bounds.toShape() };\r\n    };\r\n    Ruler.properties = {\r\n        label: \"Ruler\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            unit: \"metric\",\r\n            length: 300,\r\n            color: \"beige\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"length\", label: \"Length\",\r\n                min: 100, max: 600,\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"unit\", label: \"Units\",\r\n                options: [\r\n                    { value: \"metric\", label: \"Metric (cm)\" },\r\n                    { value: \"imperial\", label: \"Imperial (in)\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"color\", label: \"Colour\",\r\n                options: [\r\n                    { value: \"beige\", label: \"Beige\" },\r\n                    { value: \"white\", label: \"White\" },\r\n                    { value: \"blue\", label: \"Blue\" },\r\n                ],\r\n            }\r\n        ],\r\n    };\r\n    return Ruler;\r\n}());\r\nexport { Ruler };\r\nfunction rulerColor(color) {\r\n    switch (color) {\r\n        case \"beige\":\r\n            return { fill: \"#ede6d7\", stroke: \"#969082\" };\r\n        case \"white\":\r\n            return { fill: \"#eeeeee\", stroke: \"#444444\" };\r\n        case \"blue\":\r\n            return { fill: \"#becfea\", stroke: \"#7586a0\" };\r\n    }\r\n}\r\n","import { g } from \"analytics\";\r\nimport { commandProcessor } from \"command/command\";\r\nimport { ReorderItems } from \"ordering/actions\";\r\nexport function createOrderingButtons(itemIds) {\r\n    return {\r\n        spec: \"horizontal-icon-buttons\",\r\n        label: \"Ordering\",\r\n        key: \"orderingButtons\",\r\n        buttons: [\r\n            {\r\n                buttonLabel: \"Bring to front\", icon: \"d,bring-front\",\r\n                onClick: function () {\r\n                    var command = ReorderItems.create(itemIds, \"bringToFront\");\r\n                    if (command) {\r\n                        g(\"LayerOrdering\", \"BringToFront\");\r\n                        commandProcessor.execute(command);\r\n                    }\r\n                },\r\n            },\r\n            {\r\n                buttonLabel: \"Bring forward\", icon: \"d,bring-forward\",\r\n                onClick: function () {\r\n                    var command = ReorderItems.create(itemIds, \"bringForward\");\r\n                    if (command) {\r\n                        g(\"LayerOrdering\", \"BringForward\");\r\n                        commandProcessor.execute(command);\r\n                    }\r\n                },\r\n            },\r\n            {\r\n                buttonLabel: \"Send backward\", icon: \"d,send-backward\",\r\n                onClick: function () {\r\n                    var command = ReorderItems.create(itemIds, \"sendBackward\");\r\n                    if (command) {\r\n                        g(\"LayerOrdering\", \"SendBackward\");\r\n                        commandProcessor.execute(command);\r\n                    }\r\n                },\r\n            },\r\n            {\r\n                buttonLabel: \"Send to back\", icon: \"d,send-back\",\r\n                onClick: function () {\r\n                    var command = ReorderItems.create(itemIds, \"sendToBack\");\r\n                    if (command) {\r\n                        g(\"LayerOrdering\", \"SendToBack\");\r\n                        commandProcessor.execute(command);\r\n                    }\r\n                },\r\n            },\r\n        ],\r\n    };\r\n}\r\n","import { mirrorX, strokeWidth } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { P, Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar GRAY_CYLINDER = Gradients.cylinder(\"#848489\".color());\r\nvar DeskLamp = /** @class */ (function () {\r\n    function DeskLamp() {\r\n        this.drivers = [\r\n            {\r\n                type: \"rectangle\",\r\n                minX: -50, maxX: 300,\r\n                minY: -340, maxY: -100,\r\n                fromAppearance: function (a) { return P(a.headX, -a.headY).multiply(a.scale); },\r\n                toAppearance: function (p, a) { return ({ headX: p.x / a.scale, headY: -p.y / a.scale }); },\r\n                scale: 1.0,\r\n            }\r\n        ];\r\n    }\r\n    DeskLamp.prototype.render = function (appearance) {\r\n        var armLength = 170;\r\n        var armWidth = 20;\r\n        // Solve 2-arm IK, from 0 to (headX, -headY)\r\n        //         +\r\n        //         |       XXX(headX, -headY)\r\n        //         |     XXXXX\r\n        //         |  XXXX  X\r\n        //         |XX\r\n        //      XXX|\r\n        //  XXXX   |\r\n        //  XX     |\r\n        //    X    |\r\n        //    X    |\r\n        //     X   |\r\n        //      X  |\r\n        //      XX |\r\n        //       XX+\r\n        var headVector = P(appearance.headX, -appearance.headY);\r\n        var length = Math.min(headVector.length, armLength * 1.99);\r\n        headVector.length = length;\r\n        var halfX = length / 2;\r\n        var armAngle = Math.acos(halfX / armLength).toDegrees();\r\n        var arm1 = Shape.Rectangle(R(-armWidth / 2, 0, armLength + armWidth, armWidth, Pivot.CENTER_LEFT), armWidth / 2);\r\n        arm1.rotate(-armAngle, P(0, 0));\r\n        arm1.fillColor = \"#aaaaaa\";\r\n        arm1.withStroke(strokeWidth(\"default\"), \"#888888\");\r\n        var arm2 = arm1.clone();\r\n        arm2.scale(-1.0, 1.0, P(halfX, 0));\r\n        var arms = new Group([arm1, arm2]);\r\n        arms.rotate(headVector.angle, P(0, 0));\r\n        var lampAttachment = Shape.Rectangle(R(0, -8, 16, 40, Pivot.TOP_CENTER), 5.0);\r\n        lampAttachment.withStroke(strokeWidth(\"default\"), \"#61605f\").withFill(\"#888888\");\r\n        var lampHead = new Path(Segments([[0, 20], , [50, 0]], [[50, 100]]));\r\n        mirrorX(lampHead);\r\n        lampHead.closePath();\r\n        lampHead.withStroke(strokeWidth(\"default\"), \"#61605f\").withGradientFill(\"right\", GRAY_CYLINDER);\r\n        var lightColor = this.glowColor(appearance.lightColor);\r\n        var lightCone = new Path(Segments([[50, 100]], [[80, 200]]));\r\n        mirrorX(lightCone);\r\n        lightCone.closePath();\r\n        lightCone.withGradientFill(\"down\", [[lightColor + \"80\", 0.0], [lightColor + \"00\", 1.0]]);\r\n        var lampTop = new Group([\r\n            lampAttachment, lightCone, lampHead\r\n        ]);\r\n        lampTop.pivot = P(0, 0);\r\n        lampTop.position = headVector;\r\n        lampTop.rotation = -appearance.angle;\r\n        var base = Shape.Rectangle(R(0, 0, 120, 25, Pivot.TOP_CENTER), 2.0);\r\n        base.withStroke(strokeWidth(\"default\"), \"#61605f\").withGradientFill(\"right\", GRAY_CYLINDER);\r\n        var graphic = new Group([arms, base, lampTop]);\r\n        // Apply scale, around the pivot.\r\n        graphic.scale(appearance.scale, P(0, 0));\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            pivot: P(0, 0),\r\n            snapping: base.placeable(),\r\n        };\r\n    };\r\n    DeskLamp.prototype.glowColor = function (color) {\r\n        switch (color) {\r\n            case \"yellow\": return \"#fce653\";\r\n            case \"red\": return \"#ff957a\";\r\n            case \"blue\": return \"#5192f5\";\r\n            case \"green\": return \"#67e22d\";\r\n        }\r\n    };\r\n    DeskLamp.properties = {\r\n        label: \"Desk lamp\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            headX: 10,\r\n            headY: 300,\r\n            angle: 30,\r\n            scale: 1.0,\r\n            lightColor: \"yellow\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"angle\", label: \"Head angle\",\r\n                min: 0, max: 90, step: 0\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.6, max: 1.2, step: 0.01, unit: \"%\",\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"lightColor\", label: \"Color\",\r\n                options: [\r\n                    { value: \"yellow\", label: \"Yellow\" },\r\n                    { value: \"red\", label: \"Red\" },\r\n                    { value: \"green\", label: \"Green\" },\r\n                    { value: \"blue\", label: \"Blue\" },\r\n                ]\r\n            },\r\n        ],\r\n    };\r\n    return DeskLamp;\r\n}());\r\nexport { DeskLamp };\r\n","import { SEARCH_BOX_ID } from \"components/searchbox\";\r\nimport clipboard from \"editing/clipboard\";\r\nimport { deleteSelected } from \"editing/deleting\";\r\nimport { redo, undo } from \"editing/undo_redo\";\r\nimport Flags from \"flags\";\r\nimport { Consts } from \"vars\";\r\nimport { selectTool } from \"./tools\";\r\n/** Key codes. */\r\nexport var Keys;\r\n(function (Keys) {\r\n    Keys[Keys[\"DELETE\"] = 46] = \"DELETE\";\r\n    Keys[Keys[\"ENTER\"] = 13] = \"ENTER\";\r\n    Keys[Keys[\"ESCAPE\"] = 27] = \"ESCAPE\";\r\n    Keys[Keys[\"BACKSPACE\"] = 8] = \"BACKSPACE\";\r\n    Keys[Keys[\"_1\"] = 49] = \"_1\";\r\n    Keys[Keys[\"_2\"] = 50] = \"_2\";\r\n    Keys[Keys[\"_3\"] = 51] = \"_3\";\r\n    Keys[Keys[\"_4\"] = 52] = \"_4\";\r\n    Keys[Keys[\"C\"] = 67] = \"C\";\r\n    Keys[Keys[\"D\"] = 68] = \"D\";\r\n    Keys[Keys[\"E\"] = 69] = \"E\";\r\n    Keys[Keys[\"F\"] = 70] = \"F\";\r\n    Keys[Keys[\"N\"] = 78] = \"N\";\r\n    Keys[Keys[\"S\"] = 83] = \"S\";\r\n    Keys[Keys[\"V\"] = 86] = \"V\";\r\n    Keys[Keys[\"X\"] = 88] = \"X\";\r\n    Keys[Keys[\"Y\"] = 89] = \"Y\";\r\n    Keys[Keys[\"Z\"] = 90] = \"Z\";\r\n    Keys[Keys[\"LEFT\"] = 37] = \"LEFT\";\r\n    Keys[Keys[\"UP\"] = 38] = \"UP\";\r\n    Keys[Keys[\"RIGHT\"] = 39] = \"RIGHT\";\r\n    Keys[Keys[\"DOWN\"] = 40] = \"DOWN\";\r\n    Keys[Keys[\"QUESTION_MARK\"] = 191] = \"QUESTION_MARK\";\r\n})(Keys || (Keys = {}));\r\nfunction isArrowKeys(e) {\r\n    return (e.which >= Keys.LEFT && e.which <= Keys.DOWN);\r\n}\r\n/** Returns true if this keyboard event should not be handled by Chemix. */\r\nfunction shouldHandleEvent(e) {\r\n    // Key code not set.\r\n    if (!e.keyCode)\r\n        return false;\r\n    // Do not handle if the target is a text input.\r\n    if ($(e.target).is(\"input\"))\r\n        return false;\r\n    // Also do not handle if the target is a text area.\r\n    if ($(e.target).is(\"textarea\"))\r\n        return false;\r\n    // Or a select.\r\n    if ($(e.target).is(\"select\"))\r\n        return false;\r\n    // Do not handle if the focus is on the slider handle.\r\n    // and arrow keys are used.\r\n    if ($(e.target).hasClass(\"ui-slider-handle\") && isArrowKeys(e))\r\n        return false;\r\n    // Do not handle if tutorial is running.\r\n    if ($(\".introjs-overlay\").length > 0)\r\n        return false;\r\n    // Do not handle while a context menu is focused.\r\n    if ($(e.target).hasClass(\"rc-menu__item\") && isArrowKeys(e))\r\n        return false;\r\n    // This event is safe to handle.\r\n    return true;\r\n}\r\n/** Return focus to main app so shortcuts work. */\r\nexport function focusMainApp() {\r\n    $(\"body\").focus();\r\n}\r\nexport function registerKeyboardShortcutHandler(handler) {\r\n    $(\"body\").on(\"keydown\", function (e) {\r\n        if (shouldHandleEvent(e)) {\r\n            handler(e);\r\n        }\r\n    });\r\n}\r\nexport function setUpKeyboard() {\r\n    $(\"body\").attr('tabindex', 0).on(\"keydown\", function (e) {\r\n        if (!shouldHandleEvent(e))\r\n            return;\r\n        var isCtrlDown = e.ctrlKey || e.metaKey;\r\n        var handled = true;\r\n        // Note the precedence, keys with modifiers trump the same key without.\r\n        if (e.keyCode == Keys.DELETE || e.keyCode == Keys.BACKSPACE) {\r\n            deleteSelected(\"keyboard\");\r\n        }\r\n        else if (e.keyCode == Keys.Z && isCtrlDown) {\r\n            undo(\"keyboard\");\r\n        }\r\n        else if (e.keyCode == Keys.Y && isCtrlDown) {\r\n            redo(\"keyboard\");\r\n        }\r\n        else if (e.keyCode == Keys.X && isCtrlDown) {\r\n            clipboard.cut(\"keyboard\");\r\n        }\r\n        else if (e.keyCode == Keys.C && isCtrlDown) {\r\n            clipboard.copy(\"keyboard\");\r\n        }\r\n        else if (e.keyCode == Keys.V && isCtrlDown) {\r\n            clipboard.paste(\"keyboard\");\r\n        }\r\n        else if (e.keyCode == Keys.F && isCtrlDown) {\r\n            $(\"#\" + SEARCH_BOX_ID).focus();\r\n        }\r\n        else if (e.key == \"1\" || e.key == \"v\" || e.keyCode == Keys.ESCAPE) {\r\n            selectTool(\"select\", \"keyboard\");\r\n        }\r\n        else if (e.key == \"2\" || e.key == \"p\") {\r\n            selectTool(\"pan\", \"keyboard\");\r\n        }\r\n        else if (e.key == \"3\" || e.key == \"t\") {\r\n            selectTool(\"arrow\", \"keyboard\");\r\n        }\r\n        else if (Flags.isFreeHandToolEnabled && (e.key == \"4\" || e.key == \"d\")) {\r\n            selectTool(\"freehand\", \"keyboard\");\r\n        }\r\n        else if (Consts.isDev && (e.key == \"5\")) {\r\n            selectTool(\"pathedit\", \"keyboard\");\r\n        }\r\n        else {\r\n            handled = false;\r\n        }\r\n        if (handled) {\r\n            e.preventDefault();\r\n        }\r\n    });\r\n}\r\nexport function keyToDirection(key) {\r\n    switch (key) {\r\n        case Keys.LEFT: return \"left\";\r\n        case Keys.RIGHT: return \"right\";\r\n        case Keys.DOWN: return \"down\";\r\n        case Keys.UP: return \"up\";\r\n    }\r\n    return \"left\";\r\n}\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { PropertyPanel } from \"components/propertyPanel\";\r\nimport Flags from \"flags\";\r\nimport { sectionsForOneApparatus } from \"panel/apparatus_panel_ui\";\r\nimport { arrowPanelUI } from \"panel/arrow_panel_ui\";\r\nimport { sectionsForMultipleItems } from \"panel/propertyPanel\";\r\nimport { sectionsForMultipleItemsOfSameType } from \"panel/same_type_apparatus\";\r\nimport * as React from \"react\";\r\nimport { setThemeStrokeThickness } from \"store/actions\";\r\nimport { TierContext } from \"tiers/context\";\r\nimport { appStore } from \"../store/store\";\r\n/**\r\n * Adapter element that basically contians a PropertyPanel\r\n * and is responsible for creating elements for the property\r\n * panel based on the current state of the app.\r\n */\r\nvar PropertyPanelAdapter = /** @class */ (function (_super) {\r\n    __extends(PropertyPanelAdapter, _super);\r\n    function PropertyPanelAdapter(props) {\r\n        return _super.call(this, props) || this;\r\n    }\r\n    // Creates PropertyPanel props from current selection.\r\n    PropertyPanelAdapter.prototype.createPropsForChild = function (tiers) {\r\n        var _a = this.props, selected = _a.selected, app = _a.app;\r\n        if (this.props.selected.isEmpty) {\r\n            return sectionsForProject(this.props.theme);\r\n        }\r\n        else if (selected.items.length == 1 && selected.arrows.length == 0) {\r\n            return sectionsForOneApparatus(selected.items[0], app, tiers, selected);\r\n        }\r\n        else if (selected.items.length == 0 && selected.arrows.length == 1) {\r\n            return arrowPanelUI(selected, selected.arrows, app, tiers);\r\n        }\r\n        else if (Flags.isEditingMultipleItemsOfSameTypeEnabled && selected.items.length == 0 && selected.arrows.length >= 1) {\r\n            return arrowPanelUI(selected, selected.arrows, app, tiers);\r\n        }\r\n        else if (Flags.isEditingMultipleItemsOfSameTypeEnabled && selected.items.length > 1 && (selected.sameApparatusType || selected.sameApparatusKind)) {\r\n            return sectionsForMultipleItemsOfSameType(selected, app, tiers);\r\n        }\r\n        else {\r\n            return sectionsForMultipleItems(selected, app);\r\n        }\r\n    };\r\n    PropertyPanelAdapter.prototype.render = function () {\r\n        var _this = this;\r\n        return React.createElement(TierContext.Consumer, { key: \"PropPanelConsumer\" }, function (tiers) { return (React.createElement(PropertyPanel, __assign({}, _this.createPropsForChild(tiers), { key: \"PropertyPanel\" }))); });\r\n    };\r\n    return PropertyPanelAdapter;\r\n}(React.Component));\r\nexport { PropertyPanelAdapter };\r\nvar strokeThicknessThemeButtons = [\r\n    { name: \"Thin\", value: \"s\", icon: \"l,horizontal-rule\" },\r\n    { name: \"Medium\", value: \"m\", icon: \"r,horizontal-rule\" },\r\n    { name: \"Strong\", value: \"l\", icon: \"horizontal-rule\" },\r\n];\r\nfunction sectionsForProject(theme) {\r\n    var themeButtonIndex = 0;\r\n    for (var i = 0; i < strokeThicknessThemeButtons.length; i++) {\r\n        if (strokeThicknessThemeButtons[i].value == theme.strokeThickness) {\r\n            themeButtonIndex = i;\r\n            break;\r\n        }\r\n    }\r\n    return {\r\n        icon: \"drafting-compass\",\r\n        title: \"Diagram settings\",\r\n        tabs: [\r\n            {\r\n                type: \"theme\",\r\n                sections: [\r\n                    {\r\n                        header: \"First\",\r\n                        icon: \"tint\",\r\n                        hideHeaderIfFirst: true,\r\n                        elements: [\r\n                            {\r\n                                spec: \"toggle-horizontal-buttons\",\r\n                                key: \"strokeThicknessTheme\",\r\n                                label: \"Stroke Thickness\",\r\n                                size: \"large\",\r\n                                highlightIndex: themeButtonIndex,\r\n                                buttons: strokeThicknessThemeButtons.map(function (s) { return ({\r\n                                    icon: s.icon,\r\n                                    buttonLabel: s.name,\r\n                                    onClick: function () {\r\n                                        appStore.dispatch(setThemeStrokeThickness(s.value));\r\n                                    }\r\n                                }); })\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    };\r\n}\r\n","module.exports = paper;","// Based on:\r\n// https://codeburst.io/react-authentication-with-twitter-google-facebook-and-github-862d59583105\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { g } from \"analytics\";\r\nimport { BACKEND_API } from \"api/api\";\r\nimport { clog } from \"log\";\r\nimport * as React from \"react\";\r\nimport { logIn } from \"store/actions\";\r\nimport store from \"store/store\";\r\nimport { isIEOrEdge } from \"utils\";\r\nexport function loginProviderIcon(provider) {\r\n    if (provider === \"facebook\") {\r\n        return \"fab fa-facebook-f\";\r\n    }\r\n    else if (provider === \"code\") {\r\n        return \"fas fa-key\";\r\n    }\r\n    return \"fab fa-\" + provider;\r\n}\r\nexport function loginProviderDisplayName(provider) {\r\n    return provider !== \"code\" ? provider.capitalise() : \"access code\";\r\n}\r\nvar LoginButton = /** @class */ (function (_super) {\r\n    __extends(LoginButton, _super);\r\n    function LoginButton(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.render = function () {\r\n            var providerName = _this.props.providerName;\r\n            return React.createElement(\"button\", { className: \"ui-button mx-auto mt-2 \" + providerName, onClick: function () { return _this.onButtonClick(); } },\r\n                React.createElement(\"i\", { className: \"mr-2 \" + loginProviderIcon(providerName) }),\r\n                \"Sign in with \",\r\n                loginProviderDisplayName(providerName));\r\n        };\r\n        _this.state = {};\r\n        var self = _this;\r\n        _this.messageHandler = function (ev) {\r\n            // Filter any messages that are not from our API,\r\n            // don't relate to this provider or while\r\n            // the button is not active.\r\n            if (ev.origin != BACKEND_API)\r\n                return;\r\n            if (!_this.props.active)\r\n                return;\r\n            var response = ev.data;\r\n            if (response.provider != _this.props.providerName)\r\n                return;\r\n            self.onReceiveLoginResponse(ev.data);\r\n        };\r\n        return _this;\r\n    }\r\n    LoginButton.prototype.componentDidMount = function () {\r\n        window.addEventListener(\"message\", this.messageHandler, true);\r\n    };\r\n    LoginButton.prototype.componentWillUnmount = function () {\r\n        window.removeEventListener(\"message\", this.messageHandler);\r\n    };\r\n    LoginButton.prototype.onReceiveLoginResponse = function (response) {\r\n        if (response.type == \"success\") {\r\n            // Successfully signed in.\r\n            store.dispatch(logIn({\r\n                provider: this.props.providerName,\r\n                jwtToken: response.jwt,\r\n                user: response.user,\r\n                firstTimeLogin: response.firstTimeLogin,\r\n                tier: response.tier,\r\n            }));\r\n            this.props.onSuccess(response.jwt, response.tier);\r\n            g(\"SignIn\", this.props.providerName);\r\n        }\r\n        else if (response.type == \"error\") {\r\n            toastr.error(\"Please try again later. If problems persist, please email support@chemix.org for help.\", \"Failed to sign in.\");\r\n            throw new Error(\"Failed to sign in: Error\");\r\n        }\r\n        else {\r\n            toastr.error(\"Unknown response\", \"Failed to sign in.\");\r\n            throw new Error(\"Failed to sign in: Unknown response.\");\r\n        }\r\n    };\r\n    LoginButton.prototype.onButtonClick = function () {\r\n        var provider = this.props.providerName;\r\n        var loginUrl = BACKEND_API + \"/auth/\" + provider;\r\n        if (this.props.onClick)\r\n            this.props.onClick();\r\n        var width = 800;\r\n        var height = 660;\r\n        var x = window.outerWidth / 2 + window.screenX - (width / 2);\r\n        var y = window.screenY + 20;\r\n        // IE/EDGE have a problem with permission denied, so use a login_redirect.html.\r\n        var url = isIEOrEdge() ? \"safe_redirect.html?to=\" + loginUrl : loginUrl;\r\n        var loginWindow = window.open(url, '', \"toolbar=no, location=no, directories=no, status=no, menubar=no,\\n            scrollbars=no, resizable=no, copyhistory=no\\n            width=\" + width + \" height=\" + height + \" top=\" + y + \" left=\" + x + \"\\n            \");\r\n        loginWindow.onunload = function () {\r\n            clog(\"Log in window closed.\");\r\n        };\r\n    };\r\n    return LoginButton;\r\n}(React.Component));\r\nexport { LoginButton };\r\n","import { mirrorX, strokeWidth } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { Interpolator, P, Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { hsl } from \"color\";\r\nimport { Group, Path, Shape } from \"paper\";\r\n// Main machine colours.\r\nvar OUTLINE_COLOR = hsl(252, 3, 65).string();\r\nvar FILL_GRADIENT = Gradients.cylinder(hsl(252, 3, 80));\r\nvar GRIP_FILL_GRADIENT = [[hsl(0, 0, 33).string(), 0.0], [hsl(0, 0, 10).string(), 1.0]];\r\nvar Rotavap = /** @class */ (function () {\r\n    function Rotavap() {\r\n        this.liftLerp = new Interpolator([0, 1], [220, 350]);\r\n    }\r\n    Rotavap.prototype.render = function (appearance) {\r\n        var bath = new Path(Segments([[0, -140], , [0, 140]], [[30, 0]]));\r\n        mirrorX(bath, 100);\r\n        bath.closePath();\r\n        bath.position.x += 95;\r\n        bath.position.y -= 20;\r\n        bath.withStroke(strokeWidth(\"default\"), OUTLINE_COLOR);\r\n        bath.setGradientFill(\"right\", FILL_GRADIENT);\r\n        if (appearance.translucentBath) {\r\n            bath.opacity = 0.4;\r\n        }\r\n        var base = Shape.Rectangle(R(0, 0, 310, 20, Pivot.BOTTOM_LEFT), 2.0);\r\n        base.withStroke(strokeWidth(\"default\"), hsl(0, 0, 20).string());\r\n        base.fillColor = hsl(0, 0, 35).string();\r\n        var lift = Shape.Rectangle(R(0, 0, 60, 360, Pivot.BOTTOM_LEFT), 5.0);\r\n        lift.position.x += 20;\r\n        lift.position.y -= 10;\r\n        lift.withStroke(strokeWidth(\"default\"), OUTLINE_COLOR);\r\n        lift.setGradientFill(\"right\", FILL_GRADIENT);\r\n        var liftTrack = Shape.Rectangle(R(0, 0, 10, 130, Pivot.BOTTOM_LEFT), 5.0);\r\n        liftTrack.position.x += 45;\r\n        liftTrack.position.y -= 220;\r\n        liftTrack.setGradientFill(\"right\", [[\"#aaaaaa\", 0.0], [\"#888888\", 1.0]]);\r\n        var powerUnit = new Group([\r\n            Shape.Rectangle(R(0, -23, 60, 20, Pivot.BOTTOM_CENTER), 2.0).withGradientFill(\"right\", GRIP_FILL_GRADIENT),\r\n            Shape.Rectangle(R(0, 23, 40, 20, Pivot.TOP_CENTER), 2.0).withGradientFill(\"right\", GRIP_FILL_GRADIENT),\r\n            Shape.Rectangle(R(0, 0, 80, 50, Pivot.CENTER), 3.0).withStroke(strokeWidth(\"default\"), OUTLINE_COLOR).withGradientFill(\"right\", FILL_GRADIENT),\r\n        ]);\r\n        // Add a shadow\r\n        powerUnit.insertChild(0, powerUnit.children[2].clone());\r\n        powerUnit.children[0].fillColor = \"#00000010\";\r\n        powerUnit.children[0].strokeWidth = 0;\r\n        powerUnit.children[0].position.y += 10;\r\n        powerUnit.children[0].position.x -= 10;\r\n        // Move into place.\r\n        powerUnit.position.x = 50;\r\n        powerUnit.position.y = -this.liftLerp.interpolate(appearance.lift);\r\n        powerUnit.rotation = -65;\r\n        var graphic = new Group([bath, lift, liftTrack, powerUnit, base]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: [bath.bounds.toShape(), lift.bounds.toShape(), base.bounds.toShape()],\r\n            snapping: base.placeable(),\r\n            pivot: base.strokeBounds.bottomCenter,\r\n            watermark: P(100, -140)\r\n        };\r\n    };\r\n    Rotavap.properties = {\r\n        label: \"Rotary Evaporator\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            lift: 0.1,\r\n            translucentBath: false\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"lift\", label: \"Lift\",\r\n                min: 0, max: 1, step: 0.01, unit: \"%\"\r\n            },\r\n            {\r\n                spec: \"checkbox\", key: \"translucentBath\", label: \"Translucent Bath\",\r\n            }\r\n        ],\r\n    };\r\n    return Rotavap;\r\n}());\r\nexport { Rotavap };\r\n","import { strokeWidth } from \"apparatus/common\";\r\nimport { mirrorY } from \"apparatus/draw\";\r\nimport { P, SharedColors } from \"apparatus/library/common\";\r\nimport \"ext/js\";\r\nimport { CompoundPath, Item, Path, Point, Rectangle, Shape } from \"paper\";\r\nItem.prototype.withScale = function (scale, center) {\r\n    this.scale(scale, center);\r\n    return this;\r\n};\r\n// Gradient fill an item.\r\nItem.prototype.setGradientFill = function (direction, stops) {\r\n    var _a = startStop(this.bounds, direction), start = _a.start, end = _a.end;\r\n    var gradient = new paper.Gradient(stops);\r\n    this.fillColor = new paper.Color(gradient, start, end);\r\n};\r\nItem.prototype.withGradientFill = function (direction, stops) {\r\n    this.setGradientFill(direction, stops);\r\n    return this;\r\n};\r\nItem.prototype.setGradientStroke = function (direction, stops) {\r\n    var _a = startStop(this.bounds, direction), start = _a.start, end = _a.end;\r\n    var gradient = new paper.Gradient(stops);\r\n    this.strokeColor = new paper.Color(gradient, start, end);\r\n    return this;\r\n};\r\nItem.prototype.setRadialGradientFill = function (stops, center, edge) {\r\n    var start = center !== null && center !== void 0 ? center : this.bounds.center;\r\n    var end = edge !== null && edge !== void 0 ? edge : this.bounds.rightCenter;\r\n    var gradient = new paper.Gradient(stops, true);\r\n    this.fillColor = new paper.Color(gradient, start, end);\r\n    return this;\r\n};\r\nItem.prototype.setRadialGradientStroke = function (stops) {\r\n    var start = this.bounds.center;\r\n    var end = this.bounds.rightCenter;\r\n    var gradient = new paper.Gradient(stops, true);\r\n    this.strokeColor = new paper.Color(gradient, start, end);\r\n};\r\nItem.prototype.enableScalableGradient = function () {\r\n    this.applyMatrix = false;\r\n    return this;\r\n};\r\nItem.prototype.withStroke = function (width, color) {\r\n    var widthNumber = (typeof width === \"string\") ? strokeWidth(width) : width;\r\n    this.strokeColor = color !== null && color !== void 0 ? color : SharedColors.stroke;\r\n    this.strokeWidth = widthNumber;\r\n    return this;\r\n};\r\nItem.prototype.withFill = function (color) {\r\n    this.fillColor = color;\r\n    return this;\r\n};\r\nItem.prototype.withPosition = function (position) {\r\n    if (position.x !== undefined)\r\n        this.position.x = position.x;\r\n    if (position.y !== undefined)\r\n        this.position.y = position.y;\r\n    return this;\r\n};\r\nItem.prototype.placeable = function () {\r\n    return {\r\n        type: \"placeable\",\r\n        at: this.strokeBounds.bottomCenter,\r\n    };\r\n};\r\nItem.prototype.topEdgeAsPlaceableSurface = function () {\r\n    return {\r\n        type: \"placeable_surface\",\r\n        start: this.strokeBounds.topLeft,\r\n        end: this.strokeBounds.topRight,\r\n    };\r\n};\r\nItem.prototype.withDefaultStyle = function () {\r\n    this.strokeWidth = strokeWidth(\"default\");\r\n    this.strokeColor = \"#333333\";\r\n    this.fillColor = \"#ddddddcc\";\r\n    return this;\r\n};\r\nPath.prototype.close = function () {\r\n    this.closePath();\r\n    return this;\r\n};\r\nPath.prototype.mirrorY = function (y) {\r\n    if (y === void 0) { y = 0; }\r\n    mirrorY(this, y);\r\n    return this;\r\n};\r\nPoint.prototype.toPlain = function () {\r\n    return { x: this.x, y: this.y };\r\n};\r\nPoint.prototype.toArray = function () {\r\n    return [this.x, this.y];\r\n};\r\n/**\r\n * Utility function that uses a compact syntax to create a CompoundPath. E.g.\r\n * instead of:\r\n *    let path = new CompoundPath({})\r\n *    path.moveTo(new Point(10, 10))\r\n *    path.lineTo(new Point(20, 20))\r\n * It is possible to write:\r\n *    let path = createCompoundPath(\r\n *       [\"moveTo\", 10, 10],\r\n *       [\"lineTo\", 20, 20],\r\n *    )\r\n */\r\nexport function createCompoundPath() {\r\n    var instructions = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        instructions[_i] = arguments[_i];\r\n    }\r\n    var path = new CompoundPath({});\r\n    for (var _a = 0, instructions_1 = instructions; _a < instructions_1.length; _a++) {\r\n        var instruction = instructions_1[_a];\r\n        var command = instruction[0], x = instruction[1], y = instruction[2];\r\n        var point = P(x, y);\r\n        switch (command) {\r\n            case \"lineBy\":\r\n                path.lineBy(point);\r\n                break;\r\n            case \"moveBy\":\r\n                path.moveBy(point);\r\n                break;\r\n            case \"moveTo\":\r\n                path.moveTo(point);\r\n                break;\r\n            case \"lineTo\":\r\n                path.lineTo(point);\r\n                break;\r\n        }\r\n    }\r\n    return path;\r\n}\r\nfunction startStop(bounds, direction) {\r\n    switch (direction) {\r\n        case \"up\":\r\n            return { start: bounds.bottomCenter, end: bounds.topCenter };\r\n        case \"right-up\":\r\n            return { start: bounds.bottomLeft, end: bounds.topRight };\r\n        case \"right\":\r\n            return { start: bounds.leftCenter, end: bounds.rightCenter };\r\n        case \"right-down\":\r\n            return { start: bounds.topLeft, end: bounds.bottomRight };\r\n        case \"down\":\r\n            return { start: bounds.topCenter, end: bounds.bottomCenter };\r\n        case \"left-down\":\r\n            return { start: bounds.topRight, end: bounds.bottomLeft };\r\n        case \"left\":\r\n            return { start: bounds.rightCenter, end: bounds.leftCenter };\r\n        case \"left-up\":\r\n            return { start: bounds.bottomRight, end: bounds.topLeft };\r\n    }\r\n}\r\n// Expands the current rectangle, in place, to include the other rectangle.\r\nRectangle.prototype.united = function (rect) {\r\n    this.top = Math.min(this.top, rect.top);\r\n    this.left = Math.min(this.left, rect.left);\r\n    this.right = Math.max(this.right, rect.right);\r\n    this.bottom = Math.max(this.bottom, rect.bottom);\r\n};\r\nRectangle.prototype.toShape = function () {\r\n    return Shape.Rectangle(this);\r\n};\r\n","import { mirrorX, strokeWidth } from \"apparatus/draw\";\r\nimport { P, Segments } from \"apparatus/library/common\";\r\nimport { SVG } from \"apparatus/svg\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar HeatingMantle = /** @class */ (function () {\r\n    function HeatingMantle() {\r\n    }\r\n    HeatingMantle.isBoostRequiredForAppearance = function (a) {\r\n        return a.transparency === \"clip\" || a.transparency == \"xsection\";\r\n    };\r\n    HeatingMantle.prototype.render = function (appearance) {\r\n        var graphic;\r\n        if (appearance.transparency === \"none\") {\r\n            graphic = SVG.mantle();\r\n        }\r\n        else {\r\n            var mantle = SVG.mantle();\r\n            var mask = mantle.bounds.toShape().toPath();\r\n            var masking = void 0;\r\n            if (appearance.transparency === \"clip\") {\r\n                var whiteout = Shape.Circle(mantle.bounds.topCenter.add(P(0, 30)), 90);\r\n                whiteout.setRadialGradientFill([[\"#ffffffdd\", 0.7], [\"#ffffff00\", 1.0]]);\r\n                masking = new Group([mask, whiteout]);\r\n                masking.clipped = true;\r\n                graphic = new Group([mantle, masking]);\r\n            }\r\n            else {\r\n                var cutOut = new Path(Segments([[65, 0]], [[65, 30], , [0, 30]], [[0, 90], [30, 0]]));\r\n                mirrorX(cutOut);\r\n                cutOut.position.x += 87;\r\n                cutOut.fillColor = \"white\";\r\n                cutOut.withStroke(strokeWidth(\"default\"), \"#aaaaaa\");\r\n                graphic = new Group([mantle, cutOut]);\r\n            }\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: graphic.placeable(),\r\n        };\r\n    };\r\n    HeatingMantle.properties = {\r\n        label: \"Heating Mantle\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            transparency: \"none\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"transparency\", label: \"Display\",\r\n                options: [\r\n                    { value: \"none\", label: \"Normal\" },\r\n                    { value: \"clip\", label: \"Transparent\", tier: \"boost\" },\r\n                    { value: \"xsection\", label: \"Cross-section\", tier: \"boost\" },\r\n                ],\r\n                allowSelectingTierLockedOptions: true,\r\n            }\r\n        ],\r\n    };\r\n    return HeatingMantle;\r\n}());\r\nexport { HeatingMantle };\r\n","import { strokeWidth } from \"apparatus/common\";\r\nimport { P, R } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nimport { mirrorX, setDefaultStyle } from \"../../draw\";\r\nimport { Segments } from \"../common\";\r\nvar ClayTriangle = /** @class */ (function () {\r\n    function ClayTriangle() {\r\n    }\r\n    ClayTriangle.prototype.render = function (appearance) {\r\n        var graphic = (function () {\r\n            switch (appearance.view) {\r\n                case \"side\":\r\n                    return sideView();\r\n                case \"top\":\r\n                    return topView();\r\n            }\r\n        })();\r\n        return { graphic: graphic, hitShape: graphic.bounds.toShape() };\r\n    };\r\n    ClayTriangle.properties = {\r\n        label: \"Clay triangle\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            view: \"side\"\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"view\", label: \"View\",\r\n                options: [\r\n                    { value: \"top\", label: \"Top\" },\r\n                    { value: \"side\", label: \"Side\" },\r\n                ],\r\n            },\r\n        ],\r\n    };\r\n    return ClayTriangle;\r\n}());\r\nexport { ClayTriangle };\r\nfunction createCeramic() {\r\n    var graphic = Shape.Rectangle(R(-30, -5, 60, 10), 3.0);\r\n    graphic.strokeColor = \"#c2a690\";\r\n    graphic.fillColor = \"#d9c8b9\";\r\n    graphic.strokeWidth = strokeWidth(\"default\");\r\n    return graphic;\r\n}\r\nfunction topView() {\r\n    var ceramic = createCeramic();\r\n    var wire = new Path(Segments([[66, -14]], [[40, 0]]));\r\n    mirrorX(wire);\r\n    setDefaultStyle(wire);\r\n    var part = new Group([wire, ceramic]);\r\n    // Duplicate three times in a triangle arrangement.\r\n    var pivot = P(0, 25);\r\n    var part2 = part.clone();\r\n    part2.rotate(120, pivot);\r\n    var part3 = part.clone();\r\n    part3.rotate(-120, pivot);\r\n    // Assemble together.\r\n    var graphic = new Group([part, part2, part3]);\r\n    return graphic;\r\n}\r\nfunction sideView() {\r\n    var ceramic = createCeramic();\r\n    var wire = new Path(Segments([[-66, 0]], [[66, 0]]));\r\n    setDefaultStyle(wire);\r\n    var graphic = new Group([wire, ceramic]);\r\n    return graphic;\r\n}\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { addEdgeLips, breakPath, mirrorX, setDefaultStyle } from \"apparatus/draw\";\r\nimport { Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nimport { createTap, Tap } from \"./common/tap\";\r\nvar SeparatoryFunnel = /** @class */ (function () {\r\n    function SeparatoryFunnel() {\r\n    }\r\n    SeparatoryFunnel.prototype.render = function (appearance) {\r\n        var size = appearance.size;\r\n        var halfWidth = size * 0.25;\r\n        var outflowHeight = 50;\r\n        var glass = new Path(Segments([[0, -20]], [[0, 0], undefined, [-halfWidth, 10]], // Start of arc\r\n        [[-halfWidth, halfWidth * 0.7], undefined, [0, 20]], // end of arc\r\n        [[7, size]], [[7, size + outflowHeight]]));\r\n        mirrorX(glass, 12);\r\n        var liquidMask = glass.clone();\r\n        // Adjust liquidMask based on opening.\r\n        if (Tap.isClosed(appearance.tapOpening)) {\r\n            liquidMask.segments[5].point = liquidMask.segments[3].point;\r\n        }\r\n        addEdgeLips(glass);\r\n        var glassWalls = breakPath(glass, 6);\r\n        setDefaultStyle(glassWalls);\r\n        var stopCock = createTap(appearance.tapOpening);\r\n        stopCock.position.x += 12;\r\n        stopCock.position.y = size + 2;\r\n        var graphic = new Group([glassWalls, stopCock]);\r\n        var hitShapes = [\r\n            Shape.Rectangle(glass.bounds),\r\n            Shape.Rectangle(stopCock.bounds)\r\n        ];\r\n        return { graphic: graphic, hitShape: hitShapes, liquidMask: liquidMask };\r\n    };\r\n    SeparatoryFunnel.properties = {\r\n        label: \"Separatory Funnel\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: __assign({ size: 150 }, Tap.defaultAppearance),\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 100, max: 200\r\n            },\r\n            Tap.appearanceSpec,\r\n        ],\r\n    };\r\n    return SeparatoryFunnel;\r\n}());\r\nexport { SeparatoryFunnel };\r\n","import { mirrorX } from \"apparatus/draw\";\r\nimport { P, Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nvar BLUE_COLOR = \"#1828d6\";\r\nvar WHITE_COLOR = \"#eeeeee\";\r\nvar BuretteClamp = /** @class */ (function () {\r\n    function BuretteClamp() {\r\n    }\r\n    BuretteClamp.prototype.render = function (appearance) {\r\n        var color = appearance.color.color();\r\n        var clamp = new Path(Segments([[16, 12], [0, 4]], [[16, -49]], [[45, -80], [-1, 16]], [[45, -104]], [[32, -104]], [[32, -77], , [0, 5]], [[26, -72]]));\r\n        mirrorX(clamp);\r\n        clamp.closePath();\r\n        clamp.withFill(color.hex()).withStroke(\"default\", color.ladd(-20).hex());\r\n        var pad = Shape.Rectangle(R(29, -102, 19, 16), 2.0).withFill(\"#333333\");\r\n        var pad2 = Shape.Rectangle(R(-29, -102, 19, 16, Pivot.TOP_RIGHT), 2.0).withFill(\"#333333\");\r\n        var pad3 = Shape.Rectangle(R(0, -72, 18, 25, Pivot.BOTTOM_CENTER), 2.0).withFill(\"#333333\");\r\n        var clamp2 = Shape.Rectangle(R(0, -35, 12, 65, Pivot.BOTTOM_CENTER), 2.0)\r\n            .withFill(color.hex()).withStroke(\"default\", color.ladd(-20).hex());\r\n        var nut = Shape.Circle(P(0, 0), 6).withStroke(\"thin\", \"#cccccc\").withFill(\"#aaaaaa\");\r\n        var graphic = new Group([clamp, clamp2, pad, pad2, pad3, nut]);\r\n        graphic.rotate(90, P(0, 0));\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: { type: \"attachable\", at: P(0, 0) }\r\n        };\r\n    };\r\n    BuretteClamp.properties = {\r\n        label: \"Burette Clamp\",\r\n        canContainLiquids: true,\r\n        defaultAppearance: {\r\n            color: BLUE_COLOR\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"radio\", key: \"color\", label: \"Colour\",\r\n                options: [\r\n                    { value: BLUE_COLOR, label: \"Blue\" },\r\n                    { value: WHITE_COLOR, label: \"White\" },\r\n                ],\r\n            }\r\n        ],\r\n    };\r\n    return BuretteClamp;\r\n}());\r\nexport { BuretteClamp };\r\n","import { mirrorX, setDefaultStyle } from \"apparatus/draw\";\r\nimport { createBolt } from \"apparatus/library/clamp\";\r\nimport { Group, Path, Shape } from \"paper\";\r\nimport { P, Segments } from \"../common\";\r\nvar bodyStrokeColor = \"#999999\";\r\nvar bodyFillColor = \"#cccccc\";\r\nvar rubberFillColor = \"#35a1db\";\r\nvar rubberStrokeColor = \"#1c719e\";\r\nvar BuretteHolder = /** @class */ (function () {\r\n    function BuretteHolder() {\r\n    }\r\n    BuretteHolder.prototype.render = function (appearance) {\r\n        var body = new Path(Segments([[20, -20], [0, 0], [20, 0]], [[60, -50], [0, 0], [10, -20]], [[80, -50], [5, -5], [-20, 20]], [[80, 50], [-20, -20], [5, 5]], [[60, 50], [10, 20]], [[20, 20], [20, 0]]));\r\n        mirrorX(body);\r\n        body.closePath();\r\n        setDefaultStyle(body);\r\n        body.strokeColor = bodyStrokeColor;\r\n        body.fillColor = bodyFillColor;\r\n        var graphic = new Group([body]);\r\n        // Place the rubber holders on the main body.\r\n        var rubberPositions = [P(71, 52), P(-71, 52), P(71, -52), P(-71, -52)];\r\n        rubberPositions.forEach(function (p) {\r\n            var rubber = createRubber(p);\r\n            graphic.addChild(rubber);\r\n        });\r\n        // Adjustable arms.\r\n        var movableHand = new Path(Segments([[0, 0]], [[50, -15]], [[100, -60], [0, 0], [10, -10]], [[112, -48], [10, -10]], [[105, -43]], [[110, -38], [-5, 0]], [[125, -45], [0, 0], [3, -3]], [[130, -40], [3, -3]], [[112, -31], [0, 0], [-5, 5]], [[100, -38]], [[55, -10]]));\r\n        setDefaultStyle(movableHand);\r\n        movableHand.strokeColor = bodyStrokeColor;\r\n        movableHand.fillColor = bodyFillColor;\r\n        var rubber2 = createRubber(P(108, -55));\r\n        var movableRT = new Group([movableHand, rubber2]);\r\n        var movableRB = movableRT.clone();\r\n        movableRB.scale(1, -1, P(0, 0));\r\n        var movableLT = movableRT.clone();\r\n        movableLT.scale(-1, 1, P(0, 0));\r\n        var movableLB = movableLT.clone();\r\n        movableLB.scale(1, -1, P(0, 0));\r\n        // Rotate the movable parts.\r\n        var leftClamping = appearance.leftClamping - 10;\r\n        var rightClamping = appearance.rightClamping - 10;\r\n        movableRT.rotate(rightClamping, P(50, -15));\r\n        movableRB.rotate(-rightClamping, P(50, 15));\r\n        movableLT.rotate(-leftClamping, P(-50, -15));\r\n        movableLB.rotate(leftClamping, P(-50, 15));\r\n        graphic.insertChildren(0, [movableLT, movableRT, movableLB, movableRB]);\r\n        // Center pivot\r\n        var pivot = createBolt();\r\n        graphic.addChild(pivot);\r\n        graphic.scale(appearance.scale);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            pivot: P(0, 0),\r\n            snapping: { type: \"attachable\", at: P(0, 0) }\r\n        };\r\n    };\r\n    BuretteHolder.properties = {\r\n        label: \"Burette Holder\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            scale: 1,\r\n            leftClamping: 20,\r\n            rightClamping: 20,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.7, max: 1.1, step: 0.01, unit: \"%\"\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"leftClamping\", label: \"Left Clamp\",\r\n                min: 0, max: 30, step: 0.5\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"rightClamping\", label: \"Right Clamp\",\r\n                min: 0, max: 30, step: 0.5\r\n            },\r\n        ],\r\n    };\r\n    return BuretteHolder;\r\n}());\r\nexport { BuretteHolder };\r\nfunction createRubber(p) {\r\n    return Shape.Circle(p, 8)\r\n        .withFill(rubberFillColor)\r\n        .withStroke(\"thinner\", rubberStrokeColor);\r\n}\r\n","// Component for group of radios\r\nimport * as React from \"react\";\r\nimport { TierContext } from \"tiers/context\";\r\nvar TIER_VALUE_PLACEHOLDER = \"____LOCKED_ITEM____\";\r\nexport var Select = function (props) {\r\n    var _a;\r\n    var tiers = React.useContext(TierContext);\r\n    function onChange(e) {\r\n        if (e.target.value === TIER_VALUE_PLACEHOLDER) {\r\n            tiers.popup(\"PP:\" + props.id);\r\n            return;\r\n        }\r\n        props.onSelectChange(props.value, e.target.value);\r\n    }\r\n    return React.createElement(\"select\", { className: (_a = \"custom-select \" + props.extraClass) !== null && _a !== void 0 ? _a : \"\", id: props.id, value: props.value, onChange: function (e) { return onChange(e); } }, props.options.map(function (options) {\r\n        return tiers.allow(options) ?\r\n            React.createElement(\"option\", { key: options.value, value: options.value }, options.label)\r\n            : React.createElement(\"option\", { key: options.value, value: TIER_VALUE_PLACEHOLDER },\r\n                options.label,\r\n                \" - \\u26A1\");\r\n    }));\r\n};\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { P, R, SharedColors } from \"apparatus/library/common\";\r\nimport { Interactable } from \"editing/interaction\";\r\nimport { clog } from \"log\";\r\nimport { Group, Point, PointText, Shape } from \"paper\";\r\nvar DEBUG_LOGS = false;\r\nvar DEBUG_CURSOR = false;\r\n/** Spacing between lines, as a multiple of font size. */\r\nvar LINE_SPACING = 1.25;\r\n/**\r\n * Class for rendering advanced text.\r\n *\r\n * Underneath, it opaquely uses Paper.js's PointText and Groups.\r\n * For performance reasons, these may be reused. The internal\r\n * paper structure should not be messed with.\r\n */\r\nvar AdvancedText = /** @class */ (function () {\r\n    function AdvancedText(container) {\r\n        this.container = new Group();\r\n        this.localAlignmentBounds = R(0, 0, 0, 0);\r\n        this.pointTextRecycler = new PointTextRecycler();\r\n        this.container = container !== null && container !== void 0 ? container : new Group();\r\n        this.container.applyMatrix = false;\r\n        this.container.selectedColor = SharedColors.selectionGreen;\r\n    }\r\n    /** Constructor that allows the container to be interactable. */\r\n    AdvancedText.withInteraction = function (interaction) {\r\n        var interactableGroupClass = Interactable(Group, interaction);\r\n        return new AdvancedText(new interactableGroupClass());\r\n    };\r\n    AdvancedText.prototype.setText = function (text, style) {\r\n        var _a;\r\n        // First recycle all current items.\r\n        (_a = this.pointTextRecycler).recycle.apply(_a, this.container.children);\r\n        // Empty text leads to rendering bugs. If the text has no segments, render\r\n        // a space.\r\n        if (text.segments.length == 0) {\r\n            text.segments.push({ type: \"normal\", text: \" \" });\r\n        }\r\n        if (text.segments.length == 1 && text.segments[0].type == \"normal\" && text.segments[0].text == \"\") {\r\n            text.segments[0].text = \" \";\r\n        }\r\n        // Convert style to internal style.\r\n        var internalStyle = __assign(__assign({}, style), { justification: \"left\" });\r\n        // Set up tracking of lines so that we can do text align properly at the end.\r\n        var lines = [];\r\n        var maxLineWidth = 0;\r\n        var cursor = P(0, 0);\r\n        for (var _i = 0, _b = text.segments; _i < _b.length; _i++) {\r\n            var segment = _b[_i];\r\n            if (DEBUG_CURSOR) {\r\n                var point = Shape.Circle(cursor, 5.0);\r\n                point.fillColor = \"#ff0000\";\r\n                this.container.addChild(point);\r\n            }\r\n            if (segment.type == \"newline\") {\r\n                var lineWidth_1 = cursor.x;\r\n                lines.push([this.container.children.length, lineWidth_1]);\r\n                maxLineWidth = Math.max(maxLineWidth, lineWidth_1);\r\n            }\r\n            var items = renderSegment(segment, cursor, this.pointTextRecycler, internalStyle);\r\n            if (items.length > 0) {\r\n                // Check length as newlines don't return anything.\r\n                this.container.addChildren(items);\r\n            }\r\n        }\r\n        // Track the last line.\r\n        var lineWidth = cursor.x;\r\n        lines.push([this.container.children.length, lineWidth]);\r\n        maxLineWidth = Math.max(maxLineWidth, lineWidth);\r\n        // Iterate through children and align each line to match alignment.\r\n        if (style.textAlign == \"left\" || lines.length == 1) {\r\n            // Nothing to do, by default, we left-align. Also if the text\r\n            // consists of 1 line, nothing to do either.\r\n        }\r\n        else {\r\n            var i = 0;\r\n            for (var _c = 0, lines_1 = lines; _c < lines_1.length; _c++) {\r\n                var _d = lines_1[_c], maxIndex = _d[0], lineWidth_2 = _d[1];\r\n                // If this is the longest line, nothing to do.\r\n                if (lineWidth_2 == maxLineWidth) {\r\n                    i = maxIndex;\r\n                    continue;\r\n                }\r\n                // Compute gap.\r\n                var gap = maxLineWidth - lineWidth_2;\r\n                if (style.textAlign == \"center\")\r\n                    gap /= 2.0;\r\n                // Shift all elements on the line by the gap.\r\n                while (i < maxIndex) {\r\n                    this.container.children[i].position.x += gap;\r\n                    i++;\r\n                }\r\n            }\r\n        }\r\n        // Pre-compute alignment bounds.\r\n        // For line height, don't quite take the full font-size.\r\n        var lineHeight = style.fontSize * 0.7;\r\n        var lineSpacing = LINE_SPACING * style.fontSize;\r\n        this.localAlignmentBounds = R(0, -lineHeight, maxLineWidth, lineHeight + (lines.length - 1) * lineSpacing);\r\n    };\r\n    AdvancedText.prototype.setPosition = function (x, y) {\r\n        this.container.position = new Point(x, y);\r\n    };\r\n    Object.defineProperty(AdvancedText.prototype, \"bounds\", {\r\n        get: function () {\r\n            return this.container.bounds;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AdvancedText.prototype, \"alignmentBounds\", {\r\n        get: function () {\r\n            // Return rectangle for text, ignoring subscripts etc.\r\n            var origin = this.container.localToGlobal(P(0, 0));\r\n            var alignmentBounds = this.localAlignmentBounds.clone();\r\n            alignmentBounds.point.x += origin.x;\r\n            alignmentBounds.point.y += origin.y;\r\n            return alignmentBounds;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    AdvancedText.prototype.remove = function () {\r\n        this.pointTextRecycler.dispose();\r\n        this.container.remove();\r\n    };\r\n    return AdvancedText;\r\n}());\r\nexport { AdvancedText };\r\n/**\r\n * Recycles PointText instances. To put stale instances into the recycle,\r\n * use recycle(). To request a recycled item, use request(). If the recycler\r\n * has run out of recycled instances, a new instance is returned.\r\n *\r\n * Note recycled instances are returned without modification and so all\r\n * relevant properties must be set of them during use.\r\n */\r\nvar PointTextRecycler = /** @class */ (function () {\r\n    function PointTextRecycler() {\r\n        this.recycled = [];\r\n    }\r\n    PointTextRecycler.prototype.recycle = function () {\r\n        var _a;\r\n        var items = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            items[_i] = arguments[_i];\r\n        }\r\n        for (var _b = 0, items_1 = items; _b < items_1.length; _b++) {\r\n            var item = items_1[_b];\r\n            item.remove();\r\n        }\r\n        (_a = this.recycled).push.apply(_a, items);\r\n    };\r\n    PointTextRecycler.prototype.request = function (position) {\r\n        // REMEMBER: Set position only once, before text is set!\r\n        var item = this.recycled.pop();\r\n        if (item) {\r\n            item.pivot = P(0, 0);\r\n            item.position = position;\r\n            return item;\r\n        }\r\n        var newInstance = new PointText(position);\r\n        // By setting the pivot we ensure the set\r\n        // position does not move around.\r\n        newInstance.pivot = position;\r\n        newInstance.selectedColor = SharedColors.selectionGreen;\r\n        return newInstance;\r\n    };\r\n    PointTextRecycler.prototype.dispose = function () {\r\n        for (var _i = 0, _a = this.recycled; _i < _a.length; _i++) {\r\n            var recycled = _a[_i];\r\n            recycled.remove();\r\n        }\r\n        this.recycled.length = 0;\r\n    };\r\n    return PointTextRecycler;\r\n}());\r\n/**\r\n * Renders a segment, returning items.\r\n * @param cursor Position to render at. Must be updated after rendering.\r\n */\r\nfunction renderSegment(segment, cursor, pointTextRecycler, style) {\r\n    var fontSize = style.fontSize;\r\n    switch (segment.type) {\r\n        case \"normal\":\r\n        case \"subscript\":\r\n        case \"superscript\":\r\n            var pointText = pointTextRecycler.request(cursor);\r\n            if (DEBUG_LOGS)\r\n                clog(\"before: \", pointText.position);\r\n            pointText.content = segment.text;\r\n            pointText.style = style;\r\n            pointText.fontSize = fontSize;\r\n            if (DEBUG_LOGS)\r\n                clog(\"after: \", pointText.position);\r\n            if (segment.type == \"subscript\") {\r\n                formatSubscript(pointText, style);\r\n            }\r\n            else if (segment.type == \"superscript\") {\r\n                formatSuperscript(pointText, style);\r\n            }\r\n            cursor.x += pointText.bounds.width;\r\n            return [pointText];\r\n        case \"subsuperscript\":\r\n            var superText = pointTextRecycler.request(cursor);\r\n            superText.content = segment.super;\r\n            var subText = pointTextRecycler.request(cursor);\r\n            subText.content = segment.sub;\r\n            formatSuperscript(superText, style);\r\n            formatSubscript(subText, style);\r\n            cursor.x += Math.max(superText.bounds.width, subText.bounds.width);\r\n            return [subText, superText];\r\n        case \"newline\":\r\n            cursor.x = 0;\r\n            cursor.y += style.fontSize * LINE_SPACING;\r\n            return [];\r\n    }\r\n}\r\nfunction formatSubscript(text, style) {\r\n    text.style = style;\r\n    text.fontSize = style.fontSize * 0.75;\r\n    text.position.y += style.fontSize * 0.27;\r\n}\r\nfunction formatSuperscript(text, style) {\r\n    text.style = style;\r\n    text.fontSize = style.fontSize * 0.75;\r\n    text.position.y -= style.fontSize * 0.42;\r\n}\r\n","import { strokeWidth } from \"apparatus/draw\";\r\nimport { Segments } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nvar CottonWool = /** @class */ (function () {\r\n    function CottonWool() {\r\n    }\r\n    CottonWool.prototype.render = function (appearance) {\r\n        var path = new Path(Segments([[-15, -20], [-10, -1], [7, -9]], [[11, -23], [0, -5], [10, 4]], [[21, 3], [6, -7], [4, 11]], [[8, 28], [20, 3], [-13, 8]], [[-17, 7], [-1, 14], [-13, -5]]));\r\n        path.closePath();\r\n        var stroke = appearance.wet ? \"#8596ad\" : \"#aaaaaa\";\r\n        var outside = appearance.wet ? \"#b1c2d8\" : \"#eeeeee\";\r\n        var inside = appearance.wet ? \"#dde2e9\" : \"#ffffff\";\r\n        var outline = path.clone();\r\n        outline.withStroke(strokeWidth(\"thin\"), stroke);\r\n        path.setRadialGradientFill([[inside, 0.6], [outside, 1.0]]);\r\n        path.scale(appearance.scale / 2);\r\n        outline.scale(appearance.scale / 2);\r\n        var graphic = new Group([path, outline]);\r\n        path.applyMatrix = false;\r\n        graphic.scale(appearance.squish, 1.0);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape()\r\n        };\r\n    };\r\n    CottonWool.properties = {\r\n        label: \"Cotton Wool\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            scale: 1.0,\r\n            squish: 1.0,\r\n            wet: false\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.5, max: 2.0, step: 0.01, unit: \"%\"\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"squish\", label: \"Squish\",\r\n                min: 0.4, max: 1.0, step: 0.01\r\n            },\r\n            {\r\n                spec: \"checkbox\", key: \"wet\", label: \"Wet\"\r\n            }\r\n        ],\r\n    };\r\n    return CottonWool;\r\n}());\r\nexport { CottonWool };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { P } from \"apparatus/library/common\";\r\nimport { BasicShapes } from \"apparatus/library/shapes/common\";\r\nimport { Color, Gradient, Path } from \"paper\";\r\nvar Sphere = /** @class */ (function () {\r\n    function Sphere() {\r\n        this.drivers = [\r\n            {\r\n                type: \"rectangle\",\r\n                minX: 5, maxX: 400,\r\n                minY: 0, maxY: 0,\r\n                toAppearance: function (p) { return ({\r\n                    radius: p.x\r\n                }); },\r\n                fromAppearance: function (a) { return P(a.radius, 0); },\r\n                scale: 1.0,\r\n            }\r\n        ];\r\n    }\r\n    Sphere.prototype.render = function (appearance) {\r\n        var radius = appearance.radius, shading = appearance.shading;\r\n        var graphic = new Path.Circle(P(0, 0), radius);\r\n        BasicShapes.applyCustom(appearance, function (fill) {\r\n            graphic.fillColor = new Color(new Gradient(shadingGradient(shading, fill), true), P(-radius / 2, -radius / 2), P(0, 1.5 * radius).rotate(45));\r\n        }, function (width, stroke) {\r\n            graphic.withStroke(width, stroke);\r\n        });\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: BasicShapes.bounds(graphic),\r\n        };\r\n    };\r\n    Sphere.properties = {\r\n        label: \"Sphere\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: __assign(__assign({}, BasicShapes.defaultAppearance), { shading: \"smooth\", radius: 50 }),\r\n        appearanceSpecs: __spreadArrays(BasicShapes.specs, [\r\n            BasicShapes.header,\r\n            {\r\n                spec: \"radio\", key: \"shading\", label: \"Shading\",\r\n                options: [\r\n                    { value: \"smooth\", label: \"Smooth\" },\r\n                    { value: \"hard\", label: \"Hard\" },\r\n                ],\r\n            }\r\n        ]),\r\n    };\r\n    return Sphere;\r\n}());\r\nexport { Sphere };\r\nfunction shadingGradient(shading, fill) {\r\n    switch (shading) {\r\n        case \"smooth\":\r\n            return [\r\n                [fill.color().ladd(35).hex(), 0.0],\r\n                [fill, 0.9],\r\n                [fill.color().ladd(-10).hex(), 1.0],\r\n            ];\r\n        case \"hard\":\r\n            return [\r\n                [fill.color().ladd(35).hex(), 0.3],\r\n                [fill, 0.7],\r\n                [fill.color().ladd(-10).hex(), 0.8],\r\n            ];\r\n    }\r\n}\r\n","export var LOGGED_OUT_STATE = {\r\n    state: \"logged_out\"\r\n};\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { drawPivotAndCenter } from \"apparatus/debug\";\r\nimport { createRectangleDriver } from \"apparatus/driver\";\r\nimport { apparatusClass } from \"apparatus/library\";\r\nimport { P, Pp, R, SharedColors, UIColors } from \"apparatus/library/common\";\r\nimport { SVG } from \"apparatus/svg\";\r\nimport { Interactable, SelectAndMove } from \"editing/interaction\";\r\nimport { MultiLiquid } from \"editing/multilayerliquids\";\r\nimport { transform } from \"editing/snapping/type\";\r\nimport { visualiseSnappings } from \"editing/snapping/visualise\";\r\nimport { clog } from \"log\";\r\nimport { Group } from \"paper\";\r\nimport * as React from \"react\";\r\nimport { Debug } from \"vars\";\r\nimport { strokeWidth } from \"./common\";\r\nvar DEBUG_REDRAWS = false;\r\n/**\r\n * React component for placing and rendering an apparatus. Every\r\n * apparatus that is displayed on screen is wrapped by this component.\r\n * It handles properties common to all apparatus such as\r\n * rotation, hit targets, liquids etc.\r\n *\r\n * Rendering is delegated to a specific sublcass of Apparatus, based on\r\n * the type of apparatus.\r\n */\r\nvar ApparatusComponent = /** @class */ (function (_super) {\r\n    __extends(ApparatusComponent, _super);\r\n    function ApparatusComponent(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        /** Interactable klass, to wrap hit shapes. */\r\n        _this.hitShapeWrapperKlass = Interactable(paper.Group, SelectAndMove(_this));\r\n        _this.id = props.id;\r\n        _this.item = new paper.Group();\r\n        _this.vizLayer = new paper.Group();\r\n        _this.hitShapeLayer = new Group();\r\n        _this.apparatusType = props.type;\r\n        // Instantiate apparatus instance.\r\n        var apparatusKlass = apparatusClass(_this.apparatusType);\r\n        _this.apparatus = new apparatusKlass();\r\n        // Add layers together.\r\n        _this.item.addChild(_this.hitShapeLayer);\r\n        // Set up initial state. Since this is the first time the\r\n        // item is drawn, we also need to re-render the apparatus.\r\n        _this.needsGraphicsRerender = true;\r\n        _this.needsLiquidUpdate = true;\r\n        _this.state = {\r\n            position: { x: _this.props.x, y: _this.props.y },\r\n            rotation: _this.props.rotation,\r\n            liquid: _this.props.liquid,\r\n            appearance: _this.props.appearance,\r\n        };\r\n        // Set up item.\r\n        _this.item.applyMatrix = false;\r\n        _this.vizLayer.applyMatrix = false;\r\n        // Set up layer for storing drivers.\r\n        var drivers = _this.apparatus.drivers;\r\n        _this.setUpDriversLayer(drivers);\r\n        if (DEBUG_REDRAWS)\r\n            clog(\"Constructed: \", _this.item);\r\n        return _this;\r\n    }\r\n    ApparatusComponent.prototype.UNSAFE_componentWillReceiveProps = function (nextProps) {\r\n        // Reset state.\r\n        // Note how redrawNeeded is computed: we want to redraw when\r\n        // the apparatus appearance attributes have changed. We compare\r\n        // the upcoming props with the current state (not props!) because\r\n        // the currently drawn image is based on the state.\r\n        // Note that we first compare if it's the exact same instance, then\r\n        // we do deep equals using JSON.stringify() because I am lazy.\r\n        // Comparison by \"==\" does not work: {a:1} == {a:1} is false.\r\n        var sameAppearance = this.state.appearance === nextProps.appearance ||\r\n            JSON.stringify(this.state.appearance) == JSON.stringify(nextProps.appearance);\r\n        this.needsGraphicsRerender = !sameAppearance;\r\n        var sameLiquid = sameAppearance &&\r\n            (this.state.liquid === nextProps.liquid ||\r\n                JSON.stringify(this.state.liquid) == JSON.stringify(nextProps.liquid));\r\n        this.needsLiquidUpdate = !sameLiquid;\r\n        // Update driver handles.\r\n        this.driverHandles.forEach(function (h) { return h.onPropsChanged(nextProps.appearance); });\r\n        this.setState({\r\n            position: { x: nextProps.x, y: nextProps.y },\r\n            rotation: nextProps.rotation,\r\n            liquid: nextProps.liquid,\r\n            appearance: nextProps.appearance,\r\n        });\r\n    };\r\n    ApparatusComponent.prototype.componentWillUnmount = function () {\r\n        this.item.remove();\r\n        this.vizLayer.remove();\r\n        this.hitShapeLayer.remove();\r\n        if (this.liquidLayer != null) {\r\n            this.liquidLayer.remove();\r\n        }\r\n    };\r\n    ApparatusComponent.prototype.ensureSnappingLayer = function () {\r\n        if (this.snappingLayer === undefined) {\r\n            var snappingLayer = new paper.Group();\r\n            this.vizLayer.addChild(snappingLayer);\r\n            this.snappingLayer = snappingLayer;\r\n        }\r\n    };\r\n    Object.defineProperty(ApparatusComponent.prototype, \"currentPosition\", {\r\n        /** Returns the current position, based on app props. */\r\n        get: function () {\r\n            return new paper.Point(this.props.x, this.props.y);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApparatusComponent.prototype, \"visiblePosition\", {\r\n        /** Returns actual position, based on drawn graphic. */\r\n        get: function () {\r\n            return new paper.Point(this.item.position.x, this.item.position.y);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApparatusComponent.prototype, \"currentRotation\", {\r\n        /** Returns the current rotation, based on app state, in degrees. */\r\n        get: function () {\r\n            return this.props.rotation;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApparatusComponent.prototype, \"visibleRotation\", {\r\n        /** Returns the actual rotation, based on drawn graphic, in degrees. */\r\n        get: function () {\r\n            return this.item.rotation;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApparatusComponent.prototype, \"bounds\", {\r\n        get: function () {\r\n            return this.item.strokeBounds;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApparatusComponent.prototype, \"alignmentBounds\", {\r\n        get: function () {\r\n            return this.bounds;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApparatusComponent.prototype, \"isSelected\", {\r\n        get: function () {\r\n            return this.props.selected;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApparatusComponent.prototype, \"parentGroup\", {\r\n        get: function () {\r\n            return this.props.parentGroup;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    ApparatusComponent.prototype.forceCompleteRerender = function () {\r\n        this.needsGraphicsRerender = true;\r\n        this.needsLiquidUpdate = true;\r\n    };\r\n    ApparatusComponent.prototype.setPositionDelta = function (delta) {\r\n        this.setState({\r\n            position: {\r\n                x: this.props.x + delta.x,\r\n                y: this.props.y + delta.y,\r\n            }\r\n        });\r\n    };\r\n    ApparatusComponent.prototype.setRotationDelta = function (delta, pivot) {\r\n        var position = Pp(this.props);\r\n        var newPosition = position.rotate(delta, pivot);\r\n        this.setState({\r\n            position: newPosition,\r\n            rotation: this.props.rotation + delta,\r\n        });\r\n    };\r\n    /** Updates current apparatus appearance state. */\r\n    ApparatusComponent.prototype.updateAppearanceAttributes = function (key, value) {\r\n        // Make a copy of the current appearance state, overlay passed\r\n        // attributes and then set it as the new state.\r\n        // Appearance changes will always need a redraw.\r\n        var newAppearance = __assign({}, this.state.appearance);\r\n        newAppearance[key] = value;\r\n        this.needsGraphicsRerender = true;\r\n        this.needsLiquidUpdate = true;\r\n        this.setState({\r\n            appearance: newAppearance\r\n        });\r\n    };\r\n    /** Updates current apparatus appearance state. */\r\n    ApparatusComponent.prototype.updateMultipleAppearanceAttributes = function (partialAppearance) {\r\n        var newAppearance = __assign(__assign({}, this.state.appearance), partialAppearance);\r\n        this.needsGraphicsRerender = true;\r\n        this.needsLiquidUpdate = true;\r\n        this.setState({\r\n            appearance: newAppearance\r\n        });\r\n    };\r\n    /** Helper for updating liquid state */\r\n    ApparatusComponent.prototype.updateLiquidData = function (liquidData) {\r\n        this.needsLiquidUpdate = true;\r\n        this.setState({\r\n            liquid: liquidData\r\n        });\r\n    };\r\n    /** Converts a point in local coordinate to global. */\r\n    ApparatusComponent.prototype.localToGlobal = function (p) {\r\n        return p\r\n            .subtract(this.item.pivot)\r\n            .multiply([this.props.flipped ? -1 : 1, 1])\r\n            .rotate(this.props.rotation)\r\n            .add(this.item.position);\r\n    };\r\n    // Possibly do this only once!\r\n    ApparatusComponent.prototype.recalculateGlobalSnapping = function () {\r\n        var _this = this;\r\n        if (this.snapping.length === 0) {\r\n            return [];\r\n        }\r\n        return this.snapping.map(function (s) {\r\n            return transform(s, _this.props.flipped, function (p) { return _this.localToGlobal(p); });\r\n        });\r\n    };\r\n    ApparatusComponent.prototype.setUpSnappingVisualisationLayer = function () {\r\n        var _a, _b, _c;\r\n        var hasSnappingData = this.snapping.length > 0;\r\n        if (hasSnappingData) {\r\n            this.ensureSnappingLayer();\r\n            (_a = this.snappingLayer) === null || _a === void 0 ? void 0 : _a.removeChildren();\r\n        }\r\n        else {\r\n            // Remove layer containing the snap points.\r\n            (_b = this.snappingLayer) === null || _b === void 0 ? void 0 : _b.removeChildren();\r\n            (_c = this.snappingLayer) === null || _c === void 0 ? void 0 : _c.remove();\r\n            this.snappingLayer = undefined;\r\n        }\r\n    };\r\n    /** Note this is an expensive operation! */\r\n    ApparatusComponent.prototype.setUpDriversLayer = function (drivers) {\r\n        var _a;\r\n        if (!drivers || drivers.length == 0) {\r\n            // Clear all drivers.\r\n            (_a = this.driversLayer) === null || _a === void 0 ? void 0 : _a.remove();\r\n            this.driversLayer = undefined;\r\n            this.driverHandles = [];\r\n            return;\r\n        }\r\n        if (!this.driversLayer) {\r\n            var driversLayer = new paper.Group();\r\n            this.vizLayer.addChild(driversLayer);\r\n            this.driverHandles = [];\r\n            this.driversLayer = driversLayer;\r\n        }\r\n        for (var _i = 0, drivers_1 = drivers; _i < drivers_1.length; _i++) {\r\n            var driver = drivers_1[_i];\r\n            switch (driver.type) {\r\n                case \"rectangle\":\r\n                    var driverHandle = createRectangleDriver(driver, this);\r\n                    this.driverHandles.push(driverHandle);\r\n                    this.driversLayer.addChild(driverHandle.handle);\r\n            }\r\n        }\r\n    };\r\n    ApparatusComponent.prototype.render = function () {\r\n        var _this = this;\r\n        var _a, _b, _c, _d;\r\n        var watermarkPosition;\r\n        // Render apparatus.\r\n        if (this.needsGraphicsRerender) {\r\n            if (DEBUG_REDRAWS)\r\n                clog(\"Redraw: \", this.item);\r\n            this.needsGraphicsRerender = false;\r\n            var _e = this.apparatus.render(this.state.appearance), graphic = _e.graphic, pivot = _e.pivot, xray = _e.xray, hitShape = _e.hitShape, liquidMask = _e.liquidMask, snapping = _e.snapping, watermark = _e.watermark;\r\n            // Watermark position is used later.\r\n            watermarkPosition = watermark;\r\n            if (this.graphicLayer != null) {\r\n                this.graphicLayer.replaceWith(graphic);\r\n            }\r\n            else {\r\n                this.item.insertChild(0, graphic);\r\n            }\r\n            this.graphicLayer = graphic;\r\n            // Set up Pivot if specified, otherwise take center.\r\n            var mainPivot = pivot ? pivot : graphic.bounds.center;\r\n            this.item.pivot = mainPivot;\r\n            this.vizLayer.pivot = this.item.pivot;\r\n            drawPivotAndCenter(this.item, \"orange\");\r\n            // Update Xray.\r\n            if (xray) {\r\n                if (!this.xrayLayer) {\r\n                    this.xrayLayer = new Group();\r\n                    this.vizLayer.insertChild(0, this.xrayLayer);\r\n                }\r\n                this.xrayLayer.removeChildren();\r\n                this.xrayLayer.addChild(xray);\r\n                this.xrayLayer.withStroke(2.0, UIColors.hintFill);\r\n            }\r\n            else {\r\n                (_a = this.xrayLayer) === null || _a === void 0 ? void 0 : _a.remove();\r\n                this.xrayLayer = undefined;\r\n            }\r\n            // Update Hit shape.\r\n            this.hitShapeLayer.removeChildren();\r\n            if (hitShape instanceof paper.Shape || hitShape instanceof paper.Path) {\r\n                if (hitShape instanceof paper.Path && !hitShape.closed) {\r\n                    hitShape.closePath();\r\n                }\r\n                this.hitShapeLayer.addChild(new (Interactable(paper.Group, SelectAndMove(this)))([hitShape]));\r\n            }\r\n            else {\r\n                this.hitShapeLayer.addChildren(hitShape.map(function (h) { return new _this.hitShapeWrapperKlass([h]); }));\r\n            }\r\n            // Update liquid layer.\r\n            if (liquidMask != null) {\r\n                // Initialise the liquid layer.\r\n                var liquidLayer = new paper.Group();\r\n                liquidLayer.applyMatrix = false;\r\n                liquidLayer.clipped = Debug.LIQUID_MASK ? false : true;\r\n                // Insert layer into hierarchy.\r\n                if (this.liquidLayer != null) {\r\n                    this.liquidLayer.replaceWith(liquidLayer);\r\n                }\r\n                else {\r\n                    this.item.insertChild(0, liquidLayer);\r\n                }\r\n                this.liquidLayer = liquidLayer;\r\n                // Add liquid mask.\r\n                liquidLayer.addChild(liquidMask);\r\n                liquidMask.applyMatrix = false;\r\n                liquidMask.clipMask = Debug.LIQUID_MASK ? false : true;\r\n                liquidMask.fillColor = \"red\";\r\n                // Set up positions of items.\r\n                liquidLayer.pivot = mainPivot;\r\n                liquidMask.pivot = mainPivot;\r\n                // Create liquid.\r\n                var liquid = paper.Shape.Rectangle(R(0, 0, 100.0, 100.0));\r\n                liquid.fillColor = new paper.Color(0.5, 0.8, 0.9, 0.3);\r\n                liquid.strokeWidth = strokeWidth(\"liquid\");\r\n                // WEIRD!!! If strokeScaling is disabled, then somehow gradients\r\n                // also stop being relative to the item and are instead relative\r\n                // to global coordinates! WTF?\r\n                // liquid.strokeScaling = false\r\n                liquid.applyMatrix = false;\r\n                liquid.position = mainPivot;\r\n                liquid.pivot = new paper.Point(0, 0);\r\n                liquidLayer.addChild(liquid);\r\n                drawPivotAndCenter(liquidLayer, \"blue\", 8.0);\r\n            }\r\n            else {\r\n                // Remove the liquid layer.\r\n                (_b = this.liquidLayer) === null || _b === void 0 ? void 0 : _b.removeChildren();\r\n                (_c = this.liquidLayer) === null || _c === void 0 ? void 0 : _c.remove();\r\n                this.liquidLayer = undefined;\r\n            }\r\n            // Snap points.\r\n            this.snapping = snapping ? ((snapping instanceof Array) ? snapping : [snapping]) : [];\r\n            // Create a layer containing snap points.\r\n            this.setUpSnappingVisualisationLayer();\r\n            // Set other flags.\r\n            this.updateSnapVisualisationNeeded = true;\r\n            // Update drivers.\r\n            this.driverHandles.forEach(function (h) { return h.onStateChanged(_this.state.appearance); });\r\n        }\r\n        // Set position\r\n        this.item.position.x = this.state.position.x;\r\n        this.item.position.y = this.state.position.y;\r\n        this.vizLayer.position.x = this.state.position.x;\r\n        this.vizLayer.position.y = this.state.position.y;\r\n        // Flip.\r\n        this.item.scaling = P(this.props.flipped ? -1 : 1, 1);\r\n        this.vizLayer.scaling = this.item.scaling;\r\n        // Set rotation\r\n        this.item.rotation = this.state.rotation;\r\n        this.vizLayer.rotation = this.state.rotation;\r\n        // Update position of snap points.\r\n        this.globalSnapping = this.recalculateGlobalSnapping();\r\n        // Change selection state.\r\n        if (Debug.SHAPES) {\r\n            this.graphicLayer.fullySelected = this.props.selected;\r\n        }\r\n        // Show hit shape if selected.\r\n        this.hitShapeLayer.fillColor = SharedColors.selectionGreen + '80';\r\n        this.hitShapeLayer.strokeColor = SharedColors.selectionGreen;\r\n        if (this.props.selected) {\r\n            this.hitShapeLayer.strokeWidth = 2.0;\r\n            this.hitShapeLayer.opacity = 0.5;\r\n            this.hitShapeLayer.blendMode = \"normal\";\r\n            if (this.props.liquid) {\r\n                this.hitShapeLayer.fillColor = \"#00000001\";\r\n            }\r\n        }\r\n        else {\r\n            this.hitShapeLayer.strokeWidth = 0.0;\r\n            this.hitShapeLayer.opacity = 0.000001;\r\n            this.hitShapeLayer.blendMode = \"normal\";\r\n        }\r\n        if (this.driversLayer) {\r\n            this.driversLayer.visible = this.props.selected;\r\n        }\r\n        if (this.xrayLayer) {\r\n            this.xrayLayer.visible = this.props.selected;\r\n        }\r\n        // if (this.props.selected) {\r\n        //     this.item.strokeColor = SharedColors.selectionGreen\r\n        // } else {\r\n        //     this.item.strokeColor = null\r\n        // }\r\n        // Update liquid.\r\n        if (this.state.liquid && this.liquidLayer) {\r\n            var liquidMaskItem = this.liquidLayer.children[0];\r\n            var liquidShape = this.liquidLayer.children[1];\r\n            var rotation = this.state.rotation * (this.props.flipped ? -1 : 1);\r\n            var isRotationChanged = this.lastLiquidRotation != rotation;\r\n            this.lastLiquidRotation = rotation;\r\n            // Rotate the liquid layer back and then rotate the mask.\r\n            this.liquidLayer.rotation = -rotation;\r\n            liquidMaskItem.rotation = rotation;\r\n            if (this.needsLiquidUpdate || isRotationChanged) {\r\n                this.needsLiquidUpdate = false;\r\n                // Update amount.\r\n                var liquidAmount = this.state.liquid.amountRatio;\r\n                if (liquidAmount > 0.001) {\r\n                    var liquidBounds = liquidMaskItem.bounds;\r\n                    // Calculate the height of the liquid.\r\n                    var liquidHeight = Math.max(1, liquidAmount * liquidBounds.height - 2.0);\r\n                    // // Adjustments to hide the stroke on all sides except top.\r\n                    // liquidShape.bounds.width += 4\r\n                    // liquidShape.bounds.x -= 2\r\n                    // liquidShape.bounds.height += 2\r\n                    liquidShape.size.height = liquidHeight;\r\n                    liquidShape.size.width = liquidBounds.width;\r\n                    liquidShape.bounds.bottom = liquidBounds.bottom;\r\n                    liquidShape.bounds.left = liquidBounds.left;\r\n                    liquidShape.visible = true;\r\n                }\r\n                else {\r\n                    liquidShape.visible = false;\r\n                }\r\n                // Update color. Thist must be done after the liquid's\r\n                // bounds have been updated, otherwise the colour \"jumps\".\r\n                var mainLiquidColour = this.state.liquid.color.color().alpha(this.state.liquid.alpha).toString();\r\n                if (this.state.liquid.layers.length > 0) {\r\n                    liquidShape.setGradientFill(\"up\", MultiLiquid.toGradientStops(this.state.liquid.layers, mainLiquidColour));\r\n                }\r\n                else {\r\n                    liquidShape.fillColor = mainLiquidColour;\r\n                }\r\n                liquidShape.strokeColor = this.state.liquid.color;\r\n            }\r\n        }\r\n        // Watermarking.\r\n        if (this.props.isWatermarkEnabled) {\r\n            this.graphicLayer.opacity = 0.5;\r\n            if (!this.watermarkLayer) {\r\n                this.watermarkLayer = SVG.boostBadge();\r\n                this.vizLayer.addChild(this.watermarkLayer);\r\n            }\r\n            if (watermarkPosition) {\r\n                this.watermarkLayer.position = watermarkPosition;\r\n            }\r\n        }\r\n        else {\r\n            this.graphicLayer.opacity = 1.0;\r\n            (_d = this.watermarkLayer) === null || _d === void 0 ? void 0 : _d.remove();\r\n            this.watermarkLayer = undefined;\r\n        }\r\n        // Hit shape debugging.\r\n        if (Debug.HIT_SHAPES) {\r\n            this.hitShapeLayer.fillColor = \"red\";\r\n            this.hitShapeLayer.opacity = 0.8;\r\n        }\r\n        return null;\r\n    };\r\n    ApparatusComponent.prototype.componentDidUpdate = function (prevProps, prevState) {\r\n        if (prevState.visualiseSnapping != this.state.visualiseSnapping) {\r\n            this.updateSnapVisualisationNeeded = true;\r\n        }\r\n        // Display snap points.\r\n        this.maybeRenderSnappings();\r\n    };\r\n    ApparatusComponent.prototype.maybeRenderSnappings = function () {\r\n        if (!this.snappingLayer)\r\n            return;\r\n        if (!this.updateSnapVisualisationNeeded)\r\n            return;\r\n        this.updateSnapVisualisationNeeded = false;\r\n        this.snappingLayer.removeChildren();\r\n        if (this.state.visualiseSnapping) {\r\n            visualiseSnappings(this.snappingLayer, this.snapping, this.state.visualiseSnapping);\r\n        }\r\n    };\r\n    return ApparatusComponent;\r\n}(React.Component));\r\nexport { ApparatusComponent };\r\n","var __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { setDefaultStyle } from \"apparatus/draw\";\r\nimport { DEFAULT_LIQUID_DATA, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nimport { setLiquidStyle } from \"../../draw\";\r\nvar Manometer = /** @class */ (function () {\r\n    function Manometer() {\r\n    }\r\n    Manometer.prototype.render = function (appearance) {\r\n        // Length above the bend.\r\n        var length = appearance.size * 4;\r\n        var diameter = 20;\r\n        var innerRadius = appearance.size;\r\n        var outerRadius = innerRadius + diameter;\r\n        var outerShell = new Path(Segments([[-outerRadius, -length]], [[-outerRadius, 0], undefined, [0, outerRadius * 1.4]], [[outerRadius, 0], [0, outerRadius * 1.4]], [[outerRadius, -length]]));\r\n        var innerShell = new Path(Segments([[-innerRadius, -length]], [[-innerRadius, 0], undefined, [0, innerRadius * 1.4]], [[innerRadius, 0], [0, innerRadius * 1.4]], [[innerRadius, -length]]));\r\n        setDefaultStyle(outerShell, innerShell);\r\n        innerShell.reverse();\r\n        var fluid = new (Path.bind.apply(Path, __spreadArrays([void 0], outerShell.segments.map(function (s) { return s.clone(); }), innerShell.segments.map(function (s) { return s.clone(); }))))();\r\n        fluid.closePath();\r\n        // Choose levels on either side. Keep it below length.\r\n        var rightLevel = (appearance.balance + 1) / 2 * length;\r\n        var leftLevel = (1 - (appearance.balance + 1) / 2) * length;\r\n        fluid.segments[0].point.y = -leftLevel;\r\n        fluid.segments[7].point.y = -leftLevel;\r\n        fluid.segments[3].point.y = -rightLevel;\r\n        fluid.segments[4].point.y = -rightLevel;\r\n        setLiquidStyle(fluid, appearance.color);\r\n        var graphic = new Group([fluid, innerShell, outerShell]);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            watermark: graphic.bounds.bottomCenter,\r\n        };\r\n    };\r\n    Manometer.properties = {\r\n        label: \"Manometer\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            size: 40,\r\n            color: DEFAULT_LIQUID_DATA.color,\r\n            balance: 0.2,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 25, max: 60,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"balance\", label: \"Liquid balance\",\r\n                min: -1, max: 1, step: 0.01,\r\n            },\r\n            {\r\n                spec: \"color\", key: \"color\", label: \"Colour\",\r\n            }\r\n        ],\r\n    };\r\n    return Manometer;\r\n}());\r\nexport { Manometer };\r\n","import { mirrorX } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { Pivot, R, Segments, SharedColors } from \"apparatus/library/common\";\r\nimport { drawArrowHead } from \"apparatus/library/shapes/curve\";\r\nimport { Group, Path } from \"paper\";\r\nvar Centrifuge = /** @class */ (function () {\r\n    function Centrifuge() {\r\n    }\r\n    Centrifuge.prototype.render = function (appearance) {\r\n        var wall = new Path(Segments([[-87, 0], , [-73, 89]], [[-114, 160], [-59, -26], [50, 22]])).withStroke(\"thick\").withFill(\"#ffffffe2\");\r\n        mirrorX(wall);\r\n        var lid = new Path.Rectangle(R(0, 0, 87 * 2, 20, Pivot.BOTTOM_CENTER))\r\n            .withGradientFill(\"right\", Gradients.cylinder(SharedColors.lightMetal.color()))\r\n            .withStroke(\"thin\");\r\n        var lid2 = new Path.Rectangle(R(0, -20, 40, 15, Pivot.BOTTOM_CENTER))\r\n            .withGradientFill(\"right\", Gradients.cylinder(SharedColors.lightMetal.color()))\r\n            .withStroke(\"thin\");\r\n        var motor = new Path(Segments([[12, 0]], [[22, 59]], [[62, 100], , [-17, 2]], [[18, 104]], [[31, 123], , [24, 0]], [[79, 151], [0, -30]])).close()\r\n            .withStroke(\"default\", SharedColors.mediumMetal)\r\n            .withGradientFill(\"right\", Gradients.cylinder(\"#cccccc\".color(), 2));\r\n        mirrorX(motor);\r\n        motor.position.y += 72;\r\n        var graphic = new Group([motor, wall, lid, lid2]);\r\n        if (appearance.showArrow) {\r\n            var arrowPath = new Path(Segments([[116, 170], , [-39, 55]]));\r\n            mirrorX(arrowPath);\r\n            var head = drawArrowHead(arrowPath.segments[arrowPath.segments.length - 1], \"handleIn\", 16, { adjustAngle: -4 });\r\n            var arrow = new Group([arrowPath, head]).withStroke(\"thicker\", \"#407af3\");\r\n            graphic.addChild(arrow);\r\n        }\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: graphic.placeable(),\r\n        };\r\n    };\r\n    Centrifuge.properties = {\r\n        label: \"Centrifuge\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: {\r\n            showArrow: false\r\n        },\r\n        appearanceSpecs: [\r\n            { spec: \"checkbox\", key: \"showArrow\", label: \"Show\", subLabel: \"Arrow\" },\r\n        ],\r\n    };\r\n    return Centrifuge;\r\n}());\r\nexport { Centrifuge };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { P } from \"apparatus/library/common\";\r\nimport { BasicShapes } from \"apparatus/library/shapes/common\";\r\nimport { Group, Path, Segment } from \"paper\";\r\nvar Cuboid = /** @class */ (function () {\r\n    function Cuboid() {\r\n        this.drivers = [\r\n            {\r\n                type: \"rectangle\",\r\n                minX: 6, maxX: 600,\r\n                minY: 8, maxY: 600,\r\n                toAppearance: function (p) { return ({\r\n                    height: p.y,\r\n                    width: p.x\r\n                }); },\r\n                fromAppearance: function (a) { return P(a.width, a.height); },\r\n                scale: 2.0,\r\n            }\r\n        ];\r\n    }\r\n    Cuboid.isBoostRequiredForAppearance = function (appearance) {\r\n        // return appearance.shading === \"3d\"\r\n        return false;\r\n    };\r\n    /**\r\n            P6               P5\r\n            +----------------+\r\n            |                |\r\n      P3+---+-----------+P2  |\r\n        |               |    |\r\n        |               |    |\r\n        |               +----+ P4\r\n        |               |\r\n        |               |\r\n        +---------------+\r\n      PO                 P1\r\n\r\n     */\r\n    Cuboid.prototype.render = function (appearance) {\r\n        var width = appearance.width, height = appearance.height, depth = appearance.depth;\r\n        var depthVector = P(depth, -depth / 2);\r\n        var p3 = P(0, 0);\r\n        var p0 = P(0, height);\r\n        var p1 = P(width, height);\r\n        var p2 = P(width, 0);\r\n        var p6 = p3.add(depthVector);\r\n        var p5 = p2.add(depthVector);\r\n        var p4 = p1.add(depthVector);\r\n        var frontWall = new Path([\r\n            new Segment(p0),\r\n            new Segment(p1),\r\n            new Segment(p2),\r\n            new Segment(p3),\r\n        ]).close();\r\n        var topWall = new Path([\r\n            new Segment(p3),\r\n            new Segment(p2),\r\n            new Segment(p5),\r\n            new Segment(p6),\r\n        ]).close();\r\n        var sideWall = new Path([\r\n            new Segment(p1),\r\n            new Segment(p4),\r\n            new Segment(p5),\r\n            new Segment(p2),\r\n        ]).close();\r\n        var graphic = new Group([frontWall, topWall, sideWall]);\r\n        BasicShapes.applyCustom(appearance, function (fill) {\r\n            frontWall.fillColor = fill;\r\n            topWall.fillColor = fill.color().ladd(5).string();\r\n            sideWall.fillColor = fill.color().ladd(-5).string();\r\n        }, function (width, stroke) {\r\n            var outline = new Path([p0, p1, p4, p5, p6, p3].map(function (p) { return new Segment(p); }))\r\n                .close()\r\n                .withStroke(width, stroke);\r\n            graphic.addChild(outline);\r\n        });\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: BasicShapes.bounds(graphic),\r\n            pivot: P(width / 2, height / 2)\r\n        };\r\n    };\r\n    Cuboid.properties = {\r\n        label: \"Cuboid\",\r\n        canContainLiquids: false,\r\n        flippable: true,\r\n        defaultAppearance: __assign(__assign({}, BasicShapes.defaultAppearance), { width: 120, height: 100, depth: 50 }),\r\n        appearanceSpecs: __spreadArrays(BasicShapes.specs, [\r\n            BasicShapes.header,\r\n            {\r\n                spec: \"slider\", key: \"depth\", label: \"Depth\",\r\n                min: 0, max: 200\r\n            }\r\n        ]),\r\n    };\r\n    return Cuboid;\r\n}());\r\nexport { Cuboid };\r\n","import { breakPathClosed, setDefaultStyle } from \"apparatus/draw\";\r\nimport { P, Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { Path } from \"paper\";\r\nvar OilBubbler = /** @class */ (function () {\r\n    function OilBubbler() {\r\n    }\r\n    OilBubbler.prototype.render = function (appearance) {\r\n        var body = new Path.Rectangle(R(0, 0, 60, 180, Pivot.TOP_CENTER), 30);\r\n        var inlet = new Path(Segments([[-8, 10]], [[-8, -20], , [0, -8]], [[-20, -32], [8, 0]], [[-50, -32]], [[-50, -47]], [[-20, -47], , [18, 0]], [[8, -20], [0, -18]], [[8, 10]]));\r\n        inlet.closePath();\r\n        var outlet = new Path.Rectangle(R(0, 60, 60, 12, Pivot.CENTER_LEFT));\r\n        var liquidMaskSubtract = new Path.Rectangle(R(0, 0, 100, 70, Pivot.TOP_CENTER));\r\n        var liquidMask = body.subtract(liquidMaskSubtract);\r\n        var graphic = breakPathClosed(inlet.unite(body).unite(outlet), 3, 10);\r\n        // Inner funnel\r\n        var funnelR = new Path(Segments([[30, 40], , [0, 15]], [[5, 70], [0, -15]], [[5, 145]]));\r\n        var funnelL = funnelR.clone();\r\n        funnelL.scale(-1, 1, P(0, 0));\r\n        graphic.addChildren([funnelR, funnelL]);\r\n        setDefaultStyle(graphic);\r\n        return {\r\n            graphic: graphic,\r\n            liquidMask: liquidMask,\r\n            hitShape: graphic.bounds.toShape(),\r\n            snapping: [\r\n                { type: \"connectable\", at: P(-50, -39.5), facing: -90 },\r\n                { type: \"connectable\", at: P(60, 60), facing: 90 },\r\n            ]\r\n        };\r\n    };\r\n    OilBubbler.properties = {\r\n        label: \"Oil Bubbler\",\r\n        canContainLiquids: true,\r\n        flippable: true,\r\n        defaultAppearance: {},\r\n        appearanceSpecs: [],\r\n    };\r\n    return OilBubbler;\r\n}());\r\nexport { OilBubbler };\r\n","var __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { apparatusClass } from \"apparatus/library\";\r\nimport { Select } from \"command/basic\";\r\nimport { Sequence } from \"command/command\";\r\nimport { BreakGroup, GroupObjects } from \"editing/grouping/commands\";\r\nimport { getRootGroup } from \"editing/grouping/operations\";\r\nimport { Arrays } from \"ext/array\";\r\nimport appStore from \"store/store\";\r\nimport { pluralize } from \"utils\";\r\n/**\r\n * Stores data about currently selected items and decisions about\r\n * the behaviour of the app based on those items.\r\n */\r\nvar Selected = /** @class */ (function () {\r\n    function Selected(items, arrows) {\r\n        var _a, _b;\r\n        this.items = items;\r\n        this.arrows = arrows;\r\n        // Join all items.\r\n        var allItems = __spreadArrays(items, arrows);\r\n        // Check for consistent type.\r\n        this.sameApparatusType = (_a = items[0]) === null || _a === void 0 ? void 0 : _a.type;\r\n        for (var _i = 0, items_1 = items; _i < items_1.length; _i++) {\r\n            var item = items_1[_i];\r\n            if (item.type != items[0].type) {\r\n                this.sameApparatusType = undefined;\r\n                break;\r\n            }\r\n        }\r\n        this.sameApparatusKind = ((_b = items[0]) === null || _b === void 0 ? void 0 : _b.type) ? apparatusClass(items[0].type).properties.kind : undefined;\r\n        for (var _c = 0, items_2 = items; _c < items_2.length; _c++) {\r\n            var item = items_2[_c];\r\n            if (apparatusClass(item.type).properties.kind !== apparatusClass(items[0].type).properties.kind) {\r\n                this.sameApparatusKind = undefined;\r\n                break;\r\n            }\r\n        }\r\n        this.isItemsWithLiquidOnly = this.arrows.length == 0 && this.items.every(function (i) { return i.liquid !== undefined; });\r\n        var itemsNotInGroups = [];\r\n        var arrowsNotInGroups = [];\r\n        var rootGroupIds = [];\r\n        var rootGroups = [];\r\n        for (var _d = 0, allItems_1 = allItems; _d < allItems_1.length; _d++) {\r\n            var item = allItems_1[_d];\r\n            if (item.parentGroup) {\r\n                var rootGroup = getRootGroup(item.parentGroup);\r\n                if (!Arrays.includes(rootGroupIds, rootGroup.id)) {\r\n                    rootGroupIds.push(rootGroup.id);\r\n                    rootGroups.push(rootGroup);\r\n                }\r\n            }\r\n            else {\r\n                switch (item.id.type) {\r\n                    case \"apparatus\":\r\n                        itemsNotInGroups.push(item);\r\n                        break;\r\n                    case \"arrow\":\r\n                        arrowsNotInGroups.push(item);\r\n                        break;\r\n                    case \"group\":\r\n                        continue;\r\n                }\r\n            }\r\n        }\r\n        this.rootGroups = rootGroups;\r\n        this.standaloneItems = itemsNotInGroups;\r\n        this.standaloneArrows = arrowsNotInGroups;\r\n    }\r\n    Selected.prototype.getConsistentItemsLiquidColor = function () {\r\n        var _a, _b, _c;\r\n        var color = (_b = (_a = this.items[0].liquid) === null || _a === void 0 ? void 0 : _a.color) !== null && _b !== void 0 ? _b : \"\";\r\n        if (this.items.length == 1)\r\n            return color;\r\n        for (var _i = 0, _d = this.items; _i < _d.length; _i++) {\r\n            var item = _d[_i];\r\n            if (((_c = item.liquid) === null || _c === void 0 ? void 0 : _c.color) !== color)\r\n                return;\r\n        }\r\n        return color;\r\n    };\r\n    Object.defineProperty(Selected.prototype, \"isEmpty\", {\r\n        get: function () {\r\n            return this.items.length == 0 && this.arrows.length == 0;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Selected.prototype, \"standaloneObjectsCount\", {\r\n        get: function () {\r\n            return this.standaloneArrows.length + this.standaloneItems.length;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Selected.prototype, \"groupsCount\", {\r\n        get: function () {\r\n            return this.rootGroups.length;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Selected.prototype, \"displayString\", {\r\n        /** Returns the display string, e.g. \"2 groups & 1 item selected\" */\r\n        get: function () {\r\n            if (this.groupsCount == 0) {\r\n                return pluralize(this.standaloneObjectsCount, \"item\") + \" selected\";\r\n            }\r\n            if (this.standaloneObjectsCount == 0) {\r\n                return pluralize(this.groupsCount, \"group\") + \" selected\";\r\n            }\r\n            return pluralize(this.groupsCount, \"group\") + \" & \" + pluralize(this.standaloneObjectsCount, \"item\") + \" selected\";\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Selected.prototype, \"shouldAllowGrouping\", {\r\n        get: function () { return this.standaloneObjectsCount + this.groupsCount >= 2; },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Selected.prototype, \"shouldAllowUngrouping\", {\r\n        get: function () { return this.groupsCount == 1 && this.standaloneObjectsCount == 0; },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Selected.prototype, \"shouldAllowRegrouping\", {\r\n        get: function () {\r\n            return (this.items.length == 1)\r\n                && Selected.lastRegroupData.ids.length > 0\r\n                && Arrays.includes(Selected.lastRegroupData.ids, this.items[0].id);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /** Returns a command to group selected objects. Returns undefined on no-op. */\r\n    Selected.prototype.createGroupObjectsCommand = function () {\r\n        if (!this.shouldAllowGrouping)\r\n            return;\r\n        Selected.lastRegroupData.ids = [];\r\n        var ids = __spreadArrays(this.rootGroups, this.standaloneArrows, this.standaloneItems).map(function (i) { return i.id; });\r\n        return new GroupObjects(ids);\r\n    };\r\n    /** Returns a command to ungroup selected objects. Returns undefined on no-op. */\r\n    Selected.prototype.createUngroupObjectsCommand = function () {\r\n        if (!this.shouldAllowUngrouping)\r\n            return;\r\n        Selected.lastRegroupData.ids = this.rootGroups[0].items;\r\n        return new BreakGroup(this.rootGroups[0]);\r\n    };\r\n    /** Returns a command to re-group selected item. Returns undefined on no-op. */\r\n    Selected.prototype.createRegroupObjectsCommand = function () {\r\n        if (!this.shouldAllowRegrouping)\r\n            return;\r\n        var existingIds = appStore.filterExisting(Selected.lastRegroupData.ids);\r\n        // Remove Ids of objects that have already been selected.\r\n        var selecteIds = __spreadArrays(this.items, this.arrows).map(function (i) { return i.id; });\r\n        var toSelectIds = existingIds.filter(function (id) { return !Arrays.includes(selecteIds, id); });\r\n        Selected.lastRegroupData.ids = [];\r\n        // Select unselected items and then regroup items.\r\n        return new Sequence([\r\n            new Select(toSelectIds),\r\n            new GroupObjects(existingIds)\r\n        ]);\r\n    };\r\n    Selected.lastRegroupData = { ids: [] };\r\n    return Selected;\r\n}());\r\nexport { Selected };\r\n","// Tutorial\r\nimport { g } from \"./analytics\";\r\nimport { IntroJs } from \"./shim-types\";\r\nexport function runTutorial() {\r\n    var stepsCompleted = 0;\r\n    introJs()\r\n        .setOptions({\r\n        showStepNumbers: false,\r\n        tooltipPosition: true,\r\n        overlayOpacity: 0.5,\r\n        nextLabel: \"Next <i class='fa fa-arrow-right'></i>\",\r\n        prevLabel: \"&nbsp;<i class='fa fa-arrow-left'></i>&nbsp;\",\r\n        hidePrev: true,\r\n        hideNext: true,\r\n        steps: [\r\n            {\r\n                element: \"#sidebar\",\r\n                intro: \"Start by adding apparatus here.\",\r\n                position: IntroJs.Position.RIGHT\r\n            },\r\n            {\r\n                element: \"#apparatus-search\",\r\n                intro: \"You can also search them by name.\"\r\n            },\r\n            {\r\n                element: \"#property-panel .content-container\",\r\n                intro: \"You can modify properties of selected items from here.\"\r\n            },\r\n            {\r\n                element: \"#toolbox\",\r\n                intro: \"Use tools to <br>- <b>select, move, rotate</b> items<br>- <b>pan</b> the workspace and <br>- <b>add arrows and labels</b>.\"\r\n            },\r\n            {\r\n                element: \"#history-toolbox\",\r\n                intro: \"Undo/Redo from here.\"\r\n            },\r\n            {\r\n                element: \"#menu-export\",\r\n                intro: \"Once done, download your diagram as an image.\",\r\n            },\r\n            {\r\n                element: \"#cloud-menu\",\r\n                intro: \"Save your diagram to the cloud, so you can come back to them later.\",\r\n            },\r\n            {\r\n                element: \".BeaconFabButtonFrame\",\r\n                intro: \"That's it! If you run into problems or want to ask questions, send us feedback!\",\r\n                position: IntroJs.Position.LEFT,\r\n            }\r\n        ]\r\n    })\r\n        .onchange(function () {\r\n        stepsCompleted++;\r\n    })\r\n        .onexit(function () {\r\n        g(\"Intro2\", \"Exit\", stepsCompleted);\r\n    })\r\n        .oncomplete(function () {\r\n        g(\"Intro2\", \"Complete\", 1);\r\n    })\r\n        .start();\r\n    g(\"IntroClicked\");\r\n}\r\n","import { mirrorY } from \"apparatus/draw\";\r\nimport { Gradients } from \"apparatus/gradients\";\r\nimport { Pivot, R, Segments } from \"apparatus/library/common\";\r\nimport { Group, Path } from \"paper\";\r\nimport { uniteAll } from \"../../draw\";\r\nvar DEMO_SWATCHES = {\r\n    'Black': \"#555555\",\r\n    'Blue': '#307ed1',\r\n    'Red': '#e33d4d',\r\n    'Green': '#3ac433',\r\n};\r\nvar FeltTipPen = /** @class */ (function () {\r\n    function FeltTipPen() {\r\n    }\r\n    FeltTipPen.prototype.render = function (appearance) {\r\n        var color = appearance.color, scale = appearance.scale;\r\n        var body = new Path.Rectangle(R(4, 0, 130, 20, Pivot.CENTER_RIGHT), 4.0)\r\n            .withGradientFill(\"down\", Gradients.cylinder(\"#dddddd\".color())).close();\r\n        var top = new Path(Segments([[-1, 10]], [[6, 10]], [[10, 6]], [[18, 6]]));\r\n        mirrorY(top);\r\n        top.close()\r\n            .withGradientFill(\"down\", Gradients.cylinder(color.color().ladd(0.1)));\r\n        var tip = new Path(Segments([[17, -5], , [6, 0]], [[28, 0]], [[17, 5], [6, 0]])).withGradientFill(\"up\", Gradients.simple(color.color(), 15));\r\n        var outline = uniteAll(body, top, tip).withStroke(\"thinner\");\r\n        var graphic = new Group([body, top, tip, outline]);\r\n        graphic.scale(scale);\r\n        return {\r\n            graphic: graphic,\r\n            hitShape: graphic.bounds.expand(5).toShape()\r\n        };\r\n    };\r\n    FeltTipPen.properties = {\r\n        label: \"Felt Tip Pen\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            color: DEMO_SWATCHES['Red'],\r\n            scale: 1.0\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"scale\", label: \"Scale\",\r\n                min: 0.8, max: 2.0, step: 0.1, unit: \"%\"\r\n            },\r\n            {\r\n                spec: \"color\", key: \"color\", label: \"Colour\",\r\n                swatches: DEMO_SWATCHES,\r\n                demoSwatches: DEMO_SWATCHES,\r\n                tier: \"boost\",\r\n            }\r\n        ],\r\n    };\r\n    return FeltTipPen;\r\n}());\r\nexport { FeltTipPen };\r\n","import { Group, Path, Shape } from \"paper\";\r\nimport { Random } from \"random/random\";\r\nimport { P, Segments } from \"../common\";\r\nvar Powder = /** @class */ (function () {\r\n    function Powder() {\r\n    }\r\n    Powder.prototype.render = function (appearance) {\r\n        var fillColor = appearance.color;\r\n        var strokeColor = fillColor.color().darken(0.3).hex();\r\n        var outline = createOutline(appearance);\r\n        outline.closePath();\r\n        if (appearance.shape != \"round\" && appearance.bottom == \"round\") {\r\n            // Smooth the bottom by adding handles\r\n            // on the first and last segment.\r\n            outline.firstSegment.handleIn.set(0, 5);\r\n            outline.lastSegment.handleOut.set(0, 5);\r\n        }\r\n        outline.withGradientFill(\"right-down\", [\r\n            [fillColor, 0.0],\r\n            [fillColor.color().darken(0.1).hex(), 1.0]\r\n        ]).withStroke(\"thinner\", strokeColor);\r\n        outline.scale(appearance.size / 1.5);\r\n        var graphic;\r\n        if (appearance.particles) {\r\n            // Add particles by creating dots randomly within\r\n            // the bounds of the graphic.\r\n            graphic = new Group([outline]);\r\n            // Particle color: If the fill color is dark enough,\r\n            // choose a light colour, otherwise choose the same\r\n            // color as the stroke colour.\r\n            var particleColor = fillColor.color().luminosity() > 0.1\r\n                ? strokeColor\r\n                : fillColor.color().lighten(0.2).hex();\r\n            var r = new Random();\r\n            var bounds = outline.bounds;\r\n            for (var y = bounds.top; y <= bounds.bottom; y += 5) {\r\n                for (var x = bounds.left; x <= bounds.right; x += 5) {\r\n                    var position = P(x, y).add(r.randomUnitValue(1.5));\r\n                    if (!outline.contains(position))\r\n                        continue;\r\n                    var particle = Shape.Circle(position, 1.0);\r\n                    particle.fillColor = particleColor;\r\n                    graphic.addChild(particle);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            graphic = outline;\r\n        }\r\n        return { graphic: graphic, hitShape: graphic.bounds.expand(10).toShape() };\r\n    };\r\n    Powder.properties = {\r\n        label: \"Powder pile\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: {\r\n            size: 1.5,\r\n            color: \"#90cc89\",\r\n            shape: \"smooth\",\r\n            bottom: \"round\",\r\n            particles: true,\r\n        },\r\n        appearanceSpecs: [\r\n            {\r\n                spec: \"slider\", key: \"size\", label: \"Size\",\r\n                min: 1.0, max: 5.0, step: 0.1,\r\n            },\r\n            {\r\n                spec: \"color\", key: \"color\", label: \"Colour\",\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"shape\", label: \"Shape\",\r\n                options: [\r\n                    { value: \"smooth\", label: \"Smooth\" },\r\n                    { value: \"flat\", label: \"Flat\" },\r\n                    { value: \"lumpy\", label: \"Lumpy\" },\r\n                    { value: \"round\", label: \"Round\" },\r\n                ],\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"bottom\", label: \"Bottom shape\",\r\n                options: [\r\n                    { value: \"round\", label: \"Round\" },\r\n                    { value: \"flat\", label: \"Flat\" },\r\n                ],\r\n                visible: function (a) { return a.shape === \"lumpy\" || a.shape === \"smooth\" || a.shape === \"flat\"; }\r\n            },\r\n            {\r\n                spec: \"checkbox\", key: \"particles\", label: \"Add particles\"\r\n            },\r\n        ],\r\n    };\r\n    return Powder;\r\n}());\r\nexport { Powder };\r\nfunction createOutline(apperance) {\r\n    switch (apperance.shape) {\r\n        case \"lumpy\":\r\n            return createLumpyOutline();\r\n        case \"smooth\":\r\n            return createSimplePileOutline(10);\r\n        case \"flat\":\r\n            return createSimplePileOutline(5);\r\n        case \"round\":\r\n            return new Path.Circle(P(0, -10), 10);\r\n    }\r\n}\r\nfunction createSimplePileOutline(height) {\r\n    var outline = new Path(Segments([[0, 0], undefined, [0, -height / 2]], [[10, -height], [-5, 0], [5, 0]], [[20, 0], [0, -height / 2]]));\r\n    return outline;\r\n}\r\nfunction createLumpyOutline() {\r\n    var outline = new Path(Segments([[0, 0], undefined, [-5, -3]], [[3, -8], [-4, -2], [1, -7]], [[10, -10], [-2, -3], [2, -3]], [[17, -8], [-1, -7], [4, -2]], [[20, 0], [5, -3]]));\r\n    return outline;\r\n}\r\n","import { Icon } from \"components/icon\";\r\nimport * as React from \"react\";\r\nimport { formatTooltip } from \"../../view/tooltips\";\r\n/**\r\n * Group of buttons that are displayed together.\r\n */\r\nexport var ButtonGroup = function (props) { return (React.createElement(\"div\", { className: \"toolboxGroup\", id: props.id },\r\n    \" \",\r\n    props.children)); };\r\nexport var Button = function (item) { return (React.createElement(\"div\", { onClick: function () { return item.onClick(); }, title: formatTooltip(item.hint, item.shortcuts) },\r\n    React.createElement(Icon, { name: item.icon, fullWidth: true }))); };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __rest = (this && this.__rest) || function (s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { mirrorX } from \"apparatus/draw\";\r\nimport { INFINITE_BOUNDS } from \"apparatus/driver\";\r\nimport { P, Segments } from \"apparatus/library/common\";\r\nimport { BasicShapes } from \"apparatus/library/shapes/common\";\r\nimport { Path } from \"paper\";\r\n/** Minimum gap in paper pixels, between the two arrow heads or head and an end. */\r\nvar MINIMUM_GAP = 10;\r\nfunction isV1(a) {\r\n    return a.length !== undefined;\r\n}\r\nvar Arrow = /** @class */ (function () {\r\n    function Arrow() {\r\n        this.drivers = [\r\n            __assign(__assign({ type: \"rectangle\" }, INFINITE_BOUNDS), { toAppearance: function (p) { return ({ end1x: p.x, end1y: p.y }); }, fromAppearance: function (a) { return P(a.end1x, a.end1y); }, scale: 1.0 }),\r\n            __assign(__assign({ type: \"rectangle\" }, INFINITE_BOUNDS), { toAppearance: function (p) { return ({ end2x: p.x, end2y: p.y }); }, fromAppearance: function (a) { return P(a.end2x, a.end2y); }, scale: 1.0 }),\r\n        ];\r\n        this.shouldUseBoundsCenter = true;\r\n    }\r\n    Arrow.isBoostRequiredForAppearance = function (a) {\r\n        return a.arrow === \"sharp\";\r\n    };\r\n    Arrow.convertToLatest = function (input) {\r\n        if (isV1(input)) {\r\n            var length_1 = input.length, rest = __rest(input, [\"length\"]);\r\n            return __assign(__assign({}, rest), { end1x: -length_1 / 2, end1y: 0, end2x: length_1 / 2, end2y: 0 });\r\n        }\r\n        return input;\r\n    };\r\n    Arrow.prototype.render = function (appearance) {\r\n        // The arrow is drawn vertically, centered at (0, 0).\r\n        // Hence, compute the transformation required, then draw the\r\n        // arrow, then apply the transform.\r\n        var startVector = P(appearance.end1x, appearance.end1y);\r\n        var endVector = P(appearance.end2x, appearance.end2y);\r\n        var deltaVector = endVector.subtract(startVector);\r\n        var length = deltaVector.length;\r\n        var rotation = deltaVector.angle;\r\n        var midPoint = startVector.add(endVector).divide(2);\r\n        var width = appearance.width, headScale = appearance.headScale, headThickness = appearance.headThickness, bothEnds = appearance.bothEnds;\r\n        var halfLength = length / 2;\r\n        var maxHeadSize = Math.max(4, length - MINIMUM_GAP) / (bothEnds ? 2 : 1);\r\n        var headSize = width * headScale * 2;\r\n        var headFlare = headSize * headThickness;\r\n        var effectiveHeadSize = Math.min(maxHeadSize, headSize);\r\n        var sharpShift = effectiveHeadSize * (appearance.arrow === \"sharp\" ? 0.15 : 0.0);\r\n        var graphic = new Path(Segments([[halfLength - effectiveHeadSize + sharpShift, -width / 2]], [[halfLength - effectiveHeadSize, -headFlare]], [[halfLength, 0]], // Tip\r\n        [[halfLength - effectiveHeadSize, headFlare]], [[halfLength - effectiveHeadSize + sharpShift, width / 2]]));\r\n        if (bothEnds) {\r\n            mirrorX(graphic);\r\n        }\r\n        else {\r\n            graphic.addSegments(Segments([[-halfLength, width / 2]], [[-halfLength, -width / 2]]));\r\n        }\r\n        graphic.closePath();\r\n        graphic.rotate(rotation);\r\n        graphic.position.x += midPoint.x;\r\n        graphic.position.y += midPoint.y;\r\n        BasicShapes.applyStyle(graphic, appearance);\r\n        return {\r\n            graphic: graphic,\r\n            pivot: P(0, 0),\r\n            hitShape: BasicShapes.bounds(graphic)\r\n        };\r\n    };\r\n    Arrow.properties = {\r\n        label: \"Arrow\",\r\n        canContainLiquids: false,\r\n        defaultAppearance: __assign({ end1x: -75, end1y: 0, end2x: 75, end2y: 0, width: 30, bothEnds: false, headScale: 1.0, headThickness: 0.5, arrow: \"flat\" }, BasicShapes.defaultAppearance),\r\n        appearanceSpecs: __spreadArrays(BasicShapes.specs, [\r\n            BasicShapes.header,\r\n            {\r\n                spec: \"slider\", key: \"width\", label: \"Width\",\r\n                min: 4, max: 50,\r\n            },\r\n            {\r\n                spec: \"radio\", key: \"arrow\", label: \"Arrow style\",\r\n                options: [\r\n                    { value: \"flat\", label: \"Flat\" },\r\n                    { value: \"sharp\", label: \"Sharp\", tier: \"boost\" },\r\n                ],\r\n                allowSelectingTierLockedOptions: true,\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"headScale\", label: \"Arrow scale\",\r\n                min: 1.0, max: 2, step: 0.01, unit: \"%\"\r\n            },\r\n            {\r\n                spec: \"slider\", key: \"headThickness\", label: \"Arrow thickness\",\r\n                min: 0.25, max: 1.0, step: 0.01, unit: \"%\"\r\n            },\r\n            {\r\n                spec: \"checkbox\", key: \"bothEnds\", label: \"Arrows on both ends\"\r\n            },\r\n        ]),\r\n    };\r\n    return Arrow;\r\n}());\r\nexport { Arrow };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n// Application entry point.\r\nimport '@szhsin/react-menu/dist/index.css';\r\nimport { createApparatus } from \"apparatus/library\";\r\nimport { P } from \"apparatus/library/common\";\r\nimport { addArrowMutator } from \"arrows/command\";\r\nimport { Arrow } from \"arrows/type\";\r\nimport { registerBootstrapColorpickerExtensions } from \"bootstrap_colorpicker_extensions\";\r\nimport { commandProcessor } from \"command/command\";\r\nimport Flags from \"flags\";\r\nimport { ConnectedApp } from \"layout/app\";\r\nimport { clog } from \"log\";\r\nimport * as React from \"react\";\r\nimport * as DOM from \"react-dom\";\r\nimport { Provider } from \"react-redux\";\r\nimport { addItems } from \"store/actions\";\r\nimport { ID } from \"store/id\";\r\n// Redux components.\r\nimport wrappedAppStore, { appStore } from \"store/store\";\r\n// Import styles\r\nimport \"../less/styles.less\";\r\nimport { BOOTSTRAP_COLORPICKER_CSS_SELECTOR } from \"./components/colorpicker\";\r\n// Set up libraries and frameworks\r\nimport \"./setup\";\r\nimport { setUpToastr } from \"./setup\";\r\nimport { logIn, logOut } from \"./store/actions\";\r\nimport { Consts } from \"./vars\";\r\n/** App entry point. */\r\nfunction main() {\r\n    // Set up Toastr options.\r\n    setUpToastr();\r\n    // Polyfill fetch for IE11.\r\n    if (window.fetch === undefined) {\r\n        clog(\"Polyfilling fetch...\");\r\n        window.fetch = window['unfetch'];\r\n    }\r\n    // Initialise app.\r\n    // Put the Provider on the outside and then place the connected app inside it.\r\n    var app = React.createElement(ConnectedApp);\r\n    var provider = React.createElement(Provider, { store: appStore }, app);\r\n    DOM.render(provider, document.getElementById(\"app\"));\r\n    // TODO: Handle case where the store is empty to begin with\r\n    // Add items to start with.\r\n    if (!Consts.isDev) {\r\n        // Place first items slightly off center so that new items\r\n        // added by the user are visible.\r\n        var center = paper.project.view.center.add(P(-50, -30));\r\n        var beaker = createApparatus(\"beaker\", center);\r\n        beaker.selected = true;\r\n        wrappedAppStore.dispatch(addItems([\r\n            createApparatus(\"table\", center.add(P(0, 72))),\r\n            beaker\r\n        ]));\r\n        wrappedAppStore.dispatchFn(\"addArrow\", addArrowMutator([__assign(__assign({}, Arrow.defaultArrow), { id: ID.mint(\"arrow\"), start: center.subtract(P(120, 90)).toPlain(), end: center.subtract(P(60, 20)).toPlain(), isChemMarkEnabled: true, label: \"H2O\" })]));\r\n        registerUnloadListener();\r\n    }\r\n    else {\r\n        var toAdd = [\r\n            \"__live edit__\",\r\n            \"__raster image__\",\r\n            \"powerpack\",\r\n            \"spring\",\r\n            \"mirror\",\r\n            \"magnet\",\r\n            \"voltmeter-s\",\r\n            \"ammeter-s\",\r\n            \"pulley\",\r\n            \"cable\",\r\n            \"glass block\",\r\n            \"slotted weight\",\r\n            \"raybox\",\r\n            \"choice chamber\",\r\n            \"vernier\",\r\n            \"digital voltmeter\",\r\n            \"digital ammeter\",\r\n            \"solenoid\",\r\n            \"centrifuge\",\r\n            \"weight boat\",\r\n            \"paperclip\",\r\n            \"trolley\",\r\n            \"ramp\",\r\n            \"light gate\",\r\n            \"tlc chamber\",\r\n        ];\r\n        appStore.dispatch(addItems(toAdd.map(function (item, i) { return createApparatus(item, { x: (i % 4) * 150 + 100, y: Math.floor(i / 4) * 150 + 150 }); })));\r\n    }\r\n    registerBootstrapColorpickerExtensions();\r\n    // Fix mouse up outside bootstrap colorpicker not ending slider drag.\r\n    $(\"body\").on(\"mouseup\", function () {\r\n        $(\"\" + BOOTSTRAP_COLORPICKER_CSS_SELECTOR).each(function (i, el) {\r\n            var data = $(el).data();\r\n            if (!data)\r\n                return;\r\n            if (!data.colorpicker)\r\n                return;\r\n            data.colorpicker.sliderHandler.released();\r\n        });\r\n    });\r\n}\r\n// function printNumberOfCustomisations() {\r\n//     let optionsCount = 0\r\n//     for (const spec of apparatusSpecListWithNames) {\r\n//         const klass = apparatusClass(spec.type)\r\n//         optionsCount += klass.properties.appearanceSpecs.filter(s => s.tier === \"boost\").length\r\n//     }\r\n//     console.log(optionsCount)\r\n// }\r\n/** Registers an event listener to ask user before closing Chemix. */\r\nfunction registerUnloadListener() {\r\n    window.addEventListener('beforeunload', function (e) {\r\n        if (commandProcessor.hasDirtyChanges()) {\r\n            // Ask user to confirm before exiting.\r\n            e.preventDefault();\r\n            e.returnValue = '';\r\n        }\r\n        else {\r\n            // Exit freely.\r\n            // The absence of a returnValue property on the event will guarantee the browser unload happens\r\n            delete e['returnValue'];\r\n        }\r\n    });\r\n}\r\n// Bind to on Ready\r\nfunction ready(fn) {\r\n    if (document.readyState != 'loading') {\r\n        fn();\r\n    }\r\n    else {\r\n        document.addEventListener('DOMContentLoaded', fn);\r\n    }\r\n}\r\nready(main);\r\n// Allow hacking!\r\nif (Consts.isDev) {\r\n    var fakeLogin = function (firstTimeLogin) {\r\n        appStore.dispatch(logIn({\r\n            jwtToken: \"f\", provider: \"google\", firstTimeLogin: firstTimeLogin, tier: \"boost\",\r\n            user: { id: \"0\", name: \"Chemix User\", handle: \"fake.user@Example.com\", email: \"fake.user@example.com\", avatarUrl: \"./images/200.png\" }\r\n        }));\r\n    };\r\n    window[\"__FLAGS__\"] = Flags;\r\n    window[\"__addApparatus__\"] = function (type) {\r\n        appStore.dispatch(addItems([createApparatus(type, { x: 250, y: 300 })]));\r\n    };\r\n    window[\"__fakeLogin__\"] = fakeLogin;\r\n    window[\"__fakeLogout__\"] = function () {\r\n        appStore.dispatch(logOut());\r\n    };\r\n    window[\"__enableSuperZoom__\"] = function () { return $('#zoom-slider').slider({ max: 6 }); };\r\n    window[\"__store__\"] = function () { return appStore; };\r\n}\r\n// For crash testing.\r\n;\r\nwindow[\"__tonngokhong__\"] = function () { appStore.dispatch(addItems([createApparatus(\"__brk\", { x: 250, y: 300 })])); };\r\n","import Color, * as color from \"color\";\r\nString.prototype.color = function () {\r\n    // Have to cast to any, since casting to color & Color does not work.\r\n    return color(this);\r\n};\r\nColor.prototype.ladd = function (delta) {\r\n    return this.l(this.l() + delta);\r\n};\r\nColor.prototype.sadd = function (delta) {\r\n    return this.saturationl(this.saturationl() + delta);\r\n};\r\n"],"sourceRoot":""}